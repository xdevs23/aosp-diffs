```diff
diff --git a/Android.bp b/Android.bp
index c7736221b..cb4b3aae4 100644
--- a/Android.bp
+++ b/Android.bp
@@ -16,6 +16,20 @@ package {
     default_applicable_licenses: ["Android-Apache-2.0"],
 }
 
+genrule {
+    name: "statslog-carsettings-java-gen",
+    tools: ["stats-log-api-gen"],
+    cmd: "$(location stats-log-api-gen) --java $(out) --module carsettings" +
+        " --javaPackage com.android.car.settings --javaClass CarSettingsStatsLog",
+    out: ["com/android/car/settings/CarSettingsStatsLog.java"],
+}
+
+carsettings_srcs = [
+    "src/**/*.kt",
+    "src/**/*.java",
+    ":statslog-carsettings-java-gen",
+]
+
 android_library {
     name: "CarSettings-core",
     platform_apis: true,
@@ -24,15 +38,13 @@ android_library {
         "SettingsLib-search-defaults",
     ],
 
-    srcs: [
-        "src/**/*.kt",
-        "src/**/*.java",
-    ],
+    srcs: carsettings_srcs,
 
     static_libs: [
         "androidx.lifecycle_lifecycle-common-java8",
         "androidx.lifecycle_lifecycle-extensions",
         "androidx.preference_preference",
+        "androidx.window_window",
         "androidx-constraintlayout_constraintlayout",
         "androidx.test.core",
         "car-apps-common",
@@ -99,9 +111,59 @@ android_app {
     use_resource_processor: false,
 }
 
-// Duplicate of CarSettings which includes testing only resources for Robolectric
+// Testing app (not lib) is required for deviceless testing (Robolectric) to
+// include testing only resources.This is an app and not a library due to
+// resource processing differences.
+android_app {
+    name: "CarSettingsAppForTesting",
+    platform_apis: true,
+    defaults: [
+        "SettingsLibDefaults",
+        "SettingsLib-search-defaults",
+    ],
+
+    srcs: carsettings_srcs,
+
+    libs: [
+        "android.car",
+    ],
+
+    static_libs: [
+        "CarSettings-core",
+    ],
+
+    // Testing only resources must be applied last so they take precedence.
+    resource_dirs: [
+        "res",
+        "tests/deviceless/res",
+    ],
+
+    certificate: "platform",
+
+    optimize: {
+        enabled: false,
+    },
+
+    privileged: true,
+
+    dex_preopt: {
+        enabled: false,
+    },
+
+    dxflags: ["--multi-dex"],
+    // TODO(b/319708040): re-enable use_resource_processor
+    use_resource_processor: false,
+    lint: {
+        warning_checks: [
+            "FlaggedApi",
+        ],
+    },
+}
+
+// Testing app (not lib) is required for deviceless testing (Robolectric).
+// This is an app and not a library due to resource processing differences.
 android_app {
-    name: "CarSettingsForTesting",
+    name: "CarSettingsAppForMultivalentTesting",
     platform_apis: true,
     defaults: [
         "SettingsLibDefaults",
@@ -119,14 +181,12 @@ android_app {
 
     static_libs: [
         "CarSettings-core",
-        // TODO: b/353758891 - REMOVE once prebuilt w/ fix is dropped into main.
-        "car-ui-lib-oem-apis",
     ],
 
     // Testing only resources must be applied last so they take precedence.
     resource_dirs: [
         "res",
-        "tests/robotests/res",
+        "tests/multivalent/res",
     ],
 
     certificate: "platform",
@@ -152,19 +212,15 @@ android_app {
 }
 
 android_library {
-    name: "CarSettingsForUnitTesting",
+    name: "CarSettingsLibForDeviceTesting",
     platform_apis: true,
     defaults: [
         "SettingsLibDefaults",
         "SettingsLib-search-defaults",
     ],
 
-    manifest: "tests/unit/AndroidManifest.xml",
-
-    srcs: [
-        "src/**/*.kt",
-        "src/**/*.java",
-    ],
+    manifest: "tests/multivalent/AndroidManifest.xml",
+    srcs: carsettings_srcs,
 
     libs: [
         "android.car",
@@ -192,7 +248,7 @@ android_library {
     // Testing only resources must be applied last so they take precedence.
     resource_dirs: [
         "res",
-        "tests/unit/res",
+        "tests/multivalent/res",
     ],
 
     optimize: {
@@ -219,3 +275,8 @@ filegroup {
     name: "CarSettings_proguard_flags",
     srcs: ["proguard.flags"],
 }
+
+filegroup {
+    name: "CarSettingsShadows-srcs",
+    srcs: ["tests/helpers/src/com/android/car/settings/testutils/Shadow*.java"],
+}
diff --git a/AndroidManifest.xml b/AndroidManifest.xml
index 0aad472be..ddc031da6 100644
--- a/AndroidManifest.xml
+++ b/AndroidManifest.xml
@@ -47,6 +47,7 @@
     <uses-permission android:name="android.permission.GET_PACKAGE_SIZE"/>
     <uses-permission android:name="android.permission.HIDE_NON_SYSTEM_OVERLAY_WINDOWS"/>
     <uses-permission android:name="android.permission.INJECT_EVENTS"/>
+    <uses-permission android:name="android.permission.INSTALL_PACKAGES"/>
     <uses-permission android:name="android.permission.INTERNET"/>
     <uses-permission android:name="android.permission.MANAGE_ACCOUNTS"/>
     <uses-permission android:name="android.permission.MANAGE_SENSOR_PRIVACY"/>
@@ -72,8 +73,11 @@
     <uses-permission android:name="android.permission.UWB_PRIVILEGED"/>
     <uses-permission android:name="android.permission.WRITE_SETTINGS"/>
     <uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS"/>
+    <uses-permission android:name="android.permission.LAUNCH_MULTI_PANE_SETTINGS_DEEP_LINK" />
     <uses-permission android:name="android.car.permission.CAR_CONTROL_AUDIO_SETTINGS"/>
     <uses-permission android:name="android.car.permission.CAR_CONTROL_AUDIO_VOLUME"/>
+    <uses-permission android:name="android.car.permission.CAR_IDENTIFICATION"/>
+    <uses-permission android:name="android.car.permission.CONTROL_APP_BLOCKING"/>
     <uses-permission android:name="android.car.permission.READ_PERSIST_TETHERING_SETTINGS"/>
 
     <permission android:name="com.android.car.settings.SET_INITIAL_LOCK"
@@ -88,6 +92,10 @@
         android:directBootAware="true"
         android:supportsRtl="true">
 
+        <property
+            android:name="android.window.PROPERTY_ACTIVITY_EMBEDDING_SPLITS_ENABLED"
+            android:value="true" />
+
         <activity android:name=".admin.FactoryResetActivity"
             android:excludeFromRecents="true"
             android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
@@ -195,6 +203,14 @@
             android:name=".common.CarSettingActivities$UnitsSettingsActivity"
             android:windowSoftInputMode="adjustPan"
             android:exported="true">
+            <intent-filter>
+                <action android:name="android.settings.REGIONAL_PREFERENCES_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.TEMPERATURE_UNIT_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
             <meta-data android:name="com.android.car.settings.TOP_LEVEL_HEADER_KEY"
                        android:value="@string/hk_UnitsSettingsActivity" />
             <meta-data android:name="distractionOptimized" android:value="true"/>
@@ -236,6 +252,18 @@
                 <action android:name="android.settings.ALL_APPS_NOTIFICATION_SETTINGS" />
                 <category android:name="android.intent.category.DEFAULT" />
             </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.VOICE_CONTROL_DO_NOT_DISTURB_MODE" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter android:priority="10">
+                <action android:name="android.settings.AUTOMATIC_ZEN_RULE_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.ZEN_MODE_PRIORITY_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
             <meta-data android:name="com.android.car.settings.TOP_LEVEL_HEADER_KEY"
                        android:value="@string/hk_NotificationsActivity" />
             <meta-data android:name="distractionOptimized" android:value="true"/>
@@ -420,6 +448,14 @@
             android:name=".common.CarSettingActivities$LanguagesAndInputActivity"
             android:windowSoftInputMode="adjustPan"
             android:exported="true">
+            <intent-filter>
+                <action android:name="android.settings.REQUEST_SET_AUTOFILL_SERVICE" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.INPUT_METHOD_SUBTYPE_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
             <meta-data android:name="com.android.car.settings.TOP_LEVEL_HEADER_KEY"
                        android:value="@string/hk_LanguagesAndInputActivity" />
             <meta-data android:name="distractionOptimized" android:value="true"/>
@@ -516,6 +552,33 @@
             <meta-data android:name="distractionOptimized" android:value="true"/>
         </activity>
 
+        <activity
+            android:name=".common.CarSettingActivities$AppAspectRatioActivity"
+            android:windowSoftInputMode="adjustPan"
+            android:exported="true">
+            <!-- The following intent actions are listed twice in order to support multiple ways to
+                provide the package name. -->
+            <!-- This intent filter expects to receive the package name via the data field.
+                 i.e. adb shell am start -a android.settings.APPLICATION_DETAILS_SETTINGS \
+                      -d "package:<package name>" -->
+            <intent-filter android:priority="10">
+                <action android:name="android.settings.MANAGE_USER_ASPECT_RATIO_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+                <data android:scheme="package" />
+            </intent-filter>
+
+            <!-- This intent filter expects to receive the package name via an extra string.
+                 i.e. adb shell am start -a android.settings.APPLICATION_DETAILS_SETTINGS
+                      -e "android.provider.extra.APP_PACKAGE" "<package name>" -->
+            <intent-filter android:priority="10">
+                <action android:name="android.settings.MANAGE_USER_ASPECT_RATIO_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <meta-data android:name="com.android.car.settings.TOP_LEVEL_HEADER_KEY"
+                       android:value="@string/hk_AppAspectRatioActivity" />
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
         <activity
             android:name=".common.CarSettingActivities$ModifySystemSettingsActivity"
             android:windowSoftInputMode="adjustPan"
@@ -993,8 +1056,166 @@
             </intent-filter>
             <meta-data android:name="distractionOptimized" android:value="true"/>
         </activity>
+        <activity android:name=".deeplink.DeepLinkHomepageActivity"
+                  android:exported="true"
+                  android:enabled="false"
+                  android:excludeFromRecents="true"
+                  android:launchMode="singleTask"
+                  android:taskAffinity=".deeplink.DeepLinkHomepageActivity"
+                  android:permission="android.permission.LAUNCH_MULTI_PANE_SETTINGS_DEEP_LINK">
+            <intent-filter>
+                <action android:name="android.settings.SETTINGS_EMBED_DEEP_LINK_ACTIVITY" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+        <activity android:name=".search.CarSearchResultTrampoline"
+                  android:theme="@android:style/Theme.NoDisplay"
+                  android:excludeFromRecents="true"
+                  android:exported="true">
+            <intent-filter>
+                <action android:name="com.android.car.settings.SEARCH_RESULT_TRAMPOLINE" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
+
+        <activity android:name=".common.SettingsDefaultIntentActivity"
+                  android:theme="@style/AlertDialogTheme"
+                  android:excludeFromRecents="true"
+                  android:exported="true"
+                  android:launchMode="singleTask">
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+            <!-- Common Settings Intents -->
+            <intent-filter>
+                <action android:name="android.settings.AIRPLANE_MODE_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.BATTERY_SAVER_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.BIOMETRIC_ENROLL" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.MEMORY_CARD_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.HARD_KEYBOARD_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.action.MANAGE_OVERLAY_PERMISSION" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.NFC_PAYMENT_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.NFC_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.NFCSHARING_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.NIGHT_DISPLAY_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.NOTIFICATION_POLICY_ACCESS_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.ACTION_PRINT_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.VOICE_CONTROL_AIRPLANE_MODE" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.VOICE_CONTROL_BATTERY_SAVER_MODE" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.VR_LISTENER_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.search.action.SEARCH_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.action.APP_USAGE_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.ACTION_CONDITION_PROVIDER_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.APP_NOTIFICATION_BUBBLE_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.AUTO_ROTATE_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.FINGERPRINT_ENROLL" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.MANAGE_ALL_SIM_PROFILES_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.MANAGE_APP_USE_FULL_SCREEN_INTENT" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.MANAGE_SUPERVISOR_RESTRICTED_SETTING" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.NOTIFICATION_ASSISTANT_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.QUICK_ACCESS_WALLET_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.QUICK_LAUNCH_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.SATELLITE_SETTING" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.SHOW_WORK_POLICY_INFO" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.STORAGE_VOLUME_ACCESS_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+            <intent-filter>
+                <action android:name="android.settings.VPN_SETTINGS" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
+        </activity>
 
-    <service android:name=".bluetooth.BluetoothPairingService"
+        <service android:name=".bluetooth.BluetoothPairingService"
         android:foregroundServiceType="connectedDevice"/>
 
         <service android:name=".setupservice.InitialLockSetupService"
diff --git a/PREUPLOAD.cfg b/PREUPLOAD.cfg
index 11ce03a1d..ee48b582c 100644
--- a/PREUPLOAD.cfg
+++ b/PREUPLOAD.cfg
@@ -2,6 +2,7 @@
 checkstyle_hook = ${REPO_ROOT}/prebuilts/checkstyle/checkstyle.py --sha ${PREUPLOAD_COMMIT}
 ktlint_hook = ${REPO_ROOT}/prebuilts/ktlint/ktlint.py -f ${PREUPLOAD_FILES}
 overlayable_resource_hook = ${REPO_ROOT}/packages/apps/Car/systemlibs/tools/rro/verify-overlayable.py -r res -e res/values/overlayable.xml res/values/preference_keys.xml res/values/preference_screen_keys.xml res/values/non_overlayable.xml -o res/values/overlayable.xml
+check_intents_hook = tools/handleintents/verify_intents.py -i ${REPO_ROOT}/frameworks/base/core/java/android/provider/Settings.java -o AndroidManifest.xml -p ACTION_  -e
 
 [Builtin Hooks]
 commit_msg_changeid_field = true
diff --git a/aconfig/carsettings.aconfig b/aconfig/carsettings.aconfig
index dc2a7f3f2..b408f4769 100644
--- a/aconfig/carsettings.aconfig
+++ b/aconfig/carsettings.aconfig
@@ -34,4 +34,18 @@ flag {
     namespace: "car_sys_exp"
     description: "Flag to display a single toggle for automatic local time in date/time page."
     bug: "326140783"
-}
\ No newline at end of file
+}
+
+flag {
+    name: "new_fragment_aspect_ratio_feature"
+    namespace: "car_sys_exp"
+    description: "Flag to display the preference and the fragment for the aspect ratio page."
+    bug: "375471891"
+}
+
+flag {
+    name: "new_fragment_for_intents"
+    namespace: "car_sys_exp"
+    description: "Flag to display several new fragments added to host necessary intents."
+    bug: "376744576"
+}
diff --git a/res/drawable/ic_app_aspect_ratio_16_9.xml b/res/drawable/ic_app_aspect_ratio_16_9.xml
new file mode 100644
index 000000000..2b72ff9a8
--- /dev/null
+++ b/res/drawable/ic_app_aspect_ratio_16_9.xml
@@ -0,0 +1,62 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="@dimen/aspect_ratio_icon_width"
+    android:height="@dimen/aspect_ratio_icon_height"
+    android:viewportWidth="412"
+    android:viewportHeight="300">
+  <group>
+    <clip-path
+        android:pathData="M0,0h412v300h-412z"/>
+    <path
+        android:pathData="M384.18,300H27.82C12.53,300 0,287.17 0,271.52V28.48C0,12.83 12.53,0 27.82,0H384.29C399.47,0 412,12.83 412,28.48V271.63C412,287.17 399.47,300 384.18,300Z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M321.83,134.76V134C322.96,133.96 323.87,132.78 323.87,131.32V116.86C323.87,115.4 322.96,114.22 321.83,114.18V58.55C321.83,52.85 317.2,48.22 311.49,48.22H213.79C211.62,48.22 209.49,48.77 207.6,49.82C206.71,50.18 205.73,50.18 204.84,49.83L204.81,49.82C202.92,48.77 200.79,48.22 198.62,48.22H101.22C95.51,48.22 90.88,52.85 90.88,58.55V242.05C90.88,247.76 95.51,252.38 101.22,252.38H198.84C201,252.38 203.13,251.83 205.03,250.78C205.86,250.45 206.78,250.44 207.63,250.73L207.73,250.78C209.62,251.83 213.04,252.38 215.2,252.38H311.49C317.2,252.38 321.83,247.76 321.83,242.05V181.69C322.96,181.65 323.87,180.47 323.87,179.01V152.1C323.87,150.65 322.96,149.46 321.83,149.43V134.76ZM319.45,242.43C319.45,246.61 315.67,250.01 311.49,250.01H101.21C97.04,250.01 93.26,246.61 93.26,242.43V58.55C93.26,54.38 97.04,50.6 101.21,50.6H311.49C315.67,50.6 319.45,54.38 319.45,58.55V242.43Z"
+        android:fillColor="@color/aspect_ratio_icon_outline_color"/>
+    <path
+        android:pathData="M155,53L259,53A4,4 0,0 1,263 57L263,243A4,4 0,0 1,259 247L155,247A4,4 0,0 1,151 243L151,57A4,4 0,0 1,155 53z"
+        android:fillColor="@color/aspect_ratio_icon_inner_line_color"/>
+    <path
+        android:pathData="M157,57L257,57A2,2 0,0 1,259 59L259,241A2,2 0,0 1,257 243L157,243A2,2 0,0 1,155 241L155,59A2,2 0,0 1,157 57z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M171.48,237H161V226.42"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M161,237L176,222"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M242.52,63L253,63L253,73.58"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M253,63L238,78"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+  </group>
+</vector>
diff --git a/res/drawable/ic_app_aspect_ratio_3_2.xml b/res/drawable/ic_app_aspect_ratio_3_2.xml
new file mode 100644
index 000000000..c918e85a8
--- /dev/null
+++ b/res/drawable/ic_app_aspect_ratio_3_2.xml
@@ -0,0 +1,62 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="@dimen/aspect_ratio_icon_width"
+    android:height="@dimen/aspect_ratio_icon_height"
+    android:viewportWidth="412"
+    android:viewportHeight="300">
+  <group>
+    <clip-path
+        android:pathData="M0,0h412v300h-412z"/>
+    <path
+        android:pathData="M384.18,300H27.82C12.53,300 0,287.17 0,271.52V28.48C0,12.83 12.53,0 27.82,0H384.29C399.47,0 412,12.83 412,28.48V271.63C412,287.17 399.47,300 384.18,300Z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M321.83,134.76V134C322.96,133.96 323.87,132.78 323.87,131.32V116.86C323.87,115.4 322.96,114.22 321.83,114.18V58.55C321.83,52.85 317.2,48.22 311.49,48.22H213.79C211.62,48.22 209.49,48.77 207.6,49.82C206.71,50.18 205.73,50.18 204.84,49.83L204.81,49.82C202.92,48.77 200.79,48.22 198.62,48.22H101.22C95.51,48.22 90.88,52.85 90.88,58.55V242.05C90.88,247.76 95.51,252.38 101.22,252.38H198.84C201,252.38 203.13,251.83 205.03,250.78C205.86,250.45 206.78,250.44 207.63,250.73L207.73,250.78C209.62,251.83 213.04,252.38 215.2,252.38H311.49C317.2,252.38 321.83,247.76 321.83,242.05V181.69C322.96,181.65 323.87,180.47 323.87,179.01V152.1C323.87,150.65 322.96,149.46 321.83,149.43V134.76ZM319.45,242.43C319.45,246.61 315.67,250.01 311.49,250.01H101.21C97.04,250.01 93.26,246.61 93.26,242.43V58.55C93.26,54.38 97.04,50.6 101.21,50.6H311.49C315.67,50.6 319.45,54.38 319.45,58.55V242.43Z"
+        android:fillColor="@color/aspect_ratio_icon_outline_color"/>
+    <path
+        android:pathData="M144,53L268,53A4,4 0,0 1,272 57L272,243A4,4 0,0 1,268 247L144,247A4,4 0,0 1,140 243L140,57A4,4 0,0 1,144 53z"
+        android:fillColor="@color/aspect_ratio_icon_inner_line_color"/>
+    <path
+        android:pathData="M146,57L266,57A2,2 0,0 1,268 59L268,241A2,2 0,0 1,266 243L146,243A2,2 0,0 1,144 241L144,59A2,2 0,0 1,146 57z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M160.48,237H150V226.42"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M150,237L165,222"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M251.52,63L262,63L262,73.58"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M262,63L247,78"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+  </group>
+</vector>
diff --git a/res/drawable/ic_app_aspect_ratio_4_3.xml b/res/drawable/ic_app_aspect_ratio_4_3.xml
new file mode 100644
index 000000000..3da19b497
--- /dev/null
+++ b/res/drawable/ic_app_aspect_ratio_4_3.xml
@@ -0,0 +1,62 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="@dimen/aspect_ratio_icon_width"
+    android:height="@dimen/aspect_ratio_icon_height"
+    android:viewportWidth="412"
+    android:viewportHeight="300">
+  <group>
+    <clip-path
+        android:pathData="M0,0h412v300h-412z"/>
+    <path
+        android:pathData="M384.18,300H27.82C12.53,300 0,287.17 0,271.52V28.48C0,12.83 12.53,0 27.82,0H384.29C399.47,0 412,12.83 412,28.48V271.63C412,287.17 399.47,300 384.18,300Z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M321.83,134.76V134C322.96,133.96 323.87,132.78 323.87,131.32V116.86C323.87,115.4 322.96,114.22 321.83,114.18V58.55C321.83,52.85 317.2,48.22 311.49,48.22H213.79C211.62,48.22 209.49,48.77 207.6,49.82C206.71,50.18 205.73,50.18 204.84,49.83L204.81,49.82C202.92,48.77 200.79,48.22 198.62,48.22H101.22C95.51,48.22 90.88,52.85 90.88,58.55V242.05C90.88,247.76 95.51,252.38 101.22,252.38H198.84C201,252.38 203.13,251.83 205.03,250.78C205.86,250.45 206.78,250.44 207.63,250.73L207.73,250.78C209.62,251.83 213.04,252.38 215.2,252.38H311.49C317.2,252.38 321.83,247.76 321.83,242.05V181.69C322.96,181.65 323.87,180.47 323.87,179.01V152.1C323.87,150.65 322.96,149.46 321.83,149.43V134.76ZM319.45,242.43C319.45,246.61 315.67,250.01 311.49,250.01H101.21C97.04,250.01 93.26,246.61 93.26,242.43V58.55C93.26,54.38 97.04,50.6 101.21,50.6H311.49C315.67,50.6 319.45,54.38 319.45,58.55V242.43Z"
+        android:fillColor="@color/aspect_ratio_icon_outline_color"/>
+    <path
+        android:pathData="M136,53L276,53A4,4 0,0 1,280 57L280,243A4,4 0,0 1,276 247L136,247A4,4 0,0 1,132 243L132,57A4,4 0,0 1,136 53z"
+        android:fillColor="@color/aspect_ratio_icon_inner_line_color"/>
+    <path
+        android:pathData="M138,57L274,57A2,2 0,0 1,276 59L276,241A2,2 0,0 1,274 243L138,243A2,2 0,0 1,136 241L136,59A2,2 0,0 1,138 57z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M152.48,237H142V226.42"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M142,237L157,222"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M259.52,63L270,63L270,73.58"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M270,63L255,78"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+  </group>
+</vector>
diff --git a/res/drawable/ic_app_aspect_ratio_display_size.xml b/res/drawable/ic_app_aspect_ratio_display_size.xml
new file mode 100644
index 000000000..53a17d7fc
--- /dev/null
+++ b/res/drawable/ic_app_aspect_ratio_display_size.xml
@@ -0,0 +1,62 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="@dimen/aspect_ratio_icon_width"
+    android:height="@dimen/aspect_ratio_icon_height"
+    android:viewportWidth="412"
+    android:viewportHeight="300">
+  <group>
+    <clip-path
+        android:pathData="M0,0h412v300h-412z"/>
+    <path
+        android:pathData="M384.18,300H27.82C12.53,300 0,287.17 0,271.52V28.48C0,12.83 12.53,0 27.82,0H384.29C399.47,0 412,12.83 412,28.48V271.63C412,287.17 399.47,300 384.18,300Z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M321.83,134.76V134C322.96,133.96 323.87,132.78 323.87,131.32V116.86C323.87,115.4 322.96,114.22 321.83,114.18V58.55C321.83,52.85 317.2,48.22 311.49,48.22H213.79C211.62,48.22 209.49,48.77 207.6,49.82C206.71,50.18 205.73,50.18 204.84,49.83L204.81,49.82C202.92,48.77 200.79,48.22 198.62,48.22H101.22C95.51,48.22 90.88,52.85 90.88,58.55V242.05C90.88,247.76 95.51,252.38 101.22,252.38H198.84C201,252.38 203.13,251.83 205.03,250.78C205.86,250.45 206.78,250.44 207.63,250.73L207.73,250.78C209.62,251.83 213.04,252.38 215.2,252.38H311.49C317.2,252.38 321.83,247.76 321.83,242.05V181.69C322.96,181.65 323.87,180.47 323.87,179.01V152.1C323.87,150.65 322.96,149.46 321.83,149.43V134.76ZM319.45,242.43C319.45,246.61 315.67,250.01 311.49,250.01H101.21C97.04,250.01 93.26,246.61 93.26,242.43V58.55C93.26,54.38 97.04,50.6 101.21,50.6H311.49C315.67,50.6 319.45,54.38 319.45,58.55V242.43Z"
+        android:fillColor="@color/aspect_ratio_icon_outline_color"/>
+    <path
+        android:pathData="M128,53L284,53A4,4 0,0 1,288 57L288,243A4,4 0,0 1,284 247L128,247A4,4 0,0 1,124 243L124,57A4,4 0,0 1,128 53z"
+        android:fillColor="@color/aspect_ratio_icon_inner_line_color"/>
+    <path
+        android:pathData="M130,57L282,57A2,2 0,0 1,284 59L284,241A2,2 0,0 1,282 243L130,243A2,2 0,0 1,128 241L128,59A2,2 0,0 1,130 57z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M144.48,237H134V226.42"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M134,237L149,222"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M267.52,63L278,63L278,73.58"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M278,63L263,78"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+  </group>
+</vector>
diff --git a/res/drawable/ic_app_aspect_ratio_fullscreen.xml b/res/drawable/ic_app_aspect_ratio_fullscreen.xml
new file mode 100644
index 000000000..77760dbed
--- /dev/null
+++ b/res/drawable/ic_app_aspect_ratio_fullscreen.xml
@@ -0,0 +1,62 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="@dimen/aspect_ratio_icon_width"
+    android:height="@dimen/aspect_ratio_icon_height"
+    android:viewportWidth="412"
+    android:viewportHeight="300">
+  <group>
+    <clip-path
+        android:pathData="M0,0h412v300h-412z"/>
+    <path
+        android:pathData="M384.18,300H27.82C12.53,300 0,287.17 0,271.52V28.48C0,12.83 12.53,0 27.82,0H384.29C399.47,0 412,12.83 412,28.48V271.63C412,287.17 399.47,300 384.18,300Z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M321.83,134.76V134C322.96,133.96 323.87,132.78 323.87,131.32V116.86C323.87,115.4 322.96,114.22 321.83,114.18V58.55C321.83,52.85 317.2,48.22 311.49,48.22H213.79C211.62,48.22 209.49,48.77 207.6,49.82C206.71,50.18 205.73,50.18 204.84,49.83L204.81,49.82C202.92,48.77 200.79,48.22 198.62,48.22H101.22C95.51,48.22 90.88,52.85 90.88,58.55V242.05C90.88,247.76 95.51,252.38 101.22,252.38H198.84C201,252.38 203.13,251.83 205.03,250.78C205.86,250.45 206.78,250.44 207.63,250.73L207.73,250.78C209.62,251.83 213.04,252.38 215.2,252.38H311.49C317.2,252.38 321.83,247.76 321.83,242.05V181.69C322.96,181.65 323.87,180.47 323.87,179.01V152.1C323.87,150.65 322.96,149.46 321.83,149.43V134.76ZM319.45,242.43C319.45,246.61 315.67,250.01 311.49,250.01H101.21C97.04,250.01 93.26,246.61 93.26,242.43V58.55C93.26,54.38 97.04,50.6 101.21,50.6H311.49C315.67,50.6 319.45,54.38 319.45,58.55V242.43Z"
+        android:fillColor="@color/aspect_ratio_icon_outline_color"/>
+    <path
+        android:pathData="M100,53L312,53A4,4 0,0 1,316 57L316,243A4,4 0,0 1,312 247L100,247A4,4 0,0 1,96 243L96,57A4,4 0,0 1,100 53z"
+        android:fillColor="@color/aspect_ratio_icon_inner_line_color"/>
+    <path
+        android:pathData="M102,57L310,57A2,2 0,0 1,312 59L312,241A2,2 0,0 1,310 243L102,243A2,2 0,0 1,100 241L100,59A2,2 0,0 1,102 57z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M116.48,237H106V226.42"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M106,237L121,222"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M295.52,63L306,63L306,73.58"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M306,63L291,78"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+  </group>
+</vector>
diff --git a/res/drawable/ic_app_aspect_ratio_half_screen.xml b/res/drawable/ic_app_aspect_ratio_half_screen.xml
new file mode 100644
index 000000000..5083bb286
--- /dev/null
+++ b/res/drawable/ic_app_aspect_ratio_half_screen.xml
@@ -0,0 +1,62 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="@dimen/aspect_ratio_icon_width"
+    android:height="@dimen/aspect_ratio_icon_height"
+    android:viewportWidth="412"
+    android:viewportHeight="300">
+  <group>
+    <clip-path
+        android:pathData="M0,0h412v300h-412z"/>
+    <path
+        android:pathData="M384.18,300H27.82C12.53,300 0,287.17 0,271.52V28.48C0,12.83 12.53,0 27.82,0H384.29C399.47,0 412,12.83 412,28.48V271.63C412,287.17 399.47,300 384.18,300Z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M321.83,134.76V134C322.96,133.96 323.87,132.78 323.87,131.32V116.86C323.87,115.4 322.96,114.22 321.83,114.18V58.55C321.83,52.85 317.2,48.22 311.49,48.22H213.79C211.62,48.22 209.49,48.77 207.6,49.82C206.71,50.18 205.73,50.18 204.84,49.83L204.81,49.82C202.92,48.77 200.79,48.22 198.62,48.22H101.22C95.51,48.22 90.88,52.85 90.88,58.55V242.05C90.88,247.76 95.51,252.38 101.22,252.38H198.84C201,252.38 203.13,251.83 205.03,250.78C205.86,250.45 206.78,250.44 207.63,250.73L207.73,250.78C209.62,251.83 213.04,252.38 215.2,252.38H311.49C317.2,252.38 321.83,247.76 321.83,242.05V181.69C322.96,181.65 323.87,180.47 323.87,179.01V152.1C323.87,150.65 322.96,149.46 321.83,149.43V134.76ZM319.45,242.43C319.45,246.61 315.67,250.01 311.49,250.01H101.21C97.04,250.01 93.26,246.61 93.26,242.43V58.55C93.26,54.38 97.04,50.6 101.21,50.6H311.49C315.67,50.6 319.45,54.38 319.45,58.55V242.43Z"
+        android:fillColor="@color/aspect_ratio_icon_outline_color"/>
+    <path
+        android:pathData="M148,53L264,53A4,4 0,0 1,268 57L268,243A4,4 0,0 1,264 247L148,247A4,4 0,0 1,144 243L144,57A4,4 0,0 1,148 53z"
+        android:fillColor="@color/aspect_ratio_icon_inner_line_color"/>
+    <path
+        android:pathData="M150,57L262,57A2,2 0,0 1,264 59L264,241A2,2 0,0 1,262 243L150,243A2,2 0,0 1,148 241L148,59A2,2 0,0 1,150 57z"
+        android:fillColor="@color/aspect_ratio_icon_background_color"/>
+    <path
+        android:pathData="M164.48,237H154V226.42"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M154,237L169,222"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M247.52,63L258,63L258,73.58"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+    <path
+        android:pathData="M258,63L243,78"
+        android:strokeLineJoin="round"
+        android:strokeWidth="4"
+        android:strokeColor="@color/aspect_ratio_icon_inner_line_color"
+        android:strokeLineCap="round"/>
+  </group>
+</vector>
diff --git a/res/drawable/ic_open.xml b/res/drawable/ic_open.xml
new file mode 100644
index 000000000..6fc4405e5
--- /dev/null
+++ b/res/drawable/ic_open.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="@dimen/icon_size"
+    android:height="@dimen/icon_size"
+    android:viewportWidth="960"
+    android:viewportHeight="960">
+    <path
+        android:fillColor="@color/icon_color_default"
+        android:pathData="M200,840Q167,840 143.5,816.5Q120,793 120,760L120,200Q120,167 143.5,143.5Q167,120 200,120L480,120L480,200L200,200Q200,200 200,200Q200,200 200,200L200,760Q200,760 200,760Q200,760 200,760L760,760Q760,760 760,760Q760,760 760,760L760,480L840,480L840,760Q840,793 816.5,816.5Q793,840 760,840L200,840ZM388,628L332,572L704,200L560,200L560,120L840,120L840,400L760,400L760,256L388,628Z"/>
+</vector>
diff --git a/res/drawable/ic_qr.xml b/res/drawable/ic_qr.xml
new file mode 100644
index 000000000..07edc5e0d
--- /dev/null
+++ b/res/drawable/ic_qr.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+        android:width="@dimen/icon_size"
+        android:height="@dimen/icon_size"
+        android:viewportWidth="960"
+        android:viewportHeight="960">
+    <path
+        android:fillColor="@color/icon_color_default"
+        android:pathData="M120,440L120,120L440,120L440,440L120,440ZM200,360L360,360L360,200L200,200L200,360ZM120,840L120,520L440,520L440,840L120,840ZM200,760L360,760L360,600L200,600L200,760ZM520,440L520,120L840,120L840,440L520,440ZM600,360L760,360L760,200L600,200L600,360ZM760,840L760,760L840,760L840,840L760,840ZM520,600L520,520L600,520L600,600L520,600ZM600,680L600,600L680,600L680,680L600,680ZM520,760L520,680L600,680L600,760L520,760ZM600,840L600,760L680,760L680,840L600,840ZM680,760L680,680L760,680L760,760L680,760ZM680,600L680,520L760,520L760,600L680,600ZM760,680L760,600L840,600L840,680L760,680Z"/>
+</vector>
diff --git a/res/layout/car_setting_activity.xml b/res/layout/car_setting_activity.xml
index 7b152a30d..b03043c2d 100644
--- a/res/layout/car_setting_activity.xml
+++ b/res/layout/car_setting_activity.xml
@@ -15,41 +15,16 @@
     limitations under the License.
 -->
 
-<androidx.constraintlayout.widget.ConstraintLayout
+<LinearLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:app="http://schemas.android.com/apk/res-auto"
     android:id="@+id/car_settings_activity_wrapper"
     android:layout_width="match_parent"
     android:layout_height="match_parent">
 
-    <FrameLayout
-        android:id="@+id/top_level_menu_container"
-        android:layout_width="@dimen/top_level_menu_width"
-        android:layout_height="match_parent"
-        app:layout_constraintStart_toStartOf="parent"
-        app:layout_constraintEnd_toStartOf="@id/top_level_divider">
-
-        <fragment
-            class="com.android.car.settings.common.TopLevelMenuFragment"
-            android:id="@+id/top_level_menu"
-            android:layout_width="match_parent"
-            android:layout_height="match_parent"/>
-    </FrameLayout>
-
-    <View
-        android:id="@+id/top_level_divider"
-        android:layout_width="@dimen/top_level_divider_width"
-        android:layout_height="match_parent"
-        app:layout_constraintStart_toEndOf="@id/top_level_menu_container"
-        app:layout_constraintEnd_toStartOf="@id/top_level_divider"
-        style="@style/CarSettingsActivityDividerStyle"/>
-
     <FrameLayout
         android:id="@+id/fragment_container_wrapper"
-        android:layout_width="0dp"
+        android:layout_width="match_parent"
         android:layout_height="match_parent"
-        app:layout_constraintStart_toEndOf="@id/top_level_divider"
-        app:layout_constraintEnd_toEndOf="parent"
         style="@style/CarSettingsFragmentContainerStyle">
 
         <com.android.car.settings.common.rotary.SettingsFocusParkingView
@@ -74,6 +49,6 @@
             android:text="@string/restricted_while_driving"
             android:textAppearance="?android:attr/textAppearanceLarge"
             android:visibility="gone"/>
-
     </FrameLayout>
-</androidx.constraintlayout.widget.ConstraintLayout>
+
+</LinearLayout>
diff --git a/res/layout/homepage_activity.xml b/res/layout/homepage_activity.xml
new file mode 100644
index 000000000..101ffbec1
--- /dev/null
+++ b/res/layout/homepage_activity.xml
@@ -0,0 +1,35 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2024 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/homepage_activity_wrapper"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent">
+
+    <FrameLayout
+        android:id="@+id/top_level_menu_container"
+        android:layout_width="@dimen/top_level_menu_width"
+        android:layout_height="match_parent"/>
+
+    <View
+        android:id="@+id/top_level_divider"
+        android:layout_width="@dimen/top_level_divider_width"
+        android:layout_height="match_parent"
+        style="@style/CarSettingsActivityDividerStyle"/>
+
+</LinearLayout>
diff --git a/res/layout/preference_widget_radiobutton.xml b/res/layout/preference_widget_radiobutton.xml
new file mode 100644
index 000000000..4f855cf57
--- /dev/null
+++ b/res/layout/preference_widget_radiobutton.xml
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2024 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<!-- Layout used by CheckBoxPreference for the checkbox style. This is inflated
+     inside android.R.layout.preference. -->
+<RadioButton xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@android:id/checkbox"
+    android:layout_width="wrap_content"
+    android:layout_height="wrap_content"
+    android:layout_gravity="center"
+    android:background="@null"
+    android:focusable="false"
+    android:clickable="false" />
diff --git a/res/layout/radio_with_image_preference.xml b/res/layout/radio_with_image_preference.xml
new file mode 100644
index 000000000..b5c0ca01a
--- /dev/null
+++ b/res/layout/radio_with_image_preference.xml
@@ -0,0 +1,75 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<LinearLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="?android:attr/selectableItemBackground"
+    android:gravity="center_vertical"
+    android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+    android:paddingTop="@dimen/radio_with_image_preference_padding_vertical"
+    android:paddingBottom="@dimen/radio_with_image_preference_padding_vertical">
+
+    <LinearLayout
+        android:id="@android:id/widget_frame"
+        android:layout_width="wrap_content"
+        android:layout_height="match_parent"
+        android:paddingHorizontal="@dimen/radio_with_image_preference_padding_horizontal"
+        android:gravity="center_horizontal"
+        android:minWidth="@dimen/radio_with_image_preference_min_width"
+        android:orientation="vertical"/>
+
+    <LinearLayout
+        android:layout_width="0dp"
+        android:layout_height="wrap_content"
+        android:layout_weight="1"
+        android:orientation="vertical"
+        android:paddingEnd="?android:attr/listPreferredItemPaddingEnd">
+
+        <TextView
+            android:id="@android:id/title"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:maxLines="2"
+            android:textAppearance="?android:attr/textAppearanceListItem"/>
+
+        <LinearLayout
+            android:id="@+id/summary_container"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:visibility="gone">
+            <TextView
+                android:id="@android:id/summary"
+                android:layout_width="0dp"
+                android:layout_height="wrap_content"
+                android:layout_weight="1"
+                android:textAppearance="?android:attr/textAppearanceSmall"
+                android:textAlignment="viewStart"
+                android:textColor="?android:attr/textColorSecondary"/>
+        </LinearLayout>
+
+        <ImageView
+            android:id="@android:id/icon"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:paddingTop="@dimen/radio_with_image_preference_icon_padding"
+            android:adjustViewBounds="true"
+            android:maxWidth="@dimen/radio_with_image_preference_icon_max_width"
+            android:maxHeight="@dimen/radio_with_image_preference_icon_max_height" />
+    </LinearLayout>
+</LinearLayout>
diff --git a/res/layout/top_level_preference.xml b/res/layout/top_level_preference.xml
index b9c812800..6a0593485 100644
--- a/res/layout/top_level_preference.xml
+++ b/res/layout/top_level_preference.xml
@@ -52,6 +52,7 @@
             android:id="@android:id/title"
             android:layout_width="wrap_content"
             android:layout_height="wrap_content"
+            android:layout_marginHorizontal="@dimen/top_level_preference_title_margin_horizontal"
             android:singleLine="true"
             android:textAppearance="@style/TextAppearance.CarUi.PreferenceTitle"/>
 
diff --git a/res/layout/top_level_recyclerview.xml b/res/layout/top_level_recyclerview.xml
index b6485cb39..da9f598a6 100644
--- a/res/layout/top_level_recyclerview.xml
+++ b/res/layout/top_level_recyclerview.xml
@@ -18,7 +18,6 @@
 <merge xmlns:android="http://schemas.android.com/apk/res/android">
     <com.android.car.ui.FocusArea
         xmlns:app="http://schemas.android.com/apk/res-auto"
-        android:id="@+id/settings_car_ui_focus_area"
         android:layout_width="match_parent"
         android:layout_height="match_parent">
         <com.android.car.ui.recyclerview.CarUiRecyclerView
diff --git a/res/layout/wifi_detail_share_fragment.xml b/res/layout/wifi_detail_share_fragment.xml
new file mode 100644
index 000000000..f75b80ecd
--- /dev/null
+++ b/res/layout/wifi_detail_share_fragment.xml
@@ -0,0 +1,56 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+<androidx.constraintlayout.widget.ConstraintLayout
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+    android:paddingStart="?android:attr/listPreferredItemPaddingStart">
+
+    <TextView
+        android:id="@+id/wifi_share_instruction"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/wifi_detail_share_description"
+        android:textAppearance="@style/TextAppearance.CarUi.PreferenceSummary"
+        android:layout_marginTop="@dimen/wifi_share_page_margin"
+        android:layout_marginBottom="@dimen/wifi_share_page_margin"
+        app:layout_constraintTop_toTopOf="parent"
+        app:layout_constraintBottom_toTopOf="@id/wifi_share_qr_code_container"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"/>
+
+    <androidx.cardview.widget.CardView
+        android:id="@+id/wifi_share_qr_code_container"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:scaleType="fitCenter"
+        android:antialias="true"
+        app:cardElevation="@dimen/card_view_elevation"
+        app:cardCornerRadius="@dimen/rounded_corner_radius"
+        android:layout_marginTop="@dimen/wifi_share_page_margin"
+        app:layout_constraintBottom_toBottomOf="parent"
+        app:layout_constraintEnd_toEndOf="parent"
+        app:layout_constraintStart_toStartOf="parent"
+        app:layout_constraintTop_toBottomOf="@id/wifi_share_instruction">
+        <ImageView
+            android:id="@+id/wifi_share_qr_code"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"/>
+    </androidx.cardview.widget.CardView>
+</androidx.constraintlayout.widget.ConstraintLayout>
diff --git a/res/values-af/strings.xml b/res/values-af/strings.xml
index 38cac58f1..57d22c3ad 100644
--- a/res/values-af/strings.xml
+++ b/res/values-af/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Verbinding suksesvol"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Wys alles"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Soek"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Gekoppelde toestelle"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Gebruik Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Ongebruikte apps"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# ongebruikte program}other{# ongebruikte programme}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Verwyder toestemmings en maak spasie oop"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Aspekverhouding (eksperimenteel)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Maak oop"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Appverstek"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Volskerm"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Halfskerm"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Toestelaspekverhouding"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Die app sal herbegin as jy die aspekverhouding verander. Jy kan ongestoorde veranderinge verloor. Sommige apps sal dalk nie vir sekere aspekverhoudings geoptimeer wees nie."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s se interne berging"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Gebruik stelselhulpbronne om programwerkverrigting te prioritiseer"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Datagebruik"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Skakel Bluetooth aan om jou toestelle te sien"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Maak Bluetooth-instellings oop om \'n toestel saam te bind"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Stel bestuurmodus"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Wys uitleg se grense"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Verplig RTL-uitlegrigting"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Pasmakingoorlegger"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Inligtingvermaakstelseladmin"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Geaktiveerde programme"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Gedeaktiveerde programme"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Jou internetpakkette het verval"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Sien pakkette"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Klaar"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Jou voertuig steun nie hierdie kenmerk nie"</string>
 </resources>
diff --git a/res/values-am/strings.xml b/res/values-am/strings.xml
index 8c5cce379..ece6e6954 100644
--- a/res/values-am/strings.xml
+++ b/res/values-am/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"   "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#    }one{#    }other{#    }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"  "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"  "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"                "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s    "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"      "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"     "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">" "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"--   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"    "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"   "</string>
 </resources>
diff --git a/res/values-ar/strings.xml b/res/values-ar/strings.xml
index b0269bb16..a0281433d 100644
--- a/res/values-ar/strings.xml
+++ b/res/values-ar/strings.xml
@@ -133,7 +133,7 @@
     <string name="wifi_details_ipv6_address_header" msgid="4707181386646531890">" IPv6"</string>
     <string name="wifi_gateway" msgid="4975799192860431013">""</string>
     <string name="wifi_preferences_title" msgid="772788844257225510">"   Wi-Fi"</string>
-    <string name="wifi_wakeup" msgid="7451825226044542000">"  WiFi "</string>
+    <string name="wifi_wakeup" msgid="7451825226044542000">"  WiFi "</string>
     <string name="wifi_wakeup_summary" msgid="7237521683331291414">"  WiFi         ."</string>
     <string name="wifi_wakeup_summary_no_location" msgid="2821576525488435259">"     .    "<annotation id="link">""</annotation>"."</string>
     <string name="wifi_settings_scanning_required_title" msgid="2726782203331704928">"       WiFi"</string>
@@ -141,7 +141,7 @@
     <string name="wifi_settings_scanning_required_enabled" msgid="5457372118991438313">"     WiFi."</string>
     <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"    "</string>
     <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"           WiFi       ."</string>
-    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"   WiFi  "</string>
+    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"   WiFi  "</string>
     <string name="learn_more" msgid="8214605928933358604">"  "</string>
     <string name="wifi_hotspot_name_title" msgid="8844779338692535356">"  "</string>
     <string name="wifi_hotspot_name_summary_connecting" msgid="5262510450498600038">"  <xliff:g id="WIFI_HOTSPOT_NAME">%1$s</xliff:g>"</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" ."</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -221,7 +227,7 @@
     <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"  "</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"       ."</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"      \"\"  \"\"."</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"    <xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"     <xliff:g id="DEVICE_NAME">%1$s</xliff:g>"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"  <xliff:g id="DEVICE_NAME">%1$s</xliff:g>      "</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"          ."</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"         ."</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"  "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{   }zero{#   }two{  }few{#   }many{#   }other{#   }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"    ( )"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"      "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"     "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"        .      .           ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"   %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"        ."</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -567,7 +583,7 @@
     <string name="uninstall_apps_permission_title" msgid="8448422340567430659">"  "</string>
     <string name="user_add_user_menu" msgid="4125869008006021799">"  "</string>
     <string name="user_new_user_name" msgid="906698527658609819">"  "</string>
-    <string name="user_add_user_title" msgid="6296827596015729982">"     "</string>
+    <string name="user_add_user_title" msgid="6296827596015729982">"     "</string>
     <string name="user_add_user_message_setup" msgid="812616230454605159">"              ."</string>
     <string name="user_add_user_message_update" msgid="3836353291078729240">"            ."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"     "</string>
@@ -787,7 +803,7 @@
     <string name="assistant_and_voice_use_screenshot_summary" msgid="3738474919393817950">"      "</string>
     <string name="notifications_recently_sent" msgid="9051696542615302799">"    "</string>
     <string name="notifications_all_apps" msgid="3557079551048958846">" "</string>
-    <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"  "</string>
+    <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"  "</string>
     <string name="manage_other_profiles_button_text" msgid="2262188413455510828">"   "</string>
     <string name="add_a_profile_button_text" msgid="8027395095117925114">"  "</string>
     <string name="delete_this_profile_text" msgid="6035404714526922665">"   "</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"      .          "</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">" "</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    ."</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"    ."</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"     ."</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">" \" \""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"      "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">" \"  \""</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -957,4 +976,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"  "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-as/strings.xml b/res/values-as/strings.xml
index cb4f2b575..78f3ba5b0 100644
--- a/res/values-as/strings.xml
+++ b/res/values-as/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"   "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#   }one{#   }other{#   }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"     "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">":"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">":"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">":"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"                         "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"     "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"      "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL     "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"    "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-az/strings.xml b/res/values-az/strings.xml
index b5b2c991a..cdb4da438 100644
--- a/res/values-az/strings.xml
+++ b/res/values-az/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Qouldu"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Hamsna baxn"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Axtarlr"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Qoulmu cihazlar"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth istifad edin"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"stifad olunmayan ttbiqlr"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# istifad olunmayan ttbiq}other{# istifad olunmayan ttbiq}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"cazlri silin v yer boaldn"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Trflr nisbti (Tcrbi)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"An"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Ttbiq defoltu"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Tam ekran"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Yarm ekran"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Cihazn trflr nisbti"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Trflr nisbtini dyidikd ttbiq yenidn baladlacaq. Yadda saxlanlmayan dyiikliklr it bilr. Bzi ttbiqlr myyn trflr nisbti n optimalladrlmaya bilr."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"Daxili yaddada %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Ttbiq performansn prioritetldirmk n sistem resurslarndan istifad edilir"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Data istifadsi"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Cihazlarnz grmk n Bluetooth\'u aktiv edin"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Cihaz birldirmk n Bluetooth ayarlarn an"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Srclk rejimini ayarlayn"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Dzn srhdlrini gstrin"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL dzn istiqamtini mcburi ttbiq et"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Frdildirm rty"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Mlumat-ylnc sisteminin admini"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktiv edilmi ttbiqlr"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktiv edilmi ttbiqlr"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"nternet planlarnn vaxt keib"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Planlara baxn"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Hazrdr"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Avtomobiliniz bu funksiyan dstklmir"</string>
 </resources>
diff --git a/res/values-b+sr+Latn/strings.xml b/res/values-b+sr+Latn/strings.xml
index f6f98dac7..e4d7f79a3 100644
--- a/res/values-b+sr+Latn/strings.xml
+++ b/res/values-b+sr+Latn/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Povezivanje je uspelo"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Prikai sve"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Pretrauje se"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Povezani ureaji"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Koristi Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Aplikacije koje se ne koriste"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# aplikacija koja se ne koristi}one{# aplikacija koje se ne koristi}few{# aplikacije koje se ne koriste}other{# aplikacija koje se ne koriste}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Ukloni dozvole i oslobodi prostor"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Razmera (eksperimentalno)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Otvori"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Podrazumevano za aplikacije"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Preko celog ekrana"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Na pola ekrana"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Razmera na ureaju"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aplikacija e se restartovati kada promenite razmeru. Moete da izgubite nesauvane promene. Neke aplikacije moda nee biti optimizovane za odreene razmere."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s u internoj memoriji"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Koristi sistemske resurse za davanje prioriteta uinku aplikacije"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Potronja podataka"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Da biste videli ureaje, ukljuite Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Da biste uparili ureaj, otvorite Bluetooth podeavanja"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Podesi reim vonje"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Prikai granice rasporeda"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Nametni smer rasporeda zdesna nalevo"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Preklopni element za prilagoavanje"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrator sistema za informacije i zabavu"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivirane aplikacije"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivirane aplikacije"</string>
@@ -939,4 +958,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Internet paket je istekao"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Pogledajte pakete"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Gotovo"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Vozilo ne podrava ovu funkciju"</string>
 </resources>
diff --git a/res/values-be/strings.xml b/res/values-be/strings.xml
index fcfdc2882..725ac6b47 100644
--- a/res/values-be/strings.xml
+++ b/res/values-be/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">",   "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }one{#  }few{#  }many{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"   "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"   "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"    ,  .     .         ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"    ,   "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -407,7 +423,7 @@
     <string name="notification_access_title" msgid="1467340098885813473">"  "</string>
     <string name="notification_listener_security_warning_title" msgid="2893273335175140895">"   \"<xliff:g id="SERVICE">%1$s</xliff:g>\"   ?"</string>
     <string name="notification_listener_security_warning_summary" msgid="7280197998063498125">" \"<xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>\"     ,   ,       .    ,       .\n\n ,        \" \",       ."</string>
-    <string name="notification_listener_revoke_warning_summary" msgid="4904973394539125407">"     \"<xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>\"   ,        \" \"."</string>
+    <string name="notification_listener_revoke_warning_summary" msgid="4904973394539125407">"    \"<xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>\"   ,        \" \"."</string>
     <string name="notification_listener_revoke_warning_confirm" msgid="2759583507454984812">""</string>
     <string name="notification_listener_revoke_warning_cancel" msgid="4399941651358241154">""</string>
     <string name="performance_impacting_apps_description" msgid="7361464904617808444">"    ,       .\n  ,            ."</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"  ,  Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"  ,   Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  \" \""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">" - "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -945,4 +964,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">" - "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-bg/strings.xml b/res/values-bg/strings.xml
index be5b1e292..e5d767344 100644
--- a/res/values-bg/strings.xml
+++ b/res/values-bg/strings.xml
@@ -180,6 +180,9 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"  "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <string name="wifi_detail_share" msgid="3765487472190563802">""</string>
+    <string name="wifi_detail_share_description" msgid="1417559695973326762">"  QR ,      WiFi "</string>
+    <string name="wifi_detail_share_toast" msgid="9106513465439393280">"  WiFi      WiFi ."</string>
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  Bluetooth"</string>
@@ -343,6 +346,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"  .  .  "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"  ,    .      .          ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"         "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"  "</string>
@@ -797,7 +810,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    ,  Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   ,    Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"    "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"    "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"  "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"   "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +949,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-bn/strings.xml b/res/values-bn/strings.xml
index 675a57f62..cea9b740b 100644
--- a/res/values-bn/strings.xml
+++ b/res/values-bn/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"  "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -194,7 +200,7 @@
     <string name="bluetooth_name" msgid="2609869978821094114">" "</string>
     <string name="bluetooth_rename_vehicle" msgid="5769424875066563154">"    "</string>
     <string name="bluetooth_rename_device" msgid="8406868875363878712">"   "</string>
-    <string name="bluetooth_rename_button" msgid="2397892174725986383">"  "</string>
+    <string name="bluetooth_rename_button" msgid="2397892174725986383">"  "</string>
     <string name="bluetooth_available_devices" msgid="1854446368146061448">" "</string>
     <string name="bluetooth_profiles" msgid="5580372290862835951">""</string>
     <string name="bluetooth_error_title" msgid="2341600997536511742"></string>
@@ -218,10 +224,10 @@
     <string name="uwb_toggle_summary" msgid="2206513296288659105">"   UWB      "</string>
     <string name="bluetooth_notif_ticker" msgid="7192577740198156792">"   "</string>
     <string name="bluetooth_device_context_pair_connect" msgid="3138105800372470422">"   "</string>
-    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"-    "</string>
+    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"    "</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"    "</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"    Return  Enter "</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>    ?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>-    ?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>        "</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"        "</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"         "</string>
@@ -234,12 +240,12 @@
     <string name="bluetooth_bonded_phone_toggle_content_description" msgid="8152794643249938377">" "</string>
     <string name="bluetooth_bonded_media_toggle_content_description" msgid="7803420585378155404">""</string>
     <string name="language_settings" msgid="2079258598337245546">""</string>
-    <string name="languages_and_input_settings" msgid="3672322610529408248">"  "</string>
+    <string name="languages_and_input_settings" msgid="3672322610529408248">"  "</string>
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">"  "</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">" "</string>
     <string name="keyboard_settings" msgid="1959697870618278081">""</string>
-    <string name="manage_keyboard" msgid="4045394766282200132">"  "</string>
-    <string name="text_to_speech_settings" msgid="811985746199507343">"   "</string>
+    <string name="manage_keyboard" msgid="4045394766282200132">"  "</string>
+    <string name="text_to_speech_settings" msgid="811985746199507343">"-- "</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">" "</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">" "</string>
     <string name="tts_speech_rate" msgid="4512944877291943133">"  "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"    "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{    # }one{    # }other{    # }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"     "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">":"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">":"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">":"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"    ,                    "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"        "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -368,7 +384,7 @@
     <string name="assist_access_screenshot_title" msgid="2855956879971465044">"  "</string>
     <string name="assist_access_screenshot_summary" msgid="6246496926635145782">"        "</string>
     <string name="voice_input_settings_title" msgid="3238707827815647526">" "</string>
-    <string name="autofill_settings_title" msgid="1188754272680049972">"   "</string>
+    <string name="autofill_settings_title" msgid="1188754272680049972">" "</string>
     <string name="app_list_preference_none" msgid="7753357799926715901">" "</string>
     <string name="default_app_selected_app" msgid="5289396663745484773">"  "</string>
     <string name="assistant_security_warning" msgid="1844807956967428012">"           ,         "</string>
@@ -569,7 +585,7 @@
     <string name="user_new_user_name" msgid="906698527658609819">" "</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"    ?"</string>
     <string name="user_add_user_message_setup" msgid="812616230454605159">"     ,        "</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">"             "</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">"               "</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"      "</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{     }one{  #    }other{  #    }}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">"    "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"     "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"   "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"   "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"      "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-bs/strings.xml b/res/values-bs/strings.xml
index 89ecd882f..18a1ad4f7 100644
--- a/res/values-bs/strings.xml
+++ b/res/values-bs/strings.xml
@@ -41,18 +41,18 @@
     <string name="confirm_mobile_data_disable" msgid="826493998804496639">"Iskljuiti prijenos podataka na mobilnoj mrei?"</string>
     <string name="sim_selection_required_pref" msgid="6599562910262785784">"Potrebno je odabrati"</string>
     <string name="sim_change_data_title" msgid="6677115745127365131">"Koristiti <xliff:g id="CARRIER">%1$s</xliff:g> za mobilne podatke?"</string>
-    <string name="sim_change_data_message" msgid="4669775284395549069">"Koristite <xliff:g id="CARRIER2_0">%2$s</xliff:g> za prijenos podataka na mobilnoj mrei. Ako se prebacite na operatera <xliff:g id="CARRIER1">%1$s</xliff:g>, <xliff:g id="CARRIER2_1">%2$s</xliff:g> se vie nee koristiti za prijenos podataka na mobilnoj mrei."</string>
+    <string name="sim_change_data_message" msgid="4669775284395549069">"Koristite <xliff:g id="CARRIER2_0">%2$s</xliff:g> za prenos podataka na mobilnoj mrei. Ako se prebacite na operatera <xliff:g id="CARRIER1">%1$s</xliff:g>, <xliff:g id="CARRIER2_1">%2$s</xliff:g> se vie nee koristiti za prenos podataka na mobilnoj mrei."</string>
     <string name="sim_change_data_ok" msgid="2348804996223271081">"Koristi <xliff:g id="CARRIER">%1$s</xliff:g>"</string>
     <string name="roaming_title" msgid="6218635014519017734">"Roming"</string>
-    <string name="roaming_summary" msgid="7476127740259728901">"Povezivanje na usluge prijenosa podataka u romingu"</string>
+    <string name="roaming_summary" msgid="7476127740259728901">"Povezivanje na usluge prenosa podataka u romingu"</string>
     <string name="roaming_alert_title" msgid="4433901635766775763">"Dozvoliti roming podataka?"</string>
     <string name="roaming_warning" msgid="4908184914868720704">"Mogui su trokovi za roming."</string>
     <string name="data_usage_settings" msgid="7877132994777987848">"Prijenos podataka"</string>
-    <string name="data_usage_title" msgid="2923515974389203812">"Prim. plan prijenosa podataka"</string>
+    <string name="data_usage_title" msgid="2923515974389203812">"Prim. plan prenosa podataka"</string>
     <string name="data_used_formatted" msgid="6684557577780068339">"Iskoriteno je <xliff:g id="ID_1">^1</xliff:g> <xliff:g id="ID_2">^2</xliff:g>"</string>
-    <string name="cell_data_warning" msgid="8997739664336571149">"Upozorenje o prijenosu podataka: <xliff:g id="ID_1">^1</xliff:g>"</string>
-    <string name="cell_data_limit" msgid="6862164869877993009">"Ogranienje prijenosa podataka: <xliff:g id="ID_1">^1</xliff:g>"</string>
-    <string name="cell_data_warning_and_limit" msgid="5003954080814312475">"Upozorenje o prijenosu podataka: <xliff:g id="ID_1">^1</xliff:g> / Ogranienje prijenosa podataka: <xliff:g id="ID_2">^2</xliff:g>"</string>
+    <string name="cell_data_warning" msgid="8997739664336571149">"Upozorenje o prenosu podataka: <xliff:g id="ID_1">^1</xliff:g>"</string>
+    <string name="cell_data_limit" msgid="6862164869877993009">"Ogranienje prenosa podataka: <xliff:g id="ID_1">^1</xliff:g>"</string>
+    <string name="cell_data_warning_and_limit" msgid="5003954080814312475">"Upozorenje o prenosu podataka: <xliff:g id="ID_1">^1</xliff:g> / Ogranienje prenosa podataka: <xliff:g id="ID_2">^2</xliff:g>"</string>
     <string name="billing_cycle_days_left" msgid="1810100330204239102">"{count,plural, =1{Preostao je jo # dan}one{Preostao je jo # dan}few{Preostala su jo # dana}other{Preostalo je jo # dana}}"</string>
     <string name="billing_cycle_none_left" msgid="3499893148398931302">"Nema preostalog vremena"</string>
     <string name="billing_cycle_less_than_one_day_left" msgid="8121013296375203759">"Preostalo je manje od 1 dana"</string>
@@ -73,10 +73,10 @@
     <string name="data_warning" msgid="116776633806885370">"Upozorenje na podatke"</string>
     <string name="set_data_limit" msgid="7136539812414500084">"Postavi ogranienje za podatke"</string>
     <string name="data_limit" msgid="227338836292511425">"Ogranienje za podatke"</string>
-    <string name="data_usage_limit_dialog_title" msgid="1864716658371721883">"Ograniavanje prijenosa podataka"</string>
+    <string name="data_usage_limit_dialog_title" msgid="1864716658371721883">"Ograniavanje prenosa podataka"</string>
     <string name="data_usage_limit_dialog_mobile" msgid="3633960011913085089">"Glavna jedinica vozila e iskljuiti prijenos podataka na mobilnoj mrei nakon to dostigne ogranienje koje ste postavili.\n\nS obzirom na to da glavna jedinica vozila mjeri prijenos podataka te da obraun vaeg operatera moe biti drugaiji, uzmite u obzir postavljanje umjerenog ogranienja."</string>
-    <string name="data_usage_warning_editor_title" msgid="2041517150169038813">"Postavljanje upozorenja o prijenosu podataka"</string>
-    <string name="data_usage_limit_editor_title" msgid="133468242379286689">"Postavljanje ogranienja za prijenos podataka"</string>
+    <string name="data_usage_warning_editor_title" msgid="2041517150169038813">"Postavljanje upozorenja o prenosu podataka"</string>
+    <string name="data_usage_limit_editor_title" msgid="133468242379286689">"Postavljanje ogranienja za prenos podataka"</string>
     <string name="data_usage_settings_footer" msgid="681881387909678237">"Va ureaj mjeri koritenje podataka. Moe se razlikovati od podataka mobilnog operatera."</string>
     <string name="usage_bytes_threshold_picker_positive_button" msgid="4625479840977965519">"Postavi"</string>
     <string name="data_usage_warning_save_title" msgid="2900544287239037695">"Sauvaj"</string>
@@ -139,8 +139,8 @@
     <string name="wifi_settings_scanning_required_title" msgid="2726782203331704928">"Ukljuiti skeniranje WiFi mree?"</string>
     <string name="wifi_settings_scanning_required_turn_on" msgid="4464931023377210050">"Ukljui"</string>
     <string name="wifi_settings_scanning_required_enabled" msgid="5457372118991438313">"Skeniranje WiFi mree je iskljueno"</string>
-    <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"Automatsko prebacivanje na prijenos podataka na mobilnoj mrei"</string>
-    <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"Koritenje prijenosa podataka na mobilnoj mrei kada WiFi mrea nema pristup internetu. Mogu nastati trokovi prijenosa podataka."</string>
+    <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"Automatsko prebacivanje na prenos podataka na mobilnoj mrei"</string>
+    <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"Koritenje prenosa podataka na mobilnoj mrei kada WiFi mrea nema pristup internetu. Mogu nastati trokovi prenosa podataka."</string>
     <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Pronaite WiFi mree i poveite se s njima"</string>
     <string name="learn_more" msgid="8214605928933358604">"Saznajte vie"</string>
     <string name="wifi_hotspot_name_title" msgid="8844779338692535356">"Naziv pristupne take"</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Uspjeno povezivanje"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Prikai sve"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Pretraivanje"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Povezani ureaji"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Koristi Bluetooth"</string>
@@ -194,7 +200,7 @@
     <string name="bluetooth_name" msgid="2609869978821094114">"Naziv vozila"</string>
     <string name="bluetooth_rename_vehicle" msgid="5769424875066563154">"Promijena naziva vozila"</string>
     <string name="bluetooth_rename_device" msgid="8406868875363878712">"Promijena naziva ureaja"</string>
-    <string name="bluetooth_rename_button" msgid="2397892174725986383">"Promijeni naziv"</string>
+    <string name="bluetooth_rename_button" msgid="2397892174725986383">"Promijenite naziv"</string>
     <string name="bluetooth_available_devices" msgid="1854446368146061448">"Dostupni ureaji"</string>
     <string name="bluetooth_profiles" msgid="5580372290862835951">"Profili"</string>
     <string name="bluetooth_error_title" msgid="2341600997536511742"></string>
@@ -238,7 +244,7 @@
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">"Predloeno"</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">"Svi jezici"</string>
     <string name="keyboard_settings" msgid="1959697870618278081">"Tastatura"</string>
-    <string name="manage_keyboard" msgid="4045394766282200132">"Upravljanje tastaturama"</string>
+    <string name="manage_keyboard" msgid="4045394766282200132">"Upravljajte tastaturama"</string>
     <string name="text_to_speech_settings" msgid="811985746199507343">"Pretvaranje teksta u govor"</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">"eljeni alat"</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">"Trenutni program"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nekoritene aplikacije"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# nekoritena aplikacija}one{# nekoritena aplikacija}few{# nekoritene aplikacije}other{# nekoritenih aplikacija}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Ukloni odobrenja i oslobodi prostor"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Format slike (eksperimentalno)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Otvori"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Zadano za aplikaciju"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Prikaz preko cijelog ekrana"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Pola ekrana"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Format slike ureaja"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aplikacija e se ponovo pokrenuti kada promijenite format slike. Moda ete izgubiti nesauvane promjene. Neke aplikacije se moda nee optimizirati za odreene formate slike."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s u unutranjoj pohrani"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Koristi izvore sistema da dodijeli prioritet performansama aplikacije"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Prijenos podataka"</string>
@@ -565,7 +581,7 @@
     <string name="sms_messaging_permission_title" msgid="6099328509729071243">"Poruke putem mobilnih podataka auta"</string>
     <string name="install_apps_permission_title" msgid="3099705360827925296">"Instalirajte nove aplikacije"</string>
     <string name="uninstall_apps_permission_title" msgid="8448422340567430659">"Deinstalirajte aplikacije"</string>
-    <string name="user_add_user_menu" msgid="4125869008006021799">"Dodaj profil"</string>
+    <string name="user_add_user_menu" msgid="4125869008006021799">"Dodajte profil"</string>
     <string name="user_new_user_name" msgid="906698527658609819">"Novi profil"</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"Dodati novi profil?"</string>
     <string name="user_add_user_message_setup" msgid="812616230454605159">"Kada kreirate novi profil, korisnik ga treba samostalno prilagoditi."</string>
@@ -615,7 +631,7 @@
     <string name="storage_unmount_success" msgid="1553591517580407021">"<xliff:g id="NAME">%1$s</xliff:g> je sigurno izbaena"</string>
     <string name="storage_unmount_failure" msgid="4591934911541762883">"<xliff:g id="NAME">%1$s</xliff:g> se ne moe sigurno izbaciti"</string>
     <string name="accounts_settings_title" msgid="436190037084293471">"Rauni"</string>
-    <string name="user_add_account_menu" msgid="6625351983590713721">"Dodaj raun"</string>
+    <string name="user_add_account_menu" msgid="6625351983590713721">"Dodajte raun"</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"Nije dodan nijedan raun"</string>
     <string name="account_list_title" msgid="7631588514613843065">"Rauni za korisnika <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"Automatsko sinhroniziranje podataka"</string>
@@ -623,7 +639,7 @@
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"Dozvoliti automatsku sinhronizaciju podataka?"</string>
     <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"Sve promjene na raunu koje izvrite na webu e se automatski kopirati na vae vozilo.\n\nNeki rauni takoer mogu automatski kopirati na web svaku promjenu koju izvrite na vozilu."</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="6683011954002351091">"Ne dozvoliti automatsku sinhronizaciju podataka?"</string>
-    <string name="data_usage_auto_sync_off_dialog" msgid="5040873073016183315">"Ovim e se utedjeti na prijenosu podataka, ali ete morati runo sinhronizirati svaki raun da prikupite najnovije informacije. Takoer, neete primati obavjetenja kada se izvre auriranja."</string>
+    <string name="data_usage_auto_sync_off_dialog" msgid="5040873073016183315">"Ovim e se utedjeti na prenosu podataka, ali ete morati runo sinhronizirati svaki raun da prikupite najnovije informacije. Takoer, neete primati obavjetenja kada se izvre auriranja."</string>
     <string name="account_details_title" msgid="7529571432258448573">"Podaci o raunu"</string>
     <string name="add_account_title" msgid="5988746086885210040">"Dodaj raun"</string>
     <string name="add_an_account" msgid="1072285034300995091">"Dodavanje rauna"</string>
@@ -752,7 +768,7 @@
     <string name="lockpassword_password_too_long" msgid="1709616257350671045">"{count,plural, =1{Ukupan broj znakova mora biti manji od #}one{Ukupan broj znakova mora biti manji od #}few{Ukupan broj znakova mora biti manji od #}other{Ukupan broj znakova mora biti manji od #}}"</string>
     <string name="lockpassword_pin_too_long" msgid="8315542764465856288">"{count,plural, =1{Ukupan broj cifara mora biti manji od #}one{Ukupan broj cifara mora biti manji od #}few{Ukupan broj cifara mora biti manji od #}other{Ukupan broj cifara mora biti manji od #}}"</string>
     <string name="lockpassword_pin_no_sequential_digits" msgid="6511579896796310956">"Nije dozvoljen rastui, opadajui ili ponavljajui niz cifri"</string>
-    <string name="setup_lock_settings_options_button_label" msgid="3337845811029780896">"Opcije zakljuavanja ekrana"</string>
+    <string name="setup_lock_settings_options_button_label" msgid="3337845811029780896">"Opcije otkljuavanja ekrana"</string>
     <string name="credentials_reset" msgid="873900550885788639">"Brisanje akreditiva"</string>
     <string name="credentials_reset_summary" msgid="6067911547500459637">"Uklanjanje svih certifikata"</string>
     <string name="credentials_reset_hint" msgid="3459271621754137661">"Ukloniti sav sadraj?"</string>
@@ -789,15 +805,18 @@
     <string name="notifications_all_apps" msgid="3557079551048958846">"Sve aplikacije"</string>
     <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"Profili i rauni"</string>
     <string name="manage_other_profiles_button_text" msgid="2262188413455510828">"Upravljajte drugim profilima"</string>
-    <string name="add_a_profile_button_text" msgid="8027395095117925114">"Dodaj profil"</string>
+    <string name="add_a_profile_button_text" msgid="8027395095117925114">"Dodajte profil"</string>
     <string name="delete_this_profile_text" msgid="6035404714526922665">"Izbrii ovaj profil"</string>
-    <string name="add_profile_text" msgid="9118410102199116969">"Dodaj profil"</string>
+    <string name="add_profile_text" msgid="9118410102199116969">"Dodajte profil"</string>
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"Profil je trenutno prijavljen kao voza. Pokuajte ponovo kada profil ne bude koriten kao voza."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">"Osvjetljenje ekrana"</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Da vidite svoje ureaje, ukljuite Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Da uparite ureaj, otvorite postavke Bluetootha"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Postavi nain rada za vonju"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Prikai granice rasporeda"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Prisilno postavi raspored zdesna ulijevo"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Preklapanje prilagoavanja"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrator informativno-zabavnog sistema"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivirane aplikacije"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivirane aplikacije"</string>
@@ -939,4 +958,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Internetski paketi su istekli"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Pogledajte pakete"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Gotovo"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Vozilo ne podrava ovu funkciju"</string>
 </resources>
diff --git a/res/values-ca/strings.xml b/res/values-ca/strings.xml
index 82f2730af..add0ecc1e 100644
--- a/res/values-ca/strings.xml
+++ b/res/values-ca/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"S\'ha connectat correctament"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Mostra-ho tot"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"S\'est cercant"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispositius connectats"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Utilitza el Bluetooth"</string>
@@ -221,7 +227,7 @@
     <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"Codi de vinculaci per Bluetooth"</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"El PIN cont lletres o smbols"</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"Escriu el codi de vinculaci i prem Retorn"</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"Vols vincular el dispositiu amb <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"Vols vincular <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"Permet que <xliff:g id="DEVICE_NAME">%1$s</xliff:g> accedeixi als contactes i a l\'historial de trucades"</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"Pot ser que tamb hagis d\'introduir aquest PIN a l\'altre dispositiu."</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"Pot ser que tamb hagis d\'introduir aquesta clau d\'accs a l\'altre dispositiu."</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Aplicacions no utilitzades"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# aplicaci no utilitzada}other{# aplicacions no utilitzades}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Suprimeix els permisos i allibera espai"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Relaci d\'aspecte (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Obre"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Predeterminada de l\'aplicaci"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Pantalla completa"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Mitja pantalla"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Relaci d\'aspecte del dispositiu"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"L\'aplicaci es reiniciar quan canvis la relaci d\'aspecte. s possible que es perdin els canvis sense desar. Pot ser que algunes aplicacions no s\'optimitzin per a determinades relacions d\'aspecte."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s a l\'emmagatzematge intern"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Utilitza recursos del sistema per prioritzar el rendiment de l\'aplicaci"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"s de dades"</string>
@@ -495,7 +511,7 @@
     <string name="hardware_revision" msgid="5713759927934872874">"Versi del maquinari"</string>
     <string name="regulatory_info_text" msgid="8890339124198005428"></string>
     <string name="settings_license_activity_title" msgid="8499293744313077709">"Llicncies de tercers"</string>
-    <string name="settings_license_activity_unavailable" msgid="6104592821991010350">"S\'ha produt un problema en carregar les llicncies."</string>
+    <string name="settings_license_activity_unavailable" msgid="6104592821991010350">"Hi ha hagut un problema en carregar les llicncies."</string>
     <string name="settings_license_activity_loading" msgid="6163263123009681841">"S\'est carregant"</string>
     <string name="show_dev_countdown" msgid="7416958516942072383">"{count,plural, =1{Ara ja noms et queda # pas per convertir-te en desenvolupador.}other{Ara ja noms et queden # passos per convertir-te en desenvolupador.}}"</string>
     <string name="show_dev_on" msgid="5339077400040834808">"Ara ja ets desenvolupador!"</string>
@@ -703,7 +719,7 @@
     <string name="lockpattern_recording_incorrect_too_short" msgid="2417932185815083082">"Connecta 4 punts com a mnim. Torna-ho a provar."</string>
     <string name="lockpattern_pattern_wrong" msgid="929223969555399363">"El patr no s correcte"</string>
     <string name="lockpattern_settings_help_how_to_record" msgid="4436556875843192284">"Com es dibuixa un patr de desbloqueig"</string>
-    <string name="error_saving_lockpattern" msgid="2933512812768570130">"S\'ha produt un error en desar el patr"</string>
+    <string name="error_saving_lockpattern" msgid="2933512812768570130">"Hi ha hagut un error en desar el patr"</string>
     <string name="lockpattern_too_many_failed_confirmation_attempts" msgid="4636307830951251013">"Has superat el nombre d\'intents incorrectes permesos. Torna-ho a provar d\'aqu a <xliff:g id="NUMBER">%d</xliff:g>segons."</string>
     <string name="lockpattern_does_not_support_rotary" msgid="7356367113555659428">"Patr de rotaci no adms; utilitza un tctil"</string>
     <string name="okay" msgid="4589873324439764349">"D\'acord"</string>
@@ -718,7 +734,7 @@
     <string name="choose_lock_pin_hints" msgid="7362906249992020844">"El PIN ha de tenir 4 dgits com a mnim"</string>
     <string name="lockpin_invalid_pin" msgid="2149191577096327424">"El PIN no s vlid. Ha de tenir com a mnim 4dgits."</string>
     <string name="confirm_pins_dont_match" msgid="4607110139373520720">"Els PIN no coincideixen"</string>
-    <string name="error_saving_lockpin" msgid="9011960139736000393">"S\'ha produt un error en desar el PIN"</string>
+    <string name="error_saving_lockpin" msgid="9011960139736000393">"Hi ha hagut un error en desar el PIN"</string>
     <string name="lockscreen_wrong_pin" msgid="4922465731473805306">"El PIN no s correcte"</string>
     <string name="lockscreen_wrong_password" msgid="5757087577162231825">"La contrasenya no s correcta"</string>
     <string name="choose_lock_password_message" msgid="6124341145027370784">"Per seguretat, defineix una contrasenya"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Per veure els teus dispositius, activa el Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Per vincular un dispositiu, obre la configuraci del Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Configura la conducci"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Mostra els lmits de la disposici"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Fora la direcci dreta-esquerra"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Superposici de personalitzaci"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrador del sistema d\'informaci i entreteniment"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aplicacions activades"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Aplicacions desactivades"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Els teus plans d\'Internet han caducat"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Mostra els plans"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Fet"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"El vehicle no admet aquesta funci"</string>
 </resources>
diff --git a/res/values-cs/strings.xml b/res/values-cs/strings.xml
index 1e53a5e99..29b2d4d8c 100644
--- a/res/values-cs/strings.xml
+++ b/res/values-cs/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Pipojen spn navzno"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Zobrazit ve"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Hledn"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Pipojen zazen"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Pouvat Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nepouvan aplikace"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#nepouvan aplikace}few{#nepouvan aplikace}many{#nepouvan aplikace}other{#nepouvanch aplikac}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Odebrat oprvnn auvolnit msto"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Pomr stran (experimentln)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Otevt"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Vchoz nastaven aplikace"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Cel obrazovka"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Polovina obrazovky"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Pomr stran zazen"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Kdy zmnte pomr stran, aplikace se restartuje. Mete pijt oneuloen zmny. Nkter aplikace nemus bt optimalizovan pro urit pomry stran."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s vinternm loiti"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Pouv systmov zdroje kupednostnn vkonu aplikace"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Vyuit dat"</string>
@@ -397,7 +413,7 @@
     <string name="apps_default_apps_summary" msgid="2017792579839972926">"Pro Asistenta adal aplikace"</string>
     <string name="performance_impacting_apps_summary" msgid="7762122057244111162">"{count,plural, =1{#aplikace ovlivuje vkon}few{#aplikace ovlivuj vkon}many{#aplikace ovlivuje vkon}other{#aplikac ovlivuje vkon}}"</string>
     <string name="apps_special_app_access_summary" msgid="6464767436309742163">"Ksystmu adalm nastavenm"</string>
-    <string name="special_access" msgid="5730278220917123811">"Zvltn pstup aplikac"</string>
+    <string name="special_access" msgid="5730278220917123811">"Speciln pstup aplikac"</string>
     <string name="show_system" msgid="4401355756969485287">"Zobrazit systmov aplikace"</string>
     <string name="hide_system" msgid="8845453295584638040">"Skrt systmov aplikace"</string>
     <string name="hide_system_apps" msgid="6583947381056154020">"Skrt systmov aplikace"</string>
@@ -589,7 +605,7 @@
     <string name="current_user_name" msgid="3813671533249316823">"Vy (%1$s)"</string>
     <string name="user_name_label" msgid="3210832645046206845">"Jmno"</string>
     <string name="user_summary_not_set_up" msgid="1473688119241224145">"Nen nastaveno"</string>
-    <string name="edit_user_name_title" msgid="1118500707473139995">"Upravit profilov jmno"</string>
+    <string name="edit_user_name_title" msgid="1118500707473139995">"Upravit nzev profilu"</string>
     <string name="name_input_blank_error" msgid="2088850865880984123">"Pole nesm bt przdn."</string>
     <string name="name_input_invalid_error" msgid="4355625213535164704">"Zadan profilov jmno je neplatn."</string>
     <string name="users_list_title" msgid="770764290290240909">"Uivatel"</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"Tento profil je aktuln pihlen jako idi. Zkuste to znovu, a se tento profil pouvat nebude."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">"Jas displeje"</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Pokud chcete zobrazit sv zazen, zapnte Bluetooth"</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Pokud sprovat zazen, zapnte nastaven Bluetooth"</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Zazen sprujete v nastaven Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Motiv"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Nastavit reim jzdy autem"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Zobrazit ohranien"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Vynutit rozvren zprava doleva"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Vrstva pizpsoben"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrtor informanho azbavnho systmu"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivovan aplikace"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivovan aplikace"</string>
@@ -945,4 +964,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Vaim internetovm tarifm vyprela platnost"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Zobrazit tarify"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Hotovo"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Vae vozidlo tuhle funkci nepodporuje"</string>
 </resources>
diff --git a/res/values-da/strings.xml b/res/values-da/strings.xml
index e9ae23a8a..38891d2f8 100644
--- a/res/values-da/strings.xml
+++ b/res/values-da/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Der blev oprettet forbindelse"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Vis alle"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Sger"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Forbundne enheder"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Brug Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Apps, du ikke bruger"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# ubrugt app}one{# ubrugt app}other{# ubrugte apps}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Fjern tilladelser, og frigr plads"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Billedformat (eksperimentel)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"bn"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Standardindstilling for appen"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Fuld skrm"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Halv skrm"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Billedformat p enheden"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Denne app genstartes, nr du ndrer billedformatet. Du mister muligvis ndringer, der ikke er gemt. Visse apps er muligvis ikke optimeret til bestemte billedformater."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s i intern lagerplads"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Bruger systemressourcer til at prioritere app-ydeevne"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Dataforbrug"</string>
@@ -368,7 +384,7 @@
     <string name="assist_access_screenshot_title" msgid="2855956879971465044">"Brug screenshot"</string>
     <string name="assist_access_screenshot_summary" msgid="6246496926635145782">"Giv assistanceappen adgang til et billede af skrmen"</string>
     <string name="voice_input_settings_title" msgid="3238707827815647526">"Indtaling"</string>
-    <string name="autofill_settings_title" msgid="1188754272680049972">"AutoFyld-tjeneste"</string>
+    <string name="autofill_settings_title" msgid="1188754272680049972">"Autofyld-tjeneste"</string>
     <string name="app_list_preference_none" msgid="7753357799926715901">"Ingen"</string>
     <string name="default_app_selected_app" msgid="5289396663745484773">"Valgt"</string>
     <string name="assistant_security_warning" msgid="1844807956967428012">"Assistenten kan lse oplysninger om, hvilke apps der bruges i dit system, herunder oplysninger, der er synlige p din skrm eller tilgngelige i dine apps."</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Aktivr Bluetooth for at se dine enheder"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"bn Bluetooth-indstillingerne for at parre en enhed"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Indstil krsel"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Vis layoutgrnser"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Tving visning fra hjre mod venstre"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Tilpasningsoverlejring"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrator af infotainmentsystemet"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktiverede apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktiverede apps"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Dine internetabonnementer er udlbet"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Se abonnementer"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Udfr"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Dit kretj understtter ikke denne funktion"</string>
 </resources>
diff --git a/res/values-de/strings.xml b/res/values-de/strings.xml
index 871b9d5a0..625372113 100644
--- a/res/values-de/strings.xml
+++ b/res/values-de/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Verbindung hergestellt"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Alle anzeigen"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Suche luft"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Verbundene Gerte"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth verwenden"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nicht verwendete Apps"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#nicht verwendete App}other{#nicht verwendete Apps}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Berechtigungen lschen/Speicher freigeben"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Seitenverhltnis (experimentell)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"ffnen"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"App-Standard"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Vollbild"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Halbes Display"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Seitenverhltnis des Gerts"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Wenn du das Seitenverhltnis nderst, wird die App neu gestartet. Dadurch knnen nicht gespeicherte nderungen verloren gehen. Einige Apps sind mglicherweise nicht fr bestimmte Seitenverhltnisse optimiert."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s in internem Speicher"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Verwendet Systemressourcen, um die App-Leistung zu priorisieren"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Datennutzung"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Aktiviere Bluetooth, um deine Gerte anzuzeigen"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"ffne die Bluetooth-Einstellungen, um ein Gert zu koppeln"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Design"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Fahrmodus aktivieren"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Layoutgrenzen anzeigen"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Linkslufiges Layout erzwingen"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Overlay fr die Anpassung"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrator des Infotainmentsystems"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivierte Apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivierte Apps"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Deine Internettarife sind abgelaufen"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Tarife ansehen"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Fertig"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Dein Fahrzeug untersttzt diese Funktion nicht"</string>
 </resources>
diff --git a/res/values-el/strings.xml b/res/values-el/strings.xml
index 736b1473b..bbb1effde 100644
--- a/res/values-el/strings.xml
+++ b/res/values-el/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"   "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth"</string>
@@ -234,7 +240,7 @@
     <string name="bluetooth_bonded_phone_toggle_content_description" msgid="8152794643249938377">""</string>
     <string name="bluetooth_bonded_media_toggle_content_description" msgid="7803420585378155404">""</string>
     <string name="language_settings" msgid="2079258598337245546">""</string>
-    <string name="languages_and_input_settings" msgid="3672322610529408248">"  "</string>
+    <string name="languages_and_input_settings" msgid="3672322610529408248">"  "</string>
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">""</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">"  "</string>
     <string name="keyboard_settings" msgid="1959697870618278081">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"   "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#    }other{#    }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"         .       .           ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"          ."</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -789,7 +805,7 @@
     <string name="notifications_all_apps" msgid="3557079551048958846">"  "</string>
     <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"  "</string>
     <string name="manage_other_profiles_button_text" msgid="2262188413455510828">"  "</string>
-    <string name="add_a_profile_button_text" msgid="8027395095117925114">"  "</string>
+    <string name="add_a_profile_button_text" msgid="8027395095117925114">" "</string>
     <string name="delete_this_profile_text" msgid="6035404714526922665">"   "</string>
     <string name="add_profile_text" msgid="9118410102199116969">" "</string>
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"     .          ."</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    ,   Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   ,     Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"   RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"    "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"   "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"  "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"       "</string>
 </resources>
diff --git a/res/values-en-rAU/strings.xml b/res/values-en-rAU/strings.xml
index b4df6a01b..8f16b497c 100644
--- a/res/values-en-rAU/strings.xml
+++ b/res/values-en-rAU/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Connection successful"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Show all"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Searching"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Connected devices"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Use Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Unused apps"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# unused app}other{# unused apps}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Remove permissions and free up space"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Aspect ratio (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Open"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"App default"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Full screen"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Half screen"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Device aspect ratio"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"The app will restart when you change aspect ratio. You may lose unsaved changes. Some apps may not be optimised for certain aspect ratios."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s in internal storage"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Uses system resources to prioritise app performance"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Data usage"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"To see your devices, turn on Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"To pair a device, open Bluetooth settings"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Theme"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Set driving"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Show layout bounds"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Force RTL layout direction"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Customisation overlay"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainment system admin"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Activated apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deactivated apps"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Your Internet plans have expired"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"See plans"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Done"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Your vehicle does not support this feature"</string>
 </resources>
diff --git a/res/values-en-rCA/strings.xml b/res/values-en-rCA/strings.xml
index b107fd4ea..71bf4fb9b 100644
--- a/res/values-en-rCA/strings.xml
+++ b/res/values-en-rCA/strings.xml
@@ -180,6 +180,9 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Connection successful"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Show all"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Searching"</string>
+    <string name="wifi_detail_share" msgid="3765487472190563802">"Share"</string>
+    <string name="wifi_detail_share_description" msgid="1417559695973326762">"Scan this QR code to connect to WiFi"</string>
+    <string name="wifi_detail_share_toast" msgid="9106513465439393280">"WiFi share is not available for this WiFi."</string>
     <string name="connected_settings_title" msgid="8868738903280658151">"Connected devices"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Use Bluetooth"</string>
@@ -343,6 +346,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Unused apps"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# unused app}other{# unused apps}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Remove permissions and free up space"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Aspect ratio (Experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Open"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"App default"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Full screen"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Half screen"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Device aspect ratio"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"The app will restart when you change aspect ratio. You may lose unsaved changes. Some apps may not be optimized for certain aspect ratios."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s in internal storage"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Uses system resources to prioritize app performance"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Data usage"</string>
@@ -797,7 +810,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"To see your devices, turn on Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"To pair a device, open Bluetooth settings"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Theme"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Set driving"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Show layout bounds"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Force RTL layout direction"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Customization overlay"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainment system admin"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Activated apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deactivated apps"</string>
@@ -933,4 +949,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Your internet plans expired"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"See plans"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Done"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Your vehicle does not support this feature"</string>
 </resources>
diff --git a/res/values-en-rGB/strings.xml b/res/values-en-rGB/strings.xml
index 8b68f752f..203ae30d9 100644
--- a/res/values-en-rGB/strings.xml
+++ b/res/values-en-rGB/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Connection successful"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Show all"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Searching"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Connected devices"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Use Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Unused apps"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# unused app}other{# unused apps}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Remove permissions and free up space"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Aspect ratio (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Open"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"App default"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Full screen"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Half screen"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Device aspect ratio"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"The app will restart when you change aspect ratio. You may lose unsaved changes. Some apps may not be optimised for certain aspect ratios."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s in internal storage"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Uses system resources to prioritise app performance"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Data usage"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"To see your devices, turn on Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"To pair a device, open Bluetooth settings"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Theme"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Set driving"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Show layout bounds"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Force RTL layout direction"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Customisation overlay"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainment system admin"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Activated apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deactivated apps"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Your Internet plans have expired"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"See plans"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Done"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Your vehicle does not support this feature"</string>
 </resources>
diff --git a/res/values-en-rIN/strings.xml b/res/values-en-rIN/strings.xml
index 392496199..35969283c 100644
--- a/res/values-en-rIN/strings.xml
+++ b/res/values-en-rIN/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Connection successful"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Show all"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Searching"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Connected devices"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Use Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Unused apps"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# unused app}other{# unused apps}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Remove permissions and free up space"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Aspect ratio (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Open"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"App default"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Full screen"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Half screen"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Device aspect ratio"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"The app will restart when you change aspect ratio. You may lose unsaved changes. Some apps may not be optimised for certain aspect ratios."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s in internal storage"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Uses system resources to prioritise app performance"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Data usage"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"To see your devices, turn on Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"To pair a device, open Bluetooth settings"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Theme"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Set driving"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Show layout bounds"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Force RTL layout direction"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Customisation overlay"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainment system admin"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Activated apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deactivated apps"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Your Internet plans have expired"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"See plans"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Done"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Your vehicle does not support this feature"</string>
 </resources>
diff --git a/res/values-en-rXC/strings.xml b/res/values-en-rXC/strings.xml
index c59adf88d..662548c10 100644
--- a/res/values-en-rXC/strings.xml
+++ b/res/values-en-rXC/strings.xml
@@ -797,7 +797,9 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"To see your devices, turn on Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"To pair a device, open Bluetooth settings"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Theme"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Set driving"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Show layout bounds"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Force RTL layout direction"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainment system admin"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Activated apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deactivated apps"</string>
diff --git a/res/values-es-rUS/strings.xml b/res/values-es-rUS/strings.xml
index 573ec0470..a145e406a 100644
--- a/res/values-es-rUS/strings.xml
+++ b/res/values-es-rUS/strings.xml
@@ -180,6 +180,9 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Conexin exitosa"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Mostrar todo"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Buscando"</string>
+    <string name="wifi_detail_share" msgid="3765487472190563802">"Compartir"</string>
+    <string name="wifi_detail_share_description" msgid="1417559695973326762">"Escanea este cdigo QR para conectarte a la red Wi-Fi"</string>
+    <string name="wifi_detail_share_toast" msgid="9106513465439393280">"La opcin de compartir Wi-Fi no est disponible para esta red."</string>
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispositivos conectados"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Usar Bluetooth"</string>
@@ -343,6 +346,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Apps que no usas"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#app en desuso}other{#apps en desuso}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Quitar permisos y liberar espacio"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Relacin de aspecto (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Abrir"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Predeterminada de la app"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Pantalla completa"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Media pantalla"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Relacin de aspecto del dispositivo"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Cuando cambies la relacin de aspecto, se reiniciar la app. Es posible que pierdas los cambios que no se hayan guardado y que algunas apps no estn optimizadas para ciertas relaciones de aspecto."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s de almacenamiento interno"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Usa los recursos del sistema para priorizar el rendimiento de la app"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Uso de datos"</string>
@@ -482,8 +495,8 @@
     <string name="legal_information" msgid="1838443759229784762">"Informacin legal"</string>
     <string name="contributors_title" msgid="7698463793409916113">"Colaboradores"</string>
     <string name="manual" msgid="4819839169843240804">"Manual"</string>
-    <string name="regulatory_labels" msgid="3165587388499646779">"Etiquetas reglamentarias"</string>
-    <string name="safety_and_regulatory_info" msgid="1204127697132067734">"Manual sobre reglamentacin y seguridad"</string>
+    <string name="regulatory_labels" msgid="3165587388499646779">"Etiquetas sobre reglamentaciones"</string>
+    <string name="safety_and_regulatory_info" msgid="1204127697132067734">"Manual sobre seguridad y reglamentaciones"</string>
     <string name="copyright_title" msgid="4220237202917417876">"Copyright"</string>
     <string name="license_title" msgid="936705938435249965">"Licencia"</string>
     <string name="terms_title" msgid="5201471373602628765">"Trminos y condiciones"</string>
@@ -619,7 +632,7 @@
     <string name="no_accounts_added" msgid="5148163140691096055">"No se agreg ninguna cuenta"</string>
     <string name="account_list_title" msgid="7631588514613843065">"Cuentas de <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"Sincronizar datos automticamente"</string>
-    <string name="account_auto_sync_summary" msgid="6963837893148304128">"Permitir que las apps actualicen datos automticamente"</string>
+    <string name="account_auto_sync_summary" msgid="6963837893148304128">"Permite que las apps actualicen datos automticamente"</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"Permitir la sincronizacin automtica de datos?"</string>
     <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"Los cambios que realices en tus cuentas en la Web se copiarn automticamente al vehculo.\n\nAlgunas cuentas tambin podran copiar automticamente a la Web los cambios que hagas en el vehculo."</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="6683011954002351091">"Desactivar la sincronizacin automtica de datos?"</string>
@@ -795,9 +808,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"Se accedi a este perfil como conductor. Vuelve a intentarlo cuando el perfil no est en ese modo."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">"Brillo de pantalla"</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Para ver tus dispositivos, activa Bluetooth"</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Para vincular un dispositivo, abre la configuracin de Bluetooth"</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Vincula un dispositivo desde la config. de Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Establecer en automvil"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Mostrar lmites de diseo"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forzar diseo de derecha a izquierda"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Personalizacin de la superposicin"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrador del sistema de infoentretenimiento"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Apps activadas"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Apps desactivadas"</string>
@@ -933,4 +949,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Tus planes de Internet vencieron"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Ver planes"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Listo"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Tu vehculo no admite esta funcin"</string>
 </resources>
diff --git a/res/values-es/strings.xml b/res/values-es/strings.xml
index 17b66543b..69f2f9401 100644
--- a/res/values-es/strings.xml
+++ b/res/values-es/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Se ha conectado correctamente"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Mostrar todo"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Buscando"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispositivos conectados"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Usar Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Aplicaciones no usadas"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# aplicacin no usada}other{# aplicaciones no usadas}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Quitar permisos y liberar espacio"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Relacin de aspecto (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Abrir"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Predeterminada de la aplicacin"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Pantalla completa"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Media pantalla"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Relacin de aspecto del dispositivo"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"La aplicacin se reiniciar cuando cambies la relacin de aspecto. Puede que pierdas los cambios sin guardar. Puede que algunas aplicaciones no estn optimizadas para determinadas relaciones de aspecto."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s en el almacenamiento interno"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Usa recursos del sistema para priorizar el rendimiento de la aplicacin"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Uso de datos"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Para ver tus dispositivos, activa el Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Para emparejar un dispositivo, abre los ajustes de Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Activar modo Conduccin"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Mostrar lmites de diseo"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forzar direccin derecha-izquierda"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Superposicin de personalizacin"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrador del sistema de infoentretenimiento"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aplicaciones activadas"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Aplicaciones desactivadas"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Tus planes de Internet han caducado"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Ver planes"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Hecho"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Tu vehculo no admite esta funcin"</string>
 </resources>
diff --git a/res/values-et/strings.xml b/res/values-et/strings.xml
index a5e7312bc..7d62a262f 100644
--- a/res/values-et/strings.xml
+++ b/res/values-et/strings.xml
@@ -164,7 +164,7 @@
     <string name="wifi_ap_band_select_one" msgid="615578175244067396">"Valige WiFi-kuumkohale vhemalt ks riba:"</string>
     <string name="tether_settings_title_all" msgid="6076625733772210734">"WiFi-kuumkoht"</string>
     <string name="hotspot_settings_title" msgid="8220814387592756713">"Kuumkoht"</string>
-    <string name="wifi_hotspot_switch_title" msgid="5011183846278097937">"WiFi-kuumkoha kasutamine"</string>
+    <string name="wifi_hotspot_switch_title" msgid="5011183846278097937">"Kasuta WiFi-kuumkohta"</string>
     <string name="wifi_hotspot_state_off" msgid="6096709579204322798">"Vljas"</string>
     <string name="wifi_hotspot_keep_on_title" msgid="2920327805105370804">"Kasuta kuumkohta kigi situde puhul"</string>
     <string name="wifi_hotspot_keep_on_summary" msgid="7701814310702163462">"Kuumkoht muudetakse kttesaadavaks alati, kui auto on sisse llitatud"</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"hendamine nnestus"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Kuva kik"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Otsimine"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"hendatud seadmed"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Kasuta Bluetoothi"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Kasutamata rakendused"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# kasutamata rakendus}other{# kasutamata rakendust}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Eemalda load ja vabasta ruumi"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Kuvasuhe (katseline)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Ava"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Rakenduse vaikeseade"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Tisekraan"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Pool ekraani"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Seadme kuvasuhe"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"See rakendus taaskivitatakse, kui muudate kuvasuhet. Salvestamata muudatused vivad kaduma minna. Teatud kuvasuhete korral ei pruugita mningaid rakendusi optimeerida."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s sisemist salvestusruumi"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Kasutab rakenduse toimivuse prioriseerimiseks ssteemi ressursse"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Andmekasutus"</string>
@@ -615,7 +631,7 @@
     <string name="storage_unmount_success" msgid="1553591517580407021">"ksus <xliff:g id="NAME">%1$s</xliff:g> eemaldati ohutult"</string>
     <string name="storage_unmount_failure" msgid="4591934911541762883">"ksust <xliff:g id="NAME">%1$s</xliff:g> ei saanud ohutult eemaldada"</string>
     <string name="accounts_settings_title" msgid="436190037084293471">"Kontod"</string>
-    <string name="user_add_account_menu" msgid="6625351983590713721">"Lisa konto"</string>
+    <string name="user_add_account_menu" msgid="6625351983590713721">"Konto lisamine"</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"Kontosid pole lisatud"</string>
     <string name="account_list_title" msgid="7631588514613843065">"Kasutaja <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g> kontod"</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"Snkrooni andmed automaatselt"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Oma seadmete ngemiseks llitage Bluetooth sisse"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Seadme sidumiseks avage Bluetoothi seaded"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Teema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Sidureiimi mramine"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Nita paigutuse piire"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Justa paremalt vasakule paigutus"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Kohandamise lekate"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Teabe ja meelelahutuse ssteemi administraator"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktiveeritud rakendused"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Inaktiveeritud rakendused"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Teie internetipaketid on aegunud"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Kuva paketid"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Valmis"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Teie siduk ei toeta seda funktsiooni"</string>
 </resources>
diff --git a/res/values-eu/strings.xml b/res/values-eu/strings.xml
index 00f1c795b..570913c23 100644
--- a/res/values-eu/strings.xml
+++ b/res/values-eu/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Konektatu da"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Erakutsi guztiak"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Bilatzen"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Konektatutako gailuak"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetootha"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Erabili Bluetootha"</string>
@@ -317,7 +323,7 @@
     <string name="performance_impacting_apps" msgid="3439260699394720569">"Errendimendua okertzen duten aplikazioak"</string>
     <string name="app_permissions" msgid="32799922508313948">"Aplikazio-baimenak"</string>
     <string name="app_permissions_summary" msgid="5402214755935368418">"Kontrolatu aplikazioek datuak atzitzeko duten baimena"</string>
-    <string name="applications_settings" msgid="794261395191035632">"Aplikazioaren informazioa"</string>
+    <string name="applications_settings" msgid="794261395191035632">"Aplikazioei buruzko informazioa"</string>
     <string name="force_stop" msgid="1616958676171167028">"Gelditu aplikazioa"</string>
     <string name="force_stop_dialog_title" msgid="4481858344628934971">"Aplikazioa gelditu nahi duzu?"</string>
     <string name="force_stop_dialog_text" msgid="4354954014318432599">"Aplikazioak gelditzera behartzen badituzu, baliteke behar bezala ez funtzionatzea."</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Erabiltzen ez diren aplikazioak"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{Erabiltzen ez den # aplikazio}other{Erabiltzen ez diren # aplikazio}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Kendu baimenak eta egin tokia"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Aspektu-erlazioa (esperimentala)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Ireki"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Aplikazioaren balio lehenetsia"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Pantaila osoa"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Pantaila erdia"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Gailuaren aspektu-erlazioa"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aspektu-erlazioa aldatzean, aplikazioa berrabiaraziko da. Litekeena da gorde gabeko aldaketak galtzea. Agian aplikazio batzuk ez daude aspektu-erlazio jakin batzuetarako optimizatuta."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s barneko memorian"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Sistemaren baliabideak erabiltzen ditu aplikazioen errendimendua lehenesteko"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Datu-erabilera"</string>
@@ -401,7 +417,7 @@
     <string name="show_system" msgid="4401355756969485287">"Erakutsi sistemaren prozesuak"</string>
     <string name="hide_system" msgid="8845453295584638040">"Ezkutatu sistemaren prozesuak"</string>
     <string name="hide_system_apps" msgid="6583947381056154020">"Ezkutatu sistemaren aplikazioak"</string>
-    <string name="alarms_and_reminders_title" msgid="5201073616071479075">"Alarmak eta abisuak"</string>
+    <string name="alarms_and_reminders_title" msgid="5201073616071479075">"Alarmak eta gogorarazpenak"</string>
     <string name="modify_system_settings_title" msgid="4596320571562433972">"Aldatu sistemaren ezarpenak"</string>
     <string name="modify_system_settings_description" msgid="5295023124419592452">"Baimen honekin, sistemaren ezarpenak alda ditzakete aplikazioek."</string>
     <string name="notification_access_title" msgid="1467340098885813473">"Jakinarazpenetarako sarbidea"</string>
@@ -509,7 +525,7 @@
     <string name="reset_network_item_mobile" msgid="5747282716664480997"><li>"Datu-konexioa"</li></string>
     <string name="reset_network_item_bluetooth" msgid="7475279871421815601"><li>"Telefonoak eta Bluetooth bidezko beste gailu batzuk"</li></string>
     <string name="reset_esim_title" msgid="8132107637911831211">"Ezabatu ibilgailuaren eSIM txarteletako eduki guztia"</string>
-    <string name="reset_esim_desc" msgid="1437276625485586740">"Ez da utziko bertan behera daukazun zerbitzu-plana."</string>
+    <string name="reset_esim_desc" msgid="1437276625485586740">"Ez da bertan behera utziko daukazun zerbitzu-plana."</string>
     <string name="reset_esim_error_title" msgid="7245109418130525492">"Ezin dira berrezarri eSIM txartelak"</string>
     <string name="reset_network_select" msgid="2433825874868038739">"Hautatu sarea"</string>
     <string name="reset_network_button_text" msgid="8374174455632765033">"Berrezarri ezarpenak"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Aktibatu Bluetootha gailuak ikusteko"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Ireki Bluetootharen ezarpenak gailu batekin parekatzeko"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Gaia"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Ezarri gidatze modua"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Erakutsi diseinu-mugak"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Behartu eskuinetik ezkerrerako norabidea"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Pertsonalizazio-gainjartzea"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Informazio- eta aisia-sistemaren administratzailea"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktibatutako aplikazioak"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Desaktibatutako aplikazioak"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Interneteko kidetzak iraungi dira"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Ikusi kidetzak"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Eginda"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Ibilgailuak ez du onartzen eginbide hau"</string>
 </resources>
diff --git a/res/values-fa/strings.xml b/res/values-fa/strings.xml
index 5a9c21fa7..40b20bdce 100644
--- a/res/values-fa/strings.xml
+++ b/res/values-fa/strings.xml
@@ -74,7 +74,7 @@
     <string name="set_data_limit" msgid="7136539812414500084">"  "</string>
     <string name="data_limit" msgid="227338836292511425">" "</string>
     <string name="data_usage_limit_dialog_title" msgid="1864716658371721883">"   "</string>
-    <string name="data_usage_limit_dialog_mobile" msgid="3633960011913085089">"                .\n\n                            ."</string>
+    <string name="data_usage_limit_dialog_mobile" msgid="3633960011913085089">"                .\n\n                            ."</string>
     <string name="data_usage_warning_editor_title" msgid="2041517150169038813">"   "</string>
     <string name="data_usage_limit_editor_title" msgid="133468242379286689">"    "</string>
     <string name="data_usage_settings_footer" msgid="681881387909678237">"      .               ."</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"  "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -208,7 +214,7 @@
     <string name="bluetooth_ask_discovery_no_name" msgid="164397600370102369">"           <xliff:g id="TIMEOUT">%1$d</xliff:g>   ."</string>
     <string name="bluetooth_ask_enablement_and_discovery" msgid="5487502083015708674">"<xliff:g id="APP_NAME">%1$s</xliff:g>               <xliff:g id="TIMEOUT">%2$d</xliff:g>   ."</string>
     <string name="bluetooth_ask_enablement_and_discovery_no_name" msgid="907153034209916282">"                <xliff:g id="TIMEOUT">%1$d</xliff:g>   ."</string>
-    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"    %1$s   "</string>
+    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"     %1$s   "</string>
     <string name="bluetooth_my_devices" msgid="6352010339607939612">" "</string>
     <string name="bluetooth_previously_connected" msgid="5206229557831180323">" "</string>
     <string name="bluetooth_device_connected_toast" msgid="4614765282582494488">"%1$s  "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }one{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"     "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">" "</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">":"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">":"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">":"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"         .       .           ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"        "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -443,7 +459,7 @@
     <string name="location_use_location_title" msgid="117735895374606680">"  "</string>
     <string name="location_access_settings_title" msgid="2378398106582207440">"  "</string>
     <string name="location_access_settings_summary" msgid="7676354917209152932">"           "</string>
-    <string name="location_access_disclaimer_summary" msgid="914984622682562036">"           .          ."</string>
+    <string name="location_access_disclaimer_summary" msgid="914984622682562036">"           .          ."</string>
     <string name="location_adas_app_info_summary" msgid="7806057735910556609">"             .\n\n                     ."</string>
     <string name="microphone_settings_title" msgid="7125554350537136922">""</string>
     <string name="microphone_toggle_title" msgid="911586035332827275">"  "</string>
@@ -589,7 +605,7 @@
     <string name="current_user_name" msgid="3813671533249316823">" (%1$s)"</string>
     <string name="user_name_label" msgid="3210832645046206845">""</string>
     <string name="user_summary_not_set_up" msgid="1473688119241224145">" "</string>
-    <string name="edit_user_name_title" msgid="1118500707473139995">"  "</string>
+    <string name="edit_user_name_title" msgid="1118500707473139995">"  "</string>
     <string name="name_input_blank_error" msgid="2088850865880984123">"    ."</string>
     <string name="name_input_invalid_error" msgid="4355625213535164704">"    ."</string>
     <string name="users_list_title" msgid="770764290290240909">""</string>
@@ -605,10 +621,10 @@
     <string name="memory_calculating_size" msgid="1672238502950390033">"  "</string>
     <string name="storage_application_size_label" msgid="1146156683170661354">" "</string>
     <string name="storage_data_size_label" msgid="7986110464268960652">" "</string>
-    <string name="storage_cache_size_label" msgid="6361308766707419555">" "</string>
+    <string name="storage_cache_size_label" msgid="6361308766707419555">" "</string>
     <string name="storage_total_size_label" msgid="3892138268243791912">""</string>
     <string name="storage_clear_user_data_text" msgid="8787615136779130680">"   "</string>
-    <string name="storage_clear_cache_btn_text" msgid="8449547925966775612">"   "</string>
+    <string name="storage_clear_cache_btn_text" msgid="8449547925966775612">"   "</string>
     <string name="storage_clear_data_dlg_title" msgid="5863775997588969879">"   "</string>
     <string name="storage_clear_data_dlg_text" msgid="3255314337644212283">"       .           ."</string>
     <string name="storage_clear_failed_dlg_text" msgid="6710485971686866306">"     ."</string>
@@ -621,7 +637,7 @@
     <string name="account_auto_sync_title" msgid="3238816995364191432">"  "</string>
     <string name="account_auto_sync_summary" msgid="6963837893148304128">"       "</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"    "</string>
-    <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"               .\n\n                  ."</string>
+    <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"               .\n\n                  ."</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="6683011954002351091">"    "</string>
     <string name="data_usage_auto_sync_off_dialog" msgid="5040873073016183315">"                   .      ."</string>
     <string name="account_details_title" msgid="7529571432258448573">" "</string>
@@ -666,7 +682,7 @@
     <string name="required_apps_group_title" msgid="8607608579973985786">" "</string>
     <string name="required_apps_group_summary" msgid="5026442309718220831">"          "</string>
     <string name="required_apps_privacy_policy_button_text" msgid="960364076891996263">""</string>
-    <string name="camera_access_disclaimer_summary" msgid="442467418242962647">"           "</string>
+    <string name="camera_access_disclaimer_summary" msgid="442467418242962647">"           "</string>
     <string name="camera_infotainment_apps_toggle_title" msgid="6628966732265022536">" -"</string>
     <string name="camera_infotainment_apps_toggle_summary" msgid="2422476957183039039">"    -      "</string>
     <string name="permission_grant_allowed" msgid="4844649705788049638">""</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"      "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"        "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  -"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -814,12 +833,12 @@
     <string name="admin_device_owner_message" msgid="896530502350904835">"           -                   ."</string>
     <string name="admin_financed_message" msgid="7357397436233684082">"           -              ."</string>
     <string name="disabled_by_policy_title" msgid="1121694702115232518">" "</string>
-    <string name="disabled_by_policy_title_adjust_volume" msgid="7002865820552702232">"         "</string>
-    <string name="disabled_by_policy_title_outgoing_calls" msgid="158752542663419500">"       "</string>
-    <string name="disabled_by_policy_title_sms" msgid="3044491214572494290">"      "</string>
-    <string name="disabled_by_policy_title_camera" msgid="8929782627587059121">"      "</string>
-    <string name="disabled_by_policy_title_screen_capture" msgid="4059715943558852466">"      "</string>
-    <string name="disabled_by_policy_title_suspend_packages" msgid="7505332012990359725">"         "</string>
+    <string name="disabled_by_policy_title_adjust_volume" msgid="7002865820552702232">"         "</string>
+    <string name="disabled_by_policy_title_outgoing_calls" msgid="158752542663419500">"       "</string>
+    <string name="disabled_by_policy_title_sms" msgid="3044491214572494290">"      "</string>
+    <string name="disabled_by_policy_title_camera" msgid="8929782627587059121">"      "</string>
+    <string name="disabled_by_policy_title_screen_capture" msgid="4059715943558852466">"      "</string>
+    <string name="disabled_by_policy_title_suspend_packages" msgid="7505332012990359725">"         "</string>
     <string name="disabled_by_policy_title_financed_device" msgid="6005343494788285981">"      "</string>
     <string name="default_admin_support_msg" msgid="2986598061733013282">"        .\n\n       ."</string>
     <string name="help_url_action_disabled_by_it_admin" msgid="1479392394986580260"></string>
@@ -830,14 +849,14 @@
     <string name="work_policy_privacy_settings_no_org_name" msgid="8011687012493940230">"  "</string>
     <string name="work_policy_privacy_settings_summary" msgid="5321618399949880194">"   "</string>
     <string name="footer_learn_more_content_description" msgid="7749452309729272078">" <xliff:g id="SERVICE">%1$s</xliff:g>  "</string>
-    <string name="enterprise_privacy_settings" msgid="6496900796150572727">"  "</string>
+    <string name="enterprise_privacy_settings" msgid="6496900796150572727">"  "</string>
     <string name="enterprise_privacy_settings_summary_generic" msgid="5850991363779957797">"   "</string>
-    <string name="enterprise_privacy_header" msgid="4652489109303330306">"                     -  .\n\n       ."</string>
+    <string name="enterprise_privacy_header" msgid="4652489109303330306">"                     -  .\n\n       ."</string>
     <string name="enterprise_privacy_exposure_category" msgid="4870494030035008520">"      "</string>
     <string name="enterprise_privacy_exposure_changes_category" msgid="8837106430193547177">"       "</string>
-    <string name="enterprise_privacy_exposure_desc" msgid="7962571201715956427">" "<li>"      "</li>\n" "<li>"     "</li>\n" "<li>"      "</li></string>
+    <string name="enterprise_privacy_exposure_desc" msgid="7962571201715956427">" "<li>"      "</li>\n" "<li>"     "</li>\n" "<li>"      "</li></string>
     <string name="enterprise_privacy_device_access_category" msgid="5820180227429886857">"    -"</string>
-    <string name="enterprise_privacy_installed_packages" msgid="1069862734971848156">"    "</string>
+    <string name="enterprise_privacy_installed_packages" msgid="1069862734971848156">"    "</string>
     <string name="enterprise_privacy_apps_count_estimation_info" msgid="2684195229249659340">"              Play ."</string>
     <plurals name="enterprise_privacy_number_packages_lower_bound" formatted="false" msgid="1628398874478431488">
       <item quantity="one"> <xliff:g id="COUNT_1">%d</xliff:g> </item>
@@ -900,13 +919,13 @@
     <string name="screen_reader_settings_title" msgid="4012734340987826872">""</string>
     <string name="show_captions_toggle_title" msgid="710582308974826311">"   "</string>
     <string name="captions_text_size_title" msgid="1960814652560877963">" "</string>
-    <string name="captions_settings_style_header" msgid="944591388386054372">"   "</string>
+    <string name="captions_settings_style_header" msgid="944591388386054372">"   "</string>
     <string name="captions_settings_text_size_very_small" msgid="7476485317028306502">" "</string>
     <string name="captions_settings_text_size_small" msgid="1481895299805450566">""</string>
     <string name="captions_settings_text_size_default" msgid="2227802573224038267">""</string>
     <string name="captions_settings_text_size_large" msgid="5198207220911360512">""</string>
     <string name="captions_settings_text_size_very_large" msgid="949511539689307969">" "</string>
-    <string name="captions_text_style_title" msgid="8547777957403577760">" "</string>
+    <string name="captions_text_style_title" msgid="8547777957403577760">" "</string>
     <string name="captions_settings_text_style_by_app" msgid="7014882290456996444">"  "</string>
     <string name="captions_settings_text_style_white_on_black" msgid="5758084000323596070">"  "</string>
     <string name="captions_settings_text_style_black_on_white" msgid="3906140601916221220">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-fi/strings.xml b/res/values-fi/strings.xml
index 36eebf111..08a3481db 100644
--- a/res/values-fi/strings.xml
+++ b/res/values-fi/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Yhteyden muodostus onnistui"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Nyt kaikki"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Haetaan"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Yhdistetyt laitteet"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Kyt Bluetoothia"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Kyttmttmt sovellukset"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# kyttmtn sovellus}other{# kyttmtnt sovellusta}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Poista lupia ja vapauta tilaa"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Kuvasuhde (kokeellinen)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Avaa"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Sovelluksen oletus"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Koko nytt"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Puolikas nytt"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Laitteen kuvasuhde"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Sovellus kynnistyy uudelleen, kun muutat kuvasuhdetta. Voit menett tallentamattomat muutokset. Kaikkia sovelluksia ei ehk optimoida tietyille kuvasuhteille."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s sisisess tallennustilassa"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Kytt jrjestelmn resursseja sovelluksen suorituskyvyn priorisointiin"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Datan kytt"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Laita Bluetooth plle, jotta voit nhd laitteesi"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Avaa Bluetooth-asetukset, jotta voit muodostaa laiteparin"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Teema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Laita ajotila plle"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Nyt asettelun rajat"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Pakota RTL-asettelun suunta"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Yksilinti-peitto"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainment-jrjestelmn valvoja"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivoidut sovellukset"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Kytst poistetut sovellukset"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Internetliittymsi ovat vanhentuneet"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Katso liittymt"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Valmis"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Ajoneuvosi ei tue tt ominaisuutta"</string>
 </resources>
diff --git a/res/values-fr-rCA/strings.xml b/res/values-fr-rCA/strings.xml
index 0275c124f..09cdd84c2 100644
--- a/res/values-fr-rCA/strings.xml
+++ b/res/values-fr-rCA/strings.xml
@@ -141,7 +141,7 @@
     <string name="wifi_settings_scanning_required_enabled" msgid="5457372118991438313">"La recherche de rseaux Wi-Fi est active"</string>
     <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"Passer automatiquement au rseau cellulaire"</string>
     <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"Utiliser le rseau de donnes cellulaires lorsque le rseau Wi-Fi n\'a pas accs  Internet. Des frais de transmission de donnes peuvent s\'appliquer."</string>
-    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Recherchez rseaux Wi-Fi et connectez-y-vous"</string>
+    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Recherchez rseaux Wi-Fi et connectez-vous-y"</string>
     <string name="learn_more" msgid="8214605928933358604">"En savoir plus"</string>
     <string name="wifi_hotspot_name_title" msgid="8844779338692535356">"Nom du point d\'accs"</string>
     <string name="wifi_hotspot_name_summary_connecting" msgid="5262510450498600038">"Activation de <xliff:g id="WIFI_HOTSPOT_NAME">%1$s</xliff:g> en cours"</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Connexion russie"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Tout afficher"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Recherche en cours"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Appareils connects"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Utiliser le Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Applications non utilises"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#application non utilise}one{#application non utilise}other{#applications non utilises}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Retirer autorisations et librer espace"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Proportions (exprimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Ouvrir"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Proportions par dfaut de l\'appli"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Plein cran"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Moiti de l\'cran"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Proportions de l\'appareil"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"L\'appli redmarrera lorsque vous aurez modifi les proportions. Vous pourriez perdre les modifications non enregistres. Il se peut que certaines applis ne soient pas optimises pour certaines proportions."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s de mmoire de stockage interne"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Utilise les ressources systme pour prioriser la performance de l\'application"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Utilisation des donnes"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Pour afficher vos appareils, activez le Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Pour associer un appareil, ouvrez les paramtres Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Thme"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Activer le mode Voiture"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Afficher les contours de la mise en page"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forcer l\'orientation de droite  gauche"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Superposition de personnalisation"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrateur du systme d\'infodivertissement"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Applications actives"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Applications dsactives"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Vos forfaits Internet ont expir"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Voir les forfaits"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Termin"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Votre vhicule ne prend pas en charge cette fonctionnalit"</string>
 </resources>
diff --git a/res/values-fr/strings.xml b/res/values-fr/strings.xml
index 004e04563..9eeb28173 100644
--- a/res/values-fr/strings.xml
+++ b/res/values-fr/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Connexion russie"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Tout afficher"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Recherche en cours"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Appareils connects"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Utiliser le Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Applis inutilises"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#appli inutilise}one{#appli inutilise}other{#applis inutilises}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Supprimer autorisations et librer espace"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Format (version exprimentale)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Ouvrir"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Paramtre par dfaut de l\'appli"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Plein cran"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Moiti de l\'cran"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Format de l\'appareil"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Si vous modifiez le format, l\'appli redmarrera. Vous risquez de perdre les modifications non enregistres. Certaines applis peuvent ne pas tre optimises pour certains formats."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s de mmoire de stockage interne"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Utiliser les ressources systme pour prioriser les performances de l\'appli"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Consommation des donnes"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Pour voir vos appareils, activez le Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Pour associer un appareil, ouvrez les paramtres du Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Thme"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Configurer le mode Voiture"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Afficher les contours"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forcer l\'orientation de droite  gauche"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Fentre de personnalisation"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administration du systme d\'infoloisirs"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Applis actives"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Applis dsactives"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Vos forfaits Internet ont expir"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Afficher les forfaits"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"OK"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Votre vhicule n\'est pas compatible avec cette fonctionnalit."</string>
 </resources>
diff --git a/res/values-gl/strings.xml b/res/values-gl/strings.xml
index b5487a4bb..1e516bbd8 100644
--- a/res/values-gl/strings.xml
+++ b/res/values-gl/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Conexin correcta"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Mostrar todo"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Buscando"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispositivos conectados"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Usar Bluetooth"</string>
@@ -218,10 +224,10 @@
     <string name="uwb_toggle_summary" msgid="2206513296288659105">"Permite que o coche poida identificar a posicin dos dispositivos de banda ultralarga"</string>
     <string name="bluetooth_notif_ticker" msgid="7192577740198156792">"Solicitude de sincronizacin por Bluetooth"</string>
     <string name="bluetooth_device_context_pair_connect" msgid="3138105800372470422">"Sincronizar e conectar"</string>
-    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"Cdigo de sincronizacin por Bluetooth"</string>
+    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"Cdigo de vinculacin por Bluetooth"</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"O PIN contn letras ou smbolos"</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"Escribe o cdigo de sincronizacin e, a continuacin, preme Intro"</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"Queres sincronizar con <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"Queres vincular o dispositivo con <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"Permitir que <xliff:g id="DEVICE_NAME">%1$s</xliff:g> acceda aos teus contactos e ao historial de chamadas"</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">" posible que tamn teas que escribir este PIN no outro dispositivo."</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">" posible que tamn teas que escribir esta clave de acceso no outro dispositivo."</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Aplicacins que non se usan"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#aplicacin que non se usa}other{#aplicacins que non se usan}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Quitar permisos e liberar espazo"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Proporcin (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Abrir"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Opcin predeterminada da aplicacin"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Pantalla completa"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Media pantalla"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Proporcin do dispositivo"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"A aplicacin reiniciarase cando cambies a proporcin. Podes perder os cambios que non estean gardados.  posible que algunhas aplicacins non estean optimizadas para determinadas proporcins."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s do almacenamento interno"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Utiliza recursos do sistema para priorizar o rendemento da aplicacin"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Uso de datos"</string>
@@ -500,7 +516,7 @@
     <string name="show_dev_countdown" msgid="7416958516942072383">"{count,plural, =1{Agora ests a #paso de converterte en programador.}other{Agora ests a #pasos de converterte en programador.}}"</string>
     <string name="show_dev_on" msgid="5339077400040834808">"Agora es programador."</string>
     <string name="show_dev_already" msgid="1678087328973865736">"Non  necesario, xa es programador."</string>
-    <string name="developer_options_settings" msgid="1530739225109118480">"Opcins para programadores"</string>
+    <string name="developer_options_settings" msgid="1530739225109118480">"Opcins de programacin"</string>
     <string name="reset_options_title" msgid="4388902952861833420">"Opcins de restablecemento"</string>
     <string name="reset_options_summary" msgid="5508201367420359293">"Restablecemento do dispositivo, das aplicacins ou da rede"</string>
     <string name="reset_network_title" msgid="3077846909739832734">"Restablecer wifi e Bluetooth"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Para ver os teus dispositivos, activa o Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Para vincular un dispositivo, abre a configuracin do Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Activar modo de conducin"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Mostrar lmites de deseo"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forzar direccin dereita a esquerda"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Personalizacin da superposicin"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrador do sistema de informacin e entretemento"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aplicacins activadas"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Aplicacins desactivadas"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Os teus plans de Internet caducaron"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Ver plans"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Feito"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"O teu vehculo non admite esta funcin"</string>
 </resources>
diff --git a/res/values-gu/strings.xml b/res/values-gu/strings.xml
index 14c459784..3f4f11aa4 100644
--- a/res/values-gu/strings.xml
+++ b/res/values-gu/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"  "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -208,7 +214,7 @@
     <string name="bluetooth_ask_discovery_no_name" msgid="164397600370102369">",       <xliff:g id="TIMEOUT">%1$d</xliff:g>      ."</string>
     <string name="bluetooth_ask_enablement_and_discovery" msgid="5487502083015708674">"<xliff:g id="APP_NAME">%1$s</xliff:g>,          <xliff:g id="TIMEOUT">%2$d</xliff:g>      ."</string>
     <string name="bluetooth_ask_enablement_and_discovery_no_name" msgid="907153034209916282">",          <xliff:g id="TIMEOUT">%1$d</xliff:g>      ."</string>
-    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"   %1$s  "</string>
+    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"   %1$s   "</string>
     <string name="bluetooth_my_devices" msgid="6352010339607939612">" "</string>
     <string name="bluetooth_previously_connected" msgid="5206229557831180323">"  "</string>
     <string name="bluetooth_device_connected_toast" msgid="4614765282582494488">"%1$s   "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{ # }one{ # }other{ # }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"      "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"          .           .               ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s  "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -419,7 +435,7 @@
     <string name="wifi_control_title" msgid="5660436566907731929">"- "</string>
     <string name="wifi_control_description" msgid="6021926850423169261">"-   -    , -     ,       -      ."</string>
     <string name="more_special_access_title" msgid="166115485446645971">""</string>
-    <string name="location_settings_title" msgid="901334356682423679">""</string>
+    <string name="location_settings_title" msgid="901334356682423679">""</string>
     <string name="location_toggle_title" msgid="836779750812064601">"  "</string>
     <string name="location_toggle_summary" msgid="5651728747635881194">"          ."</string>
     <string name="location_infotainment_apps_toggle_title" msgid="2083924249183557387">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"      "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-hi/strings.xml b/res/values-hi/strings.xml
index 7081514c7..702a15c97 100644
--- a/res/values-hi/strings.xml
+++ b/res/values-hi/strings.xml
@@ -132,8 +132,8 @@
     <string name="wifi_dns" msgid="1841448353154932801">""</string>
     <string name="wifi_details_ipv6_address_header" msgid="4707181386646531890">"IPv6 "</string>
     <string name="wifi_gateway" msgid="4975799192860431013">""</string>
-    <string name="wifi_preferences_title" msgid="772788844257225510">"-   "</string>
-    <string name="wifi_wakeup" msgid="7451825226044542000">"-    "</string>
+    <string name="wifi_preferences_title" msgid="772788844257225510">"-  "</string>
+    <string name="wifi_wakeup" msgid="7451825226044542000">"- -   "</string>
     <string name="wifi_wakeup_summary" msgid="7237521683331291414">"          -     ,      "</string>
     <string name="wifi_wakeup_summary_no_location" msgid="2821576525488435259">"\'  \'        . "<annotation id="link">"  "</annotation>"  ."</string>
     <string name="wifi_settings_scanning_required_title" msgid="2726782203331704928">"-      ?"</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"   "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"   "</string>
@@ -208,7 +214,7 @@
     <string name="bluetooth_ask_discovery_no_name" msgid="164397600370102369">"  <xliff:g id="TIMEOUT">%1$d</xliff:g>             ."</string>
     <string name="bluetooth_ask_enablement_and_discovery" msgid="5487502083015708674">"<xliff:g id="APP_NAME">%1$s</xliff:g>     <xliff:g id="TIMEOUT">%2$d</xliff:g>            ."</string>
     <string name="bluetooth_ask_enablement_and_discovery_no_name" msgid="907153034209916282">"      <xliff:g id="TIMEOUT">%1$d</xliff:g>            ."</string>
-    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"   %1$s     "</string>
+    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"   %1$s    "</string>
     <string name="bluetooth_my_devices" msgid="6352010339607939612">" "</string>
     <string name="bluetooth_previously_connected" msgid="5206229557831180323">"    "</string>
     <string name="bluetooth_device_connected_toast" msgid="4614765282582494488">"%1$s   "</string>
@@ -218,10 +224,10 @@
     <string name="uwb_toggle_summary" msgid="2206513296288659105">"               "</string>
     <string name="bluetooth_notif_ticker" msgid="7192577740198156792">"       "</string>
     <string name="bluetooth_device_context_pair_connect" msgid="3138105800372470422">"      "</string>
-    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"     "</string>
+    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"      "</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"       "</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"         Return  Enter "</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"  <xliff:g id="DEVICE_NAME">%1$s</xliff:g>    ?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"  <xliff:g id="DEVICE_NAME">%1$s</xliff:g>   ?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>            "</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"        ."</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"        ."</string>
@@ -238,8 +244,8 @@
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">" "</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">" "</string>
     <string name="keyboard_settings" msgid="1959697870618278081">""</string>
-    <string name="manage_keyboard" msgid="4045394766282200132">"  "</string>
-    <string name="text_to_speech_settings" msgid="811985746199507343">"\'    \' "</string>
+    <string name="manage_keyboard" msgid="4045394766282200132">"  "</string>
+    <string name="text_to_speech_settings" msgid="811985746199507343">"      "</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">" "</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">" "</string>
     <string name="tts_speech_rate" msgid="4512944877291943133">"  "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"     "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{     # }one{     # }other{     # }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"     "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  (  )"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"    "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"   "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"  (-  )      .            .  ,            ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"    %s "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       ,      "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -368,7 +384,7 @@
     <string name="assist_access_screenshot_title" msgid="2855956879971465044">"   "</string>
     <string name="assist_access_screenshot_summary" msgid="6246496926635145782">"        "</string>
     <string name="voice_input_settings_title" msgid="3238707827815647526">"      "</string>
-    <string name="autofill_settings_title" msgid="1188754272680049972">"    "</string>
+    <string name="autofill_settings_title" msgid="1188754272680049972">"   "</string>
     <string name="app_list_preference_none" msgid="7753357799926715901">" "</string>
     <string name="default_app_selected_app" msgid="5289396663745484773">"  "</string>
     <string name="assistant_security_warning" msgid="1844807956967428012">"            .                 ."</string>
@@ -409,7 +425,7 @@
     <string name="notification_listener_security_warning_summary" msgid="7280197998063498125">"<xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>     .    ,            .                  .\n\n   \'  \'            ."</string>
     <string name="notification_listener_revoke_warning_summary" msgid="4904973394539125407">"  <xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>        ,  \'  \'        ."</string>
     <string name="notification_listener_revoke_warning_confirm" msgid="2759583507454984812">" "</string>
-    <string name="notification_listener_revoke_warning_cancel" msgid="4399941651358241154">" "</string>
+    <string name="notification_listener_revoke_warning_cancel" msgid="4399941651358241154">" "</string>
     <string name="performance_impacting_apps_description" msgid="7361464904617808444">" ,        . ,        .\n          ,               ."</string>
     <string name="performance_impacting_apps_button_label" msgid="8277507326717608783">"   "</string>
     <string name="premium_sms_access_title" msgid="4290463862145052004">"      "</string>
@@ -568,7 +584,7 @@
     <string name="user_add_user_menu" msgid="4125869008006021799">" "</string>
     <string name="user_new_user_name" msgid="906698527658609819">" "</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"   ?"</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"     ,              ."</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"    ,          ."</string>
     <string name="user_add_user_message_update" msgid="3836353291078729240">"         ,        ."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"     "</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{ 1     .}one{    #    .}other{    #    .}}"</string>
@@ -589,7 +605,7 @@
     <string name="current_user_name" msgid="3813671533249316823">" (%1$s)"</string>
     <string name="user_name_label" msgid="3210832645046206845">""</string>
     <string name="user_summary_not_set_up" msgid="1473688119241224145">"  "</string>
-    <string name="edit_user_name_title" msgid="1118500707473139995">"    "</string>
+    <string name="edit_user_name_title" msgid="1118500707473139995">"     "</string>
     <string name="name_input_blank_error" msgid="2088850865880984123">"        ."</string>
     <string name="name_input_invalid_error" msgid="4355625213535164704">"     ."</string>
     <string name="users_list_title" msgid="770764290290240909">""</string>
@@ -618,8 +634,8 @@
     <string name="user_add_account_menu" msgid="6625351983590713721">" "</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"     "</string>
     <string name="account_list_title" msgid="7631588514613843065">"<xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>  "</string>
-    <string name="account_auto_sync_title" msgid="3238816995364191432">"  -   "</string>
-    <string name="account_auto_sync_summary" msgid="6963837893148304128">"   -   "</string>
+    <string name="account_auto_sync_title" msgid="3238816995364191432">" -   "</string>
+    <string name="account_auto_sync_summary" msgid="6963837893148304128">"  -    "</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"        ?"</string>
     <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"           Android Auto    -   .\n\n  , Android Auto     ,    -    ."</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="6683011954002351091">"        ?"</string>
@@ -779,7 +795,7 @@
     <string name="restricted_for_driver" msgid="3364388937671526800">"     "</string>
     <string name="add_user_restricted_while_driving" msgid="1037301074725362944">"        "</string>
     <string name="default_search_query" msgid="3137420627428857068">""</string>
-    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"Assistant     "</string>
+    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"     "</string>
     <string name="assistant_and_voice_assistant_app_title" msgid="5981647244625171285">"  "</string>
     <string name="assistant_and_voice_use_text_from_screen_title" msgid="5851460943413795599">"     "</string>
     <string name="assistant_and_voice_use_text_from_screen_summary" msgid="4161751708121301541">"        "</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"            .       ."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">"  "</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"     ,   "</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"        ,   "</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"     ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"      "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"     "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"         "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"    "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"     "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"      "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"        "</string>
 </resources>
diff --git a/res/values-hr/strings.xml b/res/values-hr/strings.xml
index 2422a622d..434be2da9 100644
--- a/res/values-hr/strings.xml
+++ b/res/values-hr/strings.xml
@@ -86,7 +86,7 @@
     <string name="network_and_internet_oem_network_dialog_confirm_label" msgid="2630033932472996255">"Ipak iskljui"</string>
     <string name="network_and_internet_oem_network_disabled_footer" msgid="3529208167627034245">"Internet u vozilu je iskljuen. To moe onemoguiti rad nekih znaajki ili aplikacija vozila. Kritini podaci potrebni za rad vozila i dalje e se dijeliti s proizvoaem."</string>
     <string name="network_and_internet_data_usage_time_range_summary" msgid="1792995626433410056">"%1$s iskoriteno od %2$s do %3$s"</string>
-    <string name="network_and_internet_join_other_network_title" msgid="7126831320010062712">"Pridruivanje drugoj mrei"</string>
+    <string name="network_and_internet_join_other_network_title" msgid="7126831320010062712">"Poveite se s drugom mreom"</string>
     <string name="network_and_internet_network_preferences_title" msgid="2983548049081168876">"Postavke mree"</string>
     <string name="wifi_settings" msgid="7701477685273103841">"Wi-Fi"</string>
     <string name="wifi_starting" msgid="473253087503153167">"Ukljuivanje Wi-Fija"</string>
@@ -178,8 +178,14 @@
     <string name="network_connection_timeout_dialog_ok" msgid="2228662561126434792">"Pokuajte ponovo"</string>
     <string name="network_connection_errorstate_dialog_message" msgid="4268321315241218483">"Dolo je do pogreke. Aplikacija je otkazala zahtjev za odabir ureaja."</string>
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Povezivanje je uspjelo"</string>
-    <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Pokai sve"</string>
+    <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Prikai sve"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Pretraivanje"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Povezani ureaji"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Koristi Bluetooth"</string>
@@ -312,7 +318,7 @@
     <string name="units_unit_name_kilometers_per_liter" msgid="8769902235588571155">"Kilometara po litri"</string>
     <string name="units_unit_name_liter_per_hundred_kilometers" msgid="4867647387452453552">"Litara na stotinu kilometara"</string>
     <string name="apps_and_notifications_settings" msgid="8704585874333781975">"Aplikacije i obavijesti"</string>
-    <string name="all_applications" msgid="7798210477486822168">"Pokai sve aplikacije"</string>
+    <string name="all_applications" msgid="7798210477486822168">"Prikai sve aplikacije"</string>
     <string name="default_applications" msgid="1558183275638697087">"Zadane aplikacije"</string>
     <string name="performance_impacting_apps" msgid="3439260699394720569">"Aplikacije koje utjeu na izvedbu"</string>
     <string name="app_permissions" msgid="32799922508313948">"Doputenja za aplikacije"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nekoritene aplikacije"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# nekoritena aplikacija}one{# nekoritena aplikacija}few{# nekoritene aplikacije}other{# nekoritenih aplikacija}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Ukloni doputenja i oslobodi prostor"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Omjer slike (eksperimentalno)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Otvori"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Zadano za aplikaciju"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Cijeli zaslon"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Pola zaslona"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Omjer slike ureaja"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aplikacija e se ponovo pokrenuti kad promijenite omjer slike. Moda ete izgubiti nespremljene promjene. Neke aplikacije moda nisu optimizirane za odreene omjere slike."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s u internoj pohrani"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Upotrijebite resurse sustava da biste izvedbu aplikacije postavili kao prioritet"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Potronja podataka"</string>
@@ -589,7 +605,7 @@
     <string name="current_user_name" msgid="3813671533249316823">"Vi (%1$s)"</string>
     <string name="user_name_label" msgid="3210832645046206845">"Ime"</string>
     <string name="user_summary_not_set_up" msgid="1473688119241224145">"Nije postavljen"</string>
-    <string name="edit_user_name_title" msgid="1118500707473139995">"Ureivanje naziva profila"</string>
+    <string name="edit_user_name_title" msgid="1118500707473139995">"Uredite naziv profila"</string>
     <string name="name_input_blank_error" msgid="2088850865880984123">"Polje ne moe biti prazno."</string>
     <string name="name_input_invalid_error" msgid="4355625213535164704">"Uneseni naziv profila nije vaei."</string>
     <string name="users_list_title" msgid="770764290290240909">"Korisnici"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Da biste vidjeli svoje ureaje, ukljuite Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Da biste uparili ureaj, otvorite postavke Bluetootha"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Postavi nain za vonju"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Prikai okvir izgleda"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Prisilna upotreba izgleda zdesna ulijevo"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Preklapanje prilagodbe"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrator sustava za informiranje i zabavu"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivirane aplikacije"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivirane aplikacije"</string>
@@ -939,4 +958,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Vai su internetski paketi istekli"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Prikai pakete"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Gotovo"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Vae vozilo ne podrava tu znaajku"</string>
 </resources>
diff --git a/res/values-hu/strings.xml b/res/values-hu/strings.xml
index 8d4889f84..d3032ede2 100644
--- a/res/values-hu/strings.xml
+++ b/res/values-hu/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Sikeres kapcsolds"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"sszes mutatsa"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Keress"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Csatlakoztatott eszkzk"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth hasznlata"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nem hasznlt alkalmazsok"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# nem hasznlt alkalmazs}other{# nem hasznlt alkalmazs}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Engedlytrls s trhely-felszabadts"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Kparny (ksrleti)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Megnyits"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Alkalmazs alaprtelmezett rtke"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Teljes kperny"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Fl kperny"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Eszkz kparnya"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Az alkalmazs jraindul a kparny mdostsakor. A nem mentett mdostsai elveszhetnek. Elfordulhat, hogy egyes alkalmazsok nem optimalizlhatk bizonyos mretarnyokra."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s a bels trhelyen"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"A rendszer erforrsait hasznlja az appteljestmny rangsorolshoz"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Adathasznlat"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Eszkzei megtekintshez kapcsolja be a Bluetootht"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Eszkz prostshoz nyissa meg a Bluetooth-belltsokat"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tma"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Vezetsi md bekapcsolsa"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Elrendezshatrok megjelentse"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Knyszertett elrendezs jobbrl balra"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Szemlyre szabsi fedvny"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainment-rendszergazda"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivlt alkalmazsok"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivlt alkalmazsok"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Lejrtak az n internetcsomagjai"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Csomagok megtekintse"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Ksz"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Jrmve nem tmogatja ezt a funkcit"</string>
 </resources>
diff --git a/res/values-hy/strings.xml b/res/values-hy/strings.xml
index 980328f92..6dc0f922a 100644
--- a/res/values-hy/strings.xml
+++ b/res/values-hy/strings.xml
@@ -101,7 +101,7 @@
     <string name="wifi_disconnected" msgid="4485699234859368137">" "</string>
     <string name="wifi_not_in_range_message" msgid="2617126307140203787">"  "</string>
     <string name="wifi_password" msgid="5565632142720292397">""</string>
-    <string name="wifi_show_password" msgid="8423293211933521097">" "</string>
+    <string name="wifi_show_password" msgid="8423293211933521097">"  "</string>
     <string name="wifi_no_network_name" msgid="6819604337231313594">"  "</string>
     <string name="wifi_ssid" msgid="488604828159458741">" "</string>
     <string name="wifi_ssid_hint" msgid="3170608752313710099">" SSID-"</string>
@@ -111,7 +111,7 @@
     <string name="wifi_speed" msgid="1650692446731850781">" "</string>
     <string name="wifi_frequency" msgid="8951455949682864922">""</string>
     <string name="wifi_ip_address" msgid="3128140627890954061">"IP "</string>
-    <string name="show_password" msgid="2074628020371139240">" "</string>
+    <string name="show_password" msgid="2074628020371139240">"  "</string>
     <string name="default_network_name_summary" msgid="8148402439232464276">"  "</string>
     <string name="default_password_summary" msgid="8789594645836902982">" "</string>
     <string name="access_point_tag_key" msgid="1517143378973053337">"access_point_tag_key"</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"  "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth-"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }one{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"   ,                "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -617,7 +633,7 @@
     <string name="accounts_settings_title" msgid="436190037084293471">""</string>
     <string name="user_add_account_menu" msgid="6625351983590713721">" "</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"  "</string>
-    <string name="account_list_title" msgid="7631588514613843065">"<xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>- "</string>
+    <string name="account_list_title" msgid="7631588514613843065">"<xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g> "</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"  "</string>
     <string name="account_auto_sync_summary" msgid="6963837893148304128">"     "</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"   "</string>
@@ -779,7 +795,7 @@
     <string name="restricted_for_driver" msgid="3364388937671526800">"    "</string>
     <string name="add_user_restricted_while_driving" msgid="1037301074725362944">"     "</string>
     <string name="default_search_query" msgid="3137420627428857068">""</string>
-    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"  Google Voice"</string>
+    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"  Voice"</string>
     <string name="assistant_and_voice_assistant_app_title" msgid="5981647244625171285">"  "</string>
     <string name="assistant_and_voice_use_text_from_screen_title" msgid="5851460943413795599">"  "</string>
     <string name="assistant_and_voice_use_text_from_screen_summary" msgid="4161751708121301541">"    "</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"        ,     "</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">" "</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"     Bluetooth-"</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"    Bluetooth- "</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"    Bluetooth- "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"   "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"      "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-in/strings.xml b/res/values-in/strings.xml
index 983d68cb0..463fc2909 100644
--- a/res/values-in/strings.xml
+++ b/res/values-in/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Koneksi berhasil"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Tampilkan semua"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Menelusuri"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Perangkat terhubung"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Gunakan Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Aplikasi tidak digunakan"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# aplikasi tidak digunakan}other{# aplikasi tidak digunakan}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Hapus izin &amp; kosongkan ruang penyimpanan"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Rasio aspek (Eksperimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Buka"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Default aplikasi"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Layar penuh"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Setengah layar"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Rasio aspek perangkat"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aplikasi akan dimulai ulang saat Anda mengubah rasio aspek. Anda mungkin akan kehilangan perubahan yang belum disimpan. Beberapa aplikasi mungkin tidak dioptimalkan untuk rasio aspek tertentu."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s di penyimpanan internal"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Menggunakan resource sistem untuk memprioritaskan performa aplikasi"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Penggunaan data"</string>
@@ -760,7 +776,7 @@
     <string name="credentials_not_erased" msgid="6118567459076742720">"Penyimpanan kredensial tidak dapat dihapus."</string>
     <string name="forget" msgid="3971143908183848527">"Lupakan"</string>
     <string name="connect" msgid="5861699594602380150">"Hubungkan"</string>
-    <string name="disconnect" msgid="6140789953324820336">"Putuskan koneksi"</string>
+    <string name="disconnect" msgid="6140789953324820336">"Berhenti hubungkan"</string>
     <string name="delete_button" msgid="5840500432614610850">"Hapus"</string>
     <string name="remove_button" msgid="6664656962868194178">"Hapus"</string>
     <string name="cancel" msgid="750286395700355455">"Batal"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Untuk melihat perangkat Anda, aktifkan Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Untuk menyambungkan perangkat, buka setelan Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Setel mode mengemudi"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Tampilkan batas tata letak"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Paksa arah tata letak RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Overlay penyesuaian"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Admin sistem infotainmen"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aplikasi yang diaktifkan"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Aplikasi yang dinonaktifkan"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Masa berlaku paket internet Anda telah berakhir"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Lihat paket"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Selesai"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Kendaraan Anda tidak mendukung fitur ini"</string>
 </resources>
diff --git a/res/values-is/strings.xml b/res/values-is/strings.xml
index 78f220dad..8435aefa7 100644
--- a/res/values-is/strings.xml
+++ b/res/values-is/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Tenging tkst"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Sna allar"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Leitar"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Tengd tki"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Nota Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"notu forrit"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# nota forrit}one{# nota forrit}other{# notu forrit}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Fjarlgja heimildir og losa um plss"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Myndhlutfall (tilraun)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Opna"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Sjlfgefi  forriti"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Allur skjrinn"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Hlfur skjrinn"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Myndhlutfall tkis"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Forriti verur endurrst egar  breytir myndhlutfallinu. vistaar breytingar gtu glatast. Sum forrit eru ef til vill ekki fnstillt fyrir tiltekin myndhlutfll."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s  innbyggri geymslu"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Notar kerfistilfng til a forgangsraa afkstum forrits"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Gagnanotkun"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Kveiktu  Bluetooth til a sj tkin n"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Opnau stillingar Bluetooth til a para tki"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"ema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Kveikja  akstursstillingu"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Sna uppsetningarmrk"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"vinga uppsetningu fr hgri til vinstri"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Yfirlgn srsnis"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Stjrnandi upplsinga- og afreyingarkerfis"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Virk forrit"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"virk forrit"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Netskriftirnar nar runnu t"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Sj skriftir"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Loki"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Bllinn inn styur ekki ennan eiginleika"</string>
 </resources>
diff --git a/res/values-it/strings.xml b/res/values-it/strings.xml
index 13eb3ef51..5b343189c 100644
--- a/res/values-it/strings.xml
+++ b/res/values-it/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Connessione riuscita"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Mostra tutte"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Ricerca"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispositivi connessi"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Usa il Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"App inutilizzate"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# app inutilizzata}other{# app inutilizzate}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Rimuovi autorizzazioni e libera spazio"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Formato (sperimentale)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Apri"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Valore predefinito dell\'app"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Schermo intero"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Met schermo"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Proporzioni del dispositivo"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Se modifichi i formati, l\'app verr riavviata. Potresti perdere le modifiche non salvate. Alcune app potrebbero non essere ottimizzate per determinati formati."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s nella memoria interna"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Utilizza le risorse del sistema per dare la priorit alle prestazioni dell\'app"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Utilizzo dei dati"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Per vedere i tuoi dispositivi, attiva il Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Per accoppiare un dispositivo, apri le impostazioni Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Imposta modalit di guida"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Mostra limiti di layout"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forza direzione layout RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Overlay di personalizzazione"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Amministratore di sistema di infotainment"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"App attivate"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"App disattivate"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"I tuoi piani internet sono scaduti"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Vedi i piani"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Fine"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Il tuo veicolo non supporta questa funzionalit"</string>
 </resources>
diff --git a/res/values-iw/strings.xml b/res/values-iw/strings.xml
index 719ad416e..63a165cca 100644
--- a/res/values-iw/strings.xml
+++ b/res/values-iw/strings.xml
@@ -180,13 +180,19 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" -Bluetooth"</string>
     <string name="bluetooth_device" msgid="3178478829314083240">"  "</string>
     <string name="bluetooth_paired_devices" msgid="6463199569164652410">" "</string>
     <string name="bluetooth_pair_new_device" msgid="6948753485443263095">"  "</string>
-    <string name="bluetooth_pair_new_device_summary" msgid="2497221247690369031">"Bluetooth   "</string>
+    <string name="bluetooth_pair_new_device_summary" msgid="2497221247690369031">"-Bluetooth     "</string>
     <string name="bluetooth_disconnect_title" msgid="7675271355910637528">"  ?"</string>
     <string name="bluetooth_disconnect_all_profiles" msgid="2017519733701757244">"  -<xliff:g id="DEVICE_NAME">%1$s</xliff:g>."</string>
     <string name="bluetooth_vehicle_mac_address" msgid="7069234636525805937">" -Bluetooth  : <xliff:g id="ADDRESS">%1$s</xliff:g>"</string>
@@ -208,7 +214,7 @@
     <string name="bluetooth_ask_discovery_no_name" msgid="164397600370102369">"           Bluetooth   <xliff:g id="TIMEOUT">%1$d</xliff:g> ."</string>
     <string name="bluetooth_ask_enablement_and_discovery" msgid="5487502083015708674">" <xliff:g id="APP_NAME">%1$s</xliff:g>    -Bluetooth           <xliff:g id="TIMEOUT">%2$d</xliff:g> ."</string>
     <string name="bluetooth_ask_enablement_and_discovery_no_name" msgid="907153034209916282">"     -Bluetooth           <xliff:g id="TIMEOUT">%1$d</xliff:g> ."</string>
-    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"  %1$s  "</string>
+    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"    %1$s"</string>
     <string name="bluetooth_my_devices" msgid="6352010339607939612">" "</string>
     <string name="bluetooth_previously_connected" msgid="5206229557831180323">"  "</string>
     <string name="bluetooth_device_connected_toast" msgid="4614765282582494488">"%1$s "</string>
@@ -218,10 +224,10 @@
     <string name="uwb_toggle_summary" msgid="2206513296288659105">"        UWB"</string>
     <string name="bluetooth_notif_ticker" msgid="7192577740198156792">"  Bluetooth"</string>
     <string name="bluetooth_device_context_pair_connect" msgid="3138105800372470422">" "</string>
-    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"  Bluetooth"</string>
+    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"  -Bluetooth"</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"     "</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"         Return  Enter"</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"   <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"   <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"-<xliff:g id="DEVICE_NAME">%1$s</xliff:g>         "</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"          ."</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"         ."</string>
@@ -254,7 +260,7 @@
     <string name="media_volume_summary" msgid="2961762827637127239">"    "</string>
     <string name="alarm_volume_title" msgid="840384014895796587">""</string>
     <string name="ringtone_title" msgid="8370531086214517972">"  "</string>
-    <string name="notification_ringtone_title" msgid="8661716239594010288">"   "</string>
+    <string name="notification_ringtone_title" msgid="8661716239594010288">"   "</string>
     <string name="alarm_ringtone_title" msgid="3257364170646440908">"    "</string>
     <string name="ringtone_picker_save_title" msgid="4388137432517227001">""</string>
     <string name="sound_alert_sounds" msgid="6838044721739163867">" "</string>
@@ -328,7 +334,7 @@
     <string name="prioritize_app_performance_dialog_action_off" msgid="2813324718753199319">" "</string>
     <string name="disable_text" msgid="4358165448648990820">""</string>
     <string name="enable_text" msgid="1794971777861881238">""</string>
-    <string name="uninstall_text" msgid="277907956072833012">" "</string>
+    <string name="uninstall_text" msgid="277907956072833012">""</string>
     <string name="app_disable_dialog_text" msgid="7731155411006654025">"   ,  -Android     ."</string>
     <string name="app_disable_dialog_positive" msgid="4448684722791563349">" "</string>
     <string name="not_installed" msgid="4163454337822508007">"   "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"    "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{     }one{#     }two{#     }other{#     }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" - ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"   "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">" -  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"       -.      .         -."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"  "</string>
@@ -364,7 +380,7 @@
     <string name="assist_and_voice_input_settings" msgid="8813195157136637132">"   "</string>
     <string name="assist_app_settings" msgid="9085261410166776497">" "</string>
     <string name="assist_access_context_title" msgid="8034851731390785301">"   "</string>
-    <string name="assist_access_context_summary" msgid="2374281280599443774">"     ,  "</string>
+    <string name="assist_access_context_summary" msgid="2374281280599443774">"     "</string>
     <string name="assist_access_screenshot_title" msgid="2855956879971465044">"  "</string>
     <string name="assist_access_screenshot_summary" msgid="6246496926635145782">"      "</string>
     <string name="voice_input_settings_title" msgid="3238707827815647526">" "</string>
@@ -515,7 +531,7 @@
     <string name="reset_network_button_text" msgid="8374174455632765033">" "</string>
     <string name="reset_network_confirm_title" msgid="5255502723840197663">"?"</string>
     <string name="reset_network_confirm_desc" msgid="7721698076856330212">"     ?     !"</string>
-    <string name="reset_network_confirm_button_text" msgid="5246859685069024851">" "</string>
+    <string name="reset_network_confirm_button_text" msgid="5246859685069024851">" "</string>
     <string name="reset_network_complete_toast" msgid="3804108209431416865">"  "</string>
     <string name="reset_app_pref_title" msgid="5855420038951743992">"  "</string>
     <string name="reset_app_pref_desc" msgid="579392665146962149">"     :\n\n"<li>" "</li>\n<li>"   "</li>\n<li>"     "</li>\n<li>"    "</li>\n<li>" "</li>\n\n"   ."</string>
@@ -568,8 +584,8 @@
     <string name="user_add_user_menu" msgid="4125869008006021799">" "</string>
     <string name="user_new_user_name" msgid="906698527658609819">" "</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"  ?"</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"    ,         ."</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">"         ."</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"   ,        ."</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">"    ,     ."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"   "</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{    .}one{   # .}two{   # .}other{   # .}}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">"      "</string>
@@ -617,7 +633,7 @@
     <string name="accounts_settings_title" msgid="436190037084293471">""</string>
     <string name="user_add_account_menu" msgid="6625351983590713721">" "</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"  "</string>
-    <string name="account_list_title" msgid="7631588514613843065">"  <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
+    <string name="account_list_title" msgid="7631588514613843065">" : <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"   "</string>
     <string name="account_auto_sync_summary" msgid="6963837893148304128">"     "</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"    ?"</string>
@@ -748,7 +764,7 @@
     <string name="lockpassword_password_requires_nonletter" msgid="3089186186422638926">"{count,plural, =1{      }one{   #   }two{   #   }other{   #   }}"</string>
     <string name="lockpassword_password_requires_nonnumerical" msgid="1677123573552379526">"{count,plural, =1{      }one{   #   }two{   #   }other{   #   }}"</string>
     <string name="lockpassword_password_too_short" msgid="3898753131694105832">"{count,plural, =1{    }one{   # }two{   # }other{   # }}"</string>
-    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{    }one{   # }two{   # }other{   # }}"</string>
+    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{    }one{   # }two{   # }other{   # }}"</string>
     <string name="lockpassword_password_too_long" msgid="1709616257350671045">"{count,plural, =1{    }one{   -# }two{   -# }other{   -# }}"</string>
     <string name="lockpassword_pin_too_long" msgid="8315542764465856288">"{count,plural, =1{    }one{   -# }two{   -# }other{   -# }}"</string>
     <string name="lockpassword_pin_no_sequential_digits" msgid="6511579896796310956">"    ,   "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    ,    Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"  ,     Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">" "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"-   "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"    "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -939,4 +958,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"  "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-ja/strings.xml b/res/values-ja/strings.xml
index 050c5245d..b5b179777 100644
--- a/res/values-ja/strings.xml
+++ b/res/values-ja/strings.xml
@@ -44,7 +44,7 @@
     <string name="sim_change_data_message" msgid="4669775284395549069">" <xliff:g id="CARRIER2_0">%2$s</xliff:g> <xliff:g id="CARRIER1">%1$s</xliff:g>  <xliff:g id="CARRIER2_1">%2$s</xliff:g> "</string>
     <string name="sim_change_data_ok" msgid="2348804996223271081">"<xliff:g id="CARRIER">%1$s</xliff:g> "</string>
     <string name="roaming_title" msgid="6218635014519017734">""</string>
-    <string name="roaming_summary" msgid="7476127740259728901">""</string>
+    <string name="roaming_summary" msgid="7476127740259728901">""</string>
     <string name="roaming_alert_title" msgid="4433901635766775763">" "</string>
     <string name="roaming_warning" msgid="4908184914868720704">""</string>
     <string name="data_usage_settings" msgid="7877132994777987848">""</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth "</string>
@@ -331,7 +337,7 @@
     <string name="uninstall_text" msgid="277907956072833012">""</string>
     <string name="app_disable_dialog_text" msgid="7731155411006654025">"Android "</string>
     <string name="app_disable_dialog_positive" msgid="4448684722791563349">""</string>
-    <string name="not_installed" msgid="4163454337822508007">""</string>
+    <string name="not_installed" msgid="4163454337822508007">""</string>
     <string name="permissions_label" msgid="2701446753515612685">""</string>
     <string name="app_info_all_services_label" msgid="6495363975322723452">""</string>
     <string name="notifications_label" msgid="6586089149665170731">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">""</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# }other{# }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">""</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">""</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">""</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">""</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">" "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -392,7 +408,7 @@
     <string name="apps_settings_title" msgid="3982535942394315336">""</string>
     <string name="apps_recently_opened" msgid="5320377037971195984">""</string>
     <string name="apps_view_all_apps_title" msgid="2322120325505230530">"%1$d "</string>
-    <string name="apps_permission_manager_title" msgid="8776335943862484131">""</string>
+    <string name="apps_permission_manager_title" msgid="8776335943862484131">""</string>
     <string name="apps_permission_manager_summary" msgid="4180424218228141274">""</string>
     <string name="apps_default_apps_summary" msgid="2017792579839972926">""</string>
     <string name="performance_impacting_apps_summary" msgid="7762122057244111162">"{count,plural, =1{# }other{# }}"</string>
@@ -566,12 +582,12 @@
     <string name="install_apps_permission_title" msgid="3099705360827925296">""</string>
     <string name="uninstall_apps_permission_title" msgid="8448422340567430659">""</string>
     <string name="user_add_user_menu" msgid="4125869008006021799">""</string>
-    <string name="user_new_user_name" msgid="906698527658609819">""</string>
-    <string name="user_add_user_title" msgid="6296827596015729982">""</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">""</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">""</string>
-    <string name="user_limit_reached_title" msgid="5677729355746623293">""</string>
-    <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{ 1 }other{ # }}"</string>
+    <string name="user_new_user_name" msgid="906698527658609819">""</string>
+    <string name="user_add_user_title" msgid="6296827596015729982">""</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">""</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">""</string>
+    <string name="user_limit_reached_title" msgid="5677729355746623293">""</string>
+    <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{ 1 }other{ # }}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">""</string>
     <string name="delete_user_dialog_title" msgid="575517556232943687">""</string>
     <string name="delete_user_dialog_message" msgid="3916865958419051299">""</string>
@@ -589,9 +605,9 @@
     <string name="current_user_name" msgid="3813671533249316823">"%1$s"</string>
     <string name="user_name_label" msgid="3210832645046206845">""</string>
     <string name="user_summary_not_set_up" msgid="1473688119241224145">""</string>
-    <string name="edit_user_name_title" msgid="1118500707473139995">""</string>
+    <string name="edit_user_name_title" msgid="1118500707473139995">""</string>
     <string name="name_input_blank_error" msgid="2088850865880984123">""</string>
-    <string name="name_input_invalid_error" msgid="4355625213535164704">""</string>
+    <string name="name_input_invalid_error" msgid="4355625213535164704">""</string>
     <string name="users_list_title" msgid="770764290290240909">""</string>
     <string name="profiles_list_title" msgid="1443396686780460221">""</string>
     <string name="user_details_admin_title" msgid="3530292857178371891">"%1$s "</string>
@@ -787,17 +803,20 @@
     <string name="assistant_and_voice_use_screenshot_summary" msgid="3738474919393817950">""</string>
     <string name="notifications_recently_sent" msgid="9051696542615302799">""</string>
     <string name="notifications_all_apps" msgid="3557079551048958846">""</string>
-    <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">""</string>
+    <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">""</string>
     <string name="manage_other_profiles_button_text" msgid="2262188413455510828">""</string>
-    <string name="add_a_profile_button_text" msgid="8027395095117925114">""</string>
-    <string name="delete_this_profile_text" msgid="6035404714526922665">""</string>
+    <string name="add_a_profile_button_text" msgid="8027395095117925114">""</string>
+    <string name="delete_this_profile_text" msgid="6035404714526922665">""</string>
     <string name="add_profile_text" msgid="9118410102199116969">""</string>
-    <string name="cannot_remove_driver_profile" msgid="4109363161608717969">""</string>
+    <string name="cannot_remove_driver_profile" msgid="4109363161608717969">""</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">""</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Bluetooth  ON "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Bluetooth "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">""</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">" "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -859,10 +878,10 @@
     <string name="enterprise_privacy_input_method" msgid="5062395693747004531">" "</string>
     <string name="enterprise_privacy_input_method_name" msgid="2027313786295077607">"<xliff:g id="APP_LABEL">%s</xliff:g> "</string>
     <string name="enterprise_privacy_global_http_proxy" msgid="1366593928008294049">" HTTP "</string>
-    <string name="enterprise_privacy_ca_certs_personal" msgid="5677098981429650665">""</string>
+    <string name="enterprise_privacy_ca_certs_personal" msgid="5677098981429650665">""</string>
     <string name="enterprise_privacy_device_access_desc" msgid="3442555102576036038">" "<li>" "</li>\n" "<li>" "</li></string>
     <string name="enterprise_privacy_failed_password_wipe_device" msgid="4768743631260876559">" "</string>
-    <string name="enterprise_privacy_failed_password_wipe_current_user" msgid="786246192213446835">" "</string>
+    <string name="enterprise_privacy_failed_password_wipe_current_user" msgid="786246192213446835">" "</string>
     <plurals name="enterprise_privacy_number_failed_password_wipe" formatted="false" msgid="445847844239023816">
       <item quantity="other">: <xliff:g id="COUNT_1">%d</xliff:g> </item>
       <item quantity="one">: <xliff:g id="COUNT_0">%d</xliff:g> </item>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">" "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">""</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">""</string>
 </resources>
diff --git a/res/values-ka/strings.xml b/res/values-ka/strings.xml
index 3323ec830..6f3a5fd64 100644
--- a/res/values-ka/strings.xml
+++ b/res/values-ka/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth- "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    ."</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">" "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"    .    .        ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s  "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"      "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   Bluetooth "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"/  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"    "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-kk/strings.xml b/res/values-kk/strings.xml
index 9de3cca8e..1edd6e21b 100644
--- a/res/values-kk/strings.xml
+++ b/res/values-kk/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" ."</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"..."</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth  "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">" "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"  ,   .    .        ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">" : %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       ."</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   Bluetooth- ."</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   Bluetooth  ."</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">" "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"  "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"-  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"    "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"    ."</string>
 </resources>
diff --git a/res/values-km/strings.xml b/res/values-km/strings.xml
index ee1fbbaf8..3d880dfcf 100644
--- a/res/values-km/strings.xml
+++ b/res/values-km/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">""</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">""</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{ #}other{ #}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">" "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">""</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"   "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">" "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">" "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">" "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">""</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">" RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">""</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">" "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -900,7 +919,7 @@
     <string name="screen_reader_settings_title" msgid="4012734340987826872">""</string>
     <string name="show_captions_toggle_title" msgid="710582308974826311">""</string>
     <string name="captions_text_size_title" msgid="1960814652560877963">""</string>
-    <string name="captions_settings_style_header" msgid="944591388386054372">" "</string>
+    <string name="captions_settings_style_header" msgid="944591388386054372">" "</string>
     <string name="captions_settings_text_size_very_small" msgid="7476485317028306502">""</string>
     <string name="captions_settings_text_size_small" msgid="1481895299805450566">""</string>
     <string name="captions_settings_text_size_default" msgid="2227802573224038267">""</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">""</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">""</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">""</string>
 </resources>
diff --git a/res/values-kn/strings.xml b/res/values-kn/strings.xml
index 02debefea..3d998c917 100644
--- a/res/values-kn/strings.xml
+++ b/res/values-kn/strings.xml
@@ -22,7 +22,7 @@
     <string name="display_settings" msgid="5325515247739279185">""</string>
     <string name="brightness" msgid="2919605130898772866">" "</string>
     <string name="auto_brightness_title" msgid="9124647862844666581">" "</string>
-    <string name="auto_brightness_summary" msgid="2002570577219479702">"    "</string>
+    <string name="auto_brightness_summary" msgid="2002570577219479702">"     "</string>
     <string name="theme_toggle_title" msgid="7091393596274709558">""</string>
     <string name="condition_night_display_title" msgid="3777509730126972675">"   "</string>
     <string name="network_and_internet" msgid="4229023630498537530">"  "</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -262,7 +268,7 @@
     <string name="audio_route_selector_title" msgid="9137648859313120159">"   :"</string>
     <string name="audio_route_selector_toast" msgid="338103814096108292">" %1$s  "</string>
     <string name="display_brightness" msgid="5718970880488110840">""</string>
-    <string name="display_night_mode_summary" msgid="4939425286027546230">"    "</string>
+    <string name="display_night_mode_summary" msgid="4939425286027546230">"     "</string>
     <string name="units_settings" msgid="402325305096925886">""</string>
     <string name="units_speed_title" msgid="7115143916747108160">""</string>
     <string name="units_distance_title" msgid="6257691565990474635">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }one{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">" ,  "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">" "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"    .     .       ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -364,7 +380,7 @@
     <string name="assist_and_voice_input_settings" msgid="8813195157136637132">"   "</string>
     <string name="assist_app_settings" msgid="9085261410166776497">" "</string>
     <string name="assist_access_context_title" msgid="8034851731390785301">"  "</string>
-    <string name="assist_access_context_summary" msgid="2374281280599443774">"      "</string>
+    <string name="assist_access_context_summary" msgid="2374281280599443774">"      "</string>
     <string name="assist_access_screenshot_title" msgid="2855956879971465044">" "</string>
     <string name="assist_access_screenshot_summary" msgid="6246496926635145782">"     "</string>
     <string name="voice_input_settings_title" msgid="3238707827815647526">" "</string>
@@ -372,7 +388,7 @@
     <string name="app_list_preference_none" msgid="7753357799926715901">" "</string>
     <string name="default_app_selected_app" msgid="5289396663745484773">""</string>
     <string name="assistant_security_warning" msgid="1844807956967428012">"       ,         ."</string>
-    <string name="autofill_confirmation_message" msgid="1832984461556991378">"&lt;b&gt;      &lt;/b&gt; &lt;br/&gt; &lt;br/&gt;   -    &lt;xliff:g id=app_name example=Google Autofill&gt;%1$s&lt;/xliff:g&gt;    ."</string>
+    <string name="autofill_confirmation_message" msgid="1832984461556991378">"&lt;b&gt;      &lt;/b&gt; &lt;br/&gt; &lt;br/&gt;   -    &lt;xliff:g id=app_name example=Google Autofill&gt;%1$s&lt;/xliff:g&gt;    ."</string>
     <string name="autofill_add_service" msgid="6413893366443609951">" "</string>
     <string name="app_launch_domain_links_title" msgid="774480184927726651">" "</string>
     <string name="domain_url_section_title" msgid="9070403140947787214">"  "</string>
@@ -543,7 +559,7 @@
     <string name="date_time_set_timezone_title" msgid="3001779256157093425">" "</string>
     <string name="date_time_set_timezone" msgid="4759353576185916944">"  "</string>
     <string name="date_time_set_date_title" msgid="6834785820357051138">""</string>
-    <string name="date_time_set_date" msgid="2537494485643283230">" "</string>
+    <string name="date_time_set_date" msgid="2537494485643283230">"  "</string>
     <string name="zone_list_menu_sort_alphabetically" msgid="7041628618528523514">" "</string>
     <string name="zone_list_menu_sort_by_timezone" msgid="4944880536057914136">"   "</string>
     <string name="date_picker_title" msgid="1533614225273770178">""</string>
@@ -675,7 +691,7 @@
     <string name="permission_grant_in_use" msgid="2314262542396732455">"   "</string>
     <string name="permission_grant_ask" msgid="1613256400438907973">"  "</string>
     <string name="security_settings_title" msgid="6955331714774709746">""</string>
-    <string name="security_settings_subtitle" msgid="2244635550239273229">" "</string>
+    <string name="security_settings_subtitle" msgid="2244635550239273229">" "</string>
     <string name="security_lock_none" msgid="1054645093754839638">" "</string>
     <string name="security_lock_pattern" msgid="1174352995619563104">""</string>
     <string name="security_lock_pin" msgid="4891899974369503200">""</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"  ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">" ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -907,7 +926,7 @@
     <string name="captions_settings_text_size_large" msgid="5198207220911360512">""</string>
     <string name="captions_settings_text_size_very_large" msgid="949511539689307969">" "</string>
     <string name="captions_text_style_title" msgid="8547777957403577760">" "</string>
-    <string name="captions_settings_text_style_by_app" msgid="7014882290456996444">"  "</string>
+    <string name="captions_settings_text_style_by_app" msgid="7014882290456996444">"   "</string>
     <string name="captions_settings_text_style_white_on_black" msgid="5758084000323596070">"  "</string>
     <string name="captions_settings_text_style_black_on_white" msgid="3906140601916221220">"  "</string>
     <string name="captions_settings_text_style_yellow_on_black" msgid="4681565950104511943">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"    "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-ko/strings.xml b/res/values-ko/strings.xml
index cde2a88ca..8afbf7cfc 100644
--- a/res/values-ko/strings.xml
+++ b/res/values-ko/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"."</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"  "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{   #}other{   #}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ( )"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"     .      .          ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"      ."</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -420,7 +436,7 @@
     <string name="wifi_control_description" msgid="6021926850423169261">"Wi-Fi    Wi-Fi    , Wi-Fi    ,    ,     ."</string>
     <string name="more_special_access_title" msgid="166115485446645971">""</string>
     <string name="location_settings_title" msgid="901334356682423679">""</string>
-    <string name="location_toggle_title" msgid="836779750812064601">" "</string>
+    <string name="location_toggle_title" msgid="836779750812064601">"  "</string>
     <string name="location_toggle_summary" msgid="5651728747635881194">"     ."</string>
     <string name="location_infotainment_apps_toggle_title" msgid="2083924249183557387">" "</string>
     <string name="location_infotainment_apps_toggle_summary" msgid="6657657826985915806">"       "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    ."</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"    ."</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"  ."</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"    ."</string>
 </resources>
diff --git a/res/values-ky/strings.xml b/res/values-ky/strings.xml
index dac6711ea..b18700e38 100644
--- a/res/values-ky/strings.xml
+++ b/res/values-ky/strings.xml
@@ -180,11 +180,17 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth\' "</string>
     <string name="bluetooth_device" msgid="3178478829314083240">"  "</string>
-    <string name="bluetooth_paired_devices" msgid="6463199569164652410">" "</string>
+    <string name="bluetooth_paired_devices" msgid="6463199569164652410">" "</string>
     <string name="bluetooth_pair_new_device" msgid="6948753485443263095">"  "</string>
     <string name="bluetooth_pair_new_device_summary" msgid="2497221247690369031">"Bluetooth "</string>
     <string name="bluetooth_disconnect_title" msgid="7675271355910637528">" ?"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">" ,  "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"      .     .          ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s  "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -379,7 +395,7 @@
     <string name="domain_urls_summary_none" msgid="3077803215088293183">"   "</string>
     <string name="domain_urls_summary_one" msgid="5072257421806034237">"<xliff:g id="DOMAIN">%s</xliff:g>  "</string>
     <string name="domain_urls_summary_some" msgid="5523153458016701725">"<xliff:g id="DOMAIN">%s</xliff:g>   URL\' "</string>
-    <string name="app_launch_title" msgid="3442601467010363057">"   "</string>
+    <string name="app_launch_title" msgid="3442601467010363057">"  "</string>
     <string name="app_launch_other_defaults_title" msgid="5734827759507953180">" "</string>
     <string name="auto_launch_disable_text" msgid="3595315315092716391">"   ."</string>
     <string name="auto_launch_enable_text" msgid="7230832269574106901">"       "</string>
@@ -569,7 +585,7 @@
     <string name="user_new_user_name" msgid="906698527658609819">" "</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"  ?"</string>
     <string name="user_add_user_message_setup" msgid="812616230454605159">"   ,      ."</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">"       ."</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">"       ."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"   "</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{    .}other{#     .}}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">"   "</string>
@@ -589,7 +605,7 @@
     <string name="current_user_name" msgid="3813671533249316823">" (%1$s)"</string>
     <string name="user_name_label" msgid="3210832645046206845">" "</string>
     <string name="user_summary_not_set_up" msgid="1473688119241224145">" "</string>
-    <string name="edit_user_name_title" msgid="1118500707473139995">"  "</string>
+    <string name="edit_user_name_title" msgid="1118500707473139995">"  "</string>
     <string name="name_input_blank_error" msgid="2088850865880984123">"   ."</string>
     <string name="name_input_invalid_error" msgid="4355625213535164704">"    ."</string>
     <string name="users_list_title" msgid="770764290290240909">""</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"     .     ."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">" "</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   Bluetooth\' "</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   Bluetooth\'  "</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   Bluetooth\'  "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"   "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"  "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"   "</string>
 </resources>
diff --git a/res/values-lo/strings.xml b/res/values-lo/strings.xml
index 4dff745c3..d8525b9b7 100644
--- a/res/values-lo/strings.xml
+++ b/res/values-lo/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">"..."</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">""</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">""</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# }other{# }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"  "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">""</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">". . ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">""</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">",  Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">",  Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">""</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">" RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">""</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">""</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">""</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">""</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">""</string>
 </resources>
diff --git a/res/values-lt/strings.xml b/res/values-lt/strings.xml
index e48017028..71dfa8181 100644
--- a/res/values-lt/strings.xml
+++ b/res/values-lt/strings.xml
@@ -180,6 +180,9 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Skmingai prisijungta"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Rodyti visk"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Iekoma"</string>
+    <string name="wifi_detail_share" msgid="3765487472190563802">"Bendrinimas"</string>
+    <string name="wifi_detail_share_description" msgid="1417559695973326762">"Nuskaitykite  QR kod, kad prisijungtumte prie WiFi"</string>
+    <string name="wifi_detail_share_toast" msgid="9106513465439393280">"iame WiFi tinkle WiFi bendrinimas nepasiekiamas."</string>
     <string name="connected_settings_title" msgid="8868738903280658151">"Prijungti renginiai"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Naudoti Bluetooth"</string>
@@ -343,6 +346,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nenaudojamos programos"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# nenaudojama programa}one{# nenaudojama programa}few{# nenaudojamos programos}many{# nenaudojamos programos}other{# nenaudojam program}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Paalinti leidimus ir atlaisvinti vietos"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Kratini santykis (eksperimentinis)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Atidaryti"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Numatytasis programos nustatymas"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Visas ekranas"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Pus ekrano"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"renginio kratini santykis"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Programa bus paleista i naujo, kai pakeisite kratini santyk. Neisaugoti pakeitimai gali bti prarasti. Kai kurios programos gali bti neoptimizuotos pagal tam tikrus kratini santykius."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s vidinje atmintyje"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Naudojami sistemos itekliai, kad bt galima suteikti prioritet programos naumui"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Duomen naudojimas"</string>
@@ -797,7 +810,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Nordami matyti savo renginius, junkite Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Nordami susieti rengin, atidarykite Bluetooth nustatymus"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Nustatyti vairavimo reim"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Rodyti idstymo ribas"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Priverst. prit. id. i deins  kair"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Tinkinimo perdanga"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Informacins pramogins sistemos administratorius"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Suaktyvintos programos"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Iaktyvintos programos"</string>
@@ -945,4 +961,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Js interneto planas nebegalioja"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Perirti planus"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Atlikta"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Js transporto priemon nepalaiko ios funkcijos"</string>
 </resources>
diff --git a/res/values-lv/strings.xml b/res/values-lv/strings.xml
index 117224b8b..e3cb602b8 100644
--- a/res/values-lv/strings.xml
+++ b/res/values-lv/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Savienojums izveidots"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Rdt visu"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Notiek meklana"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Pievienots ierces"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Izmantot Bluetooth"</string>
@@ -238,7 +244,7 @@
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">"Ieteikts"</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">"Visas valodas"</string>
     <string name="keyboard_settings" msgid="1959697870618278081">"Tastatra"</string>
-    <string name="manage_keyboard" msgid="4045394766282200132">"Tastatru prvaldba"</string>
+    <string name="manage_keyboard" msgid="4045394766282200132">"Prvaldt tastatras"</string>
     <string name="text_to_speech_settings" msgid="811985746199507343">"Teksta prvranas run izvade"</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">"Vlam programma"</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">"Pareizj programma"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Neizmantots lietotnes"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#neizmantota lietotne}zero{#neizmantotu lietotu}one{#neizmantota lietotne}other{#neizmantotas lietotnes}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Noemt ataujas un atbrvot vietu"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Malu attiecba (eksperimentla funkcija)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Atvrt"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Lietotnes noklusjums"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Pilnekrna rems"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Puse ekrna"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Ierces malu attiecba"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Mainot malu attiecbu, lietotne tiks restartta. Iespjams, zaudsiet nesaglabtas izmaias. Daas lietotnes var nebt optimiztas noteiktm malu attiecbm."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s: iekj atmia"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Tiek izmantoti sistmas resursi, lai pieirtu lietotnes veiktspjas prioritti."</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Datu lietojums"</string>
@@ -482,7 +498,7 @@
     <string name="legal_information" msgid="1838443759229784762">"Juridisk informcija"</string>
     <string name="contributors_title" msgid="7698463793409916113">"Ldzdalbnieki"</string>
     <string name="manual" msgid="4819839169843240804">"Manuli"</string>
-    <string name="regulatory_labels" msgid="3165587388499646779">"Reguljos uzlmes"</string>
+    <string name="regulatory_labels" msgid="3165587388499646779">"Reguljos atzmes"</string>
     <string name="safety_and_regulatory_info" msgid="1204127697132067734">"Drobas un reguljo informcija"</string>
     <string name="copyright_title" msgid="4220237202917417876">"Autortiesbas"</string>
     <string name="license_title" msgid="936705938435249965">"Licence"</string>
@@ -568,8 +584,8 @@
     <string name="user_add_user_menu" msgid="4125869008006021799">"Pievienot profilu"</string>
     <string name="user_new_user_name" msgid="906698527658609819">"Jauns profils"</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"Vai pievienot jaunu profilu?"</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"Kad js esat izveidojis jaunu profilu, profila paniekam tas patstvgi jpielgo."</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">"No jebkura profila var atjaunint lietotnes, lai izmantotu ts visos prjos profilos."</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"Pc jauna profila izveides attiecgais lietotjs vars to pielgot."</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">"Jebkur profil var atjaunint lietotnes, kas tiek izmantotas ar visos prjos profilos."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"Sasniegts profilu ierobeojums"</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{Var izveidot tikai vienu profilu.}zero{Var izveidot ne vairk k #profilus.}one{Var izveidot ne vairk k #profilu.}other{Var izveidot ne vairk k #profilus.}}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">"Nevarja izveidot jaunu profilu"</string>
@@ -779,7 +795,7 @@
     <string name="restricted_for_driver" msgid="3364388937671526800">"Js nevarat veikt o darbbu."</string>
     <string name="add_user_restricted_while_driving" msgid="1037301074725362944">"Nevar pievienot profilu braukanas laik."</string>
     <string name="default_search_query" msgid="3137420627428857068">"Meklt"</string>
-    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"Asistents un balss vadba"</string>
+    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"Asistents un balss"</string>
     <string name="assistant_and_voice_assistant_app_title" msgid="5981647244625171285">"Digitl asistenta lietotne"</string>
     <string name="assistant_and_voice_use_text_from_screen_title" msgid="5851460943413795599">"Izmantot ekrn redzamo tekstu"</string>
     <string name="assistant_and_voice_use_text_from_screen_summary" msgid="4161751708121301541">"Ataujiet Asistentam piekt ekrna saturam"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Lai skattu savas ierces, iesldziet Bluetooth."</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Lai savienotu pr kdu ierci, atveriet Bluetooth iestatjumus."</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Motvs"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Ieslgt braukanas remu"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Rdt izkrtojuma robeas"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Virziens no labs uz kreiso (obligts)"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Pielgoanas prkljums"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Informatvi izklaidjos sistmas administrators"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivizts lietotnes"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivizts lietotnes"</string>
@@ -939,4 +958,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Beidzies jsu interneta plnu derguma termi"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Skatt plnus"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Gatavs"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Jsu transportldzekl  funkcija netiek atbalstta"</string>
 </resources>
diff --git a/res/values-mk/strings.xml b/res/values-mk/strings.xml
index 15ecad0b6..98ea6165d 100644
--- a/res/values-mk/strings.xml
+++ b/res/values-mk/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"  "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth"</string>
@@ -194,7 +200,7 @@
     <string name="bluetooth_name" msgid="2609869978821094114">"  "</string>
     <string name="bluetooth_rename_vehicle" msgid="5769424875066563154">"  "</string>
     <string name="bluetooth_rename_device" msgid="8406868875363878712">"  "</string>
-    <string name="bluetooth_rename_button" msgid="2397892174725986383">""</string>
+    <string name="bluetooth_rename_button" msgid="2397892174725986383">""</string>
     <string name="bluetooth_available_devices" msgid="1854446368146061448">" "</string>
     <string name="bluetooth_profiles" msgid="5580372290862835951">""</string>
     <string name="bluetooth_error_title" msgid="2341600997536511742"></string>
@@ -221,7 +227,7 @@
     <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"    Bluetooth"</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"PIN-    "</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"    ,      "</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"     <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"    <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">" <xliff:g id="DEVICE_NAME">%1$s</xliff:g>        ."</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"       PIN    ."</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"          ."</string>
@@ -238,7 +244,7 @@
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">""</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">" "</string>
     <string name="keyboard_settings" msgid="1959697870618278081">""</string>
-    <string name="manage_keyboard" msgid="4045394766282200132">"  "</string>
+    <string name="manage_keyboard" msgid="4045394766282200132">"  "</string>
     <string name="text_to_speech_settings" msgid="811985746199507343">"   "</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">" "</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }one{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"        .      .          ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"             "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -568,8 +584,8 @@
     <string name="user_add_user_menu" msgid="4125869008006021799">" "</string>
     <string name="user_new_user_name" msgid="906698527658609819">" "</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"    ?"</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"       ,         ."</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">"        ,        ."</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"      ,         ."</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">"                ."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"    "</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{      .}one{    # .}other{    # .}}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">"      "</string>
@@ -617,9 +633,9 @@
     <string name="accounts_settings_title" msgid="436190037084293471">""</string>
     <string name="user_add_account_menu" msgid="6625351983590713721">" "</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"  "</string>
-    <string name="account_list_title" msgid="7631588514613843065">"  <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
+    <string name="account_list_title" msgid="7631588514613843065">" : <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"   "</string>
-    <string name="account_auto_sync_summary" msgid="6963837893148304128">"      "</string>
+    <string name="account_auto_sync_summary" msgid="6963837893148304128">"        "</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"     ?"</string>
     <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"                 .\n\n  ,             ."</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="6683011954002351091">"     ?"</string>
@@ -789,7 +805,7 @@
     <string name="notifications_all_apps" msgid="3557079551048958846">" "</string>
     <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"  "</string>
     <string name="manage_other_profiles_button_text" msgid="2262188413455510828">"   "</string>
-    <string name="add_a_profile_button_text" msgid="8027395095117925114">" "</string>
+    <string name="add_a_profile_button_text" msgid="8027395095117925114">" "</string>
     <string name="delete_this_profile_text" msgid="6035404714526922665">"  "</string>
     <string name="add_profile_text" msgid="9118410102199116969">" "</string>
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">" ,     .           ."</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    ,  Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   ,     Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"   "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"     "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"  "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"      "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">" -  "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"  "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-ml/strings.xml b/res/values-ml/strings.xml
index 60def21cb..c0030c8e7 100644
--- a/res/values-ml/strings.xml
+++ b/res/values-ml/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"      .   .       ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"      "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   Bluetooth "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   Bluetooth  "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"   "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"    "</string>
 </resources>
diff --git a/res/values-mn/strings.xml b/res/values-mn/strings.xml
index e8584b3f4..3c7d21ae3 100644
--- a/res/values-mn/strings.xml
+++ b/res/values-mn/strings.xml
@@ -25,7 +25,7 @@
     <string name="auto_brightness_summary" msgid="2002570577219479702">"   "</string>
     <string name="theme_toggle_title" msgid="7091393596274709558">""</string>
     <string name="condition_night_display_title" msgid="3777509730126972675">"   "</string>
-    <string name="network_and_internet" msgid="4229023630498537530">" &amp; "</string>
+    <string name="network_and_internet" msgid="4229023630498537530">", "</string>
     <string name="mobile_network_settings" msgid="1708621113321368597">"  "</string>
     <string name="mobile_network_summary_count" msgid="760865625847664029">"{count,plural, =1{# SIM}other{# SIM}}"</string>
     <string name="mobile_network_active_sim" msgid="1901674954229832811">" / SIM"</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" ..."</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth "</string>
@@ -234,7 +240,7 @@
     <string name="bluetooth_bonded_phone_toggle_content_description" msgid="8152794643249938377">""</string>
     <string name="bluetooth_bonded_media_toggle_content_description" msgid="7803420585378155404">""</string>
     <string name="language_settings" msgid="2079258598337245546">""</string>
-    <string name="languages_and_input_settings" msgid="3672322610529408248">" &amp; "</string>
+    <string name="languages_and_input_settings" msgid="3672322610529408248">", "</string>
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">" "</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">" "</string>
     <string name="keyboard_settings" msgid="1959697870618278081">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">" ,   "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">" "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"      .     .       ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s-  "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"      "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -532,7 +548,7 @@
     <string name="factory_reset_confirm_button_text" msgid="1797490544756481809">" "</string>
     <string name="factory_reset_progress_title" msgid="4580937077054738173">" "</string>
     <string name="factory_reset_progress_text" msgid="7704636573522634757">"  ..."</string>
-    <string name="date_and_time_settings_title" msgid="4058492663544475485">" &amp; "</string>
+    <string name="date_and_time_settings_title" msgid="4058492663544475485">", "</string>
     <string name="date_and_time_settings_summary" msgid="7669856855390804666">", ,   &amp;  "</string>
     <string name="date_time_auto" msgid="6018635902717385962">"  "</string>
     <string name="zone_auto" msgid="4174874778459184605">"   "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   Bluetooth-  "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   Bluetooth   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">" "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"    "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-mr/strings.xml b/res/values-mr/strings.xml
index 7f57060eb..2dd9632a7 100644
--- a/res/values-mr/strings.xml
+++ b/res/values-mr/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"  "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#   }other{#   }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"      "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"."</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">":"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"   ,    .       .          ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s  "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"      "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"  ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"  ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"  "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-ms/strings.xml b/res/values-ms/strings.xml
index 146594fa7..f0e49cc4b 100644
--- a/res/values-ms/strings.xml
+++ b/res/values-ms/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Sambungan berjaya"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Tunjukkan semua"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Mencari"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Peranti tersambung"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Gunakan Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Apl yang tidak digunakan"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# apl yang tidak digunakan}other{# apl yang tidak digunakan}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Alih keluar kebenaran dan kosongkan ruang"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Nisbah bidang (Percubaan)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Buka"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Lalai apl"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Skrin penuh"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Skrin separuh"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Nisbah bidang peranti"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Apl akan dimulakan semula apabila anda mengubah nisbah bidang. Anda mungkin kehilangan perubahan yang belum disimpan. Sesetengah apl mungkin tidak dioptimumkan untuk nisbah bidang tertentu."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s dalam storan dalaman"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Gunakan sumber sistem untuk mengutamakan prestasi apl"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Penggunaan data"</string>
@@ -568,7 +584,7 @@
     <string name="user_add_user_menu" msgid="4125869008006021799">"Tambah profil"</string>
     <string name="user_new_user_name" msgid="906698527658609819">"Profil baharu"</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"Tambah profil baharu?"</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"Selepas anda mencipta profil baharu, orang itu perlu menyesuaikan profil untuk diri sendiri."</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"Selepas anda membuat profil baharu, orang itu perlu menyesuaikan profilnya sendiri."</string>
     <string name="user_add_user_message_update" msgid="3836353291078729240">"Apl boleh dikemas kini daripada mana-mana profil untuk kegunaan semua profil lain."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"Had profil dicapai"</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{Hanya satu profil boleh dibuat.}other{Anda boleh membuat sehingga # profil.}}"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Untuk melihat peranti anda, hidupkan Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Untuk menggandingkan peranti, buka tetapan Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Tetapkan mod memandu"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Tunjukkan batas reka letak"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Paksa arah reka letak RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Tindanan penyesuaian"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Pentadbir sistem maklumat hibur"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Apl yang diaktifkan"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Apl yang dinyahaktifkan"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Pelan Internet anda telah tamat tempoh"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Lihat pelan"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Selesai"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Kenderaan anda tidak menyokong ciri ini"</string>
 </resources>
diff --git a/res/values-my/strings.xml b/res/values-my/strings.xml
index 92a276420..9bc61fb69 100644
--- a/res/values-my/strings.xml
+++ b/res/values-my/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">""</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">" "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">" x "</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">" x "</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">" x "</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"        "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">" %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"   "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -796,9 +812,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"       "</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">" "</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"  "</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   "</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">" "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">" "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL  "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -934,4 +953,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">" "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"  "</string>
 </resources>
diff --git a/res/values-nb/strings.xml b/res/values-nb/strings.xml
index 4b9561ad2..50d9f60c2 100644
--- a/res/values-nb/strings.xml
+++ b/res/values-nb/strings.xml
@@ -132,7 +132,7 @@
     <string name="wifi_dns" msgid="1841448353154932801">"DNS"</string>
     <string name="wifi_details_ipv6_address_header" msgid="4707181386646531890">"IPv6-adresser"</string>
     <string name="wifi_gateway" msgid="4975799192860431013">"Gateway"</string>
-    <string name="wifi_preferences_title" msgid="772788844257225510">"WiFi-innstillinger"</string>
+    <string name="wifi_preferences_title" msgid="772788844257225510">"Wifiinnstillinger"</string>
     <string name="wifi_wakeup" msgid="7451825226044542000">"Sl p wifi automatisk"</string>
     <string name="wifi_wakeup_summary" msgid="7237521683331291414">"Wifi sls p igjen i nrheten av lagrede nettverk av hy kvalitet, for eksempel hjemmenettverket ditt"</string>
     <string name="wifi_wakeup_summary_no_location" msgid="2821576525488435259">"Utilgjengelig fordi Posisjon er sltt av. Sl p "<annotation id="link">"Posisjon"</annotation>"."</string>
@@ -141,7 +141,7 @@
     <string name="wifi_settings_scanning_required_enabled" msgid="5457372118991438313">"Wifi-skanning er sltt p"</string>
     <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"Bytt til mobildata automatisk"</string>
     <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"Bruk mobildata nr Wifi ikke har internettilgang. Avgifter for databruk kan plpe."</string>
-    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Finn og koble til Wifi-nettverk"</string>
+    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Finn og koble til wifinettverk"</string>
     <string name="learn_more" msgid="8214605928933358604">"Finn ut mer"</string>
     <string name="wifi_hotspot_name_title" msgid="8844779338692535356">"Navn p wifi-sone"</string>
     <string name="wifi_hotspot_name_summary_connecting" msgid="5262510450498600038">"Slr p <xliff:g id="WIFI_HOTSPOT_NAME">%1$s</xliff:g> "</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Tilkoblingen var vellykket"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Vis alle"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Sker"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Tilkoblede enheter"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bruk Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Ubrukte apper"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# ubrukt app}other{# ubrukte apper}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Fjern tillatelser og frigjr plass"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Hyde/bredde-forhold (p forsksstadiet)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"pne"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Appstandard"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Fullskjerm"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Halv skjerm"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Hyde/bredde-forhold for enheten"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Appen starter p nytt nr du endrer hyde/bredde-forholdet. Du kan miste endringer som ikke er lagret. Enkelte apper er kanskje ikke optimalisert for visse hyde/bredde-forhold."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s i internminne"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Bruker systemressurser til  prioritere appytelse"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Databruk"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Sl p Bluetooth for  se enhetene dine"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"pne Bluetooth-innstillingene for  koble til enheter"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Sl p kjremodus"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Vis layoutgrenser"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Vis all tekst fra hyre til venstre"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Tilpasningsoverlegg"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainmentsystem-admin"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktiverte apper"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktiverte apper"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Internettabonnementene dine er utlpt"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Se abonnementer"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Ferdig"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Kjretyet ditt sttter ikke denne funksjonen"</string>
 </resources>
diff --git a/res/values-ne/strings.xml b/res/values-ne/strings.xml
index e82647320..31e5f4977 100644
--- a/res/values-ne/strings.xml
+++ b/res/values-ne/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -208,7 +214,7 @@
     <string name="bluetooth_ask_discovery_no_name" msgid="164397600370102369">"     <xliff:g id="TIMEOUT">%1$d</xliff:g>       "</string>
     <string name="bluetooth_ask_enablement_and_discovery" msgid="5487502083015708674">"<xliff:g id="APP_NAME">%1$s</xliff:g>     <xliff:g id="TIMEOUT">%2$d</xliff:g>         "</string>
     <string name="bluetooth_ask_enablement_and_discovery_no_name" msgid="907153034209916282">"      <xliff:g id="TIMEOUT">%1$d</xliff:g>         "</string>
-    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"  %1$s   "</string>
+    <string name="bluetooth_state_switch_summary" msgid="171929910916432266">"  %1$s   "</string>
     <string name="bluetooth_my_devices" msgid="6352010339607939612">" "</string>
     <string name="bluetooth_previously_connected" msgid="5206229557831180323">"   "</string>
     <string name="bluetooth_device_connected_toast" msgid="4614765282582494488">"%1$s   "</string>
@@ -216,12 +222,12 @@
     <string name="device_connections_category_title" msgid="1753729363581927505">"    "</string>
     <string name="uwb_toggle_title" msgid="8831695790040626922">"- (UWB)"</string>
     <string name="uwb_toggle_summary" msgid="2206513296288659105">"  UWB      "</string>
-    <string name="bluetooth_notif_ticker" msgid="7192577740198156792">"   "</string>
+    <string name="bluetooth_notif_ticker" msgid="7192577740198156792">"   "</string>
     <string name="bluetooth_device_context_pair_connect" msgid="3138105800372470422">"    "</string>
-    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"   "</string>
+    <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"   "</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"PIN      "</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"             "</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>    ?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>    ?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"<xliff:g id="DEVICE_NAME">%1$s</xliff:g>          "</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"     PIN     "</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"          "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"  "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{  # }other{  #  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"      "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  (  )"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"   "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">":"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">":"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">":"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"                       "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -457,7 +473,7 @@
     <string name="microphone_settings_recent_requests_view_all_title" msgid="4339820818072842872">" "</string>
     <string name="microphone_settings_loading_app_permission_stats" msgid="4357161201098081615">"  "</string>
     <string name="system_setting_title" msgid="6864599341809463440">""</string>
-    <string name="system_update_settings_title" msgid="8448588267784138855">" "</string>
+    <string name="system_update_settings_title" msgid="8448588267784138855">" "</string>
     <string name="system_advanced_title" msgid="6303355131691523362">""</string>
     <string name="system_advanced_summary" msgid="5833643795981791953">" ,  ,     "</string>
     <string name="restart_infotainment_system_title" msgid="5174129167446756511">"   "</string>
@@ -567,8 +583,8 @@
     <string name="uninstall_apps_permission_title" msgid="8448422340567430659">"   "</string>
     <string name="user_add_user_menu" msgid="4125869008006021799">" "</string>
     <string name="user_new_user_name" msgid="906698527658609819">" "</string>
-    <string name="user_add_user_title" msgid="6296827596015729982">"   ?"</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"            "</string>
+    <string name="user_add_user_title" msgid="6296827596015729982">"   ?"</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"          "</string>
     <string name="user_add_user_message_update" msgid="3836353291078729240">"            "</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"    "</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{      }other{  #     }}"</string>
@@ -616,10 +632,10 @@
     <string name="storage_unmount_failure" msgid="4591934911541762883">"<xliff:g id="NAME">%1$s</xliff:g>    "</string>
     <string name="accounts_settings_title" msgid="436190037084293471">""</string>
     <string name="user_add_account_menu" msgid="6625351983590713721">" "</string>
-    <string name="no_accounts_added" msgid="5148163140691096055">"   "</string>
+    <string name="no_accounts_added" msgid="5148163140691096055">"    "</string>
     <string name="account_list_title" msgid="7631588514613843065">"<xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>  "</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"   "</string>
-    <string name="account_auto_sync_summary" msgid="6963837893148304128">"      "</string>
+    <string name="account_auto_sync_summary" msgid="6963837893148304128">"     "</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"     ?"</string>
     <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"               \n\n            "</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="6683011954002351091">"     ?"</string>
@@ -636,7 +652,7 @@
     <string name="account_sync_summary_some_on" msgid="4525960296068027182">"<xliff:g id="ID_2">%2$d</xliff:g>  <xliff:g id="ID_1">%1$d</xliff:g>     "</string>
     <string name="account_sync_summary_all_on" msgid="3652264471870312725">"     "</string>
     <string name="account_sync_summary_all_off" msgid="6550959714035312414">"     "</string>
-    <string name="sync_disabled" msgid="393531064334628258">"  "</string>
+    <string name="sync_disabled" msgid="393531064334628258">"  "</string>
     <string name="sync_error" msgid="6698021343089247914">" "</string>
     <string name="last_synced" msgid="4745124489150101529">"    : <xliff:g id="LAST_SYNC_TIME">%1$s</xliff:g>"</string>
     <string name="sync_in_progress" msgid="1237573373537382416">"  ..."</string>
@@ -743,12 +759,12 @@
     <string name="lockpassword_password_requires_letters" msgid="324864645474528299">"{count,plural, =1{    #    }other{    #     }}"</string>
     <string name="lockpassword_password_requires_lowercase" msgid="5373735547134824114">"{count,plural, =1{    #     }other{    #      }}"</string>
     <string name="lockpassword_password_requires_uppercase" msgid="2002482631049525313">"{count,plural, =1{    #     }other{    #      }}"</string>
-    <string name="lockpassword_password_requires_numeric" msgid="5694949801691947801">"{count,plural, =1{    #    }other{    #     }}"</string>
+    <string name="lockpassword_password_requires_numeric" msgid="5694949801691947801">"{count,plural, =1{  #    }other{  #     }}"</string>
     <string name="lockpassword_password_requires_symbols" msgid="1789501049908004075">"{count,plural, =1{    #     }other{    #      }}"</string>
     <string name="lockpassword_password_requires_nonletter" msgid="3089186186422638926">"{count,plural, =1{     #    }other{     #     }}"</string>
     <string name="lockpassword_password_requires_nonnumerical" msgid="1677123573552379526">"{count,plural, =1{     #    }other{     #     }}"</string>
     <string name="lockpassword_password_too_short" msgid="3898753131694105832">"{count,plural, =1{    #      }other{    #      }}"</string>
-    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{    #    }other{    #     }}"</string>
+    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{  #    }other{  #     }}"</string>
     <string name="lockpassword_password_too_long" msgid="1709616257350671045">"{count,plural, =1{  #     }other{  #     }}"</string>
     <string name="lockpassword_pin_too_long" msgid="8315542764465856288">"{count,plural, =1{  #     }other{  #     }}"</string>
     <string name="lockpassword_pin_no_sequential_digits" msgid="6511579896796310956">",       "</string>
@@ -780,7 +796,7 @@
     <string name="add_user_restricted_while_driving" msgid="1037301074725362944">"     "</string>
     <string name="default_search_query" msgid="3137420627428857068">""</string>
     <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"  Voice"</string>
-    <string name="assistant_and_voice_assistant_app_title" msgid="5981647244625171285">"  "</string>
+    <string name="assistant_and_voice_assistant_app_title" msgid="5981647244625171285">"  "</string>
     <string name="assistant_and_voice_use_text_from_screen_title" msgid="5851460943413795599">"    "</string>
     <string name="assistant_and_voice_use_text_from_screen_summary" msgid="4161751708121301541">"         "</string>
     <string name="assistant_and_voice_use_screenshot_title" msgid="1930735578425470046">"   "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"     "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"     "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-nl/strings.xml b/res/values-nl/strings.xml
index f2e3a8a9b..b084bb64c 100644
--- a/res/values-nl/strings.xml
+++ b/res/values-nl/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Verbinding gemaakt"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Alles tonen"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Zoeken"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Verbonden apparaten"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth gebruiken"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Niet-gebruikte apps"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# niet-gebruikte app}other{# niet-gebruikte apps}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Rechten intrekken en ruimte vrijmaken"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Beeldverhouding (experimenteel)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Openen"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"App-standaard"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Volledig scherm"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Half scherm"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Beeldverhouding van apparaat"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"De app wordt opnieuw opgestart als je de beeldverhouding wijzigt. Je kunt niet-opgeslagen wijzigingen verliezen. Sommige apps zijn misschien niet geoptimaliseerd voor bepaalde beeldverhoudingen."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s in interne opslag"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Gebruikt systeembronnen om de app-prestaties te prioriteren"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Datagebruik"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Zet bluetooth aan als je je apparaten wilt zien"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Open de bluetooth-instellingen om een apparaat te koppelen"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Thema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Rijstand instellen"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Indelingsgrenzen tonen"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"V.r.n.l.-indelingsrichting afdwingen"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Overlay voor aanpassing"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Beheer van infotainmentsysteem"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Geactiveerde apps"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Gedeactiveerde apps"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Je internetabonnementen zijn verlopen"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Abonnementen bekijken"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Klaar"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Je voertuig ondersteunt deze functie niet"</string>
 </resources>
diff --git a/res/values-or/strings.xml b/res/values-or/strings.xml
index 77d521772..a0e9bf52b 100644
--- a/res/values-or/strings.xml
+++ b/res/values-or/strings.xml
@@ -25,7 +25,7 @@
     <string name="auto_brightness_summary" msgid="2002570577219479702">"     "</string>
     <string name="theme_toggle_title" msgid="7091393596274709558">""</string>
     <string name="condition_night_display_title" msgid="3777509730126972675">"   "</string>
-    <string name="network_and_internet" msgid="4229023630498537530">"  "</string>
+    <string name="network_and_internet" msgid="4229023630498537530">"  "</string>
     <string name="mobile_network_settings" msgid="1708621113321368597">" "</string>
     <string name="mobile_network_summary_count" msgid="760865625847664029">"{count,plural, =1{# SIM}other{# SIM}}"</string>
     <string name="mobile_network_active_sim" msgid="1901674954229832811">" / SIM"</string>
@@ -132,7 +132,7 @@
     <string name="wifi_dns" msgid="1841448353154932801">"DNS"</string>
     <string name="wifi_details_ipv6_address_header" msgid="4707181386646531890">"IPv6 "</string>
     <string name="wifi_gateway" msgid="4975799192860431013">""</string>
-    <string name="wifi_preferences_title" msgid="772788844257225510">"- "</string>
+    <string name="wifi_preferences_title" msgid="772788844257225510">"- "</string>
     <string name="wifi_wakeup" msgid="7451825226044542000">"-   "</string>
     <string name="wifi_wakeup_summary" msgid="7237521683331291414">"-          "</string>
     <string name="wifi_wakeup_summary_no_location" msgid="2821576525488435259">"      "<annotation id="link">""</annotation>"  "</string>
@@ -141,7 +141,7 @@
     <string name="wifi_settings_scanning_required_enabled" msgid="5457372118991438313">"-   "</string>
     <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"     "</string>
     <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"WiFi             "</string>
-    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"-     "</string>
+    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"-     "</string>
     <string name="learn_more" msgid="8214605928933358604">" "</string>
     <string name="wifi_hotspot_name_title" msgid="8844779338692535356">" "</string>
     <string name="wifi_hotspot_name_summary_connecting" msgid="5262510450498600038">"<xliff:g id="WIFI_HOTSPOT_NAME">%1$s</xliff:g>  ..."</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"   "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"..."</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -239,7 +245,7 @@
     <string name="language_picker_list_all_header" msgid="1577387973934368428">" "</string>
     <string name="keyboard_settings" msgid="1959697870618278081">""</string>
     <string name="manage_keyboard" msgid="4045394766282200132">"  "</string>
-    <string name="text_to_speech_settings" msgid="811985746199507343">"-- "</string>
+    <string name="text_to_speech_settings" msgid="811985746199507343">"-- "</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">"  "</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">" "</string>
     <string name="tts_speech_rate" msgid="4512944877291943133">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"    ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"    "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"                         "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"        "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -368,7 +384,7 @@
     <string name="assist_access_screenshot_title" msgid="2855956879971465044">"  "</string>
     <string name="assist_access_screenshot_summary" msgid="6246496926635145782">"       "</string>
     <string name="voice_input_settings_title" msgid="3238707827815647526">" "</string>
-    <string name="autofill_settings_title" msgid="1188754272680049972">" "</string>
+    <string name="autofill_settings_title" msgid="1188754272680049972">" "</string>
     <string name="app_list_preference_none" msgid="7753357799926715901">" "</string>
     <string name="default_app_selected_app" msgid="5289396663745484773">""</string>
     <string name="assistant_security_warning" msgid="1844807956967428012">" ,                 "</string>
@@ -596,7 +612,7 @@
     <string name="profiles_list_title" msgid="1443396686780460221">""</string>
     <string name="user_details_admin_title" msgid="3530292857178371891">"%1$s    "</string>
     <string name="storage_settings_title" msgid="8957054192781341797">""</string>
-    <string name="storage_music_audio" msgid="7827147379976134040">"  "</string>
+    <string name="storage_music_audio" msgid="7827147379976134040">"  "</string>
     <string name="storage_other_apps" msgid="945509804756782640">" "</string>
     <string name="storage_files" msgid="6382081694781340364">"Files"</string>
     <string name="storage_system" msgid="1271345630248014010">""</string>
@@ -615,11 +631,11 @@
     <string name="storage_unmount_success" msgid="1553591517580407021">"<xliff:g id="NAME">%1$s</xliff:g>    "</string>
     <string name="storage_unmount_failure" msgid="4591934911541762883">"<xliff:g id="NAME">%1$s</xliff:g>     "</string>
     <string name="accounts_settings_title" msgid="436190037084293471">""</string>
-    <string name="user_add_account_menu" msgid="6625351983590713721">" "</string>
+    <string name="user_add_account_menu" msgid="6625351983590713721">"  "</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"   "</string>
     <string name="account_list_title" msgid="7631588514613843065">"<xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>  "</string>
-    <string name="account_auto_sync_title" msgid="3238816995364191432">"    "</string>
-    <string name="account_auto_sync_summary" msgid="6963837893148304128">"      "</string>
+    <string name="account_auto_sync_title" msgid="3238816995364191432">"   "</string>
+    <string name="account_auto_sync_summary" msgid="6963837893148304128">"     "</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"      ?"</string>
     <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"              \n\n             "</string>
     <string name="data_usage_auto_sync_off_dialog_title" msgid="6683011954002351091">"      ?"</string>
@@ -638,7 +654,7 @@
     <string name="account_sync_summary_all_off" msgid="6550959714035312414">"     "</string>
     <string name="sync_disabled" msgid="393531064334628258">"  "</string>
     <string name="sync_error" msgid="6698021343089247914">" "</string>
-    <string name="last_synced" msgid="4745124489150101529">" <xliff:g id="LAST_SYNC_TIME">%1$s</xliff:g>    "</string>
+    <string name="last_synced" msgid="4745124489150101529">"<xliff:g id="LAST_SYNC_TIME">%1$s</xliff:g>    "</string>
     <string name="sync_in_progress" msgid="1237573373537382416">"  "</string>
     <string name="sync_one_time_sync" msgid="491707183321353107">" <xliff:g id="LAST_SYNC_TIME">
 %1$s</xliff:g>      "</string>
@@ -706,7 +722,7 @@
     <string name="error_saving_lockpattern" msgid="2933512812768570130">"   "</string>
     <string name="lockpattern_too_many_failed_confirmation_attempts" msgid="4636307830951251013">"   <xliff:g id="NUMBER">%d</xliff:g>    "</string>
     <string name="lockpattern_does_not_support_rotary" msgid="7356367113555659428">"    ,   "</string>
-    <string name="okay" msgid="4589873324439764349">""</string>
+    <string name="okay" msgid="4589873324439764349">" "</string>
     <string name="remove_screen_lock_title" msgid="1234382338764193387">"    ?"</string>
     <string name="remove_screen_lock_message" msgid="6675850371585564965">"        "</string>
     <string name="security_profile_lock_title" msgid="3082523481292617350">" "</string>
@@ -727,7 +743,7 @@
     <string name="lockpassword_clear_label" msgid="6363680971025188064">" "</string>
     <string name="lockpassword_cancel_label" msgid="5791237697404166450">" "</string>
     <string name="lockpassword_confirm_label" msgid="5918463281546146953">""</string>
-    <string name="choose_lock_password_hints" msgid="3903696950202491593">" 4   "</string>
+    <string name="choose_lock_password_hints" msgid="3903696950202491593">" 4   "</string>
     <string name="locktype_unavailable" msgid="2678317466336249126">"    "</string>
     <string name="lockpassword_pin_contains_non_digits" msgid="3044526271686839923">" 0-9    "</string>
     <string name="lockpassword_pin_recently_used" msgid="7901918311213276207">"       "</string>
@@ -748,7 +764,7 @@
     <string name="lockpassword_password_requires_nonletter" msgid="3089186186422638926">"{count,plural, =1{ # -   }other{ # -   }}"</string>
     <string name="lockpassword_password_requires_nonnumerical" msgid="1677123573552379526">"{count,plural, =1{ # -   }other{ # -   }}"</string>
     <string name="lockpassword_password_too_short" msgid="3898753131694105832">"{count,plural, =1{ #   }other{ #   }}"</string>
-    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{ #   }other{ #   }}"</string>
+    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{ #   }other{ #   }}"</string>
     <string name="lockpassword_password_too_long" msgid="1709616257350671045">"{count,plural, =1{#    }other{#    }}"</string>
     <string name="lockpassword_pin_too_long" msgid="8315542764465856288">"{count,plural, =1{#    }other{#    }}"</string>
     <string name="lockpassword_pin_no_sequential_digits" msgid="6511579896796310956">" , ,     "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"    ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"      "</string>
 </resources>
diff --git a/res/values-pa/strings.xml b/res/values-pa/strings.xml
index 2fe4cd892..8cfaea47f 100644
--- a/res/values-pa/strings.xml
+++ b/res/values-pa/strings.xml
@@ -180,13 +180,19 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"  "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
     <string name="bluetooth_device" msgid="3178478829314083240">" "</string>
     <string name="bluetooth_paired_devices" msgid="6463199569164652410">"  "</string>
     <string name="bluetooth_pair_new_device" msgid="6948753485443263095">"   "</string>
-    <string name="bluetooth_pair_new_device_summary" msgid="2497221247690369031">"     "</string>
+    <string name="bluetooth_pair_new_device_summary" msgid="2497221247690369031">"      "</string>
     <string name="bluetooth_disconnect_title" msgid="7675271355910637528">"    ?"</string>
     <string name="bluetooth_disconnect_all_profiles" msgid="2017519733701757244">"  <xliff:g id="DEVICE_NAME">%1$s</xliff:g>    "</string>
     <string name="bluetooth_vehicle_mac_address" msgid="7069234636525805937">"   : <xliff:g id="ADDRESS">%1$s</xliff:g>"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }one{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"     "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" -"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"      \'  -                     "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"   %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"            "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"     ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"      "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"       "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"       "</string>
 </resources>
diff --git a/res/values-pl/strings.xml b/res/values-pl/strings.xml
index 1e529afc1..1f164ff96 100644
--- a/res/values-pl/strings.xml
+++ b/res/values-pl/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Poczono"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Poka wszystko"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Wyszukiwanie"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Poczone urzdzenia"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Uyj Bluetootha"</string>
@@ -238,7 +244,7 @@
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">"Sugerowane"</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">"Wszystkie jzyki"</string>
     <string name="keyboard_settings" msgid="1959697870618278081">"Klawiatura"</string>
-    <string name="manage_keyboard" msgid="4045394766282200132">"Zarzdzanie klawiaturami"</string>
+    <string name="manage_keyboard" msgid="4045394766282200132">"Zarzdzaj klawiaturami"</string>
     <string name="text_to_speech_settings" msgid="811985746199507343">"Zamiana tekstu na mow"</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">"Preferowany mechanizm"</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">"Uywany mechanizm"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nieuywane aplikacje"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#nieuywana aplikacja}few{#nieuywane aplikacje}many{#nieuywanych aplikacji}other{#nieuywanej aplikacji}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Usu uprawnienia izwolnij miejsce"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Format obrazu (funkcja eksperymentalna)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Otwrz"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Ustawienie domylne aplikacji"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Peny ekran"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Poowa ekranu"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Format obrazu urzdzenia"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Kiedy zmienisz format obrazu, aplikacja uruchomi si ponownie. Moesz utraci niezapisane zmiany. Niektre aplikacje mog nie by zoptymalizowane pod ktem pewnych formatw obrazu."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s wpamici wewntrznej"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Wykorzystuje wicej zasobw systemu do uzyskania wikszej wydajnoci aplikacji"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Uycie danych"</string>
@@ -696,7 +712,7 @@
     <string name="lockpattern_retry_button_text" msgid="4655398824001857843">"Wyczy"</string>
     <string name="lockpattern_cancel_button_text" msgid="4068764595622381766">"Anuluj"</string>
     <string name="lockpattern_pattern_confirmed" msgid="5984306638250515385">"Nowy wzr odblokowania"</string>
-    <string name="lockpattern_recording_intro_header" msgid="7864149726033694408">"Narysuj wzr odblokowania"</string>
+    <string name="lockpattern_recording_intro_header" msgid="7864149726033694408">"Narysuj wzr, ktrym odblokujesz ekran"</string>
     <string name="lockpattern_recording_inprogress" msgid="1575019990484725964">"Gdy skoczysz, podnie palec"</string>
     <string name="lockpattern_pattern_entered" msgid="6103071005285320575">"Wzr zapisany"</string>
     <string name="lockpattern_need_to_confirm" msgid="4648070076022940382">"Narysuj ponownie wzr, aby go potwierdzi"</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"Ten profil jest obecnie uywany wtrybie kierowcy. Sprbuj ponownie, gdy profil nie bdzie wtym trybie."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">"Jasno wywietlacza"</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Aby zobaczy urzdzenia, wcz Bluetooth"</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Aby sparowa urzdzenie, otwrz ustawienia Bluetooth"</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Aby sparowa urzdzenie, otwrz ustawienia Bluetootha"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Motyw"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Ustaw tryb samochodowy"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Poka granice ukadu"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Wymu ukad od prawej do lewej"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Nakadka personalizacji"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrator systemu multimedialno-rozrywkowego"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aplikacje aktywowane"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Aplikacje dezaktywowane"</string>
@@ -945,4 +964,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Twoje abonamenty internetowe straciy wano"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Zobacz abonamenty"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Gotowe"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Pojazd nie obsuguje tej funkcji"</string>
 </resources>
diff --git a/res/values-pt-rPT/strings.xml b/res/values-pt-rPT/strings.xml
index f527b9953..2ab4b8b55 100644
--- a/res/values-pt-rPT/strings.xml
+++ b/res/values-pt-rPT/strings.xml
@@ -180,6 +180,9 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Ligao estabelecida com xito"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Mostrar tudo"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"A pesquisar"</string>
+    <string name="wifi_detail_share" msgid="3765487472190563802">"Partilhar"</string>
+    <string name="wifi_detail_share_description" msgid="1417559695973326762">"Leia este cdigo QR para se ligar  rede Wi-Fi"</string>
+    <string name="wifi_detail_share_toast" msgid="9106513465439393280">"A partilha de Wi-Fi no est disponvel para esta rede Wi-Fi."</string>
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispositivos ligados"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Usar Bluetooth"</string>
@@ -343,6 +346,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Apps no usadas"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# app no utilizada}other{# apps no utilizadas}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Remover autorizaes e libertar espao"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Formato (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Abrir"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Predefinio da app"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Ecr inteiro"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Meio ecr"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Formato do dispositivo"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"A app vai ser reiniciada quando alterar o formato. Pode perder alteraes no guardadas. Algumas apps podem no estar otimizadas para determinados formatos."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s de memria de armazenamento interno"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Utiliza os recursos do sistema para dar prioridade ao desempenho da app"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Utilizao de dados"</string>
@@ -795,9 +808,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"Este perfil tem sesso iniciada como condutor. Tente de novo quando o perfil no for usado como condutor."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">"Luminosidade do ecr"</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Para ver os seus dispositivos, ative o Bluetooth"</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Para sincronizar um dispositivo, abra as definies de Bluetooth"</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Para sincronizar, abra as definies de Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Definir modo de conduo"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Mostrar limites do esquema"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forar direo do esquema RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Sobreposio da personalizao"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrador do sistema de infoentretenimento"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Apps ativadas"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Apps desativadas"</string>
@@ -933,4 +949,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Os seus planos de Internet expiraram"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Ver planos"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Concluir"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"O seu veculo no suporta esta funcionalidade"</string>
 </resources>
diff --git a/res/values-pt/strings.xml b/res/values-pt/strings.xml
index 52a0d6b32..7c834ac45 100644
--- a/res/values-pt/strings.xml
+++ b/res/values-pt/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Conexo realizada"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Mostrar tudo"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Pesquisar"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispositivos conectados"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Usar Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Apps no usados"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# app no usado}one{# app no usado}other{# apps no usados}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Remover permisses e liberar espao"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Proporo (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Abrir"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Padro do app"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Tela cheia"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Meia tela"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Proporo do dispositivo"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"O app ser reiniciado quando voc mudar a proporo.  possvel que voc perca mudanas que no foram salvas. Talvez alguns apps no estejam otimizados para algumas propores."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s no armazenamento interno"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Usa os recursos do sistema para priorizar o desempenho do app"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Uso de dados"</string>
@@ -779,7 +795,7 @@
     <string name="restricted_for_driver" msgid="3364388937671526800">"No  possvel realizar esta ao"</string>
     <string name="add_user_restricted_while_driving" msgid="1037301074725362944">"No  possvel adicionar perfis enquanto voc dirige"</string>
     <string name="default_search_query" msgid="3137420627428857068">"Pesquisa"</string>
-    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"Assistente e Voice"</string>
+    <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"Assistente e voz"</string>
     <string name="assistant_and_voice_assistant_app_title" msgid="5981647244625171285">"App assistente digital"</string>
     <string name="assistant_and_voice_use_text_from_screen_title" msgid="5851460943413795599">"Usar texto da tela"</string>
     <string name="assistant_and_voice_use_text_from_screen_summary" msgid="4161751708121301541">"Permitir que o Assistente acesse os contedos da tela"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Para acessar seus dispositivos, ative o Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Para parear um dispositivo, abra as configuraes do Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Definir modo carro"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Mostrar limites de layout"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Forar layout da direita para a esquerda"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Sobreposio de personalizao"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administrador do sistema de infoentretenimento"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Apps ativados"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Apps desativados"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Seus planos de Internet expiraram"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Ver planos"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Concluir"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Seu veculo no  compatvel com este recurso"</string>
 </resources>
diff --git a/res/values-ro/strings.xml b/res/values-ro/strings.xml
index f90fe9bd1..a9cf28804 100644
--- a/res/values-ro/strings.xml
+++ b/res/values-ro/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Conectare reuit"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Afieaz-le pe toate"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Se caut dispozitive"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Dispozitive conectate"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Folosete Bluetooth"</string>
@@ -239,7 +245,7 @@
     <string name="language_picker_list_all_header" msgid="1577387973934368428">"Toate limbile"</string>
     <string name="keyboard_settings" msgid="1959697870618278081">"Tastatur"</string>
     <string name="manage_keyboard" msgid="4045394766282200132">"Gestioneaz tastaturile"</string>
-    <string name="text_to_speech_settings" msgid="811985746199507343">"Setri pentru redarea vocal a textului"</string>
+    <string name="text_to_speech_settings" msgid="811985746199507343">"Redare vocal a textului"</string>
     <string name="text_to_speech_preferred_engine_settings" msgid="2766782925699132256">"Motor preferat"</string>
     <string name="text_to_speech_current_engine" msgid="8133107484909612597">"Motor actual"</string>
     <string name="tts_speech_rate" msgid="4512944877291943133">"Ritmul vorbirii"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Aplicaii nefolosite"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# aplicaie nefolosit}few{# aplicaii nefolosite}other{# de aplicaii nefolosite}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Elimin permisiuni i elibereaz spaiu"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Raportul de dimensiuni (experimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Deschide"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Prestabilit pentru aplicaie"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Ecran complet"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Jumtate de ecran"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Raportul de dimensiuni al dispozitivului"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aplicaia va reporni cnd schimbi raportul de dimensiuni. Este posibil s pierzi modificrile nesalvate. Unele aplicaii pot s nu fie optimizate pentru anumite raporturi de dimensiuni."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s n memoria intern"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Folosete resursele de sistem pentru a prioritiza performana aplicaiilor"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Utilizarea datelor"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Pentru a vedea dispozitivele, activeaz Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Pentru a asocia un dispozitiv, deschide setrile Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tem"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Seteaz modul cu maina"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Afieaz limite aspect"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Direcie aspect dreapta  stnga"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Suprapunere de personalizare"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administratorul sistemului de infotainment"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aplicaii activate"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Aplicaii dezactivate"</string>
@@ -939,4 +958,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Planurile tale de internet au expirat"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Vezi planurile"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Gata"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Vehiculul tu nu accept aceast funcie"</string>
 </resources>
diff --git a/res/values-ru/strings.xml b/res/values-ru/strings.xml
index d5ebedb24..d6c7a59b3 100644
--- a/res/values-ru/strings.xml
+++ b/res/values-ru/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }one{#  }few{#  }many{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" , . "</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"   "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"    ,  .     .        ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s:  "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"   ,   "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -364,7 +380,7 @@
     <string name="assist_and_voice_input_settings" msgid="8813195157136637132">"   "</string>
     <string name="assist_app_settings" msgid="9085261410166776497">""</string>
     <string name="assist_access_context_title" msgid="8034851731390785301">"   "</string>
-    <string name="assist_access_context_summary" msgid="2374281280599443774">"      "</string>
+    <string name="assist_access_context_summary" msgid="2374281280599443774">" -       "</string>
     <string name="assist_access_screenshot_title" msgid="2855956879971465044">" "</string>
     <string name="assist_access_screenshot_summary" msgid="6246496926635145782">" -    "</string>
     <string name="voice_input_settings_title" msgid="3238707827815647526">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"    ,  Bluetooth."</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"  ,   Bluetooth."</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">" - "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -945,4 +964,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"       "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"    ."</string>
 </resources>
diff --git a/res/values-si/strings.xml b/res/values-si/strings.xml
index fc18c00c3..fdf20cfb1 100644
--- a/res/values-si/strings.xml
+++ b/res/values-si/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"  "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{   #}one{   #}other{   #}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"      "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">" "</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"          .       .         ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"  ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"  ,    "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">" RTL  "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"   "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"     "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-sk/strings.xml b/res/values-sk/strings.xml
index f8e6f7b29..ce68709e2 100644
--- a/res/values-sk/strings.xml
+++ b/res/values-sk/strings.xml
@@ -86,7 +86,7 @@
     <string name="network_and_internet_oem_network_dialog_confirm_label" msgid="2630033932472996255">"Aj tak vypn"</string>
     <string name="network_and_internet_oem_network_disabled_footer" msgid="3529208167627034245">"Internet vo vozidle je vypnut. Me to spsobi, e niektor funkcie alebo aplikcie vozidla prestan fungova. Kov daje, ktor vyaduje prevdzka vozidla, sa bud alej zdiea svrobcom vozidla."</string>
     <string name="network_and_internet_data_usage_time_range_summary" msgid="1792995626433410056">"%1$s vyuit %2$s  %3$s"</string>
-    <string name="network_and_internet_join_other_network_title" msgid="7126831320010062712">"Pripojenie kinej sieti"</string>
+    <string name="network_and_internet_join_other_network_title" msgid="7126831320010062712">"Pripoji kinej sieti"</string>
     <string name="network_and_internet_network_preferences_title" msgid="2983548049081168876">"Nastavenia siete"</string>
     <string name="wifi_settings" msgid="7701477685273103841">"WiFi"</string>
     <string name="wifi_starting" msgid="473253087503153167">"Zapna sa WiFi"</string>
@@ -141,7 +141,7 @@
     <string name="wifi_settings_scanning_required_enabled" msgid="5457372118991438313">"Vyhadvanie siet WiFi je zapnut"</string>
     <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"Automaticky prepn na mobiln dta"</string>
     <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"Pouva mobiln dta, ke WiFi nem prstup kinternetu. Za vyuit dta vm mu by tovan poplatky."</string>
-    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Vyhada apripoji sa ksieam Wi-Fi"</string>
+    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Vyhadva siete Wi-Fi apripja sa knim"</string>
     <string name="learn_more" msgid="8214605928933358604">"alie informcie"</string>
     <string name="wifi_hotspot_name_title" msgid="8844779338692535356">"Nzov hotspotu"</string>
     <string name="wifi_hotspot_name_summary_connecting" msgid="5262510450498600038">"Zapna sa <xliff:g id="WIFI_HOTSPOT_NAME">%1$s</xliff:g>..."</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Pripojenie je spen"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Zobrazi vetko"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Vyhadvanie"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Pripojen zariadenia"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Pouva Bluetooth"</string>
@@ -221,7 +227,7 @@
     <string name="bluetooth_pairing_key_msg" msgid="5066825929751599037">"Provac kd Bluetooth"</string>
     <string name="bluetooth_enable_alphanumeric_pin" msgid="1636575922217263060">"PIN obsahuje psmen i symboly"</string>
     <string name="bluetooth_enter_passkey_msg" msgid="5955236916732265593">"Zadajte provac kd apotom stlate tlaidlo Return alebo Enter"</string>
-    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"Sprova so zariadenm <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
+    <string name="bluetooth_pairing_request" msgid="4769675459526556801">"Chcete sprova so zariadenm <xliff:g id="DEVICE_NAME">%1$s</xliff:g>?"</string>
     <string name="bluetooth_pairing_shares_phonebook" msgid="2015966932886300630">"Povoli zariadeniu <xliff:g id="DEVICE_NAME">%1$s</xliff:g> prstup kvaim kontaktom ahistrii hovorov"</string>
     <string name="bluetooth_enter_pin_other_device" msgid="7825091249522704764">"Tento kd PIN bude mono treba zada aj v druhom zariaden."</string>
     <string name="bluetooth_enter_passkey_other_device" msgid="7147248221018865922">"Tento prstupov k mono bude potrebn zada aj vdruhom zariaden."</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Nepouvan aplikcie"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#nepouvan aplikcia}few{#nepouvan aplikcie}many{# unused apps}other{#nepouvanch aplikci}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Odstraova povol. auvoova priestor"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Pomer strn (experimentlne)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Otvori"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Predvolen nastavenie aplikcie"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Cel obrazovka"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Polovica obrazovky"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Pomer strn zariadenia"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Ke zmente pomer strn, aplikcia sa retartuje. Mete prs oneuloen zmeny. Niektor aplikcie sa nemusia da optimalizova na urit pomery strn."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s vinternom loisku"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Priorizuje vkon aplikcie pomocou systmovch zdrojov"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Spotreba dt"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Ak chcete vidie svoje zariadenia, zapnite Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Ak chcete sprova zariadenie, otvorte nastavenia Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Motv"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Nastavi reim jazdy"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Zobrazova ohranienia"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Rozloenie sprava doava"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Prekrytie prispsobenia"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"sprvca palubnho systmu"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivovan aplikcie"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivovan aplikcie"</string>
@@ -945,4 +964,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Vae internetov tarify vyprali"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Zobrazi tarify"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Hotovo"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Vae vozidlo tto funkciu nepodporuje"</string>
 </resources>
diff --git a/res/values-sl/strings.xml b/res/values-sl/strings.xml
index 53c9fa7e7..46422abea 100644
--- a/res/values-sl/strings.xml
+++ b/res/values-sl/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Uspena vzpostavitev povezave"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Pokai vse"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Iskanje"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Povezane naprave"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Uporaba Bluetootha"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Neuporabljene aplikacije"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# neuporabljena aplikacija}one{# neuporabljena aplikacija}two{# neuporabljeni aplikaciji}few{# neuporabljene aplikacije}other{# neuporabljenih aplikacij}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Odstrani dovoljenja in sprosti prostor"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Razmerje stranic (preizkusno)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Odpri"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Privzeto za aplikacijo"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Celozaslonski nain"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Nain polovice zaslona"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Razmerje stranic naprave"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16 : 9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3 : 2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4 : 3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aplikacija se bo znova zagnala, ko boste spremenili razmerje stranic. Morda boste izgubili neshranjene spremembe. Nekatere aplikacije morda niso optimizirane za nekatera razmerja stranic."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s v notranji shrambi"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Uporablja sistemska sredstva zaradi prednosti uinkovitosti delovanja aplikacije"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Prenes. koliina podatkov"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"e si elite ogledati naprave, vklopite Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"e elite seznaniti napravo, odprite nastavitve za Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Nastavitev vonje"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Prikai meje postavitve"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Vsili od desne proti levi"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Prekrivni element za prilagajanje"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Skrbnik informativno-razvedrilnega sistema"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktivirane aplikacije"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Deaktivirane aplikacije"</string>
@@ -945,4 +964,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Vai internetni paketi so potekli"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Oglejte si pakete"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Konano"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Vae vozilo ne podpira te funkcije"</string>
 </resources>
diff --git a/res/values-sq/strings.xml b/res/values-sq/strings.xml
index d40e6475c..c6eb2dcba 100644
--- a/res/values-sq/strings.xml
+++ b/res/values-sq/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Lidhja ishte e suksesshme"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Shfaq t gjitha"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Po krkon"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Pajisjet e lidhura"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Prdor Bluetooth-in"</string>
@@ -230,7 +236,7 @@
     <string name="bluetooth_notif_title" msgid="8374602799367803335">"Krkesa e iftimit"</string>
     <string name="bluetooth_notif_message" msgid="1060821000510108726">"Trokit pr ta iftuar me <xliff:g id="DEVICE_NAME">%1$s</xliff:g>."</string>
     <string name="bluetooth_device_picker" msgid="673238198452345475">"Zgjidh pajisjen me Bluetooth"</string>
-    <string name="bluetooth_bonded_bluetooth_toggle_content_description" msgid="6800772154405846597">"Bluetooth"</string>
+    <string name="bluetooth_bonded_bluetooth_toggle_content_description" msgid="6800772154405846597">"Bluetooth-i"</string>
     <string name="bluetooth_bonded_phone_toggle_content_description" msgid="8152794643249938377">"Telefoni"</string>
     <string name="bluetooth_bonded_media_toggle_content_description" msgid="7803420585378155404">"Media"</string>
     <string name="language_settings" msgid="2079258598337245546">"Gjuht"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Aplikacionet e paprdorura"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# aplikacion i paprdorur}other{# aplikacione t paprdorura}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Hiq lejet dhe liro hapsirn"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Raporti i pamjes (eksperimental)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Hap"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Parazgjedhja e aplikacionit"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Ekran i plot"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Gjysm ekrani"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Raporti i pamjes i pajisjes"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Aplikacioni do t riniset kur t ndryshosh raportin e pamjes. Mund t\'i humbassh ndryshimet e paruajtura. Disa aplikacione mund t mos jen t optimizuara pr raporte t caktuara t pamjes."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s n hapsirn e brendshme t ruajtjes"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Prdor burimet e sistemit pr t\'i dhn prparsi performancs s aplikacionit"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Prdorimi i t dhnave"</string>
@@ -617,7 +633,7 @@
     <string name="accounts_settings_title" msgid="436190037084293471">"Llogarit"</string>
     <string name="user_add_account_menu" msgid="6625351983590713721">"Shto llogari"</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"Nuk sht shtuar asnj llogari"</string>
-    <string name="account_list_title" msgid="7631588514613843065">"Llogarit pr <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
+    <string name="account_list_title" msgid="7631588514613843065">"Llogarit pr: <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">"Sinkronizo automatikisht t dhnat"</string>
     <string name="account_auto_sync_summary" msgid="6963837893148304128">"Lejo q aplikacionet t\'i rifreskojn automatikisht t dhnat"</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"T lejohet sinkronizimi automatik i t dhnave?"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Pr t par pajisjet e tua, aktivizo Bluetooth-in"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Pr t iftuar nj pajisje, hap cilsimet e Bluetooth-it"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Cakto modalitetin \"me makin\""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Shfaq konturet e kuadrit"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Detyro drejtimin e shkrimit nga e djathta n t majt"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Mbivendosja e personalizimit"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Administratori i sistemit info-argtues"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aplikacionet e aktivizuara"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Aplikacionet e aktivizuara"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Planet e tua t internetit kan skaduar"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Shiko planet"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"U krye"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Automjeti yt nuk e mbshtet kt veori"</string>
 </resources>
diff --git a/res/values-sr/strings.xml b/res/values-sr/strings.xml
index b671b5ea6..637307762 100644
--- a/res/values-sr/strings.xml
+++ b/res/values-sr/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"    "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#     }one{#     }few{#     }other{#     }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"  "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"  "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"      .     .         ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"       "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   ,  Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"   ,  Bluetooth "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"   "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"     "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -939,4 +958,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"   "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"    "</string>
 </resources>
diff --git a/res/values-sv/strings.xml b/res/values-sv/strings.xml
index ded7d5881..11d9b8085 100644
--- a/res/values-sv/strings.xml
+++ b/res/values-sv/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Anslutningen har upprttats"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Visa alla"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Sker"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Anslutna enheter"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Anvnd Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Appar som inte anvnds"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# app som inte anvnds}other{# appar som inte anvnds}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Ta bort behrigheter och frigr utrymme"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Bildformat (experimentellt)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"ppna"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Standard fr appen"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Helskrm"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Halvskrm"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Enhetens bildformat"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Appen startas om nr du ndrar bildformatet. Du kan frlora ndringar som inte har sparats. Vissa appar kanske inte r optimerade fr vissa bildformat."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s i internt lagringsutrymme"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Systemresurser anvnds fr att prioritera appars prestanda"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Dataanvndning"</string>
@@ -371,7 +387,7 @@
     <string name="autofill_settings_title" msgid="1188754272680049972">"Autofylltjnst"</string>
     <string name="app_list_preference_none" msgid="7753357799926715901">"Ingen"</string>
     <string name="default_app_selected_app" msgid="5289396663745484773">"Vald"</string>
-    <string name="assistant_security_warning" msgid="1844807956967428012">"Assistenten kan lsa information om appar som anvnds i systemet, inklusive information som visas p skrmen eller r tkomlig i apparna."</string>
+    <string name="assistant_security_warning" msgid="1844807956967428012">"Assistent kan lsa information om appar som anvnds i systemet, inklusive information som visas p skrmen eller r tkomlig i apparna."</string>
     <string name="autofill_confirmation_message" msgid="1832984461556991378">"&lt;b&gt;Kontrollera att du litar p den hr appen&lt;/b&gt; &lt;br/&gt; &lt;br/&gt; &lt;xliff:g id=app_name example=Google Autofyll&gt;%1$s&lt;/xliff:g&gt; identifierar vad som kan fyllas i automatiskt utifrn vad som visas p skrmen."</string>
     <string name="autofill_add_service" msgid="6413893366443609951">"Lgg till tjnst"</string>
     <string name="app_launch_domain_links_title" msgid="774480184927726651">"ppna lnkar"</string>
@@ -394,7 +410,7 @@
     <string name="apps_view_all_apps_title" msgid="2322120325505230530">"Visa alla %1$d appar"</string>
     <string name="apps_permission_manager_title" msgid="8776335943862484131">"Behrighetshantering"</string>
     <string name="apps_permission_manager_summary" msgid="4180424218228141274">"Styr apptkomst till din data"</string>
-    <string name="apps_default_apps_summary" msgid="2017792579839972926">"Fr assistenten med mera"</string>
+    <string name="apps_default_apps_summary" msgid="2017792579839972926">"Fr Google Assistent med mera"</string>
     <string name="performance_impacting_apps_summary" msgid="7762122057244111162">"{count,plural, =1{# app som pverkar prestandan}other{# appar som pverkar prestandan}}"</string>
     <string name="apps_special_app_access_summary" msgid="6464767436309742163">"Till systeminstllningar och andra instllningar"</string>
     <string name="special_access" msgid="5730278220917123811">"Srskild apptkomst"</string>
@@ -782,9 +798,9 @@
     <string name="assistant_and_voice_setting_title" msgid="737733881661819853">"Assistent och rst"</string>
     <string name="assistant_and_voice_assistant_app_title" msgid="5981647244625171285">"Digital assistentapp"</string>
     <string name="assistant_and_voice_use_text_from_screen_title" msgid="5851460943413795599">"Anvnda text frn skrmen"</string>
-    <string name="assistant_and_voice_use_text_from_screen_summary" msgid="4161751708121301541">"Ge assistenten tkomst till skrminnehllet"</string>
+    <string name="assistant_and_voice_use_text_from_screen_summary" msgid="4161751708121301541">"Ge Google Assistent tkomst till skrminnehllet"</string>
     <string name="assistant_and_voice_use_screenshot_title" msgid="1930735578425470046">"Anvnda skrmdump"</string>
-    <string name="assistant_and_voice_use_screenshot_summary" msgid="3738474919393817950">"Ge assistenten tkomst till skrmbilden"</string>
+    <string name="assistant_and_voice_use_screenshot_summary" msgid="3738474919393817950">"Ge Google Assistent tkomst till skrmbilden"</string>
     <string name="notifications_recently_sent" msgid="9051696542615302799">"Nyligen skickat"</string>
     <string name="notifications_all_apps" msgid="3557079551048958846">"Alla appar"</string>
     <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"Profiler och konton"</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"Den hr profilen r inloggad som frare. Frsk igen nr profilen inte anvnds som frare."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">"Skrmens ljusstyrka"</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Aktivera Bluetooth fr att visa enheterna"</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"ppna Bluetooth-instllningarna fr att koppla en enhet"</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Koppla en enhet i Bluetooth-instllningarna"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Stll in krlge"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Visa layoutgrnser"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Tvinga fram RTL-layout"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Anpassningsverlagring"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Infotainmentsystemets administratr"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Aktiverade appar"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Inaktiverade appar"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Dina internetabonnemang har lpt ut"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Se abonnemang"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Klar"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Fordonet har inte std fr den hr funktionen"</string>
 </resources>
diff --git a/res/values-sw/strings.xml b/res/values-sw/strings.xml
index 8ebe3c6ae..2b523aaea 100644
--- a/res/values-sw/strings.xml
+++ b/res/values-sw/strings.xml
@@ -180,6 +180,9 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Imeunganisha"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Onyesha yote"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Inatafuta"</string>
+    <string name="wifi_detail_share" msgid="3765487472190563802">"Ruhusu ufikiaji"</string>
+    <string name="wifi_detail_share_description" msgid="1417559695973326762">"Changanua msimbo huu wa QR ili uunganishe kwenye WiFi"</string>
+    <string name="wifi_detail_share_toast" msgid="9106513465439393280">"Kipengele cha kuruhusu ufikiaji wa WiFi hakipatikani kwenye WiFi hii."</string>
     <string name="connected_settings_title" msgid="8868738903280658151">"Vifaa vilivyounganishwa"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Tumia Bluetooth"</string>
@@ -343,6 +346,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Programu zisizotumika"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{Programu # isiyotumika}other{Programu # zisizotumika}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Ondoa ruhusa na upate nafasi"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Uwiano (Wa Majaribio)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Fungua"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Uwiano chaguomsingi wa programu"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Skrini nzima"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Nusu skrini"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Uwiano wa kifaa"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Programu itafungwa kisha ifunguliwe upya utakapobadilisha uwiano. Huenda ukapoteza mabadiliko ambayo hujahifadhi. Huenda baadhi ya programu zisiweze kutumia uwiano fulani."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s katika hifadhi ya mfumo"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Hutumia nyenzo za mfumo kuweka kipaumbele cha utendaji wa programu"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Matumizi ya data"</string>
@@ -569,7 +582,7 @@
     <string name="user_new_user_name" msgid="906698527658609819">"Wasifu mpya"</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"Utaweka wasifu mpya?"</string>
     <string name="user_add_user_message_setup" msgid="812616230454605159">"Baada ya kutengeneza wasifu mpya, mtu huyo anapaswa kuuwekea mapendeleo ili uwe jinsi apendavyo."</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">"Programu zinaweza kusasishwa kwenye wasifu wowote wa kutumiwa na wasifu nyingine zote."</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">"Programu zinaweza kusasishwa kwenye wasifu wowote ili zitumiwe na wasifu mwingine wowote."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"Umefikisha kikomo cha wasifu"</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{Unaweza kuweka wasifu mmoja pekee.}other{Unaweza kuweka hadi wasifu #.}}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">"Imeshindwa kutengeneza wasifu mpya"</string>
@@ -797,7 +810,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Ili uone vifaa vyako, washa Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Ili uoanishe kifaa, fungua mipangilio ya Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Mandhari"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Washa hali ya kuendesha gari"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Onyesha mipaka ya mpangilio"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Lazimisha uelekezaji wa muundo wa RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Kuweka mapendeleo ya mwonekano"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Msimamizi wa mfumo wa burudani na habari"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Programu zilizowashwa"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Programu zilizozimwa"</string>
@@ -933,4 +949,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Muda wa mipango yako ya intaneti umekwisha"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Angalia mipango"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Nimemaliza"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Gari lako halitumii kipengele hiki"</string>
 </resources>
diff --git a/res/values-ta/strings.xml b/res/values-ta/strings.xml
index f8dbe275c..89f1dc9fa 100644
--- a/res/values-ta/strings.xml
+++ b/res/values-ta/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"   "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ( )"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">" "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"     .    .        ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"     "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"     "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"    "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"   "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"  "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"  "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"   "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"    "</string>
 </resources>
diff --git a/res/values-te/strings.xml b/res/values-te/strings.xml
index 3c936ee67..4b2be726b 100644
--- a/res/values-te/strings.xml
+++ b/res/values-te/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"  "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">" "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"  "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">" "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#  }other{#  }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"-"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"  "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"      .     .       ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"  %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"      "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"  ,   "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"  ,   "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL    "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"  "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"    "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"  "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"    "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-th/strings.xml b/res/values-th/strings.xml
index b3ff3bce7..624cb601b 100644
--- a/res/values-th/strings.xml
+++ b/res/values-th/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">""</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">""</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">""</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">""</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"  "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s "</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">""</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">""</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">""</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">""</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">" RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">""</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">""</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">""</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">""</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">""</string>
 </resources>
diff --git a/res/values-tl/strings.xml b/res/values-tl/strings.xml
index e2173a4cf..0605feadd 100644
--- a/res/values-tl/strings.xml
+++ b/res/values-tl/strings.xml
@@ -132,7 +132,7 @@
     <string name="wifi_dns" msgid="1841448353154932801">"DNS"</string>
     <string name="wifi_details_ipv6_address_header" msgid="4707181386646531890">"Mga IPv6 address"</string>
     <string name="wifi_gateway" msgid="4975799192860431013">"Gateway"</string>
-    <string name="wifi_preferences_title" msgid="772788844257225510">"Mga kagustuhan sa WiFi"</string>
+    <string name="wifi_preferences_title" msgid="772788844257225510">"Mga preference sa WiFi"</string>
     <string name="wifi_wakeup" msgid="7451825226044542000">"Awtomatikong i-on ang WiFi"</string>
     <string name="wifi_wakeup_summary" msgid="7237521683331291414">"Mag-o-on ang WiFi malapit sa saved high-quality network, gaya ng home network"</string>
     <string name="wifi_wakeup_summary_no_location" msgid="2821576525488435259">"Hindi available, naka-off ang lokasyon. I-on ang "<annotation id="link">"lokasyon"</annotation>"."</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Naikonekta"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Ipakita lahat"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Naghahanap"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Mga nakakonektang device"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Gumamit ng Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Mga hindi ginagamit na app"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# hindi ginagamit na app}one{# hindi ginagamit na app}other{# na hindi ginagamit na app}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Alisin ang pahintulot, i-clear ang space"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Aspect ratio (Pang-eksperimento)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Buksan"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Default ng app"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Full screen"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Kalahating screen"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Aspect ratio ng device"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Magre-restart ang app kapag binago mo ang aspect ratio. Posibleng mawala ang mga hindi na-save na pagbabago. Posibleng hindi naka-optimize ang ilang app para sa ilang partikular na aspect ratio."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s sa internal storage"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Ginagamit ang mga resource ng system para gawing priyoridad ang performance ng app"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Paggamit ng data"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Para makita ang iyong mga device, i-on ang Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Para magpares ng device, buksan ang mga setting ng Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Itakda ang driving mode"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Ipakita ang mga hangganan ng layout"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Ipilit ang RTL na direksyon ng layout"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Overlay ng pag-customize"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Admin ng infotainment system"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Mga na-activate na app"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Mga na-deactivate na app"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Nag-expire na ang iyong internet plan"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Tingnan ang mga plan"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Tapos na"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Hindi sinusuportahan ng iyong device ang feature na ito"</string>
 </resources>
diff --git a/res/values-tr/strings.xml b/res/values-tr/strings.xml
index ec5b47e9b..65fd991ec 100644
--- a/res/values-tr/strings.xml
+++ b/res/values-tr/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Balant baarl"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Tmn gster"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Aryor"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Bal cihazlar"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetooth\'u kullan"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Kullanlmayan uygulamalar"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# kullanlmayan uygulama}other{# kullanlmayan uygulama}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"zinleri kaldr ve yer a"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"En-boy oran (Deneysel)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"A"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Uygulama varsaylan"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Tam ekran"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Yarm ekran"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Cihaz en-boy oran"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"En-boy orann deitirdiinizde uygulama yeniden balatlr. Kaydedilmemi deiiklikleri kaybedebilirsiniz. Baz uygulamalar belirli en boy oranlar iin optimize edilmemi olabilir."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"Dahili depolama alannda %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Uygulama performansna ncelik vermek iin sistem kaynaklarn kullanr"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Veri kullanm"</string>
@@ -568,7 +584,7 @@
     <string name="user_add_user_menu" msgid="4125869008006021799">"Profil ekle"</string>
     <string name="user_new_user_name" msgid="906698527658609819">"Yeni profil"</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"Yeni profil eklensin mi?"</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"Yeni profili oluturmanzdan sonra bu kii, profilini zelletirmelidir."</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"Yeni profil oluturulduktan sonra profil sahibi tarafndan zelletirilmelidir."</string>
     <string name="user_add_user_message_update" msgid="3836353291078729240">"Uygulamalar, dier tm profillerin kullanabilmesi iin herhangi bir profilden gncellenebilir."</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"Profil snrna ulald"</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{Yalnzca tek bir profil oluturulabilir.}other{En fazla # profil oluturabilirsiniz.}}"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Cihazlarnz grmek iin Bluetooth\'u an"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Cihaz elemek iin Bluetooth ayarlarn an"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Tema"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Sr modunu ayarla"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Dzen snrlarn gster"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Sadan sola dzenini zorla gster"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"zelletirme yer paylam"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Bilgi-elence sistemi yneticisi"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Etkin uygulamalar"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Devre d uygulamalar"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"nternet planlarnzn sresi doldu"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Planlar gster"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Bitti"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Cihaznz bu zellii desteklemiyor"</string>
 </resources>
diff --git a/res/values-uk/strings.xml b/res/values-uk/strings.xml
index 83dd5f4ce..5df203c84 100644
--- a/res/values-uk/strings.xml
+++ b/res/values-uk/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">" Bluetooth"</string>
@@ -234,7 +240,7 @@
     <string name="bluetooth_bonded_phone_toggle_content_description" msgid="8152794643249938377">""</string>
     <string name="bluetooth_bonded_media_toggle_content_description" msgid="7803420585378155404">""</string>
     <string name="language_settings" msgid="2079258598337245546">""</string>
-    <string name="languages_and_input_settings" msgid="3672322610529408248">"  "</string>
+    <string name="languages_and_input_settings" msgid="3672322610529408248">"  "</string>
     <string name="language_picker_list_suggested_header" msgid="7593893806003415948">""</string>
     <string name="language_picker_list_all_header" msgid="1577387973934368428">" "</string>
     <string name="keyboard_settings" msgid="1959697870618278081">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">",   "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# ,   }one{# ,   }few{# ,   }many{# ,   }other{# ,   }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"    "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ( )"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"   "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"  "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"  "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">" "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"  ,  .     .       ."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s   \'"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"  ,    "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">" "</string>
@@ -589,7 +605,7 @@
     <string name="current_user_name" msgid="3813671533249316823">" (%1$s)"</string>
     <string name="user_name_label" msgid="3210832645046206845">""</string>
     <string name="user_summary_not_set_up" msgid="1473688119241224145">" "</string>
-    <string name="edit_user_name_title" msgid="1118500707473139995">" \' "</string>
+    <string name="edit_user_name_title" msgid="1118500707473139995">"  "</string>
     <string name="name_input_blank_error" msgid="2088850865880984123">"    ."</string>
     <string name="name_input_invalid_error" msgid="4355625213535164704">" \'  ."</string>
     <string name="users_list_title" msgid="770764290290240909">""</string>
@@ -787,7 +803,7 @@
     <string name="assistant_and_voice_use_screenshot_summary" msgid="3738474919393817950">"     "</string>
     <string name="notifications_recently_sent" msgid="9051696542615302799">" "</string>
     <string name="notifications_all_apps" msgid="3557079551048958846">" "</string>
-    <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"   "</string>
+    <string name="profiles_and_accounts_settings_title" msgid="2672643892127659812">"  . "</string>
     <string name="manage_other_profiles_button_text" msgid="2262188413455510828">"  "</string>
     <string name="add_a_profile_button_text" msgid="8027395095117925114">" "</string>
     <string name="delete_this_profile_text" msgid="6035404714526922665">"  "</string>
@@ -795,9 +811,12 @@
     <string name="cannot_remove_driver_profile" msgid="4109363161608717969">"    .  ,      ."</string>
     <string name="qc_display_brightness" msgid="2939655289816201170">" "</string>
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"   ,  Bluetooth"</string>
-    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"    ,   Bluetooth"</string>
+    <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"  ,   Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"  "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"   "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">" "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">" - "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">" "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">" "</string>
@@ -945,4 +964,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"      "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"     "</string>
 </resources>
diff --git a/res/values-ur/strings.xml b/res/values-ur/strings.xml
index 4e07e1c3c..53b4dde28 100644
--- a/res/values-ur/strings.xml
+++ b/res/values-ur/strings.xml
@@ -141,7 +141,7 @@
     <string name="wifi_settings_scanning_required_enabled" msgid="5457372118991438313">"WiFi   "</string>
     <string name="wifi_cellular_fallback_title" msgid="8322675436784870862">"       "</string>
     <string name="wifi_cellular_fallback_summary" msgid="2433848528924203758">"Wi-Fi                      "</string>
-    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Wi-Fi         "</string>
+    <string name="wifi_network_state_switch_subtitle" msgid="7462322882046013762">"Wi-Fi         "</string>
     <string name="learn_more" msgid="8214605928933358604">" "</string>
     <string name="wifi_hotspot_name_title" msgid="8844779338692535356">"   "</string>
     <string name="wifi_hotspot_name_summary_connecting" msgid="5262510450498600038">"<xliff:g id="WIFI_HOTSPOT_NAME">%1$s</xliff:g>    ..."</string>
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">" "</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">" "</string>
     <string name="progress_scanning" msgid="7191583064717479795">"   "</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">" "</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"  "</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"  "</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{#   }other{#   }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"      "</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"  ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"  "</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">" "</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">" "</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"   "</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"                                       "</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"   %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"             "</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"  "</string>
@@ -568,7 +584,7 @@
     <string name="user_add_user_menu" msgid="4125869008006021799">"  "</string>
     <string name="user_new_user_name" msgid="906698527658609819">" "</string>
     <string name="user_add_user_title" msgid="6296827596015729982">"   "</string>
-    <string name="user_add_user_message_setup" msgid="812616230454605159">"                    "</string>
+    <string name="user_add_user_message_setup" msgid="812616230454605159">"                    "</string>
     <string name="user_add_user_message_update" msgid="3836353291078729240">"                   "</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">"    "</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{       }other{ #      }}"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"       "</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"         "</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"  "</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"    "</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"RTL        "</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"    "</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"    "</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"  "</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"   "</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"         "</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">" "</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">" "</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"         "</string>
 </resources>
diff --git a/res/values-uz/strings.xml b/res/values-uz/strings.xml
index 9d77bb6ac..29de7e35b 100644
--- a/res/values-uz/strings.xml
+++ b/res/values-uz/strings.xml
@@ -180,6 +180,9 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Muvaffaqiyatli ulandi!"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Hammasi"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Qidirilmoqda"</string>
+    <string name="wifi_detail_share" msgid="3765487472190563802">"Ulashish"</string>
+    <string name="wifi_detail_share_description" msgid="1417559695973326762">"WiFi tarmoqqa ulanish uchun ushbu QR kodni skanerlang"</string>
+    <string name="wifi_detail_share_toast" msgid="9106513465439393280">"Bu WiFi uchun WiFi ulashuvi ishlamaydi."</string>
     <string name="connected_settings_title" msgid="8868738903280658151">"Ulangan qurilmalar"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bluetoothdan foydalaning"</string>
@@ -343,6 +346,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Ishlatilmagan ilovalar"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# ta ishlatilmagan ilova}other{# ta ishlatilmagan ilova}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Ruxsatlarni olib tashlash va joy tozalash"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Tomonlar nisbati (tajribaviy)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Ochish"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Ilova standarti"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Butun ekran"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Yarim ekran"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Qurilmadagi tomonlar nisbati"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"Tomonlar nisbati ozgarishi bilan ilova qaytadan ishga tushadi. Ozgarishlar saqlanmasligi mumkin. Ayrim ilovalar muayyan tomonlar nisbatiga optimallashtirilmagan bolishi mumkin."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s ichki xotirada"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Ilova unumdorligini oshirish uchun tizim resurslaridan foydalanadi"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Trafik sarfi"</string>
@@ -797,7 +810,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Qurilmalaringizni korish uchun Bluetoothni yoqing"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Qurilmani ulash uchun Bluetooth sozlamalarini oching"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Mavzu"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Boshqarishni belgilash"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Elementlar hoshiyasi"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Ongdan chapga qarab yozish"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Moslashtirishni ustiga joylash"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Axborot-hordiq tizimi boshqaruvi"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Faol ilovalar"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Nofaol ilovalar"</string>
@@ -933,4 +949,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Internet tarifingiz muddati tugadi"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Tarif rejalari"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Tayyor"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Avtomobilingizda bu funksiya ishlamaydi"</string>
 </resources>
diff --git a/res/values-vi/strings.xml b/res/values-vi/strings.xml
index c5abe8939..df58b8a45 100644
--- a/res/values-vi/strings.xml
+++ b/res/values-vi/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Kt ni thnh cng"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Hin th tt c"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"ang tm kim"</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Thit b  kt ni"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Bt Bluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"ng dng khng dng n"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# ng dng khng dng n}other{# ng dng khng dng n}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Xa quyn v gii phng dung lng"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"T l khung hnh (Th nghim)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"M"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Theo mc nh ca ng dng"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Ton mn hnh"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Na mn hnh"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"T l khung hnh ca thit b"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"ng dng s khi ng li khi bn thay i t l khung hnh. Bn c th b mt nhng thay i cha lu. C th mt s ng dng cha c ti u ho cho mt s t l khung hnh nht nh."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s trong b nh trong"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Dng ti nguyn ca h thng  u tin hiu sut ca ng dng"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Mc s dng d liu"</string>
@@ -618,7 +634,7 @@
     <string name="user_add_account_menu" msgid="6625351983590713721">"Thm ti khon"</string>
     <string name="no_accounts_added" msgid="5148163140691096055">"Cha thm ti khon no"</string>
     <string name="account_list_title" msgid="7631588514613843065">"Ti khon cho <xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
-    <string name="account_auto_sync_title" msgid="3238816995364191432">"T ng ng b ha d liu"</string>
+    <string name="account_auto_sync_title" msgid="3238816995364191432">"T ng ng b ho d liu"</string>
     <string name="account_auto_sync_summary" msgid="6963837893148304128">"Cho php ng dng t ng lm mi d liu"</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">"Cho php t ng ng b ho d liu?"</string>
     <string name="data_usage_auto_sync_on_dialog" msgid="8683935973719807821">"Mi thay i bn thc hin i vi ti khon trn web s t ng c sao chp sang xe.\n\nMt s ti khon cng c th t ng sao chp mi thay i bn thc hin trn xe ln web."</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">" xem cc thit b ca bn, hy bt Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">" ghp ni thit b, hy m phn ci t Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Giao din"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Thit lp ch  li xe"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Hin ranh gii b cc"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Buc hin hng b cc phi sang tri"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Lp ph tu chnh"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Qun tr h thng thng tin gii tr"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"ng dng  kch hot"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"ng dng  hy kch hot"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Cc gi Internet ca bn  ht hn"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Xem cc gi"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Xong"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">" t ca bn khng h tr tnh nng ny"</string>
 </resources>
diff --git a/res/values-zh-rCN/strings.xml b/res/values-zh-rCN/strings.xml
index 625abec29..7f134551b 100644
--- a/res/values-zh-rCN/strings.xml
+++ b/res/values-zh-rCN/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">""</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">""</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# }other{# }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">""</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">""</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">""</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">""</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">""</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -407,7 +423,7 @@
     <string name="notification_access_title" msgid="1467340098885813473">""</string>
     <string name="notification_listener_security_warning_title" msgid="2893273335175140895">"<xliff:g id="SERVICE">%1$s</xliff:g>"</string>
     <string name="notification_listener_security_warning_summary" msgid="7280197998063498125">"<xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>\n\n"</string>
-    <string name="notification_listener_revoke_warning_summary" msgid="4904973394539125407">"<xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>"</string>
+    <string name="notification_listener_revoke_warning_summary" msgid="4904973394539125407">"<xliff:g id="NOTIFICATION_LISTENER_NAME">%1$s</xliff:g>"</string>
     <string name="notification_listener_revoke_warning_confirm" msgid="2759583507454984812">""</string>
     <string name="notification_listener_revoke_warning_cancel" msgid="4399941651358241154">""</string>
     <string name="performance_impacting_apps_description" msgid="7361464904617808444">"\n"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">""</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">""</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">""</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">""</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">""</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">""</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">""</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">""</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">""</string>
 </resources>
diff --git a/res/values-zh-rHK/strings.xml b/res/values-zh-rHK/strings.xml
index cce7908e3..46d3a3a87 100644
--- a/res/values-zh-rHK/strings.xml
+++ b/res/values-zh-rHK/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">"..."</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">""</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">""</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# }other{# }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">""</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">""</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">""</string>
     <string name="storage_type_internal" msgid="8918688427078709570">" %s"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">""</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">""</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">""</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">""</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">""</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">""</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">""</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">""</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">""</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">""</string>
 </resources>
diff --git a/res/values-zh-rTW/strings.xml b/res/values-zh-rTW/strings.xml
index d92f3efc4..ecfcef419 100644
--- a/res/values-zh-rTW/strings.xml
+++ b/res/values-zh-rTW/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">""</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">""</string>
     <string name="progress_scanning" msgid="7191583064717479795">""</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">""</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">""</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">""</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">""</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{# }other{# }}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">""</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">" ()"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">""</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">""</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">""</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">""</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">""</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">""</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s ()"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">""</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">""</string>
@@ -569,7 +585,7 @@
     <string name="user_new_user_name" msgid="906698527658609819">""</string>
     <string name="user_add_user_title" msgid="6296827596015729982">""</string>
     <string name="user_add_user_message_setup" msgid="812616230454605159">""</string>
-    <string name="user_add_user_message_update" msgid="3836353291078729240">""</string>
+    <string name="user_add_user_message_update" msgid="3836353291078729240">""</string>
     <string name="user_limit_reached_title" msgid="5677729355746623293">""</string>
     <string name="user_limit_reached_message" msgid="2773441357248819721">"{count,plural, =1{ 1 }other{ # }}"</string>
     <string name="add_user_error_title" msgid="7589792057846396341">""</string>
@@ -617,7 +633,7 @@
     <string name="accounts_settings_title" msgid="436190037084293471">""</string>
     <string name="user_add_account_menu" msgid="6625351983590713721">""</string>
     <string name="no_accounts_added" msgid="5148163140691096055">""</string>
-    <string name="account_list_title" msgid="7631588514613843065">"<xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g> "</string>
+    <string name="account_list_title" msgid="7631588514613843065">"<xliff:g id="CURRENT_USER_NAME">%1$s</xliff:g>"</string>
     <string name="account_auto_sync_title" msgid="3238816995364191432">""</string>
     <string name="account_auto_sync_summary" msgid="6963837893148304128">""</string>
     <string name="data_usage_auto_sync_on_dialog_title" msgid="8068513213445588532">""</string>
@@ -748,7 +764,7 @@
     <string name="lockpassword_password_requires_nonletter" msgid="3089186186422638926">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="lockpassword_password_requires_nonnumerical" msgid="1677123573552379526">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="lockpassword_password_too_short" msgid="3898753131694105832">"{count,plural, =1{ # }other{ # }}"</string>
-    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{ # }other{ # }}"</string>
+    <string name="lockpassword_pin_too_short" msgid="3671037384464545169">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="lockpassword_password_too_long" msgid="1709616257350671045">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="lockpassword_pin_too_long" msgid="8315542764465856288">"{count,plural, =1{ # }other{ # }}"</string>
     <string name="lockpassword_pin_no_sequential_digits" msgid="6511579896796310956">""</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">""</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">""</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">""</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">""</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">""</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">""</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">""</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">""</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">""</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">""</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">""</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">""</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">""</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">""</string>
 </resources>
diff --git a/res/values-zu/strings.xml b/res/values-zu/strings.xml
index b7f15d2bd..fbc36c4cd 100644
--- a/res/values-zu/strings.xml
+++ b/res/values-zu/strings.xml
@@ -180,6 +180,12 @@
     <string name="network_connection_connect_successful" msgid="7893957133113302365">"Ukuxhumeka kuphumelele"</string>
     <string name="network_connection_request_dialog_showall" msgid="776613149566461487">"Bonisa konke"</string>
     <string name="progress_scanning" msgid="7191583064717479795">"Iyasesha..."</string>
+    <!-- no translation found for wifi_detail_share (3765487472190563802) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_description (1417559695973326762) -->
+    <skip />
+    <!-- no translation found for wifi_detail_share_toast (9106513465439393280) -->
+    <skip />
     <string name="connected_settings_title" msgid="8868738903280658151">"Amadivayisi axhunyiwe"</string>
     <string name="bluetooth_settings_title" msgid="3794688574569688649">"I-Bluetooth"</string>
     <string name="bluetooth_toggle_title" msgid="1431803611346881088">"Sebenzisa iBluetooth"</string>
@@ -343,6 +349,16 @@
     <string name="unused_apps" msgid="648471933781010395">"Ama-unused app"</string>
     <string name="unused_apps_summary" msgid="8257304516038923072">"{count,plural, =1{i-app engasetshenzisiwe engu-#}one{Ama-app angasetshenzisiwe angu-#}other{Ama-app angasetshenzisiwe angu-#}}"</string>
     <string name="unused_apps_switch" msgid="4433958286200341563">"Susa izimvume uphinde ukhulule isikhala"</string>
+    <string name="aspect_ratio_label" msgid="5484863076085548807">"Ukubukeka kwesilinganiselo (Kuyahlolwa)"</string>
+    <string name="aspect_ratio_action_button" msgid="5581373962239508271">"Vula"</string>
+    <string name="user_aspect_ratio_app_default" msgid="283669241296845522">"Okuzenzakalelayo kwe-app"</string>
+    <string name="user_aspect_ratio_fullscreen" msgid="7558176135316113">"Isikrini esigcwele"</string>
+    <string name="user_aspect_ratio_half_screen" msgid="6294133158286722632">"Isikrini esiwuhhafu"</string>
+    <string name="user_aspect_ratio_device_size" msgid="960231007272059744">"Ukubukeka kwesilinganiso sedivayisi"</string>
+    <string name="user_aspect_ratio_16_9" msgid="2419220677608547650">"16:9"</string>
+    <string name="user_aspect_ratio_3_2" msgid="5245528023878893826">"3:2"</string>
+    <string name="user_aspect_ratio_4_3" msgid="6639743021314111820">"4:3"</string>
+    <string name="app_aspect_ratio_footer" msgid="7814071704357140611">"I-app izoqala kabusha uma ushintsha ukubukeka kwesilinganiselo. Ungase ulahlekelwe yizinguquko ezingalondoloziwe. Amanye ama-app kungenzeka angalungiselelwa ukubukeka kwesilinganiselo esithile."</string>
     <string name="storage_type_internal" msgid="8918688427078709570">"%s kusitoreji sangaphakathi"</string>
     <string name="prioritize_app_performance_summary" msgid="1081874788185691418">"Isebenzisa izinsiza zesistimu ukukhuthalela i-app"</string>
     <string name="data_usage_summary_title" msgid="4368024763485916986">"Ukusebenzisa idatha"</string>
@@ -797,7 +813,10 @@
     <string name="qc_bluetooth_off_devices_info" msgid="8420985279976892700">"Ukuze ubone amadivayisi akho, vula i-Bluetooth"</string>
     <string name="qc_bluetooth_on_no_devices_info" msgid="7573736950041887300">"Ukuze ubhanqe idivayisi, vula amasethingi e-Bluetooth"</string>
     <string name="qc_ui_mode_title" msgid="2425571805732530923">"Itimu"</string>
+    <string name="driving_mode_title" msgid="8103270030335833998">"Setha ukushayela"</string>
     <string name="show_layout_bounds_title" msgid="8590148405645027755">"Bonisa imingcele yohlaka"</string>
+    <string name="show_force_rtl_title" msgid="8240732919603115320">"Phoqelela isikhombisi-ndlela sohlaka lwe-RTL"</string>
+    <string name="show_customization_overlay_title" msgid="2543804846629965883">"Imbondela yokuhlela ngokomuntu ngamunye"</string>
     <string name="device_admin_add_title" msgid="1294399588284546811">"Umphathi wesistimu ye-infotainment"</string>
     <string name="device_admin_activated_apps" msgid="568075063362271751">"Ama-app enziwe asebenza"</string>
     <string name="device_admin_deactivated_apps" msgid="3797263682500122872">"Ama-app ayekiswe ukusebenza"</string>
@@ -933,4 +952,5 @@
     <string name="connectivity_inactive_prompt" msgid="2325831357510029165">"Izinhlelo zakho ze-inthanethi ziphelelwe yisikhathi"</string>
     <string name="connectivity_inactive_action_text" msgid="1200295991890069311">"Bona izinhlelo"</string>
     <string name="audio_route_dialog_neutral_button_text" msgid="3303313405283478327">"Kwenziwe"</string>
+    <string name="unsupported_intents_toast_text" msgid="3112314947877145848">"Imoto yakho ayisekeli lesi sakhi"</string>
 </resources>
diff --git a/res/values/colors.xml b/res/values/colors.xml
index 75a4322d1..5f4c2d30d 100644
--- a/res/values/colors.xml
+++ b/res/values/colors.xml
@@ -77,4 +77,9 @@
     <color name="user_disclaimer_text_color">@android:color/white</color>
     <!-- Background color of button. -->
     <color name="user_disclaimer_action_button_background_color">@*android:color/car_grey_868</color>
+
+    <color name="aspect_ratio_icon_outline_color">@color/icon_color_default</color>
+    <color name="aspect_ratio_icon_inner_line_color">#1A73E8</color>
+    <color name="aspect_ratio_icon_background_color">@color/car_background</color>
+
 </resources>
\ No newline at end of file
diff --git a/res/values/config.xml b/res/values/config.xml
index 4b7482e5e..2459c2942 100644
--- a/res/values/config.xml
+++ b/res/values/config.xml
@@ -17,9 +17,13 @@
 
 <resources>
     <!-- Whether all activities should be single pane views or not. -->
-    <bool name="config_global_force_single_pane">true</bool>
-    <!-- Fully qualified class name for the homepage fragment. -->
-    <string name="config_homepage_fragment_class" translatable="false">com.android.car.settings.home.HomepageFragment</string>
+    <bool name="config_global_force_single_pane">false</bool>
+    <!-- Class name for the dual pane homepage placeholder activity class. -->
+    <string name="config_homepage_placeholder_class" translatable="false">
+        com.android.car.settings.common.CarSettingActivities$BluetoothSettingsActivity</string>
+    <!-- Top-level preference key for config_homepage_placeholder_class -->
+    <string name="config_homepage_placeholder_preference_key" translatable="false">
+        @string/pk_bluetooth_settings_entry</string>
     <!-- Whether to show the launcher icon for settings home or not. -->
     <bool name="config_enable_home_settings_icon">true</bool>
     <!-- Whether system_update_settings should be shown or not. -->
@@ -32,6 +36,9 @@
     <bool name="config_show_premium_sms">true</bool>
     <!-- Whether exit button in settings' root action bar should be shown or not -->
     <bool name="config_show_settings_root_exit_icon">true</bool>
+    <!-- Class name for the homepage activity alias used in AndroidManifest. -->
+    <string name="config_homepage_activity_alias_name" translatable="false">
+        com.android.car.settings.Settings_Launcher_Homepage</string>
     <!--
         Array of bluetooth device major classes that should be used for unbonded
         device filter.
@@ -113,7 +120,7 @@
         Whether to allow chevrons on top-level preferences when enabled for
         car-ui-lib preferences.
     -->
-    <bool name="config_top_level_enable_chevrons">true</bool>
+    <bool name="config_top_level_enable_chevrons">false</bool>
     <!-- Whether to show top level icon background. When this is set to be true, adjust the value
          for top_level_foreground_icon_inset accordingly. -->
     <bool name="config_show_top_level_icon_background">false</bool>
@@ -193,4 +200,20 @@
 
     <!-- Whether to show the toggle to turn on the sensor privacy for required apps -->
     <bool name="config_show_camera_required_apps_toggle">false</bool>
+
+    <!--
+        The devices that certain debug features should be shown on.
+        Emulators are included by default.
+    -->
+    <string-array name="config_debug_support_devices">
+    </string-array>
+    <!--
+        The devices that certain debug features should be shown on, but the builds on real vehicles
+        should be excluded.
+    -->
+    <string-array name="config_debug_support_devices_exclude_car">
+    </string-array>
+
+    <!-- Smallest pixel value of WIDTH of the window when dual pane should be used -->
+    <integer name="config_activity_embed_split_min_cur_dp">1400</integer>
 </resources>
diff --git a/res/values/dimens.xml b/res/values/dimens.xml
index b1d6d9990..bca995635 100644
--- a/res/values/dimens.xml
+++ b/res/values/dimens.xml
@@ -87,6 +87,7 @@
     <!-- Wifi -->
     <dimen name="hotspot_qr_code_size">256dp</dimen>
     <dimen name="qc_code_preference_margin">@*android:dimen/car_padding_1</dimen>
+    <dimen name="wifi_share_page_margin">@*android:dimen/car_padding_2</dimen>
     <dimen name="card_view_elevation">6dp</dimen>
     <!-- The white area around the actual barcode of the QR code -->
     <dimen name="qr_code_margin">1.5dp</dimen>
@@ -201,10 +202,11 @@
     <dimen name="action_buttons_divider_height">@dimen/divider_preference_height</dimen>
 
     <!-- Top-level menu -->
-    <dimen name="top_level_menu_width">550dp</dimen>
+    <dimen name="top_level_menu_width">549dp</dimen>
     <dimen name="top_level_divider_width">1dp</dimen>
     <dimen name="top_level_preference_min_height">96dp</dimen>
     <dimen name="top_level_preference_corner_radius">24dp</dimen>
+    <dimen name="top_level_preference_title_margin_horizontal">2dp</dimen>
     <dimen name="top_level_recyclerview_margin_right">@*android:dimen/car_padding_2</dimen>
     <dimen name="top_level_foreground_icon_inset">0dp</dimen>
 
@@ -227,4 +229,20 @@
     <dimen name="colored_two_action_switch_preference_margin_end">32dp</dimen>
     <dimen name="colored_two_action_switch_preference_vertical_margin">16dp</dimen>
     <dimen name="colored_two_action_switch_preference_divider_vertical_padding">27dp</dimen>
+
+    <dimen name="radio_with_image_preference_padding_vertical">16dp</dimen>
+    <dimen name="radio_with_image_preference_padding_horizontal">20dp</dimen>
+    <dimen name="radio_with_image_preference_min_width">56dp</dimen>
+    <dimen name="radio_with_image_preference_icon_padding">
+        @dimen/settingslib_illustration_padding
+    </dimen>
+    <dimen name="radio_with_image_preference_icon_max_width">
+        @dimen/settingslib_illustration_width
+    </dimen>
+    <dimen name="radio_with_image_preference_icon_max_height">
+        @dimen/settingslib_illustration_height
+    </dimen>
+
+    <dimen name="aspect_ratio_icon_height">300dp</dimen>
+    <dimen name="aspect_ratio_icon_width">412dp</dimen>
 </resources>
diff --git a/res/values/header_keys.xml b/res/values/header_keys.xml
index 7249166ac..3a2f414e6 100644
--- a/res/values/header_keys.xml
+++ b/res/values/header_keys.xml
@@ -50,6 +50,7 @@
     <string name="hk_AddWifiActivity">@string/pk_network_and_internet_entry</string>
     <string name="hk_WifiPreferencesActivity">@string/pk_network_and_internet_entry</string>
     <string name="hk_ApplicationsDetailsActivity">@string/pk_apps_settings_entry</string>
+    <string name="hk_AppAspectRatioActivity">@string/pk_apps_settings_entry</string>
     <string name="hk_ModifySystemSettingsActivity">@string/pk_apps_settings_entry</string>
     <string name="hk_NotificationAccessActivity">@string/pk_apps_settings_entry</string>
     <string name="hk_PremiumSmsAccessActivity">@string/pk_apps_settings_entry</string>
diff --git a/res/values/overlayable.xml b/res/values/overlayable.xml
index c5ff25248..d142deb8e 100644
--- a/res/values/overlayable.xml
+++ b/res/values/overlayable.xml
@@ -23,6 +23,8 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="anim" name="trans_fade_in"/>
       <item type="anim" name="trans_fade_out"/>
       <item type="array" name="config_allowed_bluetooth_scanning_packages"/>
+      <item type="array" name="config_debug_support_devices"/>
+      <item type="array" name="config_debug_support_devices_exclude_car"/>
       <item type="array" name="config_fixed_notification_access_packages"/>
       <item type="array" name="config_ignore_ux_restrictions"/>
       <item type="array" name="config_ringtone_audio_attribute_usages_map_key"/>
@@ -98,6 +100,9 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="bool" name="config_top_level_injection_background_always_use_default"/>
       <item type="bool" name="config_top_level_injection_enable_summaries"/>
       <item type="bool" name="config_use_custom_pair_device_flow"/>
+      <item type="color" name="aspect_ratio_icon_background_color"/>
+      <item type="color" name="aspect_ratio_icon_inner_line_color"/>
+      <item type="color" name="aspect_ratio_icon_outline_color"/>
       <item type="color" name="bluetooth_bonded_device_background"/>
       <item type="color" name="bluetooth_bonded_device_foreground"/>
       <item type="color" name="bluetooth_bonded_device_icon_color_checked"/>
@@ -175,6 +180,8 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="dimen" name="ap_preference_item_icon_margin_end"/>
       <item type="dimen" name="ap_preference_item_padding_end"/>
       <item type="dimen" name="ap_preference_item_padding_start"/>
+      <item type="dimen" name="aspect_ratio_icon_height"/>
+      <item type="dimen" name="aspect_ratio_icon_width"/>
       <item type="dimen" name="block_by_admin_icon_padding"/>
       <item type="dimen" name="bluetooth_bonded_device_border_width"/>
       <item type="dimen" name="bluetooth_bonded_device_button_radius"/>
@@ -257,6 +264,12 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="dimen" name="progress_bar_preference_progressbar_margin_top"/>
       <item type="dimen" name="qc_code_preference_margin"/>
       <item type="dimen" name="qr_code_margin"/>
+      <item type="dimen" name="radio_with_image_preference_icon_max_height"/>
+      <item type="dimen" name="radio_with_image_preference_icon_max_width"/>
+      <item type="dimen" name="radio_with_image_preference_icon_padding"/>
+      <item type="dimen" name="radio_with_image_preference_min_width"/>
+      <item type="dimen" name="radio_with_image_preference_padding_horizontal"/>
+      <item type="dimen" name="radio_with_image_preference_padding_vertical"/>
       <item type="dimen" name="rounded_corner_radius"/>
       <item type="dimen" name="secondary_icon_size"/>
       <item type="dimen" name="suggestions_action_bar_height"/>
@@ -278,6 +291,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="dimen" name="top_level_divider_width"/>
       <item type="dimen" name="top_level_foreground_icon_inset"/>
       <item type="dimen" name="top_level_menu_width"/>
+      <item type="dimen" name="top_level_preference_title_margin_horizontal"/>
       <item type="dimen" name="top_level_preference_corner_radius"/>
       <item type="dimen" name="top_level_preference_min_height"/>
       <item type="dimen" name="top_level_recyclerview_margin_right"/>
@@ -302,6 +316,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="dimen" name="user_disclaimer_action_button_text_size"/>
       <item type="dimen" name="user_disclaimer_action_button_top_margin"/>
       <item type="dimen" name="user_disclaimer_text_size"/>
+      <item type="dimen" name="wifi_share_page_margin"/>
       <item type="drawable" name="bluetooth_bonded_device_rotary_background"/>
       <item type="drawable" name="brightness_seekbar_background"/>
       <item type="drawable" name="brightness_seekbar_track"/>
@@ -313,6 +328,12 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="drawable" name="circle_ripple_bg"/>
       <item type="drawable" name="color_progress_bar"/>
       <item type="drawable" name="ic_add"/>
+      <item type="drawable" name="ic_app_aspect_ratio_16_9"/>
+      <item type="drawable" name="ic_app_aspect_ratio_3_2"/>
+      <item type="drawable" name="ic_app_aspect_ratio_4_3"/>
+      <item type="drawable" name="ic_app_aspect_ratio_display_size"/>
+      <item type="drawable" name="ic_app_aspect_ratio_fullscreen"/>
+      <item type="drawable" name="ic_app_aspect_ratio_half_screen"/>
       <item type="drawable" name="ic_apps"/>
       <item type="drawable" name="ic_arrow_back"/>
       <item type="drawable" name="ic_arrow_drop_down"/>
@@ -352,6 +373,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="drawable" name="ic_launcher_settings_foreground"/>
       <item type="drawable" name="ic_lock"/>
       <item type="drawable" name="ic_media_stream"/>
+      <item type="drawable" name="ic_open"/>
       <item type="drawable" name="ic_ota_update_current"/>
       <item type="drawable" name="ic_ota_update_none"/>
       <item type="drawable" name="ic_ota_update_stale"/>
@@ -386,6 +408,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="drawable" name="ic_qc_wifi_level_2"/>
       <item type="drawable" name="ic_qc_wifi_level_3"/>
       <item type="drawable" name="ic_qc_wifi_level_4"/>
+      <item type="drawable" name="ic_qr"/>
       <item type="drawable" name="ic_remove_circle"/>
       <item type="drawable" name="ic_restore"/>
       <item type="drawable" name="ic_restricted_wifi_signal_0"/>
@@ -500,6 +523,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="id" name="guideline_start"/>
       <item type="id" name="guideline_top"/>
       <item type="id" name="hint_text"/>
+      <item type="id" name="homepage_activity_wrapper"/>
       <item type="id" name="hotspot_qr_code"/>
       <item type="id" name="hotspot_qr_code_instruction"/>
       <item type="id" name="hotspot_qr_code_password"/>
@@ -554,6 +578,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="id" name="settings_recycler_view"/>
       <item type="id" name="subtitle_text"/>
       <item type="id" name="summary"/>
+      <item type="id" name="summary_container"/>
       <item type="id" name="switch_widget"/>
       <item type="id" name="text"/>
       <item type="id" name="time_picker"/>
@@ -563,12 +588,14 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="id" name="toolbar_menu_item_1"/>
       <item type="id" name="topDivider"/>
       <item type="id" name="top_level_divider"/>
-      <item type="id" name="top_level_menu"/>
       <item type="id" name="top_level_menu_container"/>
       <item type="id" name="top_level_recycler_view"/>
       <item type="id" name="up_arrow_container"/>
       <item type="id" name="vertical_guideline"/>
       <item type="id" name="widget_summary"/>
+      <item type="id" name="wifi_share_instruction"/>
+      <item type="id" name="wifi_share_qr_code"/>
+      <item type="id" name="wifi_share_qr_code_container"/>
       <item type="integer" name="audio_route_selector_usage"/>
       <item type="integer" name="audio_route_toast_duration"/>
       <item type="integer" name="button_max_ems"/>
@@ -577,6 +604,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="integer" name="config_preference_onclick_debounce_ms"/>
       <item type="integer" name="config_qc_bluetooth_device_limit"/>
       <item type="integer" name="config_top_level_icon_shape"/>
+      <item type="integer" name="config_activity_embed_split_min_cur_dp"/>
       <item type="integer" name="content_weight"/>
       <item type="integer" name="data_usage_bytes_threshold_ems"/>
       <item type="integer" name="default_app_safe_icon_size"/>
@@ -615,16 +643,19 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="layout" name="edit_profile_name_fragment"/>
       <item type="layout" name="entity_header_preference"/>
       <item type="layout" name="fallback_home_finishing_boot"/>
+      <item type="layout" name="homepage_activity"/>
       <item type="layout" name="logical_preference_group"/>
       <item type="layout" name="multi_action_preference"/>
       <item type="layout" name="multi_action_preference_toggle_button"/>
       <item type="layout" name="pin_pad_view"/>
       <item type="layout" name="preference_dialog_password_edittext"/>
       <item type="layout" name="preference_settings_icon"/>
+      <item type="layout" name="preference_widget_radiobutton"/>
       <item type="layout" name="preference_wifi_entry"/>
       <item type="layout" name="profile_switcher"/>
       <item type="layout" name="profile_switcher_pod"/>
       <item type="layout" name="progress_bar_preference"/>
+      <item type="layout" name="radio_with_image_preference"/>
       <item type="layout" name="regulatory_info"/>
       <item type="layout" name="settings_preference_fragment"/>
       <item type="layout" name="settings_recyclerview_default"/>
@@ -638,6 +669,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="layout" name="usage_bytes_threshold_picker"/>
       <item type="layout" name="usage_cycle_reset_day_of_month_picker"/>
       <item type="layout" name="usage_indicator_preference"/>
+      <item type="layout" name="wifi_detail_share_fragment"/>
       <item type="layout" name="wifi_tether_qr_code_preference"/>
       <item type="plurals" name="default_camera_app_title"/>
       <item type="plurals" name="default_email_app_title"/>
@@ -686,6 +718,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="alarms_and_reminders_title"/>
       <item type="string" name="all_applications"/>
       <item type="string" name="allow"/>
+      <item type="string" name="app_aspect_ratio_footer"/>
       <item type="string" name="app_data_usage"/>
       <item type="string" name="app_data_usage_allow_data_summary"/>
       <item type="string" name="app_data_usage_allow_data_title"/>
@@ -723,6 +756,8 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="apps_settings_title"/>
       <item type="string" name="apps_special_app_access_summary"/>
       <item type="string" name="apps_view_all_apps_title"/>
+      <item type="string" name="aspect_ratio_action_button"/>
+      <item type="string" name="aspect_ratio_label"/>
       <item type="string" name="assist_access_context_summary"/>
       <item type="string" name="assist_access_context_title"/>
       <item type="string" name="assist_access_screenshot_summary"/>
@@ -861,7 +896,9 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="condition_night_display_title"/>
       <item type="string" name="config_default_screen_reader"/>
       <item type="string" name="config_dev_options_module"/>
-      <item type="string" name="config_homepage_fragment_class"/>
+      <item type="string" name="config_homepage_activity_alias_name"/>
+      <item type="string" name="config_homepage_placeholder_class"/>
+      <item type="string" name="config_homepage_placeholder_preference_key"/>
       <item type="string" name="config_package_installer_package_name"/>
       <item type="string" name="config_settingsintelligence_package_name"/>
       <item type="string" name="confirm_grant_admin"/>
@@ -980,6 +1017,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="domain_urls_summary_one"/>
       <item type="string" name="domain_urls_summary_some"/>
       <item type="string" name="driver_assistance_label"/>
+      <item type="string" name="driving_mode_title"/>
       <item type="string" name="edit_user_name_title"/>
       <item type="string" name="eight"/>
       <item type="string" name="empty_placeholder"/>
@@ -1061,6 +1099,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="hk_AccessibilitySettingsActivity"/>
       <item type="string" name="hk_AddWifiActivity"/>
       <item type="string" name="hk_AlarmsAndRemindersActivity"/>
+      <item type="string" name="hk_AppAspectRatioActivity"/>
       <item type="string" name="hk_ApplicationsDetailsActivity"/>
       <item type="string" name="hk_ApplicationsSettingsActivity"/>
       <item type="string" name="hk_AppsActivity"/>
@@ -1391,8 +1430,10 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="sharing_remote_bugreport_dialog_message"/>
       <item type="string" name="show_captions_toggle_title"/>
       <item type="string" name="show_dev_already"/>
+      <item type="string" name="show_customization_overlay_title"/>
       <item type="string" name="show_dev_countdown"/>
       <item type="string" name="show_dev_on"/>
+      <item type="string" name="show_force_rtl_title"/>
       <item type="string" name="show_layout_bounds_title"/>
       <item type="string" name="show_password"/>
       <item type="string" name="show_system"/>
@@ -1536,6 +1577,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="units_unit_name_watt_hour"/>
       <item type="string" name="units_unit_name_year"/>
       <item type="string" name="units_volume_title"/>
+      <item type="string" name="unsupported_intents_toast_text"/>
       <item type="string" name="unused_apps"/>
       <item type="string" name="unused_apps_summary"/>
       <item type="string" name="unused_apps_switch"/>
@@ -1548,6 +1590,13 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="user_add_user_message_update"/>
       <item type="string" name="user_add_user_title"/>
       <item type="string" name="user_admin"/>
+      <item type="string" name="user_aspect_ratio_16_9"/>
+      <item type="string" name="user_aspect_ratio_3_2"/>
+      <item type="string" name="user_aspect_ratio_4_3"/>
+      <item type="string" name="user_aspect_ratio_app_default"/>
+      <item type="string" name="user_aspect_ratio_device_size"/>
+      <item type="string" name="user_aspect_ratio_fullscreen"/>
+      <item type="string" name="user_aspect_ratio_half_screen"/>
       <item type="string" name="user_cannot_add_accounts_message"/>
       <item type="string" name="user_details_admin_title"/>
       <item type="string" name="user_limit_reached_message"/>
@@ -1585,6 +1634,9 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="string" name="wifi_connecting"/>
       <item type="string" name="wifi_control_description"/>
       <item type="string" name="wifi_control_title"/>
+      <item type="string" name="wifi_detail_share"/>
+      <item type="string" name="wifi_detail_share_description"/>
+      <item type="string" name="wifi_detail_share_toast"/>
       <item type="string" name="wifi_details_ipv6_address_header"/>
       <item type="string" name="wifi_disabled"/>
       <item type="string" name="wifi_disconnected"/>
@@ -1674,6 +1726,7 @@ REGENERATE USING packages/apps/Car/libs/tools/rro/generate-overlayable.py
       <item type="xml" name="account_sync_details_fragment"/>
       <item type="xml" name="add_wifi_fragment"/>
       <item type="xml" name="alarms_and_reminders_fragment"/>
+      <item type="xml" name="app_aspect_ratio_fragment"/>
       <item type="xml" name="app_data_usage_fragment"/>
       <item type="xml" name="app_specific_data_usage_fragment"/>
       <item type="xml" name="app_storage_settings_details_fragment"/>
diff --git a/res/values/preference_keys.xml b/res/values/preference_keys.xml
index 707248139..846813f19 100644
--- a/res/values/preference_keys.xml
+++ b/res/values/preference_keys.xml
@@ -217,6 +217,41 @@
     <string name="pk_application_details_version" translatable="false">
         application_details_version
     </string>
+    <string name="pk_application_aspect_ratio" translatable="false">
+        application_aspect_ratio
+    </string>
+    <string name="pk_app_aspect_ratio_details" translatable="false">
+        application_aspect_ratio_details
+    </string>
+    <string name="pk_app_aspect_ratio_details_action_buttons" translatable="false">
+        application_aspect_ratio_details_action_buttons
+    </string>
+    <string name="pk_app_aspect_ratio_details_group" translatable="false">
+        application_aspect_ratio_details_group
+    </string>
+    <string name="pk_app_aspect_ratio_app_default_pref" translatable="false">
+        app_default_pref
+    </string>
+    <string name="pk_app_aspect_ratio_fullscreen_pref" translatable="false">
+        fullscreen_pref
+    </string>
+    <string name="pk_app_aspect_ratio_half_screen_pref" translatable="false">
+        half_screen_pref
+    </string>
+    <string name="pk_app_aspect_ratio_display_size_pref" translatable="false">
+        display_size_pref
+    </string>
+    <string name="pk_app_aspect_ratio_16_9_pref" translatable="false">
+        16_9_pref
+    </string>
+    <string name="pk_app_aspect_ratio_4_3_pref" translatable="false">
+        4_3_pref
+    </string>
+    <string name="pk_app_aspect_ratio_3_2_pref" translatable="false">
+        3_2_pref
+    </string>
+
+
 
     <!-- Default apps Settings -->
     <string name="pk_default_assist_and_voice" translatable="false">default_assist_and_voice
diff --git a/res/values/preference_screen_keys.xml b/res/values/preference_screen_keys.xml
index dcbfb61bd..f003fe9aa 100644
--- a/res/values/preference_screen_keys.xml
+++ b/res/values/preference_screen_keys.xml
@@ -31,6 +31,7 @@
     <string name="psk_applications_settings" translatable="false">applications_settings_screen</string>
     <string name="psk_apps" translatable="false">apps_screen</string>
     <string name="psk_app_storage_settings_details" translatable="false">app_storage_settings_details_screen</string>
+    <string name="psk_app_aspect_ratio" translatable="false">app_aspect_ratio_screen</string>
     <string name="psk_bluetooth_device_details" translatable="false">bluetooth_device_details_screen</string>
     <string name="psk_bluetooth_device_picker" translatable="false">bluetooth_device_picker_screen</string>
     <string name="psk_bluetooth_pairing_selection" translatable="false">bluetooth_pairing_selection_screen</string>
diff --git a/res/values/strings.xml b/res/values/strings.xml
index 26146c444..10c79b834 100644
--- a/res/values/strings.xml
+++ b/res/values/strings.xml
@@ -379,6 +379,9 @@
     <string name="network_connection_request_dialog_showall">Show all</string>
     <!--Bluetooth settings screen, text that appears in heading bar when scanning for devices -->
     <string name="progress_scanning">Searching</string>
+    <string name="wifi_detail_share">Share</string>
+    <string name="wifi_detail_share_description">Scan this QR code to connect to Wi\u2011Fi</string>
+    <string name="wifi_detail_share_toast">Wi\u2011Fi share is not available for this Wi\u2011Fi.</string>
 
     <!-- Bluetooth settings --><skip/>
     <!-- Title of Connected devices settings pages. [CHAR LIMIT=30] -->
@@ -759,6 +762,26 @@
     </string>
     <!-- Label of a switch preference that controls whether the system will remove the permissions and free up space when the app has not been used for months [CHAR LIMIT=40]-->
     <string name="unused_apps_switch">Remove permissions and free up space</string>
+    <!-- Label for changing an application's aspect ratio setting. This is an experimental setting [CHAR LIMIT=40] -->
+    <string name="aspect_ratio_label">Aspect ratio (Experimental)</string>
+    <!-- Button label for opening the app action [CHAR LIMIT=20] -->
+    <string name="aspect_ratio_action_button">Open</string>
+    <!-- [CHAR LIMIT=NONE] Label for opening the app in app default aspect ratio -->
+    <string name="user_aspect_ratio_app_default">App default</string>
+    <!-- [CHAR LIMIT=NONE] Label for opening the app in fullscreen aspect ratio -->
+    <string name="user_aspect_ratio_fullscreen">Full screen</string>
+    <!-- [CHAR LIMIT=NONE] Label for opening the app in half screen aspect ratio -->
+    <string name="user_aspect_ratio_half_screen">Half screen</string>
+    <!-- [CHAR LIMIT=NONE] Label for opening the app in device display size aspect ratio -->
+    <string name="user_aspect_ratio_device_size">Device aspect ratio</string>
+    <!-- [CHAR LIMIT=NONE] Label for opening the app in 16:9 aspect ratio -->
+    <string name="user_aspect_ratio_16_9">16:9</string>
+    <!-- [CHAR LIMIT=NONE] Label for opening the app in 3:2 aspect ratio -->
+    <string name="user_aspect_ratio_3_2">3:2</string>
+    <!-- [CHAR LIMIT=NONE] Label for opening the app in 4:3 aspect ratio -->
+    <string name="user_aspect_ratio_4_3">4:3</string>
+    <!-- [CHAR LIMIT=NONE] Warning description for app info aspect ratio page -->
+    <string name="app_aspect_ratio_footer">The app will restart when you change aspect ratio. You may lose unsaved changes. Some apps may not be optimized for certain aspect ratios.</string>
     <!-- Application's internal storage size preference summary. [CHAR LIMIT=40] -->
     <string name="storage_type_internal">%s in internal storage</string>
     <!-- Application's prioritize app performance setting summary. [CHAR LIMIT=100] -->
@@ -1921,8 +1944,14 @@
     <string name="qc_bluetooth_on_no_devices_info">To pair a device, open Bluetooth settings</string>
     <!-- UI Mode quick control, control name to change display UI mode (auto/day/night) [CHAR LIMIT=40] -->
     <string name="qc_ui_mode_title">Theme</string>
+    <!-- A quick control entry to control whether to turn on the drive mode [CHAR LIMIT=40] -->
+    <string name="driving_mode_title">Set driving</string>
     <!-- A quick control entry to control whether to show the layout bounds [CHAR LIMIT=40] -->
     <string name="show_layout_bounds_title">Show layout bounds</string>
+    <!-- A quick control entry to control whether to force show the RTL layout direction [CHAR LIMIT=40] -->
+    <string name="show_force_rtl_title">Force RTL layout direction</string>
+    <!-- A quick control entry to control whether the customization overlay is enabled or not [CHAR LIMIT=40] -->
+    <string name="show_customization_overlay_title">Customization overlay</string>
 
 
     <!-- Device Policy Management --><skip/>
@@ -2258,4 +2287,8 @@
     <string name="connectivity_inactive_action_text">See plans</string>
 
     <string name="audio_route_dialog_neutral_button_text">Done</string>
+
+    <!-- Toast message to let the user know that there is no supported function for this intent. [CHAR LIMIT=80]
+    TODO(b/371591484): to update this string when UX finalizes it.-->
+    <string name="unsupported_intents_toast_text">Your vehicle does not support this feature</string>
 </resources>
diff --git a/res/xml/app_aspect_ratio_fragment.xml b/res/xml/app_aspect_ratio_fragment.xml
new file mode 100644
index 000000000..8b3cfe917
--- /dev/null
+++ b/res/xml/app_aspect_ratio_fragment.xml
@@ -0,0 +1,66 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
+                  xmlns:settings="http://schemas.android.com/apk/res-auto"
+                  android:title="@string/aspect_ratio_label"
+                  android:key="@string/psk_app_aspect_ratio">
+    <com.android.car.settings.common.EntityHeaderPreference
+        android:key="@string/pk_app_aspect_ratio_details"
+        settings:controller="com.android.car.settings.applications.ApplicationPreferenceController"
+        settings:searchable="false"/>
+    <com.android.car.settings.common.ActionButtonsPreference
+        android:key="@string/pk_app_aspect_ratio_details_action_buttons"
+        settings:controller="com.android.car.settings.applications.appinfo.AppAspectRatioActionButtonsPreferenceController"
+        settings:searchable="false"/>
+    <com.android.car.settings.common.LogicalPreferenceGroup
+        android:key="@string/pk_app_aspect_ratio_details_group"
+        settings:controller="com.android.car.settings.applications.appinfo.AppAspectRatiosGroupPreferenceController">
+        <com.android.car.settings.common.RadioWithImagePreference
+            android:key="@string/pk_app_aspect_ratio_app_default_pref"
+            android:title="@string/user_aspect_ratio_app_default"/>
+        <com.android.car.settings.common.RadioWithImagePreference
+            android:key="@string/pk_app_aspect_ratio_fullscreen_pref"
+            android:title="@string/user_aspect_ratio_fullscreen"
+            android:icon="@drawable/ic_app_aspect_ratio_fullscreen"/>
+        <com.android.car.settings.common.RadioWithImagePreference
+            android:key="@string/pk_app_aspect_ratio_half_screen_pref"
+            android:title="@string/user_aspect_ratio_half_screen"
+            android:icon="@drawable/ic_app_aspect_ratio_half_screen"/>
+        <com.android.car.settings.common.RadioWithImagePreference
+            android:key="@string/pk_app_aspect_ratio_display_size_pref"
+            android:title="@string/user_aspect_ratio_device_size"
+            android:icon="@drawable/ic_app_aspect_ratio_display_size"/>
+        <com.android.car.settings.common.RadioWithImagePreference
+            android:key="@string/pk_app_aspect_ratio_16_9_pref"
+            android:title="@string/user_aspect_ratio_16_9"
+            android:icon="@drawable/ic_app_aspect_ratio_16_9"/>
+        <com.android.car.settings.common.RadioWithImagePreference
+            android:key="@string/pk_app_aspect_ratio_4_3_pref"
+            android:title="@string/user_aspect_ratio_4_3"
+            android:icon="@drawable/ic_app_aspect_ratio_4_3"/>
+        <com.android.car.settings.common.RadioWithImagePreference
+            android:key="@string/pk_app_aspect_ratio_3_2_pref"
+            android:title="@string/user_aspect_ratio_3_2"
+            android:icon="@drawable/ic_app_aspect_ratio_3_2"/>
+    </com.android.car.settings.common.LogicalPreferenceGroup>
+    <com.android.car.ui.preference.CarUiFooterPreference
+        android:key="@string/pk_auto_local_time_disclaimer"
+        android:summary="@string/app_aspect_ratio_footer"
+        android:icon="@drawable/ic_settings_about"
+        android:selectable="false"/>
+</PreferenceScreen>
diff --git a/res/xml/application_details_fragment.xml b/res/xml/application_details_fragment.xml
index 0932374c9..6745cdeaa 100644
--- a/res/xml/application_details_fragment.xml
+++ b/res/xml/application_details_fragment.xml
@@ -61,4 +61,9 @@
         android:key="@string/pk_application_details_version"
         settings:controller="com.android.car.settings.applications.VersionPreferenceController"
         settings:showChevron="false"/>
+    <Preference
+        android:fragment="com.android.car.settings.applications.appinfo.AppAspectRatioFragment"
+        android:key="@string/pk_application_aspect_ratio"
+        android:title="@string/aspect_ratio_label"
+        settings:controller="com.android.car.settings.applications.appinfo.AppAspectRatioPreferenceController"/>
 </PreferenceScreen>
diff --git a/res/xml/special_access_fragment.xml b/res/xml/special_access_fragment.xml
index 3f1fed0ce..e5a0c2f74 100644
--- a/res/xml/special_access_fragment.xml
+++ b/res/xml/special_access_fragment.xml
@@ -34,7 +34,9 @@
         android:fragment="com.android.car.settings.applications.specialaccess.NotificationAccessFragment"
         android:key="@string/pk_notification_access_entry"
         android:title="@string/notification_access_title"
-        settings:controller="com.android.car.settings.common.DefaultRestrictionsPreferenceController"/>
+        settings:controller="com.android.car.settings.common.DefaultRestrictionsPreferenceController"
+        settings:occupant_front_passenger="read"
+        settings:occupant_rear_passenger="read"/>
     <Preference
         android:fragment="com.android.car.settings.applications.specialaccess.PremiumSmsAccessFragment"
         android:key="@string/pk_premium_sms_access_entry"
diff --git a/src/com/android/car/settings/CarSettingsApplication.java b/src/com/android/car/settings/CarSettingsApplication.java
index 58d5eda9b..c63a8fb4d 100644
--- a/src/com/android/car/settings/CarSettingsApplication.java
+++ b/src/com/android/car/settings/CarSettingsApplication.java
@@ -27,15 +27,30 @@ import android.car.CarOccupantZoneManager.OccupantZoneConfigChangeListener;
 import android.car.CarOccupantZoneManager.OccupantZoneInfo;
 import android.car.media.CarAudioManager;
 import android.car.wifi.CarWifiManager;
+import android.content.BroadcastReceiver;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+import android.content.pm.PackageManager;
+import android.os.UserManager;
 import android.view.Display;
 
 import androidx.annotation.GuardedBy;
+import androidx.annotation.VisibleForTesting;
+
+import com.android.car.settings.activityembedding.ActivityEmbeddingRulesController;
+import com.android.car.settings.activityembedding.ActivityEmbeddingUtils;
+import com.android.car.settings.common.Logger;
+import com.android.car.settings.deeplink.DeepLinkHomepageActivity;
 
 /**
  * Application class for CarSettings.
  */
 public class CarSettingsApplication extends Application {
 
+    public static final String CAR_SETTINGS_PACKAGE_NAME = "com.android.car.settings";
+    private static final Logger LOG = new Logger(CarSettingsApplication.class);
     private CarOccupantZoneManager mCarOccupantZoneManager;
 
     private final Object mInfoLock = new Object();
@@ -96,7 +111,27 @@ public class CarSettingsApplication extends Application {
     @Override
     public void onCreate() {
         super.onCreate();
+        registerCarServiceLifecycleListener();
+        // Register activity embedding only when user is unlocked, which happens after boot has been
+        // completed. This is so that RRO values may be read properly for device configurations that
+        // uses RROs for embedding related configs, which are not available before boot completion.
+        ActivityEmbeddingRulesController controller = new ActivityEmbeddingRulesController(this);
+        if (getApplicationContext().getSystemService(UserManager.class).isUserUnlocked()) {
+            controller.initActivityEmbeddingRules();
+        } else {
+            IntentFilter filter = new IntentFilter(Intent.ACTION_USER_UNLOCKED);
+            getApplicationContext().registerReceiver(new BroadcastReceiver() {
+                @Override
+                public void onReceive(Context context, Intent intent) {
+                    controller.initActivityEmbeddingRules();
+                }
+            }, filter, 0);
+        }
+        updateDeepLinkHomepageActivityEnabledState();
+    }
 
+    @VisibleForTesting
+    void registerCarServiceLifecycleListener() {
         Car.createCar(this, /* handler= */ null , Car.CAR_WAIT_TIMEOUT_WAIT_FOREVER,
                 mCarServiceLifecycleListener);
     }
@@ -166,4 +201,21 @@ public class CarSettingsApplication extends Application {
             }
         }
     }
+
+    /**
+     * Disable {@link DeepLinkHomepageActivity} if ActivityEmbedding is not enabled.
+     */
+    private void updateDeepLinkHomepageActivityEnabledState() {
+        int componentEnabledState = ActivityEmbeddingUtils.isEmbeddingActivityEnabled(this)
+                ? PackageManager.COMPONENT_ENABLED_STATE_ENABLED
+                : PackageManager.COMPONENT_ENABLED_STATE_DISABLED;
+        try {
+            getPackageManager().setComponentEnabledSetting(
+                    /* ComponentName */ new ComponentName(this, DeepLinkHomepageActivity.class),
+                    /* newState */ componentEnabledState,
+                    /* flags */ PackageManager.DONT_KILL_APP);
+        } catch (IllegalArgumentException exception) {
+            LOG.e("Unable to update enabled state for DeepLinkHomepageActivity: " + exception);
+        }
+    }
 }
diff --git a/src/com/android/car/settings/activityembedding/ActivityEmbeddingRulesController.java b/src/com/android/car/settings/activityembedding/ActivityEmbeddingRulesController.java
new file mode 100644
index 000000000..bf2544097
--- /dev/null
+++ b/src/com/android/car/settings/activityembedding/ActivityEmbeddingRulesController.java
@@ -0,0 +1,231 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.activityembedding;
+
+import android.app.Activity;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.provider.Settings;
+
+import androidx.window.embedding.ActivityFilter;
+import androidx.window.embedding.ActivityRule;
+import androidx.window.embedding.EmbeddingAspectRatio;
+import androidx.window.embedding.RuleController;
+import androidx.window.embedding.SplitAttributes;
+import androidx.window.embedding.SplitPairFilter;
+import androidx.window.embedding.SplitPairRule;
+import androidx.window.embedding.SplitPlaceholderRule;
+import androidx.window.embedding.SplitRule;
+
+import com.android.car.settings.applications.managedomainurls.ManageDomainUrlsActivity;
+import com.android.car.settings.common.CarSettingActivities;
+import com.android.car.settings.common.Logger;
+import com.android.car.settings.common.SubSettingsActivity;
+import com.android.car.settings.deeplink.DeepLinkHomepageActivity;
+import com.android.car.settings.enterprise.DeviceAdminAddActivity;
+import com.android.car.settings.enterprise.EnterprisePrivacySettingsActivity;
+import com.android.car.settings.profiles.ProfileSwitcherActivity;
+import com.android.car.settings.security.CheckLockActivity;
+import com.android.car.settings.security.ChooseLockPasswordActivity;
+import com.android.car.settings.security.ChooseLockPatternActivity;
+import com.android.car.settings.security.ChooseLockPinActivity;
+import com.android.car.settings.security.SettingsScreenLockActivity;
+import com.android.car.settings.security.VerifyLockChangeActivity;
+
+import java.util.HashSet;
+import java.util.Set;
+
+/**
+ * Main controller class for registering and updating rules for pane split before launching another
+ * settings activity. */
+public class ActivityEmbeddingRulesController {
+    private final Context mContext;
+    private final RuleController mRuleController;
+    private static final Logger LOG = new Logger(ActivityEmbeddingRulesController.class);
+    private static final ComponentName COMPONENT_NAME_WILDCARD = new ComponentName(
+            /* pkg */ "*", /* cls */ "*");
+
+    public ActivityEmbeddingRulesController(Context context) {
+        mContext = context;
+        mRuleController = RuleController.getInstance(mContext);
+    }
+
+    /**
+     * Registers a new dual pane split rule.
+     *
+     * Method is defined to be static to allow dynamic adding of additional secondary components and
+     * intents when the activity to be embedded is not defined inside CarSettings package.
+     */
+    public static void registerDualPaneSplitRule(Context context,
+            ComponentName primaryComponent,
+            ComponentName secondaryComponent,
+            String secondaryIntentAction,
+            SplitRule.FinishBehavior finishPrimaryWithSecondary,
+            SplitRule.FinishBehavior finishSecondaryWithPrimary,
+            boolean clearTop) {
+        if (!ActivityEmbeddingUtils.isEmbeddingActivityEnabled(context)) {
+            LOG.d("Embedding is not enabled for Settings.");
+            return;
+        }
+        final Set<SplitPairFilter> filters = new HashSet<>();
+        filters.add(new SplitPairFilter(primaryComponent, secondaryComponent,
+                secondaryIntentAction));
+        SplitAttributes attributes = new SplitAttributes.Builder()
+                .setSplitType(SplitAttributes.SplitType.ratio(
+                        ActivityEmbeddingUtils.getSplitRatio(context)))
+                .setLayoutDirection(SplitAttributes.LayoutDirection.LOCALE)
+                .build();
+        SplitPairRule splitPairRule = new SplitPairRule.Builder(filters)
+                .setFinishPrimaryWithSecondary(finishPrimaryWithSecondary)
+                .setFinishSecondaryWithPrimary(finishSecondaryWithPrimary)
+                .setClearTop(clearTop)
+                .setMinWidthDp(
+                        ActivityEmbeddingUtils.getMinCurrentScreenSplitWidthDp(context))
+                .setMinSmallestWidthDp(
+                        ActivityEmbeddingUtils.getMinSmallestScreenSplitWidthDp())
+                .setMaxAspectRatioInPortrait(EmbeddingAspectRatio.ALWAYS_ALLOW)
+                .setDefaultSplitAttributes(attributes)
+                .build();
+        RuleController.getInstance(context).addRule(splitPairRule);
+    }
+    /**
+     * Registers a new dual pane split rule for all instances of Homepage Activity.
+     */
+    public static void registerHomepageDualPaneSplitRule(
+            Context context,
+            ComponentName secondaryComponent,
+            String secondaryIntentAction,
+            boolean clearTop) {
+        registerDualPaneSplitRule(/* context= */ context,
+                /* primaryComponent= */ getComponentName(context,
+                        CarSettingActivities.HomepageActivity.class),
+                /* secondaryComponent= */ secondaryComponent,
+                /* secondaryIntentAction= */ secondaryIntentAction,
+                /* finishPrimaryWithSecondary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* finishSecondaryWithPrimary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* clearTop= */ clearTop);
+        registerDualPaneSplitRule(/* context= */ context,
+                /* primaryComponent= */ getComponentName(context, DeepLinkHomepageActivity.class),
+                /* secondaryComponent= */ secondaryComponent,
+                /* secondaryIntentAction= */ secondaryIntentAction,
+                /* finishPrimaryWithSecondary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* finishSecondaryWithPrimary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* clearTop= */ clearTop);
+        registerDualPaneSplitRule(/* context= */ context,
+                /* primaryComponent= */ getComponentName(context,
+                        ActivityEmbeddingUtils.getHomepageActivityAliasName(context)),
+                /* secondaryComponent= */ secondaryComponent,
+                /* secondaryIntentAction= */ secondaryIntentAction,
+                /* finishPrimaryWithSecondary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* finishSecondaryWithPrimary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* clearTop= */ clearTop);
+    }
+
+    /**
+     * Set up all embedding rules.
+     */
+    public void initActivityEmbeddingRules() {
+        if (!ActivityEmbeddingUtils.isEmbeddingActivityEnabled(mContext)) {
+            LOG.d("Embedding is not enabled for Settings.");
+            return;
+        }
+        mRuleController.clearRules();
+        registerDefaultAlwaysExpandRules();
+        registerHomepagePlaceholderRule();
+        registerSubSettingsActivityPairRule();
+    }
+
+    private void registerDefaultAlwaysExpandRules() {
+        final Set<ActivityFilter> activityFilters = new HashSet<>();
+        ActivityRule activityRule = new ActivityRule.Builder(activityFilters)
+                .setAlwaysExpand(true)
+                .build();
+        addActivityIntentFilter(activityFilters, new Intent(Settings.ACTION_APP_SEARCH_SETTINGS));
+        addActivityClassFilter(activityFilters, ManageDomainUrlsActivity.class);
+        addActivityClassFilter(activityFilters, SettingsScreenLockActivity.class);
+        addActivityClassFilter(activityFilters, CheckLockActivity.class);
+        addActivityClassFilter(activityFilters, VerifyLockChangeActivity.class);
+        addActivityClassFilter(activityFilters, ChooseLockPatternActivity.class);
+        addActivityClassFilter(activityFilters, ChooseLockPinActivity.class);
+        addActivityClassFilter(activityFilters, ChooseLockPasswordActivity.class);
+        addActivityClassFilter(activityFilters, ProfileSwitcherActivity.class);
+        addActivityClassFilter(activityFilters, DeviceAdminAddActivity.class);
+        addActivityClassFilter(activityFilters, EnterprisePrivacySettingsActivity.class);
+        RuleController.getInstance(mContext).addRule(activityRule);
+    }
+
+    /**
+     * Registers placeholders to launch {@link CarSettingActivities.HomepageActivity} and
+     * {@link CarSettingActivities.BluetoothSettingsActivity} together without animation.
+     */
+    private void registerHomepagePlaceholderRule() {
+        final Set<ActivityFilter> activityFilters = new HashSet<>();
+        addActivityClassFilter(activityFilters, CarSettingActivities.HomepageActivity.class);
+        addActivityClassFilter(activityFilters, DeepLinkHomepageActivity.class);
+        activityFilters.add(new ActivityFilter(new ComponentName(mContext,
+                ActivityEmbeddingUtils.getHomepageActivityAliasName(mContext)), null));
+
+        final Intent startUpIntent = ActivityEmbeddingUtils.getPlaceholderIntent(mContext);
+        SplitAttributes attributes = new SplitAttributes.Builder()
+                .setSplitType(SplitAttributes.SplitType.ratio(
+                        ActivityEmbeddingUtils.getSplitRatio(mContext)))
+                .build();
+        final SplitPlaceholderRule placeholderRule = new SplitPlaceholderRule.Builder(
+                activityFilters, startUpIntent)
+                .setMinWidthDp(ActivityEmbeddingUtils.getMinCurrentScreenSplitWidthDp(mContext))
+                .setMinSmallestWidthDp(
+                        ActivityEmbeddingUtils.getMinSmallestScreenSplitWidthDp())
+                .setMaxAspectRatioInPortrait(EmbeddingAspectRatio.ALWAYS_ALLOW)
+                .setSticky(false)
+                .setFinishPrimaryWithPlaceholder(SplitRule.FinishBehavior.ADJACENT)
+                .setDefaultSplitAttributes(attributes)
+                .build();
+
+        mRuleController.addRule(placeholderRule);
+    }
+
+    /**
+     * Registers rule for splitting all {@link SubSettingsActivity} activity to the right of
+     * {@link CarSettingActivities.HomepageActivity}.
+     */
+    private void registerSubSettingsActivityPairRule() {
+        registerHomepageDualPaneSplitRule(/* context= */ mContext,
+                /* secondaryComponent= */ getComponentName(mContext, SubSettingsActivity.class),
+                /* secondaryIntentAction= */ null,
+                /* clearTop= */ true);
+    }
+
+    private static ComponentName getComponentName(
+            Context context, Class<? extends Activity> activityClass) {
+        return getComponentName(context, activityClass.getName());
+    }
+
+    private static ComponentName getComponentName(Context context, String activityClassName) {
+        return new ComponentName(context.getPackageName(), activityClassName);
+    }
+
+    private static void addActivityIntentFilter(Set<ActivityFilter> activityFilters,
+            Intent intent) {
+        activityFilters.add(new ActivityFilter(COMPONENT_NAME_WILDCARD, intent.getAction()));
+    }
+
+    private void addActivityClassFilter(Set<ActivityFilter> activityFilters,
+            Class<? extends Activity> activityClass) {
+        activityFilters.add(new ActivityFilter(new ComponentName(mContext, activityClass), null));
+    }
+}
diff --git a/src/com/android/car/settings/activityembedding/ActivityEmbeddingUtils.java b/src/com/android/car/settings/activityembedding/ActivityEmbeddingUtils.java
new file mode 100644
index 000000000..366902a55
--- /dev/null
+++ b/src/com/android/car/settings/activityembedding/ActivityEmbeddingUtils.java
@@ -0,0 +1,119 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.activityembedding;
+
+import android.app.Activity;
+import android.content.Context;
+import android.content.Intent;
+import android.view.WindowManager;
+
+import androidx.window.embedding.ActivityEmbeddingController;
+import androidx.window.embedding.SplitController;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.Logger;
+/**
+ * Utility class for retrieving Activity Embedding configurations to handle dual-pane layout.
+ */
+public class ActivityEmbeddingUtils {
+    // The smallest value of the smallest-width (sw) of the window in any rotation when
+    // the split should be used.
+    // Without rotation enabled, it is safe to set this number to 0dp;
+    private static final int MIN_SMALLEST_SCREEN_SPLIT_WIDTH_DP = 0;
+
+    private static final Logger LOG = new Logger(ActivityEmbeddingUtils.class);
+
+    private static float sSplitRatio;
+
+    /**
+     * Returns {@code true} if Activity Split API is enabled and CarSettings is
+     * not configured to force single pane.
+     */
+    public static boolean isEmbeddingActivityEnabled(Context context) {
+        boolean isSplitAvailable = SplitController.getInstance(context).getSplitSupportStatus()
+                == SplitController.SplitSupportStatus.SPLIT_AVAILABLE;
+        LOG.d("Is activity split enabled on this device: " + isSplitAvailable);
+        boolean configForceSinglePane = context.getResources().getBoolean(
+                R.bool.config_global_force_single_pane);
+        return isSplitAvailable && !configForceSinglePane;
+    }
+
+    /**
+     * Returns {@code true} if activity embedding is enabled by the system and CarSettings has
+     * activated Activity Embedding based on the current application context.
+     */
+    public static boolean isEmbeddingSplitActivated(Activity activity) {
+        return isEmbeddingActivityEnabled(activity)
+                && ActivityEmbeddingController.getInstance(activity).isActivityEmbedded(activity);
+    }
+
+    /** Get the smallest pixel value of WIDTH of the window when the split should be used. */
+    static int getMinCurrentScreenSplitWidthDp(Context context) {
+        return context.getResources().getInteger(R.integer.config_activity_embed_split_min_cur_dp);
+    }
+
+    /**
+     * Get the smallest pixel value of the SMALLEST-WIDTH (sw) of the window in any rotation when
+     * the split should be used.
+     * Effectively, (sw) is the height in dp when the width > height. Without rotation enabled, it
+     * is safe to set this number to 0dp;
+     */
+    static int getMinSmallestScreenSplitWidthDp() {
+        return MIN_SMALLEST_SCREEN_SPLIT_WIDTH_DP;
+    }
+
+    /**
+     * Returns the ratio of the screen reserved for the left pane of Settings.
+     */
+    static float getSplitRatio(Context context) {
+        if (sSplitRatio == 0) {
+            float homepageWidth = context.getResources().getDimension(R.dimen.top_level_menu_width)
+                    + context.getResources().getDimension(R.dimen.top_level_divider_width);
+            sSplitRatio = homepageWidth / getTaskAreaMaxWindowWidth(context);
+        }
+        return sSplitRatio;
+    }
+
+    /**
+     * Returns the Intent to launch the default activity in dual-pane settings.
+     */
+    public static Intent getPlaceholderIntent(Context context) {
+        return new Intent().setClassName(context.getPackageName(),
+                context.getString(R.string.config_homepage_placeholder_class));
+    }
+
+    /**
+     * Returns the preference key of the default activity dual-pane settings.
+     */
+    public static String getPlaceholderPreferenceHighlightKey(Context context) {
+        return context.getResources().getString(
+                R.string.config_homepage_placeholder_preference_key);
+    }
+
+    /**
+     * Returns the well-formed ComponentName String for the activity-alias for
+     * {@link com.android.car.settings.common.CarSettingActivities.HomepageActivity}.
+     */
+    static String getHomepageActivityAliasName(Context context) {
+        return context.getResources().getString(R.string.config_homepage_activity_alias_name);
+    }
+
+    private static int getTaskAreaMaxWindowWidth(Context context) {
+        WindowManager wm = context.getSystemService(WindowManager.class);
+        return wm.getMaximumWindowMetrics().getBounds().width();
+    }
+}
diff --git a/src/com/android/car/settings/applications/ApplicationDetailsFragment.java b/src/com/android/car/settings/applications/ApplicationDetailsFragment.java
index f3685f2ce..b204bb136 100644
--- a/src/com/android/car/settings/applications/ApplicationDetailsFragment.java
+++ b/src/com/android/car/settings/applications/ApplicationDetailsFragment.java
@@ -26,6 +26,7 @@ import androidx.annotation.XmlRes;
 
 import com.android.car.settings.R;
 import com.android.car.settings.applications.appinfo.AppAllServicesPreferenceController;
+import com.android.car.settings.applications.appinfo.AppAspectRatioPreferenceController;
 import com.android.car.settings.applications.appinfo.HibernationSwitchPreferenceController;
 import com.android.car.settings.common.Logger;
 import com.android.car.settings.common.SettingsFragment;
@@ -95,6 +96,9 @@ public class ApplicationDetailsFragment extends SettingsFragment {
                 .setPackageName(mPackageName);
         use(VersionPreferenceController.class,
                 R.string.pk_application_details_version).setPackageInfo(mPackageInfo);
+        use(AppAspectRatioPreferenceController.class,
+                R.string.pk_application_aspect_ratio)
+                .setApplicationInfo(mAppEntry.info).setPackageName(mPackageName);
     }
 
     private void retrieveAppEntry() {
diff --git a/src/com/android/car/settings/applications/appinfo/AppAspectRatioActionButtonsPreferenceController.java b/src/com/android/car/settings/applications/appinfo/AppAspectRatioActionButtonsPreferenceController.java
new file mode 100644
index 000000000..089fe5b6d
--- /dev/null
+++ b/src/com/android/car/settings/applications/appinfo/AppAspectRatioActionButtonsPreferenceController.java
@@ -0,0 +1,93 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.appinfo;
+
+import static android.content.Intent.FLAG_ACTIVITY_CLEAR_TOP;
+import static android.content.Intent.FLAG_ACTIVITY_NEW_TASK;
+
+import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons.BUTTON1;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.os.UserHandle;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ActionButtonInfo;
+import com.android.car.settings.common.ActionButtonsPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.Logger;
+import com.android.car.settings.common.PreferenceController;
+
+/**
+ * A PreferenceController handling the logic for the action button on the aspect ratio page.
+ */
+public class AppAspectRatioActionButtonsPreferenceController extends
+        PreferenceController<ActionButtonsPreference> {
+    private static final Logger LOG = new Logger(
+            AppAspectRatioActionButtonsPreferenceController.class);
+    private PackageManager mPackageManager;
+    private String mPackageName;
+    private int mUserId;
+    private ActionButtonInfo mOpenApplicationButton;
+
+    public AppAspectRatioActionButtonsPreferenceController(Context context, String preferenceKey,
+            FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+        super(context, preferenceKey, fragmentController, uxRestrictions);
+        mUserId = UserHandle.myUserId();
+        mPackageManager = context.getPackageManager();
+    }
+
+    @Override
+    protected Class<ActionButtonsPreference> getPreferenceType() {
+        return ActionButtonsPreference.class;
+    }
+
+    /**
+     * Set the packageName, which is used to perform actions on a particular package.
+     */
+    public AppAspectRatioActionButtonsPreferenceController setPackageName(String packageName) {
+        mPackageName = packageName;
+        return this;
+    }
+
+    @Override
+    protected void checkInitialized() {
+        if (mPackageName == null) {
+            throw new IllegalStateException(
+                    "PackageName should be set before calling this function");
+        }
+    }
+
+    @Override
+    protected void onCreateInternal() {
+        mOpenApplicationButton = getPreference().getButton(BUTTON1);
+        mOpenApplicationButton
+                .setText(R.string.aspect_ratio_action_button)
+                .setIcon(R.drawable.ic_open)
+                .setOnClickListener(i -> launchApplication());
+    }
+
+    private void launchApplication() {
+        Intent launchIntent = mPackageManager.getLaunchIntentForPackage(mPackageName)
+                .addFlags(FLAG_ACTIVITY_NEW_TASK | FLAG_ACTIVITY_CLEAR_TOP);
+        if (launchIntent != null) {
+            getContext().startActivityAsUser(launchIntent, new UserHandle(mUserId));
+        }
+    }
+}
diff --git a/src/com/android/car/settings/applications/appinfo/AppAspectRatioFragment.java b/src/com/android/car/settings/applications/appinfo/AppAspectRatioFragment.java
new file mode 100644
index 000000000..9fe30b3dc
--- /dev/null
+++ b/src/com/android/car/settings/applications/appinfo/AppAspectRatioFragment.java
@@ -0,0 +1,77 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.appinfo;
+
+import android.content.Context;
+import android.os.Bundle;
+import android.os.UserHandle;
+
+import com.android.car.settings.R;
+import com.android.car.settings.applications.ApplicationPreferenceController;
+import com.android.car.settings.common.Logger;
+import com.android.car.settings.common.SettingsFragment;
+import com.android.settingslib.applications.ApplicationsState;
+
+/**
+ * Shows aspect ratio selections for an application.
+ */
+public class AppAspectRatioFragment extends SettingsFragment {
+
+    private static final Logger LOG = new Logger(AppAspectRatioFragment.class);
+
+    private static final String EXTRA_PACKAGE_NAME = "aspect_ratio_package_name";
+
+    private String mPackageName;
+
+    // Application state info
+    private ApplicationsState.AppEntry mAppEntry;
+    private ApplicationsState mAppState;
+
+    /** Creates an instance of this fragment, passing packageName as an argument. */
+    public static AppAspectRatioFragment getInstance(String packageName) {
+        AppAspectRatioFragment appAspectRatioFragment =
+                new AppAspectRatioFragment();
+        Bundle bundle = new Bundle();
+        bundle.putString(EXTRA_PACKAGE_NAME, packageName);
+        appAspectRatioFragment.setArguments(bundle);
+        return appAspectRatioFragment;
+    }
+
+    @Override
+    protected int getPreferenceScreenResId() {
+        return R.xml.app_aspect_ratio_fragment;
+    }
+
+    @Override
+    public void onAttach(Context context) {
+        super.onAttach(context);
+        int userId = UserHandle.myUserId();
+        mPackageName = getArguments().getString(EXTRA_PACKAGE_NAME);
+        mAppState = ApplicationsState.getInstance(requireActivity().getApplication());
+        mAppEntry = mAppState.getEntry(mPackageName, userId);
+
+        use(ApplicationPreferenceController.class,
+                R.string.pk_app_aspect_ratio_details)
+                .setAppEntry(mAppEntry).setAppState(mAppState);
+        use(AppAspectRatioActionButtonsPreferenceController.class,
+                R.string.pk_app_aspect_ratio_details_action_buttons)
+                .setPackageName(mPackageName);
+        use(AppAspectRatiosGroupPreferenceController.class,
+                R.string.pk_app_aspect_ratio_details_group)
+                .setPackageName(mPackageName);
+    }
+}
diff --git a/src/com/android/car/settings/applications/appinfo/AppAspectRatioPreferenceController.java b/src/com/android/car/settings/applications/appinfo/AppAspectRatioPreferenceController.java
new file mode 100644
index 000000000..28aff77ab
--- /dev/null
+++ b/src/com/android/car/settings/applications/appinfo/AppAspectRatioPreferenceController.java
@@ -0,0 +1,81 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.appinfo;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.Logger;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.ui.preference.CarUiPreference;
+
+/**
+ * A PreferenceController handling the logic for setting an app's aspect ratio
+ */
+public final class AppAspectRatioPreferenceController extends
+        PreferenceController<CarUiPreference> {
+    private static final Logger LOG = new Logger(AppAspectRatioPreferenceController.class);
+    private static final String PACKAGE_UI_SCHEME = "package:";
+    private ApplicationInfo mApplicationInfo;
+    private AspectRatioManager mAspectRatioManager;
+    private String mPackageName;
+
+    public AppAspectRatioPreferenceController(Context context, String preferenceKey,
+            FragmentController fragmentController,
+            CarUxRestrictions uxRestrictions) {
+        super(context, preferenceKey, fragmentController, uxRestrictions);
+        mAspectRatioManager = new AspectRatioManager(context);
+    }
+
+    @Override
+    protected Class<CarUiPreference> getPreferenceType() {
+        return CarUiPreference.class;
+    }
+
+    @Override
+    public int getDefaultAvailabilityStatus() {
+        return mAspectRatioManager.shouldShowAspectRatioSettingsForApp(mApplicationInfo)
+                ? AVAILABLE : UNSUPPORTED_ON_DEVICE;
+    }
+
+    /**
+     * Set the ApplicationInfo associated with this setting.
+     *
+     * @param applicationInfo The applicationInfo of the app to change aspect ratio.
+     */
+    public AppAspectRatioPreferenceController setApplicationInfo(ApplicationInfo applicationInfo) {
+        mApplicationInfo = applicationInfo;
+        return this;
+    }
+
+    /**
+     * Set the packageName, which is used to perform actions on a particular package.
+     */
+    public AppAspectRatioPreferenceController setPackageName(String packageName) {
+        mPackageName = packageName;
+        return this;
+    }
+
+    @Override
+    protected boolean handlePreferenceClicked(CarUiPreference preference) {
+        getFragmentController().launchFragment(
+                AppAspectRatioFragment.getInstance(mPackageName));
+        return true;
+    }
+}
diff --git a/src/com/android/car/settings/applications/appinfo/AppAspectRatiosGroupPreferenceController.java b/src/com/android/car/settings/applications/appinfo/AppAspectRatiosGroupPreferenceController.java
new file mode 100644
index 000000000..337056b24
--- /dev/null
+++ b/src/com/android/car/settings/applications/appinfo/AppAspectRatiosGroupPreferenceController.java
@@ -0,0 +1,142 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.appinfo;
+
+import static android.content.pm.PackageManager.USER_MIN_ASPECT_RATIO_APP_DEFAULT;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.os.RemoteException;
+import android.os.UserHandle;
+
+import androidx.preference.PreferenceGroup;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.Logger;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.RadioWithImagePreference;
+import com.android.internal.annotations.VisibleForTesting;
+
+import com.google.common.collect.BiMap;
+import com.google.common.collect.ImmutableBiMap;
+
+import java.util.ArrayList;
+import java.util.List;
+
+/**
+ * A PreferenceController handling the logic for selecting an aspect ratio.
+ */
+public class AppAspectRatiosGroupPreferenceController extends
+        PreferenceController<PreferenceGroup> implements RadioWithImagePreference.OnClickListener {
+    private static final Logger LOG = new Logger(AppAspectRatiosGroupPreferenceController.class);
+    private static final String KEY_PREF_DEFAULT = "app_default_pref";
+    private static final String KEY_PREF_FULLSCREEN = "fullscreen_pref";
+    private static final String KEY_PREF_HALF_SCREEN = "half_screen_pref";
+    private static final String KEY_PREF_DISPLAY_SIZE = "display_size_pref";
+    private static final String KEY_PREF_16_9 = "16_9_pref";
+    private static final String KEY_PREF_4_3 = "4_3_pref";
+    private static final String KEY_PREF_3_2 = "3_2_pref";
+    private static final String KEY_ASPECT_RATIO_UNSET = "aspect_ratio_unset";
+    private static final BiMap<String, Integer> KEY_TO_ASPECT_RATIO_MAP = ImmutableBiMap.of(
+            KEY_PREF_DEFAULT, PackageManager.USER_MIN_ASPECT_RATIO_APP_DEFAULT,
+            KEY_PREF_FULLSCREEN, PackageManager.USER_MIN_ASPECT_RATIO_FULLSCREEN,
+            KEY_PREF_HALF_SCREEN, PackageManager.USER_MIN_ASPECT_RATIO_SPLIT_SCREEN,
+            KEY_PREF_DISPLAY_SIZE, PackageManager.USER_MIN_ASPECT_RATIO_DISPLAY_SIZE,
+            KEY_PREF_4_3, PackageManager.USER_MIN_ASPECT_RATIO_4_3,
+            KEY_PREF_16_9, PackageManager.USER_MIN_ASPECT_RATIO_16_9,
+            KEY_PREF_3_2, PackageManager.USER_MIN_ASPECT_RATIO_3_2,
+            KEY_ASPECT_RATIO_UNSET, PackageManager.USER_MIN_ASPECT_RATIO_UNSET
+    );
+    private List<RadioWithImagePreference> mPreferenceList;
+    private String mSelectedKey = KEY_PREF_DEFAULT;
+    private String mPackageName;
+    private int mUserId;
+    private AspectRatioManager mAspectRatioManager;
+
+    public AppAspectRatiosGroupPreferenceController(Context context, String preferenceKey,
+            FragmentController fragmentController, CarUxRestrictions restrictionInfo) {
+        super(context, preferenceKey, fragmentController, restrictionInfo);
+        mPreferenceList = new ArrayList<>();
+        mUserId = UserHandle.myUserId();
+        mAspectRatioManager = new AspectRatioManager(context);
+    }
+
+    /**
+     * Set the packageName, which is used to perform actions on a particular package.
+     */
+    public AppAspectRatiosGroupPreferenceController setPackageName(String packageName) {
+        mPackageName = packageName;
+        return this;
+    }
+
+    @Override
+    protected Class<PreferenceGroup> getPreferenceType() {
+        return PreferenceGroup.class;
+    }
+
+    @Override
+    protected void onCreateInternal() {
+        int currentAspectRatio = PackageManager.USER_MIN_ASPECT_RATIO_UNSET;
+        try {
+            currentAspectRatio = mAspectRatioManager.getUserMinAspectRatioValue(mPackageName,
+                    mUserId);
+        } catch (RemoteException e) {
+            LOG.d("There is an exception when trying to get the current aspect ratio: " + e);
+        }
+        mSelectedKey = KEY_TO_ASPECT_RATIO_MAP.inverse()
+                .getOrDefault(currentAspectRatio, KEY_ASPECT_RATIO_UNSET);
+        for (int i = 0; i < getPreference().getPreferenceCount(); i++) {
+            RadioWithImagePreference child =
+                    (RadioWithImagePreference) getPreference().getPreference(i);
+            mPreferenceList.add(child);
+            child.setOnClickListener(this);
+        }
+    }
+
+    @Override
+    protected void updateState(PreferenceGroup preference) {
+        super.updateState(preference);
+        for (RadioWithImagePreference child : mPreferenceList) {
+            child.setChecked(child.getKey().equals(mSelectedKey));
+        }
+    }
+
+    @Override
+    public void onRadioButtonClicked(RadioWithImagePreference selected) {
+        String selectedKey = selected.getKey();
+        if (selectedKey.equals(mSelectedKey)) {
+            return;
+        }
+        int userAspectRatio = KEY_TO_ASPECT_RATIO_MAP.getOrDefault(selectedKey,
+                USER_MIN_ASPECT_RATIO_APP_DEFAULT);
+
+        try {
+            getAspectRatioManager().setUserMinAspectRatio(mPackageName, mUserId, userAspectRatio);
+            mSelectedKey = selectedKey;
+        } catch (RemoteException e) {
+            LOG.e("Unable to set user min aspect ratio");
+            return;
+        }
+        updateState(getPreference());
+    }
+
+    @VisibleForTesting
+    AspectRatioManager getAspectRatioManager() {
+        return mAspectRatioManager;
+    }
+}
diff --git a/src/com/android/car/settings/applications/appinfo/AspectRatioManager.java b/src/com/android/car/settings/applications/appinfo/AspectRatioManager.java
new file mode 100644
index 000000000..56b8f99f6
--- /dev/null
+++ b/src/com/android/car/settings/applications/appinfo/AspectRatioManager.java
@@ -0,0 +1,136 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.appinfo;
+
+import static android.os.UserHandle.getUserHandleForUid;
+import static android.view.WindowManager.PROPERTY_COMPAT_ALLOW_USER_ASPECT_RATIO_OVERRIDE;
+
+import android.app.ActivityManager;
+import android.app.AppGlobals;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.IPackageManager;
+import android.content.pm.LauncherApps;
+import android.content.pm.PackageManager;
+import android.os.RemoteException;
+import android.provider.DeviceConfig;
+
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+
+import com.android.car.settings.common.Logger;
+
+/**
+ * Manager for handling app aspect ratio override behavior
+ */
+public final class AspectRatioManager {
+    private static final Logger LOG = new Logger(AspectRatioManager.class);
+    private static final boolean DEFAULT_VALUE_ENABLE_USER_ASPECT_RATIO_SETTINGS = true;
+    private static final String KEY_ENABLE_USER_ASPECT_RATIO_SETTINGS =
+            "enable_app_compat_aspect_ratio_user_settings";
+
+    private final Context mContext;
+    private final IPackageManager mIPm;
+    private final ActivityManager mActivityManager;
+
+    public AspectRatioManager(Context context) {
+        mContext = context;
+        mIPm = AppGlobals.getPackageManager();
+        mActivityManager = mContext.getSystemService(ActivityManager.class);
+    }
+
+    /** Determines whether an app should have aspect ratio settings */
+    public boolean shouldShowAspectRatioSettingsForApp(ApplicationInfo appInfo) {
+        if (appInfo == null) {
+            return false;
+        }
+
+        return isFeatureEnabled() && canDisplayAspectRatioUi(appInfo);
+    }
+
+    /**
+     * @return {@link PackageManager.UserMinAspectRatio} override for an app
+     */
+    @PackageManager.UserMinAspectRatio
+    public int getUserMinAspectRatioValue(@NonNull String packageName, int uid)
+            throws RemoteException {
+        int aspectRatio = mIPm.getUserMinAspectRatio(packageName, uid);
+        return aspectRatio;
+    }
+
+    /**
+     * Sets user-specified {@link PackageManager.UserMinAspectRatio} override for an app
+     */
+    public void setUserMinAspectRatio(@NonNull String packageName, int uid,
+            @PackageManager.UserMinAspectRatio int aspectRatio) throws RemoteException {
+        mIPm.setUserMinAspectRatio(packageName, uid, aspectRatio);
+        stopApp(packageName);
+    }
+
+    private void stopApp(@NonNull String packageName) {
+        mActivityManager.forceStopPackage(packageName);
+    }
+
+    /**
+     * Whether user aspect ratio settings is enabled for device.
+     */
+    private boolean isFeatureEnabled() {
+        final boolean isBuildTimeFlagEnabled = mContext.getResources().getBoolean(
+                com.android.internal.R.bool.config_appCompatUserAppAspectRatioSettingsIsEnabled);
+        return getValueFromDeviceConfig(KEY_ENABLE_USER_ASPECT_RATIO_SETTINGS,
+                DEFAULT_VALUE_ENABLE_USER_ASPECT_RATIO_SETTINGS) && isBuildTimeFlagEnabled;
+    }
+
+    private boolean getValueFromDeviceConfig(String name, boolean defaultValue) {
+        return DeviceConfig.getBoolean(DeviceConfig.NAMESPACE_WINDOW_MANAGER, name, defaultValue);
+    }
+
+    /**
+     * Whether an app's aspect ratio can be overridden by user. Only apps with launcher entry
+     * will be overridable.
+     */
+    private boolean canDisplayAspectRatioUi(@NonNull ApplicationInfo appInfo) {
+        Boolean appAllowsUserAspectRatioOverride = readComponentProperty(
+                mContext.getPackageManager(), appInfo.packageName,
+                PROPERTY_COMPAT_ALLOW_USER_ASPECT_RATIO_OVERRIDE);
+        return !(Boolean.FALSE.equals(appAllowsUserAspectRatioOverride))
+                && hasLauncherEntry(appInfo);
+    }
+
+    private boolean hasLauncherEntry(@NonNull ApplicationInfo app) {
+        LauncherApps launcherApps = mContext.getSystemService(LauncherApps.class);
+        if (launcherApps == null) {
+            return false;
+        }
+
+        return !launcherApps
+                .getActivityList(app.packageName, getUserHandleForUid(app.uid))
+                .isEmpty();
+    }
+
+    @Nullable
+    private static Boolean readComponentProperty(PackageManager pm, String packageName,
+            String propertyName) {
+        try {
+            return pm.getProperty(propertyName, packageName).getBoolean();
+        } catch (PackageManager.NameNotFoundException e) {
+            LOG.e("Error getting property " + propertyName + " for package: " + packageName + " "
+                    + e);
+        }
+        return null;
+    }
+}
diff --git a/src/com/android/car/settings/common/BaseCarSettingsActivity.java b/src/com/android/car/settings/common/BaseCarSettingsActivity.java
index 625fc5695..4b64f7b8c 100644
--- a/src/com/android/car/settings/common/BaseCarSettingsActivity.java
+++ b/src/com/android/car/settings/common/BaseCarSettingsActivity.java
@@ -16,27 +16,23 @@
 
 package com.android.car.settings.common;
 
-import static android.view.View.GONE;
-import static android.view.ViewGroup.FOCUS_BEFORE_DESCENDANTS;
-import static android.view.ViewGroup.FOCUS_BLOCK_DESCENDANTS;
-import static android.view.accessibility.AccessibilityNodeInfo.ACTION_FOCUS;
+import static android.view.ViewGroup.LayoutParams.MATCH_PARENT;
+
+import static com.android.car.settings.deeplink.DeepLinkHomepageActivity.EXTRA_TARGET_SECONDARY_CONTAINER;
+import static com.android.car.settings.deeplink.DeepLinkHomepageActivity.convertToDeepLinkHomepageIntent;
 
 import android.car.drivingstate.CarUxRestrictions;
-import android.car.drivingstate.CarUxRestrictionsManager;
 import android.car.drivingstate.CarUxRestrictionsManager.OnUxRestrictionsChangedListener;
-import android.content.Context;
+import android.content.ComponentName;
 import android.content.Intent;
 import android.content.pm.ActivityInfo;
 import android.content.pm.PackageManager;
 import android.os.Bundle;
-import android.provider.Settings;
 import android.view.View;
-import android.view.ViewGroup;
-import android.view.ViewTreeObserver;
 import android.view.inputmethod.InputMethodManager;
+import android.widget.FrameLayout;
 import android.widget.Toast;
 
-import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.fragment.app.DialogFragment;
 import androidx.fragment.app.Fragment;
@@ -47,18 +43,14 @@ import androidx.preference.PreferenceFragmentCompat;
 
 import com.android.car.apps.common.util.Themes;
 import com.android.car.settings.R;
-import com.android.car.settings.common.rotary.SettingsFocusParkingView;
+import com.android.car.settings.activityembedding.ActivityEmbeddingUtils;
 import com.android.car.ui.baselayout.Insets;
 import com.android.car.ui.baselayout.InsetsChangedListener;
 import com.android.car.ui.core.CarUi;
-import com.android.car.ui.toolbar.MenuItem;
 import com.android.car.ui.toolbar.NavButtonMode;
 import com.android.car.ui.toolbar.ToolbarController;
 import com.android.settingslib.core.lifecycle.HideNonSystemOverlayMixin;
 
-import java.util.Collections;
-import java.util.List;
-
 /**
  * Base activity class for car settings, provides a action bar with a back button that goes to
  * previous activity.
@@ -84,21 +76,13 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
     public static final String META_DATA_KEY_SINGLE_PANE = "com.android.car.settings.SINGLE_PANE";
 
     private static final Logger LOG = new Logger(BaseCarSettingsActivity.class);
-    private static final int SEARCH_REQUEST_CODE = 501;
-    private static final String KEY_HAS_NEW_INTENT = "key_has_new_intent";
-
-    private boolean mHasNewIntent = true;
-    private boolean mHasInitialFocus = false;
-    private boolean mIsInitialFragmentTransaction = true;
 
     private String mTopLevelHeaderKey;
     private boolean mIsSinglePane;
 
-    private ToolbarController mGlobalToolbar;
-    private ToolbarController mMiniToolbar;
+    private ToolbarController mToolbar;
 
     private CarUxRestrictionsHelper mUxRestrictionsHelper;
-    private ViewGroup mFragmentContainer;
     private View mRestrictedMessage;
     // Default to minimum restriction.
     private CarUxRestrictions mCarUxRestrictions = new CarUxRestrictions.Builder(
@@ -107,80 +91,121 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
             /* timestamp= */ 0
     ).build();
 
-    private ViewTreeObserver.OnGlobalLayoutListener mGlobalLayoutListener;
-    private final ViewTreeObserver.OnGlobalFocusChangeListener mFocusChangeListener =
-            (oldFocus, newFocus) -> {
-                if (oldFocus instanceof SettingsFocusParkingView) {
-                    // Focus is manually shifted away from the SettingsFocusParkingView.
-                    // Therefore, the focus should no longer shift upon global layout.
-                    removeGlobalLayoutListener();
-                }
-                if (newFocus instanceof SettingsFocusParkingView && mGlobalLayoutListener == null) {
-                    // Attempting to shift focus to the SettingsFocusParkingView without a layout
-                    // listener is not allowed, since it can cause undermined focus behavior
-                    // in these rare edge cases.
-                    requestTopLevelMenuFocus();
-                }
-
-                // This will maintain focus in the content pane if a view goes from
-                // focusable -> unfocusable.
-                if (oldFocus == null && mHasInitialFocus) {
-                    requestContentPaneFocus();
-                } else {
-                    mHasInitialFocus = true;
-                }
-            };
-
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
-        getLifecycle().addObserver(new HideNonSystemOverlayMixin(this));
-        if (savedInstanceState != null) {
-            mHasNewIntent = savedInstanceState.getBoolean(KEY_HAS_NEW_INTENT, mHasNewIntent);
-        }
         populateMetaData();
-        setContentView(R.layout.car_setting_activity);
-        mFragmentContainer = findViewById(R.id.fragment_container);
+        // When dual-pane is enabled, all activity-filter Intents into Settings should be relaunched
+        // into the secondary container with the exception of HomepageActivity.
+        // For any instance of BaseCarSettingsActivity, if its start-up Intent meets the conditions
+        // for deep link, trampoline it and restart the activity on the secondary container.
+        if (shouldUseSecondaryPaneForActivity()) {
+            startActivity(convertToDeepLinkHomepageIntent(getIntent()));
+            finish();
+            return;
+        }
+        getLifecycle().addObserver(new HideNonSystemOverlayMixin(this));
+        setContentView(this instanceof CarSettingActivities.HomepageActivity
+                ? R.layout.homepage_activity : R.layout.car_setting_activity);
 
         // We do this so that the insets are not automatically sent to the fragments.
         // The fragments have their own insets handled by the installBaseLayoutAround() method.
         CarUi.replaceInsetsChangedListenerWith(this, this);
 
-        setUpToolbars();
+        setUpToolbarAndDivider();
         getSupportFragmentManager().addOnBackStackChangedListener(this);
         mRestrictedMessage = findViewById(R.id.restricted_message);
-
-        if (mHasNewIntent) {
-            launchIfDifferent(getInitialFragment());
-            mHasNewIntent = false;
-        } else if (!mIsSinglePane) {
-            updateMiniToolbarState();
-        }
         mUxRestrictionsHelper = new CarUxRestrictionsHelper(/* context= */ this, /* listener= */
                 this);
 
-        if (shouldFocusContentOnLaunch()) {
-            requestContentPaneFocus();
-            mHasInitialFocus = true;
-        } else {
-            requestTopLevelMenuFocus();
-        }
-        setUpFocusChangeListener(true);
-        hideFocusParkingViewIfNeeded();
+        handleNewIntent(getIntent());
     }
 
     @Override
-    protected void onSaveInstanceState(@NonNull Bundle outState) {
-        super.onSaveInstanceState(outState);
-        outState.putBoolean(KEY_HAS_NEW_INTENT, mHasNewIntent);
+    protected void onNewIntent(Intent intent) {
+        super.onNewIntent(intent);
+        handleNewIntent(intent);
+    }
+
+    /**
+     * Handles when an intent being processed by this class, and should be called every time a new
+     * {@code Intent} is received by this Activity, including during {@link #onCreate(Bundle)}
+     * when this Activity first starts, and during subsequent calls to {@link #onNewIntent(Intent)}.
+     */
+    protected void handleNewIntent(Intent intent) {
+        launchIfDifferent(getInitialFragment());
+    }
+
+    private boolean shouldUseSecondaryPaneForActivity() {
+        if (!ActivityEmbeddingUtils.isEmbeddingActivityEnabled(this)) {
+            return false;
+        }
+        // Homepage and deeplink activity should never be hosted on the secondary pane.
+        if (this instanceof CarSettingActivities.HomepageActivity) {
+            return false;
+        }
+        // All deeplink intents are received via intent-filter so getAction must not be null.
+        // Only starts trampoline for deep link intents. Should return false for all the cases that
+        // CarSettings app starts a SubSettingsActivity.
+        if (getIntent().getAction() == null) {
+            return false;
+        }
+        // If the activity's launch mode is "singleInstance", it can't be embedded in Settings since
+        // it will always be created in a new task.
+        ActivityInfo info = getIntent().resolveActivityInfo(getPackageManager(),
+                PackageManager.MATCH_DEFAULT_ONLY);
+        if (info.launchMode == ActivityInfo.LAUNCH_SINGLE_INSTANCE) {
+            return false;
+        }
+        // If the activity metadata is configured to be single pane, it should be directly shown.
+        info = getActivityInfo(getPackageManager(), getComponentName());
+        if (info != null && info.metaData != null
+                && info.metaData.getBoolean(META_DATA_KEY_SINGLE_PANE, false)) {
+            return false;
+        }
+        // This intent has already been restarted as deeplink intent, or was launched by another
+        // activity already embedded on the secondary pane.
+        if (getIntent().getBooleanExtra(EXTRA_TARGET_SECONDARY_CONTAINER, false)) {
+            return false;
+        }
+        return true;
+    }
+
+    private void populateMetaData() {
+        ActivityInfo ai = getActivityInfo(getPackageManager(), getComponentName());
+        mIsSinglePane = !ActivityEmbeddingUtils.isEmbeddingSplitActivated(this);
+        if (ai != null && ai.metaData != null) {
+            setTopLevelHeaderKey(ai.metaData.getString(META_DATA_KEY_HEADER_KEY));
+            mIsSinglePane = ai.metaData.getBoolean(META_DATA_KEY_SINGLE_PANE, mIsSinglePane);
+        }
+    }
+
+    protected String getTopLevelHeaderKey() {
+        return mTopLevelHeaderKey;
+    }
+
+    protected void setTopLevelHeaderKey(@Nullable String key) {
+        mTopLevelHeaderKey = key;
+    }
+
+    private void launchIfDifferent(Fragment newFragment) {
+        Fragment currentFragment = getCurrentFragment();
+        if ((newFragment != null) && differentFragment(newFragment, currentFragment)) {
+            updateFragmentContainer(newFragment);
+        }
+    }
+
+    private boolean differentFragment(Fragment newFragment, Fragment currentFragment) {
+        return (currentFragment == null)
+                || (!currentFragment.getClass().equals(newFragment.getClass()));
     }
 
     @Override
     public void onDestroy() {
-        setUpFocusChangeListener(false);
-        removeGlobalLayoutListener();
-        mUxRestrictionsHelper.destroy();
-        mUxRestrictionsHelper = null;
+        if (mUxRestrictionsHelper != null) {
+            mUxRestrictionsHelper.destroy();
+            mUxRestrictionsHelper = null;
+        }
         super.onDestroy();
     }
 
@@ -210,16 +235,16 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
             throw new IllegalArgumentException(
                     "cannot launch dialogs with launchFragment() - use showDialog() instead");
         }
-
-        if (mIsSinglePane) {
-            Intent intent = SubSettingsActivity.newInstance(/* context= */ this, fragment);
-            startActivity(intent);
+        if (mIsSinglePane || this instanceof SubSettingsActivity) {
+            updateFragmentContainer(fragment);
         } else {
-            launchFragmentInternal(fragment);
+            Intent intent = SubSettingsActivity.newInstance(this, fragment);
+            setIntent(intent);
+            startActivity(intent);
         }
     }
 
-    protected void launchFragmentInternal(Fragment fragment) {
+    protected void updateFragmentContainer(Fragment fragment) {
         getSupportFragmentManager()
                 .beginTransaction()
                 .setCustomAnimations(
@@ -231,7 +256,7 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
                                 android.R.attr.fragmentCloseEnterAnimation),
                         Themes.getAttrResourceId(/* context= */ this,
                                 android.R.attr.fragmentCloseExitAnimation))
-                .replace(R.id.fragment_container, fragment,
+                .replace(getFragmentContainerId(), fragment,
                         Integer.toString(getSupportFragmentManager().getBackStackEntryCount()))
                 .addToBackStack(null)
                 .commit();
@@ -249,10 +274,7 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
 
     @Override
     public ToolbarController getToolbar() {
-        if (mIsSinglePane) {
-            return mGlobalToolbar;
-        }
-        return mMiniToolbar;
+        return mToolbar;
     }
 
     @Override
@@ -266,16 +288,6 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
                     .onUxRestrictionsChanged(restrictionInfo);
         }
         updateBlockingView(currentFragment);
-
-        if (!mIsSinglePane) {
-            // Update restrictions for top level menu (if present).
-            Fragment topLevelMenu =
-                    getSupportFragmentManager().findFragmentById(R.id.top_level_menu);
-            if (topLevelMenu instanceof CarUxRestrictionsManager.OnUxRestrictionsChangedListener) {
-                ((CarUxRestrictionsManager.OnUxRestrictionsChangedListener) topLevelMenu)
-                        .onUxRestrictionsChanged(restrictionInfo);
-            }
-        }
     }
 
     @Override
@@ -286,12 +298,6 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
     @Override
     public void onBackStackChanged() {
         onUxRestrictionsChanged(getCarUxRestrictions());
-        if (!mIsSinglePane) {
-            if (mHasInitialFocus && shouldFocusContentOnBackstackChange()) {
-                requestContentPaneFocus();
-            }
-            updateMiniToolbarState();
-        }
     }
 
     @Override
@@ -318,37 +324,14 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
     protected abstract Fragment getInitialFragment();
 
     protected Fragment getCurrentFragment() {
-        return getSupportFragmentManager().findFragmentById(R.id.fragment_container);
+        return getSupportFragmentManager().findFragmentById(getFragmentContainerId());
     }
 
-    /**
-     * Returns whether the content pane should get focus initially when in dual-pane configuration.
-     */
-    protected boolean shouldFocusContentOnLaunch() {
-        return true;
+    private int getFragmentContainerId() {
+        return this instanceof CarSettingActivities.HomepageActivity
+                ? R.id.top_level_menu_container : R.id.fragment_container;
     }
 
-    private void launchIfDifferent(Fragment newFragment) {
-        Fragment currentFragment = getCurrentFragment();
-        if ((newFragment != null) && differentFragment(newFragment, currentFragment)) {
-            LOG.d("launchIfDifferent: " + newFragment + " replacing " + currentFragment);
-            launchFragmentInternal(newFragment);
-        }
-    }
-
-    /**
-     * Returns {code true} if newFragment is different from current fragment.
-     */
-    private boolean differentFragment(Fragment newFragment, Fragment currentFragment) {
-        return (currentFragment == null)
-                || (!currentFragment.getClass().equals(newFragment.getClass()));
-    }
-
-    private void hideKeyboard() {
-        InputMethodManager imm = (InputMethodManager) this.getSystemService(
-                Context.INPUT_METHOD_SERVICE);
-        imm.hideSoftInputFromWindow(getWindow().getDecorView().getWindowToken(), 0);
-    }
 
     private void updateBlockingView(@Nullable Fragment currentFragment) {
         if (mRestrictedMessage == null) {
@@ -357,208 +340,44 @@ public abstract class BaseCarSettingsActivity extends FragmentActivity implement
         if (currentFragment instanceof BaseFragment
                 && !((BaseFragment) currentFragment).canBeShown(mCarUxRestrictions)) {
             mRestrictedMessage.setVisibility(View.VISIBLE);
-            mFragmentContainer.setDescendantFocusability(FOCUS_BLOCK_DESCENDANTS);
-            mFragmentContainer.clearFocus();
             hideKeyboard();
         } else {
             mRestrictedMessage.setVisibility(View.GONE);
-            mFragmentContainer.setDescendantFocusability(FOCUS_BEFORE_DESCENDANTS);
         }
     }
 
-    private void populateMetaData() {
-        try {
-            ActivityInfo ai = getPackageManager().getActivityInfo(getComponentName(),
-                    PackageManager.GET_META_DATA);
-            if (ai == null || ai.metaData == null) {
-                mIsSinglePane = getResources().getBoolean(R.bool.config_global_force_single_pane);
-                return;
-            }
-            mTopLevelHeaderKey = ai.metaData.getString(META_DATA_KEY_HEADER_KEY);
-            mIsSinglePane = ai.metaData.getBoolean(META_DATA_KEY_SINGLE_PANE,
-                    getResources().getBoolean(R.bool.config_global_force_single_pane));
-        } catch (PackageManager.NameNotFoundException e) {
-            LOG.w("Unable to find package", e);
-        }
+    private void hideKeyboard() {
+        InputMethodManager imm = getSystemService(InputMethodManager.class);
+        imm.hideSoftInputFromWindow(getWindow().getDecorView().getWindowToken(), 0);
     }
 
-    private void setUpToolbars() {
-        View globalToolbarWrappedView = mIsSinglePane ? findViewById(
-                R.id.fragment_container_wrapper) : findViewById(R.id.top_level_menu_container);
-        mGlobalToolbar = CarUi.installBaseLayoutAround(
-                globalToolbarWrappedView,
-                insets -> globalToolbarWrappedView.setPadding(
-                        insets.getLeft(), insets.getTop(), insets.getRight(),
-                        insets.getBottom()), /* hasToolbar= */ true);
-        if (mIsSinglePane) {
-            mGlobalToolbar.setNavButtonMode(NavButtonMode.BACK);
-            findViewById(R.id.top_level_menu_container).setVisibility(View.GONE);
+    private void setUpToolbarAndDivider() {
+        boolean isHomepageActivity = this instanceof CarSettingActivities.HomepageActivity;
+        if (isHomepageActivity && !ActivityEmbeddingUtils.isEmbeddingSplitActivated(this)) {
+            findViewById(R.id.top_level_menu_container).setLayoutParams(
+                    new FrameLayout.LayoutParams(MATCH_PARENT, MATCH_PARENT));
             findViewById(R.id.top_level_divider).setVisibility(View.GONE);
-            return;
         }
-        mMiniToolbar = CarUi.installBaseLayoutAround(
-                findViewById(R.id.fragment_container_wrapper),
-                insets -> findViewById(R.id.fragment_container_wrapper).setPadding(
+        View globalToolbarWrappedView = findViewById(isHomepageActivity
+                ? R.id.top_level_menu_container : R.id.fragment_container_wrapper);
+        mToolbar = CarUi.installBaseLayoutAround(
+                globalToolbarWrappedView,
+                insets -> globalToolbarWrappedView.setPadding(
                         insets.getLeft(), insets.getTop(), insets.getRight(),
                         insets.getBottom()), /* hasToolbar= */ true);
-
-        MenuItem searchButton = new MenuItem.Builder(this)
-                .setToSearch()
-                .setOnClickListener(i -> onSearchButtonClicked())
-                .setUxRestrictions(CarUxRestrictions.UX_RESTRICTIONS_NO_KEYBOARD)
-                .setId(R.id.toolbar_menu_item_0)
-                .build();
-        List<MenuItem> items = Collections.singletonList(searchButton);
-
-        mGlobalToolbar.setTitle(R.string.settings_label);
-        mGlobalToolbar.setNavButtonMode(NavButtonMode.DISABLED);
-        mGlobalToolbar.setLogo(R.drawable.ic_launcher_settings);
-        mGlobalToolbar.setMenuItems(items);
+        mToolbar.setNavButtonMode(NavButtonMode.BACK);
     }
 
-    private void updateMiniToolbarState() {
-        if (mMiniToolbar == null) {
-            return;
-        }
-        if (getSupportFragmentManager().getBackStackEntryCount() > 1 || !isTaskRoot()) {
-            mMiniToolbar.setNavButtonMode(NavButtonMode.BACK);
-        } else {
-            mMiniToolbar.setNavButtonMode(NavButtonMode.DISABLED);
-        }
-    }
-
-    private void hideFocusParkingViewIfNeeded() {
-        if (mIsSinglePane) {
-            findViewById(R.id.settings_focus_parking_view).setVisibility(GONE);
-        }
-    }
-
-    private void setUpFocusChangeListener(boolean enable) {
-        if (mIsSinglePane) {
-            // The focus change listener is only needed with two panes.
-            return;
-        }
-        ViewTreeObserver observer = findViewById(
-                R.id.car_settings_activity_wrapper).getViewTreeObserver();
-        if (enable) {
-            observer.addOnGlobalFocusChangeListener(mFocusChangeListener);
-        } else {
-            observer.removeOnGlobalFocusChangeListener(mFocusChangeListener);
-        }
-    }
-
-    private void requestTopLevelMenuFocus() {
-        if (mIsSinglePane) {
-            return;
-        }
-        Fragment topLevelMenu = getSupportFragmentManager().findFragmentById(R.id.top_level_menu);
-        if (topLevelMenu == null) {
-            return;
-        }
-        View fragmentView = topLevelMenu.getView();
-        if (fragmentView == null) {
-            return;
-        }
-        View focusArea = fragmentView.findViewById(R.id.settings_car_ui_focus_area);
-        if (focusArea == null) {
-            return;
-        }
-        removeGlobalLayoutListener();
-        mGlobalLayoutListener = () -> {
-            if (focusArea.isInTouchMode() || focusArea.hasFocus()) {
-                return;
-            }
-            focusArea.performAccessibilityAction(ACTION_FOCUS, /* arguments= */ null);
-            removeGlobalLayoutListener();
-        };
-        fragmentView.getViewTreeObserver().addOnGlobalLayoutListener(mGlobalLayoutListener);
-    }
-
-    private void requestContentPaneFocus() {
-        if (mIsSinglePane) {
-            return;
-        }
-        if (getCurrentFragment() == null) {
-            return;
-        }
-        View fragmentView = getCurrentFragment().getView();
-        if (fragmentView == null) {
-            return;
-        }
-        removeGlobalLayoutListener();
-        if (fragmentView.isInTouchMode()) {
-            mHasInitialFocus = false;
-            return;
-        }
-        View focusArea = fragmentView.findViewById(R.id.settings_car_ui_focus_area);
-
-        if (focusArea == null) {
-            focusArea = fragmentView.findViewById(R.id.settings_content_focus_area);
-            if (focusArea == null) {
-                return;
-            }
-        }
-        removeGlobalLayoutListener();
-        View finalFocusArea = focusArea; // required to be effectively final for inner class access
-        mGlobalLayoutListener = () -> {
-            if (finalFocusArea.isInTouchMode() || finalFocusArea.hasFocus()) {
-                return;
-            }
-            boolean success = finalFocusArea.performAccessibilityAction(
-                    ACTION_FOCUS, /* arguments= */ null);
-            if (success) {
-                removeGlobalLayoutListener();
-            } else {
-                findViewById(
-                        R.id.settings_focus_parking_view).performAccessibilityAction(
-                        ACTION_FOCUS, /* arguments= */ null);
-            }
-        };
-        fragmentView.getViewTreeObserver().addOnGlobalLayoutListener(mGlobalLayoutListener);
-    }
-
-    private boolean shouldFocusContentOnBackstackChange() {
-        // We don't want to reset mHasInitialFocus when initial fragment is added
-        if (mIsInitialFragmentTransaction && getInitialFragment() != null) {
-            mIsInitialFragmentTransaction = false;
-            return false;
-        }
-
-        return true;
-    }
-
-    private void removeGlobalLayoutListener() {
-        if (mGlobalLayoutListener == null) {
-            return;
-        }
-
-        // Check content pane
-        Fragment contentFragment = getCurrentFragment();
-        if (contentFragment != null && contentFragment.getView() != null) {
-            contentFragment.getView().getViewTreeObserver()
-                    .removeOnGlobalLayoutListener(mGlobalLayoutListener);
-        }
-
-        // Check top level menu
-        Fragment topLevelMenu = getSupportFragmentManager().findFragmentById(R.id.top_level_menu);
-        if (topLevelMenu != null && topLevelMenu.getView() != null) {
-            topLevelMenu.getView().getViewTreeObserver()
-                    .removeOnGlobalLayoutListener(mGlobalLayoutListener);
-        }
-
-        mGlobalLayoutListener = null;
-    }
-
-    private void onSearchButtonClicked() {
-        Intent intent = new Intent(Settings.ACTION_APP_SEARCH_SETTINGS)
-                .setPackage(getSettingsIntelligencePkgName());
-        if (intent.resolveActivity(getPackageManager()) == null) {
-            return;
+    /**
+     * Returns the ActivityInfo of the given componentName.
+     */
+    @Nullable
+    public ActivityInfo getActivityInfo(PackageManager pm, ComponentName componentName) {
+        try {
+            return pm.getActivityInfo(componentName, PackageManager.GET_META_DATA);
+        } catch (PackageManager.NameNotFoundException e) {
+            LOG.w("Unable to find package", e);
         }
-        startActivityForResult(intent, SEARCH_REQUEST_CODE);
-    }
-
-    private String getSettingsIntelligencePkgName() {
-        return getString(R.string.config_settingsintelligence_package_name);
+        return null;
     }
 }
diff --git a/src/com/android/car/settings/common/BuildInfoUtil.java b/src/com/android/car/settings/common/BuildInfoUtil.java
new file mode 100644
index 000000000..e1381757e
--- /dev/null
+++ b/src/com/android/car/settings/common/BuildInfoUtil.java
@@ -0,0 +1,108 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import android.car.Car;
+import android.car.VehicleAreaType;
+import android.car.VehiclePropertyIds;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+import android.os.Build;
+import android.text.TextUtils;
+
+import androidx.annotation.ArrayRes;
+
+import com.android.car.settings.R;
+
+import java.util.Set;
+
+/**
+ * Contains utility functions for build info.
+ */
+// TODO(b/371116800): move this class to car-apps-common library
+public class BuildInfoUtil {
+
+    private BuildInfoUtil() {
+    }
+
+    /**
+     * Returns true for builds that are for testing for developers.
+     */
+    public static boolean isDevTesting(Context context) {
+        return (Build.IS_ENG || Build.IS_USERDEBUG) && isSupportedBenchOrEmulator(context);
+    }
+
+    /**
+     * Returns true for builds that are on benches or emulators.
+     */
+    public static boolean isSupportedBenchOrEmulator(Context context) {
+        return isEmulator() || isSupportedDebugDevice(context) || isSupportedDebugDeviceExcludeCar(
+                context);
+    }
+
+    private static boolean isEmulator() {
+        return Build.IS_EMULATOR;
+    }
+
+    private static boolean isSupportedDebugDevice(Context context) {
+        return isDebugDeviceIncluded(context, R.array.config_debug_support_devices);
+    }
+
+    private static boolean isDebugDeviceIncluded(Context context, @ArrayRes int resId) {
+        Set<String> supportedDevices = Set.of(context.getResources().getStringArray(resId));
+        return supportedDevices.contains(Build.DEVICE);
+    }
+
+    private static boolean isSupportedDebugDeviceExcludeCar(Context context) {
+        return isDebugDeviceIncluded(context, R.array.config_debug_support_devices_exclude_car)
+                && !isRealCar(context);
+
+    }
+
+    /**
+     * Please make sure the VIN numbers on the benches are reset before using this function,
+     * follow the instructions in b/267517048.
+     */
+    private static boolean isRealCar(Context context) {
+        Car car = Car.createCar(context);
+        CarPropertyManager carPropertyManager = null;
+        if (car != null) {
+            carPropertyManager = (CarPropertyManager) car.getCarManager(Car.PROPERTY_SERVICE);
+        }
+        if (carPropertyManager != null) {
+            try {
+                CarPropertyValue carPropertyValue = carPropertyManager.getProperty(
+                        VehiclePropertyIds.INFO_VIN, VehicleAreaType.VEHICLE_AREA_TYPE_GLOBAL);
+                if (carPropertyValue != null && carPropertyValue.getPropertyStatus()
+                        == CarPropertyValue.STATUS_AVAILABLE) {
+                    if (TextUtils.isDigitsOnly((CharSequence) carPropertyValue.getValue())) {
+                        return Long.valueOf((String) carPropertyValue.getValue()) != 0;
+                    } else {
+                        return true;
+                    }
+                }
+            } catch (Exception e) {
+                // For the situations where there are exceptions, the status of the device is
+                // uncertain, so it will be treated as a real car in order to avoid showing the
+                // debug only features.
+                return true;
+            }
+        }
+        return false;
+    }
+}
diff --git a/src/com/android/car/settings/common/CarSettingActivities.java b/src/com/android/car/settings/common/CarSettingActivities.java
index d412096d8..9fa6187c4 100644
--- a/src/com/android/car/settings/common/CarSettingActivities.java
+++ b/src/com/android/car/settings/common/CarSettingActivities.java
@@ -26,13 +26,14 @@ import android.text.TextUtils;
 
 import androidx.fragment.app.Fragment;
 
-import com.android.car.settings.R;
 import com.android.car.settings.accessibility.AccessibilitySettingsFragment;
 import com.android.car.settings.accessibility.CaptionsSettingsFragment;
 import com.android.car.settings.accounts.ChooseAccountFragment;
+import com.android.car.settings.activityembedding.ActivityEmbeddingUtils;
 import com.android.car.settings.applications.ApplicationDetailsFragment;
 import com.android.car.settings.applications.ApplicationsSettingsFragment;
 import com.android.car.settings.applications.AppsFragment;
+import com.android.car.settings.applications.appinfo.AppAspectRatioFragment;
 import com.android.car.settings.applications.assist.AssistantAndVoiceFragment;
 import com.android.car.settings.applications.defaultapps.DefaultAutofillPickerFragment;
 import com.android.car.settings.applications.specialaccess.AlarmsAndReminderFragment;
@@ -82,23 +83,51 @@ public class CarSettingActivities {
      * Homepage Activity.
      */
     public static class HomepageActivity extends BaseCarSettingsActivity {
+        @Override
+        protected void onCreate(Bundle savedInstanceState) {
+            super.onCreate(savedInstanceState);
+            if (!isTaskRoot()) {
+                // When HomepageActivity is not launched as task root, such as via ACTION_SETTINGS,
+                // the placeholder will not be activated.
+                // In the DeepLinkHomepageActivity case, if the intent comes from another app, the
+                // host app may not have been configured as trusted embedding host, thus launching
+                // the activity without activating embeddings.
+                Intent intent = new Intent(getIntent()).setPackage(getPackageName()).addFlags(
+                        Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_FORWARD_RESULT);
+                startActivity(intent);
+                finish();
+            }
+        }
+
+        @Override
+        protected void onNewIntent(Intent intent) {
+            super.onNewIntent(intent);
+            // Because HomepageActivity is a singleTask activity, after onCreate has already been
+            // called, additional Intents will not call onCreate() again.
+            // Call setIntent() so that they may be processed during onResume()
+            setIntent(intent);
+        }
+
+        @Override
+        protected void handleNewIntent(Intent intent) {
+            super.handleNewIntent(intent);
+            if (intent.getAction() != null && (intent.getAction().equals(Intent.ACTION_MAIN)
+                    || intent.getAction().equals(Settings.ACTION_SETTINGS))) {
+                setTopLevelHeaderKey(
+                        ActivityEmbeddingUtils.getPlaceholderPreferenceHighlightKey(this));
+            }
+        }
+
         @Nullable
         @Override
         protected Fragment getInitialFragment() {
             try {
-                return getSupportFragmentManager().getFragmentFactory().instantiate(
-                        getClassLoader(), getString(R.string.config_homepage_fragment_class));
+                return new TopLevelMenuFragment();
             } catch (Fragment.InstantiationException e) {
                 LOG.e("Unable to instantiate homepage fragment", e);
                 return null;
             }
         }
-
-        @Override
-        protected boolean shouldFocusContentOnLaunch() {
-            // Focus should stay with the top-level menu for the HomepageActivity.
-            return false;
-        }
     }
 
     // Homepage sub-sections
@@ -459,6 +488,28 @@ public class CarSettingActivities {
         }
     }
 
+    /**
+     * App aspect ratio Activity.
+     */
+    public static class AppAspectRatioActivity extends BaseCarSettingsActivity {
+        @Nullable
+        @Override
+        protected Fragment getInitialFragment() {
+            Intent intent = getIntent();
+            String pkg = intent.getStringExtra(Settings.EXTRA_APP_PACKAGE);
+            if (TextUtils.isEmpty(pkg)) {
+                LOG.w("No package provided for application detailed intent");
+                Uri uri = intent.getData();
+                if (uri == null) {
+                    LOG.w("No uri provided for application detailed intent");
+                    return null;
+                }
+                pkg = uri.getSchemeSpecificPart();
+            }
+            return AppAspectRatioFragment.getInstance(pkg);
+        }
+    }
+
     // Special app access sub-section
 
     /**
diff --git a/src/com/android/car/settings/common/DataSubscriptionStatsLogHelper.java b/src/com/android/car/settings/common/DataSubscriptionStatsLogHelper.java
new file mode 100644
index 000000000..f90324213
--- /dev/null
+++ b/src/com/android/car/settings/common/DataSubscriptionStatsLogHelper.java
@@ -0,0 +1,58 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import android.os.Build;
+import android.util.Log;
+
+import com.android.car.settings.CarSettingsStatsLog;
+
+
+/**
+ * Helper class that directly interacts with {@link CarSettingsStatsLog}, a generated class that
+ * contains logging methods for MobileDataRow and MobileNetworkEntryPreferenceController.
+ */
+public class DataSubscriptionStatsLogHelper {
+    private static final String TAG = DataSubscriptionStatsLogHelper.class.getSimpleName();
+    private static DataSubscriptionStatsLogHelper sInstance;
+
+    /**
+     * Returns the current logging instance of DataSubscriptionStatsLogHelper to write this devices'
+     *  CarSettingsStatsLog.
+     *
+     * @return the logging instance of DataSubscriptionStatsLogHelper.
+     */
+    public static DataSubscriptionStatsLogHelper getInstance() {
+        if (sInstance == null) {
+            sInstance = new DataSubscriptionStatsLogHelper();
+        }
+        return sInstance;
+    }
+
+    /**
+     * Writes to CarSettingsDataSubscriptionEventReported atom with {@code launchType}
+     * as the only field,
+     *
+     */
+    public void writeDataSubscriptionEventReported() {
+        if (Build.isDebuggable()) {
+            Log.v(TAG, "writing CAR_SETTINGS_DATA_SUBSCRIPTION_EVENT_REPORTED.");
+        }
+        CarSettingsStatsLog.write(
+                /* atomId */ CarSettingsStatsLog.CAR_SETTINGS_DATA_SUBSCRIPTION_EVENT_REPORTED);
+    }
+}
diff --git a/src/com/android/car/settings/common/ExtraSettingsLoader.java b/src/com/android/car/settings/common/ExtraSettingsLoader.java
index 4192e5191..48200191e 100644
--- a/src/com/android/car/settings/common/ExtraSettingsLoader.java
+++ b/src/com/android/car/settings/common/ExtraSettingsLoader.java
@@ -42,11 +42,13 @@ import androidx.annotation.VisibleForTesting;
 import androidx.preference.Preference;
 
 import com.android.car.settings.R;
+import com.android.car.settings.activityembedding.ActivityEmbeddingRulesController;
 import com.android.car.ui.preference.CarUiPreference;
 import com.android.settingslib.drawer.TileUtils;
 
 import java.util.LinkedHashMap;
 import java.util.List;
+import java.util.Locale;
 import java.util.Map;
 import java.util.Set;
 import java.util.stream.Collectors;
@@ -56,7 +58,7 @@ import java.util.stream.Collectors;
  */
 // TODO: investigate using SettingsLib Tiles.
 public class ExtraSettingsLoader {
-    static final String META_DATA_PREFERENCE_IS_TOP_LEVEL = "injectedTopLevelPreference";
+    static final String META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS = "injectedTopLevelPreference";
     private static final Logger LOG = new Logger(ExtraSettingsLoader.class);
     private static final String META_DATA_PREFERENCE_CATEGORY = "com.android.settings.category";
     private final Context mContext;
@@ -166,7 +168,8 @@ public class ExtraSettingsLoader {
                 category = CATEGORY_DEVICE;
             }
             boolean isTopLevel = mTopLevelCategories.contains(category);
-            metaData.putBoolean(META_DATA_PREFERENCE_IS_TOP_LEVEL, isTopLevel);
+            metaData.putBoolean(META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS, isTopLevel);
+
             Drawable icon = ExtraSettingsUtil.createIcon(mContext, metaData,
                     activityInfo.packageName);
 
@@ -181,6 +184,8 @@ public class ExtraSettingsLoader {
                     summary = null;
                     metaData.remove(META_DATA_PREFERENCE_SUMMARY_URI);
                 }
+                key = key != null ? key : getTopLevelPreferenceKey(title);
+                registerDualPaneSplitRule(extraSettingIntent, activityInfo.launchMode);
             } else {
                 preference = new CarUiPreference(mContext);
             }
@@ -198,6 +203,12 @@ public class ExtraSettingsLoader {
         return mPreferenceBundleMap;
     }
 
+    private String getTopLevelPreferenceKey(CharSequence preferenceTitle) {
+        return new String("top_level_extra_settings_preference_" + preferenceTitle + "_entry")
+                .replace(" ", "_")
+                .toLowerCase(Locale.ROOT);
+    }
+
     /**
      * Extracts the value in the metadata specified by the key.
      * If it is resource, resolve the string and return. Otherwise, return the string itself.
@@ -223,4 +234,21 @@ public class ExtraSettingsLoader {
             originalList.add(newResolveInfo);
         }
     }
+
+    /**
+     * Registers {@link ActivityEmbeddingRulesController#registerHomepageDualPaneSplitRule} for all
+     * top level extra settings preference as these activities should all finish along with the
+     * {@link CarSettingActivities.HomepageActivity} on back press.
+     */
+    private void registerDualPaneSplitRule(Intent extraSettingIntent, int launchMode) {
+        // Single instance activities may create new tasks if they already exist in the back of
+        // current task stack. Settings clearTop to true will bring those activities behind Settings
+        // rather than to the foreground.
+        boolean clearTop = (launchMode != ActivityInfo.LAUNCH_SINGLE_INSTANCE)
+                && (launchMode != ActivityInfo.LAUNCH_SINGLE_INSTANCE_PER_TASK);
+        ActivityEmbeddingRulesController.registerHomepageDualPaneSplitRule(/* context= */ mContext,
+                /* secondaryComponent= */ extraSettingIntent.getComponent(),
+                /* secondaryIntentAction= */ extraSettingIntent.getAction(),
+                /* clearTop= */ clearTop);
+    }
 }
diff --git a/src/com/android/car/settings/common/ExtraSettingsPreferenceController.java b/src/com/android/car/settings/common/ExtraSettingsPreferenceController.java
index 7373cd7f1..59e088742 100644
--- a/src/com/android/car/settings/common/ExtraSettingsPreferenceController.java
+++ b/src/com/android/car/settings/common/ExtraSettingsPreferenceController.java
@@ -16,6 +16,7 @@
 
 package com.android.car.settings.common;
 
+import static com.android.car.settings.common.ExtraSettingsLoader.META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS;
 import static com.android.settingslib.drawer.SwitchesProvider.METHOD_GET_DYNAMIC_SUMMARY;
 import static com.android.settingslib.drawer.SwitchesProvider.METHOD_GET_DYNAMIC_TITLE;
 import static com.android.settingslib.drawer.SwitchesProvider.METHOD_GET_PROVIDER_ICON;
@@ -158,18 +159,25 @@ public class ExtraSettingsPreferenceController extends PreferenceController<Pref
      * Adds the extra settings from the system based on the intent that is passed in the preference
      * group. All the preferences that resolve these intents will be added in the preference group.
      *
+     * For preferences added to top the level, add a preference key so that it can be highlighted by
+     * {@link TopLevelMenuFragment#requestPreferenceHighlight} on user click. If the fragment should
+     * also be embedded, we must try to split them to the secondary container.
+     *
      * @param preferenceBundleMap a map of {@link Preference} and {@link Bundle} representing
      * settings injected from system apps and their metadata.
      */
     protected void addExtraSettings(Map<Preference, Bundle> preferenceBundleMap) {
         for (Preference setting : preferenceBundleMap.keySet()) {
             Bundle metaData = preferenceBundleMap.get(setting);
-            boolean distractionOptimized = false;
-            if (metaData.containsKey(META_DATA_DISTRACTION_OPTIMIZED)) {
-                distractionOptimized =
-                        metaData.getBoolean(META_DATA_DISTRACTION_OPTIMIZED);
-            }
-            setting.getExtras().putBoolean(META_DATA_DISTRACTION_OPTIMIZED, distractionOptimized);
+
+            boolean isDistractionOptimized = metaData.getBoolean(META_DATA_DISTRACTION_OPTIMIZED,
+                    /* defaultValue= */ false);
+            setting.getExtras().putBoolean(META_DATA_DISTRACTION_OPTIMIZED, isDistractionOptimized);
+
+            boolean isTopLevel = metaData.getBoolean(META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS,
+                    /* defaultValue= */ false);
+            setting.getExtras().putBoolean(META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS, isTopLevel);
+
             getDynamicData(setting, metaData);
             getPreference().addPreference(setting);
         }
diff --git a/src/com/android/car/settings/common/ExtraSettingsUtil.java b/src/com/android/car/settings/common/ExtraSettingsUtil.java
index 55a33f3a0..0a05f04e7 100644
--- a/src/com/android/car/settings/common/ExtraSettingsUtil.java
+++ b/src/com/android/car/settings/common/ExtraSettingsUtil.java
@@ -16,7 +16,7 @@
 
 package com.android.car.settings.common;
 
-import static com.android.car.settings.common.ExtraSettingsLoader.META_DATA_PREFERENCE_IS_TOP_LEVEL;
+import static com.android.car.settings.common.ExtraSettingsLoader.META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_TINTABLE;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_URI;
@@ -74,7 +74,7 @@ public class ExtraSettingsUtil {
         if (icon == null) {
             return null;
         }
-        if (metaData.getBoolean(META_DATA_PREFERENCE_IS_TOP_LEVEL, /* defaultValue= */ false)) {
+        if (metaData.getBoolean(META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS, /* defaultValue= */ false)) {
             icon.mutate().setTintList(
                     context.getColorStateList(R.color.top_level_injected_icon_default));
             icon = new TopLevelIcon(context, icon, R.dimen.top_level_foreground_icon_inset);
diff --git a/src/com/android/car/settings/common/HighlightablePreferenceGroupAdapter.java b/src/com/android/car/settings/common/HighlightablePreferenceGroupAdapter.java
index 1a9610de4..1ab21eb9b 100644
--- a/src/com/android/car/settings/common/HighlightablePreferenceGroupAdapter.java
+++ b/src/com/android/car/settings/common/HighlightablePreferenceGroupAdapter.java
@@ -85,10 +85,12 @@ public class HighlightablePreferenceGroupAdapter extends PreferenceGroupAdapter
         }
         root.post(() -> {
             recyclerView.scrollToPosition(position);
-            int oldPosition = mHighlightPosition;
-            mHighlightPosition = position;
-            notifyItemChanged(oldPosition);
-            notifyItemChanged(position);
+            if (position != mHighlightPosition) {
+                int oldPosition = mHighlightPosition;
+                mHighlightPosition = position;
+                notifyItemChanged(oldPosition);
+                notifyItemChanged(position);
+            }
         });
     }
 
diff --git a/src/com/android/car/settings/common/RadioWithImagePreference.java b/src/com/android/car/settings/common/RadioWithImagePreference.java
new file mode 100644
index 000000000..719aa6685
--- /dev/null
+++ b/src/com/android/car/settings/common/RadioWithImagePreference.java
@@ -0,0 +1,134 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import android.content.Context;
+import android.text.TextUtils;
+import android.util.AttributeSet;
+import android.view.View;
+
+import androidx.preference.CheckBoxPreference;
+import androidx.preference.PreferenceViewHolder;
+
+import com.android.car.settings.R;
+
+/**
+ * Radio button preference with image at the bottom.
+ *
+ * <p>Layout should stay the same as
+ * {@link com.android.settingslib.widget.SelectorWithWidgetPreference} for consistency.
+ */
+public class RadioWithImagePreference extends CheckBoxPreference {
+
+    /**
+     * Interface definition for a callback to be invoked when the preference is clicked.
+     */
+    public interface OnClickListener {
+        /**
+         * Called when a preference has been clicked.
+         *
+         * @param emiter The clicked preference
+         */
+        void onRadioButtonClicked(RadioWithImagePreference emiter);
+    }
+
+    private OnClickListener mListener = null;
+
+    /**
+     * Performs inflation from XML and apply a class-specific base style.
+     *
+     * @param context  The {@link Context} this is associated with, through which it can
+     *                 access the current theme, resources, {@link SharedPreferences}, etc.
+     * @param attrs    The attributes of the XML tag that is inflating the preference
+     * @param defStyle An attribute in the current theme that contains a reference to a style
+     *                 resource that supplies default values for the view. Can be 0 to not
+     *                 look for defaults.
+     */
+    public RadioWithImagePreference(Context context, AttributeSet attrs, int defStyle) {
+        super(context, attrs, defStyle);
+        init();
+    }
+
+    /**
+     * Performs inflation from XML and apply a class-specific base style.
+     *
+     * @param context The {@link Context} this is associated with, through which it can
+     *                access the current theme, resources, {@link SharedPreferences}, etc.
+     * @param attrs   The attributes of the XML tag that is inflating the preference
+     */
+    public RadioWithImagePreference(Context context, AttributeSet attrs) {
+        super(context, attrs);
+        init();
+    }
+
+    /**
+     * Constructor to create a preference.
+     *
+     * @param context The Context this is associated with.
+     */
+    public RadioWithImagePreference(Context context) {
+        this(context, null);
+    }
+
+    /**
+     * Sets the callback to be invoked when this preference is clicked by the user.
+     *
+     * @param listener The callback to be invoked
+     */
+    public void setOnClickListener(OnClickListener listener) {
+        mListener = listener;
+    }
+
+    /**
+     * Processes a click on the preference.
+     */
+    @Override
+    public void onClick() {
+        if (mListener != null) {
+            mListener.onRadioButtonClicked(this);
+        }
+    }
+
+    /**
+     * Binds the created View to the data for this preference.
+     *
+     * <p>This is a good place to grab references to custom Views in the layout and set
+     * properties on them.
+     *
+     * <p>Make sure to call through to the superclass's implementation.
+     *
+     * @param holder The ViewHolder that provides references to the views to fill in. These views
+     *               will be recycled, so you should not hold a reference to them after this method
+     *               returns.
+     */
+    @Override
+    public void onBindViewHolder(PreferenceViewHolder holder) {
+        super.onBindViewHolder(holder);
+
+        View summaryContainer = holder.findViewById(R.id.summary_container);
+        if (summaryContainer != null) {
+            summaryContainer.setVisibility(
+                    TextUtils.isEmpty(getSummary()) ? View.GONE : View.VISIBLE);
+        }
+    }
+
+    private void init() {
+        setWidgetLayoutResource(R.layout.preference_widget_radiobutton);
+        setLayoutResource(R.layout.radio_with_image_preference);
+        setIconSpaceReserved(false);
+    }
+}
diff --git a/src/com/android/car/settings/common/SettingsDefaultIntentActivity.java b/src/com/android/car/settings/common/SettingsDefaultIntentActivity.java
new file mode 100644
index 000000000..827b61ed1
--- /dev/null
+++ b/src/com/android/car/settings/common/SettingsDefaultIntentActivity.java
@@ -0,0 +1,53 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.widget.Toast;
+
+import androidx.fragment.app.FragmentActivity;
+
+import com.android.car.settings.R;
+
+/**
+ * Activity class that shows a toast. This is mainly for hosting all the intents that do not invoke
+ * corresponding functions on AAOS.
+ */
+public class SettingsDefaultIntentActivity extends FragmentActivity {
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        if (getIntent() != null) {
+            showToastAndFinishActivity();
+        }
+    }
+
+    @Override
+    protected void onNewIntent(Intent intent) {
+        super.onNewIntent(intent);
+        showToastAndFinishActivity();
+    }
+
+    private void showToastAndFinishActivity() {
+        Toast toast = Toast.makeText(getApplicationContext(),
+                R.string.unsupported_intents_toast_text, Toast.LENGTH_LONG);
+        toast.show();
+
+        finish();
+    }
+}
diff --git a/src/com/android/car/settings/common/SettingsFragment.java b/src/com/android/car/settings/common/SettingsFragment.java
index c49eb2c38..dad7d6f31 100644
--- a/src/com/android/car/settings/common/SettingsFragment.java
+++ b/src/com/android/car/settings/common/SettingsFragment.java
@@ -16,7 +16,7 @@
 
 package com.android.car.settings.common;
 
-import static com.android.car.settings.common.BaseCarSettingsActivity.META_DATA_KEY_SINGLE_PANE;
+import static com.android.car.settings.deeplink.DeepLinkHomepageActivity.EXTRA_TARGET_SECONDARY_CONTAINER;
 
 import android.car.drivingstate.CarUxRestrictions;
 import android.car.drivingstate.CarUxRestrictionsManager;
@@ -43,7 +43,9 @@ import androidx.preference.Preference;
 import androidx.preference.PreferenceScreen;
 import androidx.recyclerview.widget.RecyclerView;
 
+import com.android.car.settings.CarSettingsApplication;
 import com.android.car.settings.R;
+import com.android.car.settings.activityembedding.ActivityEmbeddingUtils;
 import com.android.car.ui.baselayout.Insets;
 import com.android.car.ui.preference.PreferenceFragment;
 import com.android.car.ui.recyclerview.CarUiRecyclerView;
@@ -217,11 +219,28 @@ public abstract class SettingsFragment extends PreferenceFragment implements
         toolbar.setTitle(getPreferenceScreen().getTitle());
         toolbar.setMenuItems(items);
         toolbar.setLogo(null);
-        if (getActivity().getIntent().getBooleanExtra(META_DATA_KEY_SINGLE_PANE, false)) {
+        if (shouldDisableBackButton()) {
+            toolbar.setNavButtonMode(NavButtonMode.DISABLED);
+        } else {
             toolbar.setNavButtonMode(NavButtonMode.BACK);
         }
     }
 
+    private boolean shouldDisableBackButton() {
+        if (getActivity() == null || getActivity().getIntent() == null) {
+            return false;
+        }
+        if (getFragmentManager().getBackStackEntryCount() > 1
+                || getActivity().getIntent().getBooleanExtra(EXTRA_TARGET_SECONDARY_CONTAINER,
+                false)) {
+            return false;
+        }
+        boolean startedBySettings = getActivity().getIntent().getAction() == null
+                || CarSettingsApplication.CAR_SETTINGS_PACKAGE_NAME.equals(
+                        getActivity().getLaunchedFromPackage());
+        return startedBySettings && ActivityEmbeddingUtils.isEmbeddingSplitActivated(getActivity());
+    }
+
     @Override
     public void onDetach() {
         super.onDetach();
diff --git a/src/com/android/car/settings/common/SubSettingsActivity.java b/src/com/android/car/settings/common/SubSettingsActivity.java
index b2e1d387b..457a02dd1 100644
--- a/src/com/android/car/settings/common/SubSettingsActivity.java
+++ b/src/com/android/car/settings/common/SubSettingsActivity.java
@@ -28,9 +28,8 @@ import androidx.fragment.app.Fragment;
  * Activity class for launching a SubSetting as a separate activity.
  */
 public class SubSettingsActivity extends BaseCarSettingsActivity {
-
-    private static final String KEY_SUB_SETTINGS_FRAGMENT = "key_sub_settings_fragment";
-    private static final String KEY_SUB_SETTINGS_FRAGMENT_ARGS = "key_sub_settings_fragment_args";
+    public static final String KEY_SUB_SETTINGS_FRAGMENT = "key_sub_settings_fragment";
+    public static final String KEY_SUB_SETTINGS_FRAGMENT_ARGS = "key_sub_settings_fragment_args";
     private static final Logger LOG = new Logger(SubSettingsActivity.class);
 
     /**
diff --git a/src/com/android/car/settings/common/TopLevelMenuFragment.java b/src/com/android/car/settings/common/TopLevelMenuFragment.java
index 9c0dd130b..0e99fdacc 100644
--- a/src/com/android/car/settings/common/TopLevelMenuFragment.java
+++ b/src/com/android/car/settings/common/TopLevelMenuFragment.java
@@ -16,7 +16,13 @@
 
 package com.android.car.settings.common;
 
+import static com.android.car.settings.common.ExtraSettingsLoader.META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
 import android.os.Bundle;
+import android.provider.Settings;
 import android.text.TextUtils;
 import android.view.LayoutInflater;
 import android.view.View;
@@ -26,16 +32,19 @@ import androidx.annotation.NonNull;
 import androidx.annotation.Nullable;
 import androidx.annotation.VisibleForTesting;
 import androidx.annotation.XmlRes;
-import androidx.fragment.app.DialogFragment;
 import androidx.fragment.app.Fragment;
-import androidx.fragment.app.FragmentActivity;
-import androidx.fragment.app.FragmentManager;
 import androidx.preference.Preference;
 import androidx.preference.PreferenceScreen;
 
 import com.android.car.settings.R;
+import com.android.car.settings.activityembedding.ActivityEmbeddingUtils;
+import com.android.car.settings.common.CarSettingActivities.HomepageActivity;
 import com.android.car.ui.recyclerview.CarUiRecyclerView;
+import com.android.car.ui.toolbar.MenuItem;
+import com.android.car.ui.toolbar.NavButtonMode;
+import com.android.car.ui.toolbar.ToolbarController;
 
+import java.util.Collections;
 import java.util.List;
 
 /**
@@ -52,6 +61,7 @@ public class TopLevelMenuFragment extends SettingsFragment {
 
     private static final String KEY_SAVED_SELECTED_PREFERENCE_KEY = "saved_selected_preference_key";
 
+    private MenuItem mSearchButton;
     private String mSelectedPreferenceKey;
 
     @Override
@@ -60,22 +70,78 @@ public class TopLevelMenuFragment extends SettingsFragment {
         return R.xml.homepage_fragment;
     }
 
+    @Override
+    protected List<MenuItem> getToolbarMenuItems() {
+        return Collections.singletonList(mSearchButton);
+    }
+
+    @Override
+    public void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        mSearchButton = new MenuItem.Builder(getContext())
+                .setToSearch()
+                .setOnClickListener(i -> onSearchButtonClicked())
+                .setUxRestrictions(CarUxRestrictions.UX_RESTRICTIONS_NO_KEYBOARD)
+                .build();
+    }
+
+    @Override
+    public void onResume() {
+        super.onResume();
+        updatePreferenceHighlight(getHeaderKeyFromActivity());
+    }
+
+    @Override
+    protected void setupToolbar(@NonNull ToolbarController toolbar) {
+        super.setupToolbar(toolbar);
+        toolbar.setTitle(R.string.settings_label);
+        if (ActivityEmbeddingUtils.isEmbeddingSplitActivated(getActivity())) {
+            toolbar.setLogo(R.drawable.ic_launcher_settings);
+            toolbar.setNavButtonMode(NavButtonMode.DISABLED);
+        } else {
+            toolbar.setLogo(null);
+            toolbar.setNavButtonMode(NavButtonMode.BACK);
+        }
+    }
+
     @Override
     public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
         super.onViewCreated(view, savedInstanceState);
+        if (getToolbar() != null) {
+            setupToolbar(getToolbar());
+        }
         if (savedInstanceState != null
                 && savedInstanceState.getString(KEY_SAVED_SELECTED_PREFERENCE_KEY) != null) {
             updatePreferenceHighlight(
                     savedInstanceState.getString(KEY_SAVED_SELECTED_PREFERENCE_KEY));
         } else {
-            updatePreferenceHighlight(getActivity().getIntent()
-                    .getStringExtra(BaseCarSettingsActivity.META_DATA_KEY_HEADER_KEY));
+            if (mSelectedPreferenceKey != null) {
+                updatePreferenceHighlight(mSelectedPreferenceKey);
+            } else {
+                updatePreferenceHighlight(getHeaderKeyFromActivity());
+            }
+        }
+    }
+
+    @Nullable
+    private String getHeaderKeyFromActivity() {
+        if (getActivity() == null || !(getActivity() instanceof HomepageActivity)) {
+            return null;
+        }
+        return ((HomepageActivity) getActivity()).getTopLevelHeaderKey();
+    }
+
+    private void setSelectedPreferenceKey(@Nullable String key) {
+        mSelectedPreferenceKey = key;
+        if (getActivity() != null && getActivity() instanceof HomepageActivity) {
+            ((HomepageActivity) getActivity()).setTopLevelHeaderKey(key);
         }
     }
 
     @Override
     public void onSaveInstanceState(@NonNull Bundle outState) {
         super.onSaveInstanceState(outState);
+        setSelectedPreferenceKey(mSelectedPreferenceKey);
         outState.putString(KEY_SAVED_SELECTED_PREFERENCE_KEY, mSelectedPreferenceKey);
     }
 
@@ -95,32 +161,20 @@ public class TopLevelMenuFragment extends SettingsFragment {
         if (fragment.getArguments() != null) {
             preferenceKey = fragment.getArguments().getString(FRAGMENT_MENU_PREFERENCE_KEY);
         }
-        if (TextUtils.equals(getCurrentFragmentClass(), fragment.getClass().getName())
-                && TextUtils.equals(preferenceKey, mSelectedPreferenceKey)) {
-            // Do nothing - already at the location being navigated to.
-            return;
-        }
-        clearBackStack();
         updatePreferenceHighlight(preferenceKey);
         super.launchFragment(fragment);
     }
 
     @Override
     public boolean onPreferenceTreeClick(Preference preference) {
-        if (preference.getFragment() == null) {
-            // No fragment provided - likely launching a new activity.
+        if (preference.getFragment() == null
+                && !preference.getExtras().getBoolean(META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS)) {
+            // Launching a new activity that is not a top level injected settings
             return super.onPreferenceTreeClick(preference);
         }
-        if (TextUtils.equals(getCurrentFragmentClass(), preference.getFragment())
-                && TextUtils.equals(preference.getKey(), mSelectedPreferenceKey)) {
-            // Do nothing - already at the location being navigated to.
-            return true;
-        }
-        clearBackStack();
         updatePreferenceHighlight(preference.getKey());
         return super.onPreferenceTreeClick(preference);
     }
-
     @Override
     protected HighlightablePreferenceGroupAdapter createHighlightableAdapter(
             PreferenceScreen preferenceScreen) {
@@ -130,7 +184,7 @@ public class TopLevelMenuFragment extends SettingsFragment {
     }
 
     private void updatePreferenceHighlight(String key) {
-        mSelectedPreferenceKey = key;
+        setSelectedPreferenceKey(key);
         if (!TextUtils.isEmpty(mSelectedPreferenceKey)) {
             requestPreferenceHighlight(mSelectedPreferenceKey);
         } else {
@@ -143,35 +197,16 @@ public class TopLevelMenuFragment extends SettingsFragment {
         return mSelectedPreferenceKey;
     }
 
-    @Nullable
-    private String getCurrentFragmentClass() {
-        FragmentActivity activity = getActivity();
-        if (activity == null) {
-            return null;
-        }
-        Fragment currentFragment =
-                activity.getSupportFragmentManager().findFragmentById(R.id.fragment_container);
-        if (currentFragment == null) {
-            return null;
-        }
-        return currentFragment.getClass().getName();
-    }
-
-    private void clearBackStack() {
-        FragmentActivity activity = getActivity();
-        if (activity == null) {
+    private void onSearchButtonClicked() {
+        Intent intent = new Intent(Settings.ACTION_APP_SEARCH_SETTINGS)
+                .setPackage(getSettingsIntelligencePkgName(getContext()));
+        if (intent.resolveActivity(getContext().getPackageManager()) == null) {
             return;
         }
+        startActivity(intent);
+    }
 
-        // dismiss dialogs
-        List<Fragment> fragments = activity.getSupportFragmentManager().getFragments();
-        for (Fragment fragment : fragments) {
-            if (fragment instanceof DialogFragment) {
-                ((DialogFragment) fragment).dismiss();
-            }
-        }
-        // clear fragments
-        activity.getSupportFragmentManager().popBackStackImmediate(/* name= */ null,
-                FragmentManager.POP_BACK_STACK_INCLUSIVE);
+    private String getSettingsIntelligencePkgName(Context context) {
+        return context.getString(R.string.config_settingsintelligence_package_name);
     }
 }
diff --git a/src/com/android/car/settings/datausage/AppDataUsageFragment.java b/src/com/android/car/settings/datausage/AppDataUsageFragment.java
index 1c4f8a573..0d9efcc80 100644
--- a/src/com/android/car/settings/datausage/AppDataUsageFragment.java
+++ b/src/com/android/car/settings/datausage/AppDataUsageFragment.java
@@ -22,6 +22,7 @@ import android.os.Bundle;
 import android.telephony.SubscriptionManager;
 import android.telephony.TelephonyManager;
 
+import androidx.annotation.NonNull;
 import androidx.annotation.VisibleForTesting;
 import androidx.annotation.XmlRes;
 import androidx.loader.app.LoaderManager;
@@ -77,7 +78,6 @@ public class AppDataUsageFragment extends SettingsFragment implements
     public void onAttach(Context context) {
         super.onAttach(context);
 
-        TelephonyManager telephonyManager = context.getSystemService(TelephonyManager.class);
         int subId = getArguments() != null
                 ? getArguments().getInt(ARG_NETWORK_SUB_ID, SUB_ID_NULL) : SUB_ID_NULL;
         if (subId == SUB_ID_NULL) {
@@ -87,18 +87,18 @@ public class AppDataUsageFragment extends SettingsFragment implements
                     SubscriptionManager.class);
             subId = DataUsageUtils.getDefaultSubscriptionId(subscriptionManager);
         }
-        mNetworkTemplate = DataUsageUtils.getMobileNetworkTemplate(telephonyManager, subId);
+        mNetworkTemplate = getNetworkTemplate(context, subId);
         mDataUsageController = new DataUsageController(context);
         mAppsNetworkStatsManager = new AppsNetworkStatsManager(getContext());
         mAppsNetworkStatsManager.registerListener(
                 use(AppDataUsagePreferenceController.class, R.string.pk_app_data_usage_detail));
-        mDataUsageCycleManager = new DataUsageCycleManager(getContext(), mNetworkTemplate);
+        mDataUsageCycleManager = getDataUsageCycleManager(mNetworkTemplate);
         mDataUsageCycleManager.registerListener(use(DataUsageCyclePreferenceController.class,
                 R.string.pk_data_usage_usage_history));
         use(DataUsageCyclePreferenceController.class,
                 R.string.pk_data_usage_usage_history)
                 .setDataCyclePickedListener(this)
-                .setDataUsageInfo(mDataUsageController.getDataUsageInfo(mNetworkTemplate));
+                .setDataUsageInfo(getDataUsageInfo(mNetworkTemplate));
 
         long usage = mDataUsageController.getDataUsageInfo(mNetworkTemplate).usageLevel;
         mAppDataUsageTotalPreferenceController =
@@ -133,6 +133,22 @@ public class AppDataUsageFragment extends SettingsFragment implements
         return mBundle;
     }
 
+    @VisibleForTesting
+    NetworkTemplate getNetworkTemplate(Context context, int subId) {
+        TelephonyManager telephonyManager = context.getSystemService(TelephonyManager.class);
+        return DataUsageUtils.getMobileNetworkTemplate(telephonyManager, subId);
+    }
+
+    @VisibleForTesting
+    DataUsageController.DataUsageInfo getDataUsageInfo(@NonNull NetworkTemplate networkTemplate) {
+        return mDataUsageController.getDataUsageInfo(networkTemplate);
+    }
+
+    @VisibleForTesting
+    DataUsageCycleManager getDataUsageCycleManager(@NonNull NetworkTemplate networkTemplate) {
+        return new DataUsageCycleManager(getContext(), networkTemplate);
+    }
+
     @Override
     public void onDataCyclePicked(String cycle, Map<CharSequence, NetworkCycleChartData> usages) {
         mAppDataUsageTotalPreferenceController.setDataUsage(usages.get(cycle).getTotalUsage());
diff --git a/src/com/android/car/settings/deeplink/DeepLinkHomepageActivity.java b/src/com/android/car/settings/deeplink/DeepLinkHomepageActivity.java
new file mode 100644
index 000000000..76693ce0f
--- /dev/null
+++ b/src/com/android/car/settings/deeplink/DeepLinkHomepageActivity.java
@@ -0,0 +1,146 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.deeplink;
+
+import static android.provider.Settings.ACTION_SETTINGS_EMBED_DEEP_LINK_ACTIVITY;
+import static android.provider.Settings.EXTRA_SETTINGS_EMBEDDED_DEEP_LINK_HIGHLIGHT_MENU_KEY;
+import static android.provider.Settings.EXTRA_SETTINGS_EMBEDDED_DEEP_LINK_INTENT_URI;
+
+import static com.android.car.settings.CarSettingsApplication.CAR_SETTINGS_PACKAGE_NAME;
+
+import android.annotation.NonNull;
+import android.content.ComponentName;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.net.Uri;
+import android.util.Log;
+
+import androidx.window.embedding.SplitRule;
+
+import com.android.car.settings.activityembedding.ActivityEmbeddingRulesController;
+import com.android.car.settings.activityembedding.ActivityEmbeddingUtils;
+import com.android.car.settings.common.CarSettingActivities;
+import com.android.car.settings.common.Logger;
+
+import java.net.URISyntaxException;
+
+/**
+ * {@link CarSettingActivities.HomepageActivity} for when dual-pane is enable via ActivityEmbedding.
+ * This class should only be enabled when dual-pane is active, and should only host activities
+ * that have the permission {@link android.permission.LAUNCH_MULTI_PANE_SETTINGS_DEEP_LINK}.
+ * Intents that target an Activity defined within this package, such as subclasses of
+ * {@link com.android.car.settings.common.BaseCarSettingsActivity}, will directly be started in dual
+ * pane unless it is targeting a single pane Activity. There is no need to convert these Intents
+ * using {@code convertToDeepLinkHomepageIntent}.
+ * Other Intents that target external setting defined outside of this package, such as those added
+ * by {@link com.android.car.settings.common.ExtraSettingsLoader}, should be started using a similar
+ * scheme as defined in the method {@code convertToDeepLinkHomepageIntent}.
+ */
+public class DeepLinkHomepageActivity extends CarSettingActivities.HomepageActivity {
+    public static final String EMBEDDED_DEEPLINK_INTENT_DATA =
+            "com.android.car.settings.EMBEDDED_DEEPLINK_INTENT_DATA";
+    public static final String EXTRA_TARGET_SECONDARY_CONTAINER =
+            "com.android.car.settings.EXTRA_TARGET_SECONDARY_CONTAINER";
+    private static final String TAG = "DeepLinkHomepageActivity";
+
+    private static final Logger LOG = new Logger(DeepLinkHomepageActivity.class);
+
+    @Override
+    protected void handleNewIntent(Intent intent) {
+        super.handleNewIntent(intent);
+        maybeLaunchDeepLinkActivity(intent);
+    }
+
+    /**
+     * Launches deep link activity to be directly two pane if it is supported.
+     */
+    private void maybeLaunchDeepLinkActivity(Intent intent) {
+        if (!ActivityEmbeddingUtils.isEmbeddingActivityEnabled(this)) {
+            Log.e(TAG, "Embedding is not enabled. Finishing DeepLinkHomepageActivity.");
+            finish();
+        }
+        Intent targetIntent;
+        try {
+            String intentUriString = intent.getStringExtra(
+                    EXTRA_SETTINGS_EMBEDDED_DEEP_LINK_INTENT_URI);
+            if (intentUriString == null) {
+                LOG.e("Unable to parse trampoline intent. Intent URI is null");
+                return;
+            }
+            targetIntent = Intent.parseUri(intentUriString, Intent.URI_INTENT_SCHEME);
+            targetIntent.setData(
+                    intent.getParcelableExtra(EMBEDDED_DEEPLINK_INTENT_DATA, Uri.class));
+        } catch (URISyntaxException e) {
+            LOG.e("Error parsing trampoline intent: " + e);
+            return;
+        }
+        ComponentName targetComponentName = targetIntent.resolveActivity(getPackageManager());
+        targetIntent.setComponent(targetComponentName);
+        targetIntent.removeFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+        targetIntent.addFlags(Intent.FLAG_ACTIVITY_FORWARD_RESULT);
+        targetIntent.replaceExtras(intent);
+        ActivityEmbeddingRulesController.registerDualPaneSplitRule(this,
+                /* primaryComponent= */ new ComponentName(getApplicationContext(), getClass()),
+                /* secondaryComponent= */ targetComponentName,
+                /* secondaryIntentAction= */ targetIntent.getAction(),
+                /* finishPrimaryWithSecondary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* finishSecondaryWithPrimary= */ SplitRule.FinishBehavior.ALWAYS,
+                /* clearTop= */ true);
+        setTopLevelHeaderKey(getTopLevelHeaderKey(targetIntent));
+        targetIntent.putExtra(EXTRA_TARGET_SECONDARY_CONTAINER, true);
+        startActivity(targetIntent);
+    }
+
+    /**
+     * Retrieves the top level header key from the deeplink Intent. If it is available via resolved
+     * {@link ActivityInfo}, then we prioritize displaying that over the intent extra.
+     */
+    private String getTopLevelHeaderKey(Intent targetIntent) {
+        String metaDataHeaderKey = null;
+        ActivityInfo ai = getActivityInfo(getPackageManager(), targetIntent.getComponent());
+        if (ai != null && ai.metaData != null) {
+            metaDataHeaderKey = ai.metaData.getString(META_DATA_KEY_HEADER_KEY);
+        }
+        String deepLinkExtraHeaderKey = targetIntent.getStringExtra(
+                EXTRA_SETTINGS_EMBEDDED_DEEP_LINK_HIGHLIGHT_MENU_KEY);
+        return metaDataHeaderKey != null ? metaDataHeaderKey : deepLinkExtraHeaderKey;
+    }
+
+    /**
+     * Converts an  {@link Intent} to a deeplink intent that, upon being started, will be
+     * trampolined and then handled by this class {@link DeepLinkHomepageActivity}.
+     */
+    @NonNull
+    public static Intent convertToDeepLinkHomepageIntent(@NonNull Intent targetIntent) {
+        targetIntent = new Intent(targetIntent);
+        targetIntent.setSelector(null);
+
+        Intent trampolineIntent = new Intent(ACTION_SETTINGS_EMBED_DEEP_LINK_ACTIVITY);
+        trampolineIntent.setPackage(CAR_SETTINGS_PACKAGE_NAME);
+        trampolineIntent.replaceExtras(targetIntent);
+        trampolineIntent.putExtra(EMBEDDED_DEEPLINK_INTENT_DATA, targetIntent.getData());
+        // If Intent#getData() is not null, Intent#toUri will return an Uri which has the scheme
+        // of Intent#getData(), and it may not be the scheme of the original Intent (i.e http:
+        // instead of ACTION_VIEW.
+        targetIntent.setData(null);
+        trampolineIntent.putExtra(EXTRA_SETTINGS_EMBEDDED_DEEP_LINK_INTENT_URI,
+                targetIntent.toUri(Intent.URI_INTENT_SCHEME));
+
+        return trampolineIntent.addFlags(Intent.FLAG_ACTIVITY_FORWARD_RESULT
+                | Intent.FLAG_ACTIVITY_NEW_TASK);
+    }
+}
diff --git a/src/com/android/car/settings/home/HomepageFragment.java b/src/com/android/car/settings/home/HomepageFragment.java
index 98a1f7901..b47e546fe 100644
--- a/src/com/android/car/settings/home/HomepageFragment.java
+++ b/src/com/android/car/settings/home/HomepageFragment.java
@@ -51,8 +51,10 @@ public class HomepageFragment extends SettingsFragment {
     @Override
     public void onAttach(Context context) {
         super.onAttach(context);
+        // TODO(b/376742190): deprecate this class as only TopLevelMenuFragment is used with
+        //  ActivityEmbeddings.
         // TODO: Re-enable suggestions once more use cases are supported.
-        // use(SuggestionsPreferenceController.class, R.string.pk_suggestions).setLoaderManager(
+        //  use(SuggestionsPreferenceController.class, R.string.pk_suggestions).setLoaderManager(
         //        LoaderManager.getInstance(/* owner= */ this));
     }
 
diff --git a/src/com/android/car/settings/network/MobileNetworkEntryPreferenceController.java b/src/com/android/car/settings/network/MobileNetworkEntryPreferenceController.java
index 9ddb1ff92..9d6ba3a56 100644
--- a/src/com/android/car/settings/network/MobileNetworkEntryPreferenceController.java
+++ b/src/com/android/car/settings/network/MobileNetworkEntryPreferenceController.java
@@ -40,6 +40,7 @@ import androidx.annotation.VisibleForTesting;
 import com.android.car.datasubscription.DataSubscription;
 import com.android.car.settings.R;
 import com.android.car.settings.common.ColoredTwoActionSwitchPreference;
+import com.android.car.settings.common.DataSubscriptionStatsLogHelper;
 import com.android.car.settings.common.FragmentController;
 import com.android.car.settings.common.Logger;
 import com.android.car.settings.common.PreferenceController;
@@ -159,6 +160,10 @@ public class MobileNetworkEntryPreferenceController extends
                 } catch (ActivityNotFoundException e) {
                     LOG.w("Can't start activity from package " + DATA_SUBSCRIPTION_ACTION);
                 }
+                finally {
+                    DataSubscriptionStatsLogHelper.getInstance()
+                            .writeDataSubscriptionEventReported();
+                }
             }
         } else if (subs.size() == 1) {
             getFragmentController().launchFragment(
diff --git a/src/com/android/car/settings/qc/DebugCustomizationOverlayRow.java b/src/com/android/car/settings/qc/DebugCustomizationOverlayRow.java
new file mode 100644
index 000000000..9b1192de2
--- /dev/null
+++ b/src/com/android/car/settings/qc/DebugCustomizationOverlayRow.java
@@ -0,0 +1,146 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+import static com.android.car.qc.QCItem.QC_TYPE_ACTION_SWITCH;
+
+import android.content.ContentResolver;
+import android.content.Context;
+import android.content.Intent;
+import android.net.Uri;
+import android.provider.Settings;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+import com.android.car.settings.common.BuildInfoUtil;
+import com.android.settingslib.development.DevelopmentSettingsEnabler;
+
+/**
+ * Quick control for showing a toggle for enabling the Customization tool overlay.
+ */
+public class DebugCustomizationOverlayRow extends SettingsQCItem {
+
+    private static final String SERVICE_ENABLED_STATE = "1";
+    private static final String SERVICE_DISABLED_STATE = "0";
+    private static final String PACKAGE = "com.android.car.customization.tool";
+    private static final String SERVICE = PACKAGE + '/' + PACKAGE + ".CustomizationToolService";
+    private final ContentResolver mContentResolver;
+
+    public DebugCustomizationOverlayRow(Context context) {
+        super(context);
+        mContentResolver = context.getContentResolver();
+    }
+
+    @Override
+    protected QCItem getQCItem() {
+        if (!BuildInfoUtil.isDevTesting(getContext())
+                || !DevelopmentSettingsEnabler.isDevelopmentSettingsEnabled(getContext())) {
+            return null;
+        }
+
+        QCActionItem actionItem = new QCActionItem.Builder(QC_TYPE_ACTION_SWITCH)
+                .setChecked(isCustomizationToolActive())
+                .setAction(getBroadcastIntent())
+                .build();
+
+        QCList.Builder listBuilder = new QCList.Builder()
+                .addRow(new QCRow.Builder()
+                        .setTitle(getContext().getString(R.string.show_customization_overlay_title))
+                        .addEndItem(actionItem)
+                        .build()
+                );
+        return listBuilder.build();
+    }
+
+    @Override
+    void onNotifyChange(Intent intent) {
+        boolean newState =
+                intent.getBooleanExtra(QC_ACTION_TOGGLE_STATE, /* defaultValue= */ false);
+        toggleCustomizationTool(newState);
+    }
+
+    private boolean isCustomizationToolActive() {
+        String accessibilityServices = Settings.Secure.getString(
+                mContentResolver, Settings.Secure.ENABLED_ACCESSIBILITY_SERVICES);
+        if (accessibilityServices == null || accessibilityServices.isEmpty()) {
+            return false;
+        }
+        String serviceStatus = Settings.Secure.getString(
+                mContentResolver, Settings.Secure.ACCESSIBILITY_ENABLED);
+        return accessibilityServices.contains(SERVICE)
+                && SERVICE_ENABLED_STATE.equals(serviceStatus);
+    }
+
+    private void toggleCustomizationTool(boolean newState) {
+        String newAccessibilityServices;
+        String newServiceState;
+        String currentServices = Settings.Secure.getString(
+                mContentResolver, Settings.Secure.ENABLED_ACCESSIBILITY_SERVICES);
+
+        if (newState) {
+            newAccessibilityServices = getCurrentListPlusService(currentServices);
+            newServiceState = SERVICE_ENABLED_STATE;
+        } else {
+            newAccessibilityServices = getCurrentListMinusService(currentServices);
+            newServiceState = SERVICE_DISABLED_STATE;
+        }
+
+        Settings.Secure.putString(
+                mContentResolver, Settings.Secure.ENABLED_ACCESSIBILITY_SERVICES,
+                newAccessibilityServices);
+        Settings.Secure.putString(mContentResolver, Settings.Secure.ACCESSIBILITY_ENABLED,
+                newServiceState);
+    }
+
+    private String getCurrentListPlusService(String currentServices) {
+        if (currentServices == null || currentServices.isEmpty()) {
+            return SERVICE;
+        }
+        return currentServices + ":" + SERVICE;
+    }
+
+    private String getCurrentListMinusService(String currentServices) {
+        if (currentServices == null || currentServices.isEmpty()) {
+            return "";
+        }
+        String newServiceList = currentServices.replace(
+                SERVICE, /* replacement= */"").replace(/* target= */"::", /* replacement= */":");
+        if (newServiceList.indexOf(':') == 0) {
+            newServiceList = newServiceList.substring(/* beginIndex= */ 1);
+        }
+        if (newServiceList.lastIndexOf(':') == newServiceList.length() - 1) {
+            newServiceList = newServiceList.substring(/* beginIndex= */ 0,
+                    /* endIndex= */ newServiceList.length() - 1);
+        }
+
+        return newServiceList;
+    }
+
+    @Override
+    protected Uri getUri() {
+        return SettingsQCRegistry.DEBUG_CUSTOMIZATION_OVERLAY_URI;
+    }
+
+    @Override
+    Class getBackgroundWorkerClass() {
+        return DefaultQCBackgroundWorker.class;
+    }
+}
diff --git a/src/com/android/car/settings/qc/DebugDriveModeRow.java b/src/com/android/car/settings/qc/DebugDriveModeRow.java
new file mode 100644
index 000000000..bc7ffc6d4
--- /dev/null
+++ b/src/com/android/car/settings/qc/DebugDriveModeRow.java
@@ -0,0 +1,106 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+import static com.android.car.qc.QCItem.QC_TYPE_ACTION_SWITCH;
+
+import android.annotation.SuppressLint;
+import android.car.Car;
+import android.car.drivingstate.CarDrivingStateEvent;
+import android.car.drivingstate.CarDrivingStateManager;
+import android.content.Context;
+import android.content.Intent;
+import android.net.Uri;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+import com.android.car.settings.common.BuildInfoUtil;
+import com.android.car.settings.common.CarUxRestrictionsHelper;
+import com.android.settingslib.development.DevelopmentSettingsEnabler;
+
+/**
+ * A {@link SettingsQCItem} that allows the user to toggle the driving mode on/off.
+ */
+public class DebugDriveModeRow extends SettingsQCItem {
+    private CarDrivingStateManager mDrivingStateManager;
+    private CarUxRestrictionsHelper mHelper;
+
+    public DebugDriveModeRow(Context context) {
+        super(context);
+        Car car = Car.createCar(getContext());
+        if (car != null) {
+            mDrivingStateManager =
+                    (CarDrivingStateManager) car.getCarManager(Car.CAR_DRIVING_STATE_SERVICE);
+        }
+        mHelper = new CarUxRestrictionsHelper(context, restrictionInfo -> {/* Do nothing. */});
+    }
+
+    @Override
+    protected QCItem getQCItem() {
+        if (!BuildInfoUtil.isDevTesting(getContext())
+                || !DevelopmentSettingsEnabler.isDevelopmentSettingsEnabled(getContext())
+                || mDrivingStateManager == null) {
+            return null;
+        }
+
+        QCActionItem actionItem = new QCActionItem.Builder(QC_TYPE_ACTION_SWITCH)
+                .setChecked(isDrivingModeOn())
+                .setAction(getBroadcastIntent())
+                .build();
+
+        QCList.Builder listBuilder = new QCList.Builder()
+                .addRow(new QCRow.Builder()
+                        .setTitle(getContext().getString(R.string.driving_mode_title))
+                        .addEndItem(actionItem)
+                        .build()
+                );
+        return listBuilder.build();
+    }
+
+    private boolean isDrivingModeOn() {
+        // TODO(b/369680494): Use mDrivingStateManager.getCurrentCarDrivingState() when it is
+        //  updated.
+        return mHelper.getCarUxRestrictions().isRequiresDistractionOptimization();
+    }
+
+    @Override
+    @SuppressLint("MissingPermission")
+    void onNotifyChange(Intent intent) {
+        boolean newState =
+                intent.getBooleanExtra(QC_ACTION_TOGGLE_STATE, /* defaultValue= */ false);
+
+        if (mDrivingStateManager != null) {
+            mDrivingStateManager.injectDrivingState(
+                    newState ? CarDrivingStateEvent.DRIVING_STATE_MOVING
+                            : CarDrivingStateEvent.DRIVING_STATE_PARKED);
+        }
+    }
+
+    @Override
+    protected Uri getUri() {
+        return SettingsQCRegistry.DEBUG_DRIVING_MODE_URI;
+    }
+
+    @Override
+    Class getBackgroundWorkerClass() {
+        return DebugDriveModeRowWorker.class;
+    }
+}
diff --git a/src/com/android/car/settings/qc/DebugDriveModeRowWorker.java b/src/com/android/car/settings/qc/DebugDriveModeRowWorker.java
new file mode 100644
index 000000000..73284314b
--- /dev/null
+++ b/src/com/android/car/settings/qc/DebugDriveModeRowWorker.java
@@ -0,0 +1,60 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import android.car.Car;
+import android.car.drivingstate.CarDrivingStateManager;
+import android.content.Context;
+import android.net.Uri;
+
+import java.io.IOException;
+
+/**
+ * Worker for {@link DebugDriveModeRow}.
+ */
+public class DebugDriveModeRowWorker extends SettingsQCBackgroundWorker<DebugDriveModeRow> {
+
+    private CarDrivingStateManager mDrivingStateManager;
+
+    public DebugDriveModeRowWorker(Context context, Uri uri) {
+        super(context, uri);
+        Car car = Car.createCar(getContext());
+        if (car != null) {
+            mDrivingStateManager =
+                    (CarDrivingStateManager) car.getCarManager(Car.CAR_DRIVING_STATE_SERVICE);
+        }
+    }
+
+    @Override
+    protected void onQCItemSubscribe() {
+        notifyQCItemChange();
+        if (mDrivingStateManager != null) {
+            mDrivingStateManager.registerListener(event -> notifyQCItemChange());
+        }
+    }
+
+    @Override
+    protected void onQCItemUnsubscribe() {
+        if (mDrivingStateManager != null) {
+            mDrivingStateManager.unregisterListener();
+        }
+    }
+
+    @Override
+    public void close() throws IOException {
+    }
+}
diff --git a/src/com/android/car/settings/qc/DebugForceRTLRow.java b/src/com/android/car/settings/qc/DebugForceRTLRow.java
new file mode 100644
index 000000000..af46126b6
--- /dev/null
+++ b/src/com/android/car/settings/qc/DebugForceRTLRow.java
@@ -0,0 +1,95 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+import static com.android.car.qc.QCItem.QC_TYPE_ACTION_SWITCH;
+
+import android.content.Context;
+import android.content.Intent;
+import android.net.Uri;
+import android.provider.Settings;
+import android.sysprop.DisplayProperties;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+import com.android.car.settings.common.BuildInfoUtil;
+import com.android.internal.app.LocalePicker;
+import com.android.settingslib.development.DevelopmentSettingsEnabler;
+
+/**
+ * Quick control for showing a toggle for force-showing RTL layout direction.
+ */
+public class DebugForceRTLRow extends SettingsQCItem {
+    private static final int SETTING_VALUE_ON = 1;
+    private static final int SETTING_VALUE_OFF = 0;
+
+    public DebugForceRTLRow(Context context) {
+        super(context);
+    }
+
+    @Override
+    protected QCItem getQCItem() {
+        if (!BuildInfoUtil.isDevTesting(getContext())
+                || !DevelopmentSettingsEnabler.isDevelopmentSettingsEnabled(getContext())) {
+            return null;
+        }
+        int rtlLayoutMode = Settings.Global.getInt(getContext().getContentResolver(),
+                Settings.Global.DEVELOPMENT_FORCE_RTL, SETTING_VALUE_OFF);
+        QCActionItem actionItem = new QCActionItem.Builder(QC_TYPE_ACTION_SWITCH)
+                .setChecked(rtlLayoutMode != SETTING_VALUE_OFF)
+                .setAction(getBroadcastIntent())
+                .build();
+
+        QCList.Builder listBuilder = new QCList.Builder()
+                .addRow(new QCRow.Builder()
+                        .setTitle(getContext().getString(R.string.show_force_rtl_title))
+                        .addEndItem(actionItem)
+                        .build()
+                );
+        return listBuilder.build();
+    }
+
+    @Override
+    void onNotifyChange(Intent intent) {
+        boolean newState =
+                intent.getBooleanExtra(QC_ACTION_TOGGLE_STATE, /* defaultValue = */ false);
+        writeToForceRtlLayoutSetting(newState);
+    }
+
+    private void writeToForceRtlLayoutSetting(boolean isEnabled) {
+        Settings.Global.putInt(getContext().getContentResolver(),
+                Settings.Global.DEVELOPMENT_FORCE_RTL,
+                isEnabled ? SETTING_VALUE_ON : SETTING_VALUE_OFF);
+        DisplayProperties.debug_force_rtl(isEnabled);
+
+        LocalePicker.updateLocales(getContext().getResources().getConfiguration().getLocales());
+    }
+
+    @Override
+    protected Uri getUri() {
+        return SettingsQCRegistry.DEBUG_FORCE_RTL_URI;
+    }
+
+    @Override
+    Class getBackgroundWorkerClass() {
+        return DefaultQCBackgroundWorker.class;
+    }
+}
diff --git a/src/com/android/car/settings/qc/DebugLayoutBoundsRow.java b/src/com/android/car/settings/qc/DebugLayoutBoundsRow.java
index 6dc496ba2..de2e0d1d7 100644
--- a/src/com/android/car/settings/qc/DebugLayoutBoundsRow.java
+++ b/src/com/android/car/settings/qc/DebugLayoutBoundsRow.java
@@ -22,7 +22,6 @@ import static com.android.car.qc.QCItem.QC_TYPE_ACTION_SWITCH;
 import android.content.Context;
 import android.content.Intent;
 import android.net.Uri;
-import android.os.Build;
 import android.sysprop.DisplayProperties;
 
 import com.android.car.qc.QCActionItem;
@@ -30,6 +29,7 @@ import com.android.car.qc.QCItem;
 import com.android.car.qc.QCList;
 import com.android.car.qc.QCRow;
 import com.android.car.settings.R;
+import com.android.car.settings.common.BuildInfoUtil;
 import com.android.settingslib.development.DevelopmentSettingsEnabler;
 import com.android.settingslib.development.SystemPropPoker;
 
@@ -43,7 +43,7 @@ public class DebugLayoutBoundsRow extends SettingsQCItem {
 
     @Override
     protected QCItem getQCItem() {
-        if (!(Build.IS_USERDEBUG || Build.IS_ENG)
+        if (!BuildInfoUtil.isDevTesting(getContext())
                 || !DevelopmentSettingsEnabler.isDevelopmentSettingsEnabled(getContext())) {
             return null;
         }
@@ -77,6 +77,6 @@ public class DebugLayoutBoundsRow extends SettingsQCItem {
 
     @Override
     Class getBackgroundWorkerClass() {
-        return DebugLayoutBoundsRowWorker.class;
+        return DefaultQCBackgroundWorker.class;
     }
 }
diff --git a/src/com/android/car/settings/qc/DebugLayoutBoundsRowWorker.java b/src/com/android/car/settings/qc/DefaultQCBackgroundWorker.java
similarity index 81%
rename from src/com/android/car/settings/qc/DebugLayoutBoundsRowWorker.java
rename to src/com/android/car/settings/qc/DefaultQCBackgroundWorker.java
index 4c882facb..e2d060574 100644
--- a/src/com/android/car/settings/qc/DebugLayoutBoundsRowWorker.java
+++ b/src/com/android/car/settings/qc/DefaultQCBackgroundWorker.java
@@ -22,11 +22,11 @@ import android.net.Uri;
 import java.io.IOException;
 
 /**
- * Background worker for the {@link DebugLayoutBoundsRow} QCItem.
+ * Default Worker for Quick Control items.
  */
-public class DebugLayoutBoundsRowWorker extends SettingsQCBackgroundWorker<DebugLayoutBoundsRow> {
+public class DefaultQCBackgroundWorker extends SettingsQCBackgroundWorker<SettingsQCItem> {
 
-    public DebugLayoutBoundsRowWorker(Context context, Uri uri) {
+    public DefaultQCBackgroundWorker(Context context, Uri uri) {
         super(context, uri);
     }
 
diff --git a/src/com/android/car/settings/qc/MobileDataRow.java b/src/com/android/car/settings/qc/MobileDataRow.java
index 249261366..37cd80b4c 100644
--- a/src/com/android/car/settings/qc/MobileDataRow.java
+++ b/src/com/android/car/settings/qc/MobileDataRow.java
@@ -27,6 +27,7 @@ import android.app.PendingIntent;
 import android.car.drivingstate.CarUxRestrictions;
 import android.content.Context;
 import android.content.Intent;
+import android.content.pm.PackageManager;
 import android.graphics.drawable.Icon;
 import android.net.Uri;
 import android.os.UserManager;
@@ -41,6 +42,7 @@ import com.android.car.qc.QCItem;
 import com.android.car.qc.QCList;
 import com.android.car.qc.QCRow;
 import com.android.car.settings.R;
+import com.android.car.settings.common.Logger;
 import com.android.car.settings.enterprise.EnterpriseUtils;
 import com.android.settingslib.net.DataUsageController;
 
@@ -50,6 +52,8 @@ import com.android.settingslib.net.DataUsageController;
  * to enable/disable mobile data.
  */
 public class MobileDataRow extends SettingsQCItem {
+    private static final String TAG = MobileDataRow.class.getSimpleName();
+    private static final Logger LOG = new Logger(MobileDataRow.class);
     private final DataUsageController mDataUsageController;
     private boolean mIsDistractionOptimizationRequired;
     private DataSubscription mSubscription;
@@ -100,6 +104,14 @@ public class MobileDataRow extends SettingsQCItem {
                 .addEndItem(dataToggle)
                 .build();
 
+        try {
+            dataRow.setPackageUid(getContext()
+                    .getPackageManager()
+                    .getApplicationInfo(getContext().getPackageName(), 0).uid);
+            dataRow.setTag(TAG);
+        } catch (PackageManager.NameNotFoundException e) {
+            LOG.w("Can't find application info for package " + e);
+        }
         return new QCList.Builder()
                 .addRow(dataRow)
                 .build();
diff --git a/src/com/android/car/settings/qc/SettingsQCRegistry.java b/src/com/android/car/settings/qc/SettingsQCRegistry.java
index 319d6f5b5..442e2b889 100644
--- a/src/com/android/car/settings/qc/SettingsQCRegistry.java
+++ b/src/com/android/car/settings/qc/SettingsQCRegistry.java
@@ -138,13 +138,29 @@ public class SettingsQCRegistry {
             .authority(AUTHORITY)
             .appendPath("navigation_volume_slider")
             .build();
-
+    public static final Uri DEBUG_DRIVING_MODE_URI = new Uri.Builder()
+            .scheme(ContentResolver.SCHEME_CONTENT)
+            .authority(AUTHORITY)
+            .appendPath("debug_driving_mode_toggle")
+            .build();
     public static final Uri DEBUG_LAYOUT_BOUNDS_URI = new Uri.Builder()
             .scheme(ContentResolver.SCHEME_CONTENT)
             .authority(AUTHORITY)
             .appendPath("debug_layout_bounds_toggle")
             .build();
 
+    public static final Uri DEBUG_FORCE_RTL_URI = new Uri.Builder()
+            .scheme(ContentResolver.SCHEME_CONTENT)
+            .authority(AUTHORITY)
+            .appendPath("debug_force_rtl_toggle")
+            .build();
+
+    public static final Uri DEBUG_CUSTOMIZATION_OVERLAY_URI = new Uri.Builder()
+            .scheme(ContentResolver.SCHEME_CONTENT)
+            .authority(AUTHORITY)
+            .appendPath("debug_customization_overlay_toggle")
+            .build();
+
     // End Uris
 
     @VisibleForTesting
@@ -171,7 +187,10 @@ public class SettingsQCRegistry {
         map.put(MEDIA_VOLUME_SLIDER_WITHOUT_ICON_URI, MediaVolumeSliderWithoutIcon.class);
         map.put(CALL_VOLUME_SLIDER_URI, CallVolumeSlider.class);
         map.put(NAVIGATION_VOLUME_SLIDER_URI, NavigationVolumeSlider.class);
+        map.put(DEBUG_DRIVING_MODE_URI, DebugDriveModeRow.class);
         map.put(DEBUG_LAYOUT_BOUNDS_URI, DebugLayoutBoundsRow.class);
+        map.put(DEBUG_FORCE_RTL_URI, DebugForceRTLRow.class);
+        map.put(DEBUG_CUSTOMIZATION_OVERLAY_URI, DebugCustomizationOverlayRow.class);
 
         return map;
     }
diff --git a/src/com/android/car/settings/search/CarSearchResultTrampoline.java b/src/com/android/car/settings/search/CarSearchResultTrampoline.java
new file mode 100644
index 000000000..1ca829d15
--- /dev/null
+++ b/src/com/android/car/settings/search/CarSearchResultTrampoline.java
@@ -0,0 +1,90 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.search;
+
+import static com.android.car.settings.deeplink.DeepLinkHomepageActivity.EMBEDDED_DEEPLINK_INTENT_DATA;
+import static com.android.car.settings.deeplink.DeepLinkHomepageActivity.convertToDeepLinkHomepageIntent;
+
+import android.annotation.Nullable;
+import android.app.Activity;
+import android.content.Intent;
+import android.net.Uri;
+import android.os.Bundle;
+import android.provider.Settings;
+
+import com.android.car.settings.R;
+import com.android.car.settings.activityembedding.ActivityEmbeddingUtils;
+import com.android.car.settings.common.Logger;
+
+import java.net.URISyntaxException;
+
+/**
+ * Trampoline activity for consuming, processing, and launching Intent for Settings search results
+ * provided by SettingsIntelligence.
+ */
+public class CarSearchResultTrampoline extends Activity {
+    private static final Logger LOG = new Logger(CarSearchResultTrampoline.class);
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        if (verifySearchResultCallerPackage(getLaunchedFromPackage())) {
+            Intent intentToStart = getTargetIntent(getIntent());
+            if (intentToStart == null) {
+                LOG.e("Could not parse intent to start from settings intelligence.");
+                return;
+            }
+            if (ActivityEmbeddingUtils.isEmbeddingActivityEnabled(this)) {
+                LOG.i("Starting the settings search resolved activity with a deep link.");
+                intentToStart = convertToDeepLinkHomepageIntent(intentToStart);
+                intentToStart.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
+            }
+            startActivity(intentToStart);
+        }
+        finish();
+    }
+
+    /**
+     * Parses settings search into the original intent.
+     */
+    @Nullable
+    private Intent getTargetIntent(Intent intent) {
+        Intent targetIntent = null;
+        final String intentUriString = intent.getStringExtra(
+                Settings.EXTRA_SETTINGS_EMBEDDED_DEEP_LINK_INTENT_URI);
+        try {
+            targetIntent = Intent.parseUri(intentUriString, Intent.URI_INTENT_SCHEME);
+            targetIntent.setData(
+                    intent.getParcelableExtra(EMBEDDED_DEEPLINK_INTENT_DATA, Uri.class));
+        } catch (URISyntaxException e) {
+            LOG.e("Error parsing target intent URI from: "
+                    + getSettingsIntelligencePkgName());
+        }
+        return targetIntent;
+    }
+
+    private boolean verifySearchResultCallerPackage(@Nullable String callerPackage) {
+        if (callerPackage == null) {
+            return false;
+        }
+        return callerPackage.equals(getSettingsIntelligencePkgName());
+    }
+
+    private String getSettingsIntelligencePkgName() {
+        return getString(R.string.config_settingsintelligence_package_name);
+    }
+}
diff --git a/src/com/android/car/settings/security/SettingsScreenLockActivity.java b/src/com/android/car/settings/security/SettingsScreenLockActivity.java
index 8ee2538fd..af3768521 100644
--- a/src/com/android/car/settings/security/SettingsScreenLockActivity.java
+++ b/src/com/android/car/settings/security/SettingsScreenLockActivity.java
@@ -70,6 +70,6 @@ public class SettingsScreenLockActivity extends BaseCarSettingsActivity {
                             DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED));
         }
         fragment.setArguments(bundle);
-        launchFragmentInternal(fragment);
+        updateFragmentContainer(fragment);
     }
 }
diff --git a/src/com/android/car/settings/wifi/CarWifiManager.java b/src/com/android/car/settings/wifi/CarWifiManager.java
index 37e926665..47091ae09 100644
--- a/src/com/android/car/settings/wifi/CarWifiManager.java
+++ b/src/com/android/car/settings/wifi/CarWifiManager.java
@@ -288,4 +288,21 @@ public class CarWifiManager implements WifiPickerTracker.WifiPickerTrackerCallba
             }
         }
     }
+
+    /**
+     * @return true if this device supports Wi-Fi Easy-connect (Device Provisioning Protocol)
+     */
+    public boolean isEasyConnectSupported() {
+        if (mWifiManager != null && mWifiManager.isEasyConnectSupported()) {
+            return true;
+        }
+        return false;
+    }
+
+    /**
+     * Returns the {@link WifiManager}
+     */
+    public WifiManager getWifiManager() {
+        return mWifiManager;
+    }
 }
diff --git a/src/com/android/car/settings/wifi/details/WifiDetailsActionButtonsPreferenceController.java b/src/com/android/car/settings/wifi/details/WifiDetailsActionButtonsPreferenceController.java
index 7e2fbaa18..6fbae1263 100644
--- a/src/com/android/car/settings/wifi/details/WifiDetailsActionButtonsPreferenceController.java
+++ b/src/com/android/car/settings/wifi/details/WifiDetailsActionButtonsPreferenceController.java
@@ -18,15 +18,24 @@ package com.android.car.settings.wifi.details;
 
 import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons;
 
+import android.annotation.SuppressLint;
 import android.car.drivingstate.CarUxRestrictions;
 import android.content.Context;
 import android.net.Network;
 import android.net.NetworkCapabilities;
+import android.net.Uri;
+import android.net.wifi.EasyConnectStatusCallback;
+import android.net.wifi.WifiManager;
+import android.os.Build;
 import android.widget.Toast;
 
+import androidx.annotation.NonNull;
+
+import com.android.car.settings.Flags;
 import com.android.car.settings.R;
 import com.android.car.settings.common.ActionButtonsPreference;
 import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.Logger;
 import com.android.car.settings.wifi.WifiUtil;
 import com.android.wifitrackerlib.WifiEntry;
 
@@ -36,6 +45,10 @@ import com.android.wifitrackerlib.WifiEntry;
 public class WifiDetailsActionButtonsPreferenceController
         extends WifiDetailsBasePreferenceController<ActionButtonsPreference>
         implements WifiEntry.ConnectCallback {
+    private static final Logger LOG = new Logger(
+            WifiDetailsActionButtonsPreferenceController.class);
+    private String mUri;
+    private boolean mSupportEasyConnect;
 
     public WifiDetailsActionButtonsPreferenceController(Context context,
             String preferenceKey, FragmentController fragmentController,
@@ -48,6 +61,16 @@ public class WifiDetailsActionButtonsPreferenceController
         return ActionButtonsPreference.class;
     }
 
+    @Override
+    protected void onCreateInternal() {
+        super.onCreateInternal();
+        mSupportEasyConnect = getCarWifiManager() != null
+                && getCarWifiManager().isEasyConnectSupported();
+        if (mSupportEasyConnect) {
+            setUpSharePageInfo();
+        }
+    }
+
     @Override
     protected void updateState(ActionButtonsPreference preference) {
         getPreference()
@@ -70,6 +93,13 @@ public class WifiDetailsActionButtonsPreferenceController
                 .setText(getConnectDisconnectButtonTextResource())
                 .setIcon(getConnectDisconnectButtonIconResource())
                 .setOnClickListener(v -> connectOrDisconnect());
+
+        preference.getButton(ActionButtons.BUTTON3)
+                .setVisible(mSupportEasyConnect && Flags.newFragmentForIntents())
+                .setEnabled(mUri != null)
+                .setText(R.string.wifi_detail_share)
+                .setIcon(R.drawable.ic_qr)
+                .setOnClickListener(v -> openSharePage());
     }
 
     @Override
@@ -101,7 +131,7 @@ public class WifiDetailsActionButtonsPreferenceController
     private boolean canForgetNetwork() {
         return getWifiEntry().canForget()
                 && !WifiUtil.isNetworkLockedDown(getContext(),
-                        getWifiEntry().getWifiConfiguration());
+                getWifiEntry().getWifiConfiguration());
     }
 
     private void connectOrDisconnect() {
@@ -136,4 +166,58 @@ public class WifiDetailsActionButtonsPreferenceController
                 throw new IllegalStateException("Invalid WifiEntry connected state");
         }
     }
+
+    @SuppressLint("MissingPermission")
+    private void openSharePage() {
+        if (mUri != null) {
+            getFragmentController().launchFragment(
+                    WifiDetailsShareFragment.getInstance(mUri));
+        }
+    }
+
+    @SuppressLint("MissingPermission")
+    private void setUpSharePageInfo() {
+        getCarWifiManager().getWifiManager().startEasyConnectAsEnrolleeResponder(
+                Build.DEVICE,
+                WifiManager.EASY_CONNECT_CRYPTOGRAPHY_CURVE_PRIME256V1,
+                getContext().getMainExecutor(),
+                new SettingsEasyConnectStatusCallback());
+    }
+
+    private class SettingsEasyConnectStatusCallback extends EasyConnectStatusCallback {
+
+        @Override
+        public void onBootstrapUriGenerated(@NonNull Uri dppUri) {
+            super.onBootstrapUriGenerated(dppUri);
+            if (!dppUri.toString().equals(mUri)) {
+                mUri = dppUri.toString();
+                refreshUi();
+            }
+        }
+
+        @Override
+        public void onFailure(int code) {
+            super.onFailure(code);
+            LOG.w("Unable to generate Easy Connect Wifi QR code : " + code);
+            if (mUri != null) {
+                mUri = null;
+                refreshUi();
+            }
+        }
+
+        @Override
+        public void onEnrolleeSuccess(int newNetworkId) {
+            // Do nothing.
+        }
+
+        @Override
+        public void onConfiguratorSuccess(int code) {
+            // Do nothing.
+        }
+
+        @Override
+        public void onProgress(int code) {
+            // Do nothing.
+        }
+    }
 }
diff --git a/src/com/android/car/settings/wifi/details/WifiDetailsBasePreferenceController.java b/src/com/android/car/settings/wifi/details/WifiDetailsBasePreferenceController.java
index c0b8d795c..b3b735813 100644
--- a/src/com/android/car/settings/wifi/details/WifiDetailsBasePreferenceController.java
+++ b/src/com/android/car/settings/wifi/details/WifiDetailsBasePreferenceController.java
@@ -26,6 +26,7 @@ import androidx.preference.Preference;
 
 import com.android.car.settings.common.FragmentController;
 import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.wifi.CarWifiManager;
 import com.android.car.settings.wifi.WifiUtil;
 import com.android.wifitrackerlib.WifiEntry;
 
@@ -45,6 +46,7 @@ public abstract class WifiDetailsBasePreferenceController<V extends Preference>
 
     private WifiEntry mWifiEntry;
     private WifiInfoProvider mWifiInfoProvider;
+    private CarWifiManager mCarWifiManager;
 
     public WifiDetailsBasePreferenceController(Context context, String preferenceKey,
             FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
@@ -58,6 +60,8 @@ public abstract class WifiDetailsBasePreferenceController<V extends Preference>
             WifiEntry wifiEntry, WifiInfoProvider wifiInfoProvider) {
         mWifiEntry = wifiEntry;
         mWifiInfoProvider = wifiInfoProvider;
+        mCarWifiManager = new CarWifiManager(getContext(),
+                getFragmentController().getSettingsLifecycle());
         return this;
     }
 
@@ -111,4 +115,8 @@ public abstract class WifiDetailsBasePreferenceController<V extends Preference>
                 ? AVAILABLE
                 : CONDITIONALLY_UNAVAILABLE;
     }
+
+    protected CarWifiManager getCarWifiManager() {
+        return mCarWifiManager;
+    }
 }
diff --git a/src/com/android/car/settings/wifi/details/WifiDetailsShareFragment.java b/src/com/android/car/settings/wifi/details/WifiDetailsShareFragment.java
new file mode 100644
index 000000000..37e355e09
--- /dev/null
+++ b/src/com/android/car/settings/wifi/details/WifiDetailsShareFragment.java
@@ -0,0 +1,80 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import android.graphics.Bitmap;
+import android.os.Bundle;
+import android.view.View;
+import android.widget.ImageView;
+
+import androidx.annotation.LayoutRes;
+import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
+import androidx.annotation.StringRes;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.BaseFragment;
+import com.android.car.settings.common.Logger;
+import com.android.settingslib.qrcode.QrCodeGenerator;
+
+/**
+ * Shows the easy connect QR code for a Wi-Fi network.
+ */
+public class WifiDetailsShareFragment extends BaseFragment {
+    private static final Logger LOG = new Logger(WifiDetailsShareFragment.class);
+    private static final String WIFI_SHARE_KEY = "wifi_share_uri";
+
+    /**
+     * Gets an instance of this class.
+     */
+    public static WifiDetailsShareFragment getInstance(String uri) {
+        WifiDetailsShareFragment wifiDetailsShareFragment = new WifiDetailsShareFragment();
+        Bundle bundle = new Bundle();
+        bundle.putString(WIFI_SHARE_KEY, uri);
+        wifiDetailsShareFragment.setArguments(bundle);
+        return wifiDetailsShareFragment;
+    }
+
+    @Override
+    @LayoutRes
+    protected int getLayoutId() {
+        return R.layout.wifi_detail_share_fragment;
+    }
+
+    @Override
+    @StringRes
+    protected int getTitleId() {
+        return R.string.wifi_detail_share;
+    }
+
+    @Override
+    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
+        super.onViewCreated(view, savedInstanceState);
+        String uri = getArguments().getString(WIFI_SHARE_KEY);
+        ImageView qr_image = view.findViewById(R.id.wifi_share_qr_code);
+        try {
+            int size = getContext().getResources().getDimensionPixelSize(
+                    R.dimen.hotspot_qr_code_size);
+            int margin = getContext().getResources().getDimensionPixelSize(
+                    R.dimen.qr_code_margin);
+            Bitmap bmp = QrCodeGenerator.encodeQrCode(uri, size, margin);
+            qr_image.setImageBitmap(bmp);
+        } catch (Exception e) {
+            LOG.w("Failed to load wifi easy share qr code: " + e);
+        }
+    }
+}
diff --git a/tests/README.md b/tests/README.md
new file mode 100644
index 000000000..c370eeedc
--- /dev/null
+++ b/tests/README.md
@@ -0,0 +1,52 @@
+# CarSettings Tests
+
+CarSettings tests are organized under various conveniently named directories.
+
+## multivalent
+
+These tests are independent of any particular device or deviceless SDK and
+classes. They compile against just android and unit testing libraries. These
+tests can be run on a device, emulator, or without any device using mock SDKs at
+runtime.
+
+Our goal is to increase the number of multivalent tests as they eliminate code
+duplication, reduce maintenance burden, and are portable across device and
+deviceless runs.
+
+Run these without a device (Robolectric) using following command.
+
+```
+$ atest CarSettingsMultivalentRoboTests
+```
+
+Or run with a device (physical or virtual) using following command.
+
+```
+$ atest CarSettingsMultivalentDeviceTests
+```
+
+## deviceless
+
+These tests are purely deviceless and are not guaranteed or tested on a device
+or emulator due to a direct dependency on mock SDKs or other legacy reasons.
+
+Ideally, these tests should be rare, and any tests in this category should be
+migrated to multivalent whenever possible.
+
+```
+$ atest CarSettingsDevicelessRoboTests
+```
+
+## deviceonly
+
+These are non-multivalent device-only (instrumentation tests) due to legacy
+reasons and/or due to any limitations (e.g. static mocking support) that
+prevents them from migrating to multivalent.
+
+However, with the availability of deviceless SDKs (e.g. Robolectric or
+Ravenwood) and better support, these tests should also be migrated to
+multivalent to make them portable across devices as well as deviceless runs.
+
+```
+$ atest CarSettingsDeviceOnlyTests
+```
diff --git a/tests/robotests/Android.bp b/tests/deviceless/Android.bp
similarity index 67%
rename from tests/robotests/Android.bp
rename to tests/deviceless/Android.bp
index eec5437a4..6b17dcd8c 100644
--- a/tests/robotests/Android.bp
+++ b/tests/deviceless/Android.bp
@@ -1,4 +1,4 @@
-// Copyright (C) 2019 The Android Open Source Project
+// Copyright (C) 2024 The Android Open Source Project
 //
 // Licensed under the Apache License, Version 2.0 (the "License");
 // you may not use this file except in compliance with the License.
@@ -18,10 +18,14 @@ package {
     default_applicable_licenses: ["Android-Apache-2.0"],
 }
 
+// Pure robolectric deviceless tests for settings (kept as it is for now).
+// Please consider migrating these to multivalent tests instead for portability.
+
 android_robolectric_test {
-    name: "CarSettingsRoboTests",
+    name: "CarSettingsDevicelessRoboTests",
     srcs: [
         "src/**/*.java",
+        ":CarSettingsShadows-srcs",
     ],
 
     libs: [
@@ -33,7 +37,7 @@ android_robolectric_test {
 
     java_resource_dirs: ["config"],
 
-    instrumentation_for: "CarSettingsForTesting",
+    instrumentation_for: "CarSettingsAppForTesting",
 
     test_options: {
         timeout: 36000,
@@ -41,3 +45,10 @@ android_robolectric_test {
     upstream: true,
     strict_mode: false,
 }
+
+/* Future Ravenwood tests can be added like this if required.
+android_ravenwood_test {
+    name: "CarSettingsDevicelessRavenTests",
+    srcs: [],
+}
+*/
diff --git a/tests/deviceless/README.md b/tests/deviceless/README.md
new file mode 100644
index 000000000..18aa0ca26
--- /dev/null
+++ b/tests/deviceless/README.md
@@ -0,0 +1,34 @@
+# CarSettings Deviceless Tests
+
+Unit test suite for Settings, SettingsLib using Robolectric MOCK SDK.
+
+## Why they exist
+
+These deviceless tests were previously developed using Robolectric exclusively.
+Since then, they have undergone significant refinement, but they still exhibit
+direct references and reliance on Robolectric-specific concepts like shadows.
+While deviceless tests are valuable, solely relying on them limits their utility
+and portability compared to bivalent or multivalent tests that encompass both
+device-based and deviceless testing.
+
+Ultimately, these tests should be migrated to multivalent tests to facilitate
+their utilization in both deviceless and device-based testing environments.
+
+## How to run
+
+Currently, these tests utilize and rely on Robolectric (Mock SDK for app
+testing) to execute without the requirement of a device or emulator. They
+operate solely on the host and employ Robolectric to simulate SDK calls through
+the use of Shadows (Robolectric-specific concepts).
+
+```
+$ atest CarSettingsDevicelessRoboTests
+```
+
+## What about other deviceless SDKs
+
+Similar to Robolectric, there exists Ravenwood, which employs a marginally
+distinct approach to running deviceless tests and is widely regarded as more
+appropriate for platform testing (source: go/ravenwood-readme).
+
+At present, there are no Ravenwood tests for CarSettings.
diff --git a/tests/robotests/config/robolectric.properties b/tests/deviceless/config/robolectric.properties
similarity index 100%
rename from tests/robotests/config/robolectric.properties
rename to tests/deviceless/config/robolectric.properties
diff --git a/tests/robotests/res/drawable/test_icon.png b/tests/deviceless/res/drawable/test_icon.png
similarity index 100%
rename from tests/robotests/res/drawable/test_icon.png
rename to tests/deviceless/res/drawable/test_icon.png
diff --git a/tests/robotests/res/values/arrays.xml b/tests/deviceless/res/values/arrays.xml
similarity index 100%
rename from tests/robotests/res/values/arrays.xml
rename to tests/deviceless/res/values/arrays.xml
diff --git a/tests/robotests/res/values/config.xml b/tests/deviceless/res/values/config.xml
similarity index 100%
rename from tests/robotests/res/values/config.xml
rename to tests/deviceless/res/values/config.xml
diff --git a/tests/robotests/res/values/internal_resources.xml b/tests/deviceless/res/values/internal_resources.xml
similarity index 100%
rename from tests/robotests/res/values/internal_resources.xml
rename to tests/deviceless/res/values/internal_resources.xml
diff --git a/tests/robotests/res/values/preference_keys.xml b/tests/deviceless/res/values/preference_keys.xml
similarity index 100%
rename from tests/robotests/res/values/preference_keys.xml
rename to tests/deviceless/res/values/preference_keys.xml
diff --git a/tests/robotests/res/values/strings.xml b/tests/deviceless/res/values/strings.xml
similarity index 100%
rename from tests/robotests/res/values/strings.xml
rename to tests/deviceless/res/values/strings.xml
diff --git a/tests/robotests/res/xml/preference_controller_list_helper_fail_invalid_controller.xml b/tests/deviceless/res/xml/preference_controller_list_helper_fail_invalid_controller.xml
similarity index 100%
rename from tests/robotests/res/xml/preference_controller_list_helper_fail_invalid_controller.xml
rename to tests/deviceless/res/xml/preference_controller_list_helper_fail_invalid_controller.xml
diff --git a/tests/robotests/res/xml/preference_controller_list_helper_fail_invalid_occupants.xml b/tests/deviceless/res/xml/preference_controller_list_helper_fail_invalid_occupants.xml
similarity index 100%
rename from tests/robotests/res/xml/preference_controller_list_helper_fail_invalid_occupants.xml
rename to tests/deviceless/res/xml/preference_controller_list_helper_fail_invalid_occupants.xml
diff --git a/tests/robotests/res/xml/preference_controller_list_helper_fail_missing_key.xml b/tests/deviceless/res/xml/preference_controller_list_helper_fail_missing_key.xml
similarity index 100%
rename from tests/robotests/res/xml/preference_controller_list_helper_fail_missing_key.xml
rename to tests/deviceless/res/xml/preference_controller_list_helper_fail_missing_key.xml
diff --git a/tests/robotests/res/xml/preference_controller_list_helper_success.xml b/tests/deviceless/res/xml/preference_controller_list_helper_success.xml
similarity index 100%
rename from tests/robotests/res/xml/preference_controller_list_helper_success.xml
rename to tests/deviceless/res/xml/preference_controller_list_helper_success.xml
diff --git a/tests/robotests/res/xml/preference_controller_list_helper_success_occupants.xml b/tests/deviceless/res/xml/preference_controller_list_helper_success_occupants.xml
similarity index 100%
rename from tests/robotests/res/xml/preference_controller_list_helper_success_occupants.xml
rename to tests/deviceless/res/xml/preference_controller_list_helper_success_occupants.xml
diff --git a/tests/robotests/res/xml/preference_occupants_parser.xml b/tests/deviceless/res/xml/preference_occupants_parser.xml
similarity index 100%
rename from tests/robotests/res/xml/preference_occupants_parser.xml
rename to tests/deviceless/res/xml/preference_occupants_parser.xml
diff --git a/tests/robotests/res/xml/preference_parser.xml b/tests/deviceless/res/xml/preference_parser.xml
similarity index 100%
rename from tests/robotests/res/xml/preference_parser.xml
rename to tests/deviceless/res/xml/preference_parser.xml
diff --git a/tests/robotests/res/xml/settings_fragment.xml b/tests/deviceless/res/xml/settings_fragment.xml
similarity index 100%
rename from tests/robotests/res/xml/settings_fragment.xml
rename to tests/deviceless/res/xml/settings_fragment.xml
diff --git a/tests/robotests/res/xml/test_car_volume_items.xml b/tests/deviceless/res/xml/test_car_volume_items.xml
similarity index 100%
rename from tests/robotests/res/xml/test_car_volume_items.xml
rename to tests/deviceless/res/xml/test_car_volume_items.xml
diff --git a/tests/robotests/res/xml/test_user_details_base_fragment.xml b/tests/deviceless/res/xml/test_user_details_base_fragment.xml
similarity index 100%
rename from tests/robotests/res/xml/test_user_details_base_fragment.xml
rename to tests/deviceless/res/xml/test_user_details_base_fragment.xml
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/CaptionSettingsPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/CaptionSettingsPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/CaptionSettingsPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/CaptionSettingsPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/CaptionsTextSizeListPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/CaptionsTextSizeListPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/CaptionsTextSizeListPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/CaptionsTextSizeListPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/CaptionsTextStyleListPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/CaptionsTextStyleListPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/CaptionsTextStyleListPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/CaptionsTextStyleListPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderCategoryPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderCategoryPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderCategoryPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderCategoryPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderEnabledSwitchPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderEnabledSwitchPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderEnabledSwitchPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderEnabledSwitchPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderSettingsIntentPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderSettingsIntentPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderSettingsIntentPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderSettingsIntentPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderSettingsPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderSettingsPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/ScreenReaderSettingsPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/ScreenReaderSettingsPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accessibility/ShowCaptionsSwitchPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accessibility/ShowCaptionsSwitchPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accessibility/ShowCaptionsSwitchPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accessibility/ShowCaptionsSwitchPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accounts/AccountAutoSyncPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accounts/AccountAutoSyncPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accounts/AccountAutoSyncPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accounts/AccountAutoSyncPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accounts/AccountDetailsSettingControllerTest.java b/tests/deviceless/src/com/android/car/settings/accounts/AccountDetailsSettingControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accounts/AccountDetailsSettingControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accounts/AccountDetailsSettingControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accounts/AccountSyncDetailsPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accounts/AccountSyncDetailsPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accounts/AccountSyncDetailsPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accounts/AccountSyncDetailsPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accounts/AccountSyncPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/accounts/AccountSyncPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accounts/AccountSyncPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/accounts/AccountSyncPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/accounts/AccountTypesHelperTest.java b/tests/deviceless/src/com/android/car/settings/accounts/AccountTypesHelperTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/accounts/AccountTypesHelperTest.java
rename to tests/deviceless/src/com/android/car/settings/accounts/AccountTypesHelperTest.java
diff --git a/tests/robotests/src/com/android/car/settings/applications/ApplicationListItemManagerTest.java b/tests/deviceless/src/com/android/car/settings/applications/ApplicationListItemManagerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/applications/ApplicationListItemManagerTest.java
rename to tests/deviceless/src/com/android/car/settings/applications/ApplicationListItemManagerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/applications/ApplicationsUtilsTest.java b/tests/deviceless/src/com/android/car/settings/applications/ApplicationsUtilsTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/applications/ApplicationsUtilsTest.java
rename to tests/deviceless/src/com/android/car/settings/applications/ApplicationsUtilsTest.java
diff --git a/tests/robotests/src/com/android/car/settings/applications/PermissionsPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/applications/PermissionsPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/applications/PermissionsPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/applications/PermissionsPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/applications/VersionPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/applications/VersionPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/applications/VersionPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/applications/VersionPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/applications/defaultapps/DefaultAppsPickerEntryBasePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/applications/defaultapps/DefaultAppsPickerEntryBasePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/applications/defaultapps/DefaultAppsPickerEntryBasePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/applications/defaultapps/DefaultAppsPickerEntryBasePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerEntryPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerEntryPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerEntryPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerEntryPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/applications/defaultapps/DefaultAutofillPickerPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/BluetoothDevicePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothDevicePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/BluetoothDevicePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothDevicePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilePreferenceTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilePreferenceTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilePreferenceTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilePreferenceTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/BluetoothDevicesGroupPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothDevicesGroupPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/BluetoothDevicesGroupPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothDevicesGroupPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/BluetoothEntryPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothEntryPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/BluetoothEntryPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothEntryPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/BluetoothNamePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothNamePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/BluetoothNamePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothNamePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/BluetoothPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/BluetoothPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/BluetoothRenameDialogFragmentTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothRenameDialogFragmentTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/BluetoothRenameDialogFragmentTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/BluetoothRenameDialogFragmentTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/LocalRenameDialogFragmentTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/LocalRenameDialogFragmentTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/LocalRenameDialogFragmentTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/LocalRenameDialogFragmentTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/PairNewDevicePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/PairNewDevicePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/PairNewDevicePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/PairNewDevicePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/RemoteRenameDialogFragmentTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/RemoteRenameDialogFragmentTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/RemoteRenameDialogFragmentTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/RemoteRenameDialogFragmentTest.java
diff --git a/tests/robotests/src/com/android/car/settings/bluetooth/Utf8ByteLengthFilterTest.java b/tests/deviceless/src/com/android/car/settings/bluetooth/Utf8ByteLengthFilterTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/bluetooth/Utf8ByteLengthFilterTest.java
rename to tests/deviceless/src/com/android/car/settings/bluetooth/Utf8ByteLengthFilterTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/ErrorDialogTest.java b/tests/deviceless/src/com/android/car/settings/common/ErrorDialogTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/ErrorDialogTest.java
rename to tests/deviceless/src/com/android/car/settings/common/ErrorDialogTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java b/tests/deviceless/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
similarity index 98%
rename from tests/robotests/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
rename to tests/deviceless/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
index 953bee460..2b7689576 100644
--- a/tests/robotests/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
+++ b/tests/deviceless/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
@@ -17,7 +17,6 @@
 package com.android.car.settings.common;
 
 import static com.android.settingslib.drawer.CategoryKey.CATEGORY_DEVICE;
-import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_URI;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_SUMMARY;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_TITLE;
@@ -121,7 +120,6 @@ public class ExtraSettingsLoaderTest {
             assertThat(b.getString(META_DATA_PREFERENCE_TITLE)).isEqualTo(FAKE_TITLE);
             assertThat(b.getString(META_DATA_PREFERENCE_SUMMARY)).isEqualTo(FAKE_SUMMARY);
             assertThat(b.getString(META_DATA_PREFERENCE_CATEGORY)).isEqualTo(FAKE_CATEGORY);
-            assertThat(b.getInt(META_DATA_PREFERENCE_ICON)).isNotNull();
         }
     }
 
diff --git a/tests/robotests/src/com/android/car/settings/common/ExtraSettingsPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/common/ExtraSettingsPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/ExtraSettingsPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/common/ExtraSettingsPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/FakePreferenceController.java b/tests/deviceless/src/com/android/car/settings/common/FakePreferenceController.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/FakePreferenceController.java
rename to tests/deviceless/src/com/android/car/settings/common/FakePreferenceController.java
diff --git a/tests/robotests/src/com/android/car/settings/common/GroupSelectionPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/common/GroupSelectionPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/GroupSelectionPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/common/GroupSelectionPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/PasswordEditTextPreferenceDialogFragmentTest.java b/tests/deviceless/src/com/android/car/settings/common/PasswordEditTextPreferenceDialogFragmentTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/PasswordEditTextPreferenceDialogFragmentTest.java
rename to tests/deviceless/src/com/android/car/settings/common/PasswordEditTextPreferenceDialogFragmentTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/PreferenceControllerListHelperTest.java b/tests/deviceless/src/com/android/car/settings/common/PreferenceControllerListHelperTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/PreferenceControllerListHelperTest.java
rename to tests/deviceless/src/com/android/car/settings/common/PreferenceControllerListHelperTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/PreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/common/PreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/PreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/common/PreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/PreferenceControllerTestHelper.java b/tests/deviceless/src/com/android/car/settings/common/PreferenceControllerTestHelper.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/PreferenceControllerTestHelper.java
rename to tests/deviceless/src/com/android/car/settings/common/PreferenceControllerTestHelper.java
diff --git a/tests/robotests/src/com/android/car/settings/common/PreferenceUtilTest.java b/tests/deviceless/src/com/android/car/settings/common/PreferenceUtilTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/PreferenceUtilTest.java
rename to tests/deviceless/src/com/android/car/settings/common/PreferenceUtilTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/PreferenceXmlParserTest.java b/tests/deviceless/src/com/android/car/settings/common/PreferenceXmlParserTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/PreferenceXmlParserTest.java
rename to tests/deviceless/src/com/android/car/settings/common/PreferenceXmlParserTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/ProgressBarPreferenceTest.java b/tests/deviceless/src/com/android/car/settings/common/ProgressBarPreferenceTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/ProgressBarPreferenceTest.java
rename to tests/deviceless/src/com/android/car/settings/common/ProgressBarPreferenceTest.java
diff --git a/tests/robotests/src/com/android/car/settings/common/ValidatedEditTextPreferenceDialogFragmentTest.java b/tests/deviceless/src/com/android/car/settings/common/ValidatedEditTextPreferenceDialogFragmentTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/common/ValidatedEditTextPreferenceDialogFragmentTest.java
rename to tests/deviceless/src/com/android/car/settings/common/ValidatedEditTextPreferenceDialogFragmentTest.java
diff --git a/tests/robotests/src/com/android/car/settings/language/LocalePreferenceProviderTest.java b/tests/deviceless/src/com/android/car/settings/language/LocalePreferenceProviderTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/language/LocalePreferenceProviderTest.java
rename to tests/deviceless/src/com/android/car/settings/language/LocalePreferenceProviderTest.java
diff --git a/tests/robotests/src/com/android/car/settings/profiles/BroadcastReceiverHelpers.java b/tests/deviceless/src/com/android/car/settings/profiles/BroadcastReceiverHelpers.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/profiles/BroadcastReceiverHelpers.java
rename to tests/deviceless/src/com/android/car/settings/profiles/BroadcastReceiverHelpers.java
diff --git a/tests/robotests/src/com/android/car/settings/profiles/ProfileHelperTest.java b/tests/deviceless/src/com/android/car/settings/profiles/ProfileHelperTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/profiles/ProfileHelperTest.java
rename to tests/deviceless/src/com/android/car/settings/profiles/ProfileHelperTest.java
diff --git a/tests/robotests/src/com/android/car/settings/profiles/ProfileIconProviderTest.java b/tests/deviceless/src/com/android/car/settings/profiles/ProfileIconProviderTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/profiles/ProfileIconProviderTest.java
rename to tests/deviceless/src/com/android/car/settings/profiles/ProfileIconProviderTest.java
diff --git a/tests/robotests/src/com/android/car/settings/profiles/ProfilesPreferenceProviderTest.java b/tests/deviceless/src/com/android/car/settings/profiles/ProfilesPreferenceProviderTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/profiles/ProfilesPreferenceProviderTest.java
rename to tests/deviceless/src/com/android/car/settings/profiles/ProfilesPreferenceProviderTest.java
diff --git a/tests/robotests/src/com/android/car/settings/security/CredentialsResetPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/security/CredentialsResetPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/security/CredentialsResetPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/security/CredentialsResetPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/security/InitialLockSetupServiceTest.java b/tests/deviceless/src/com/android/car/settings/security/InitialLockSetupServiceTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/security/InitialLockSetupServiceTest.java
rename to tests/deviceless/src/com/android/car/settings/security/InitialLockSetupServiceTest.java
diff --git a/tests/robotests/src/com/android/car/settings/security/NoLockPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/security/NoLockPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/security/NoLockPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/security/NoLockPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/security/PinPadViewTest.java b/tests/deviceless/src/com/android/car/settings/security/PinPadViewTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/security/PinPadViewTest.java
rename to tests/deviceless/src/com/android/car/settings/security/PinPadViewTest.java
diff --git a/tests/robotests/src/com/android/car/settings/security/SaveLockWorkerTest.java b/tests/deviceless/src/com/android/car/settings/security/SaveLockWorkerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/security/SaveLockWorkerTest.java
rename to tests/deviceless/src/com/android/car/settings/security/SaveLockWorkerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/security/SecurityEntryPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/security/SecurityEntryPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/security/SecurityEntryPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/security/SecurityEntryPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/sound/RingtonePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/sound/RingtonePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/sound/RingtonePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/sound/RingtonePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/sound/VolumeSettingsRingtoneManagerTest.java b/tests/deviceless/src/com/android/car/settings/sound/VolumeSettingsRingtoneManagerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/sound/VolumeSettingsRingtoneManagerTest.java
rename to tests/deviceless/src/com/android/car/settings/sound/VolumeSettingsRingtoneManagerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/suggestions/SuggestionPreferenceTest.java b/tests/deviceless/src/com/android/car/settings/suggestions/SuggestionPreferenceTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/suggestions/SuggestionPreferenceTest.java
rename to tests/deviceless/src/com/android/car/settings/suggestions/SuggestionPreferenceTest.java
diff --git a/tests/robotests/src/com/android/car/settings/suggestions/SuggestionsPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/suggestions/SuggestionsPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/suggestions/SuggestionsPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/suggestions/SuggestionsPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/BaseTestActivity.java b/tests/deviceless/src/com/android/car/settings/testutils/BaseTestActivity.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/BaseTestActivity.java
rename to tests/deviceless/src/com/android/car/settings/testutils/BaseTestActivity.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/DialogTestUtils.java b/tests/deviceless/src/com/android/car/settings/testutils/DialogTestUtils.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/DialogTestUtils.java
rename to tests/deviceless/src/com/android/car/settings/testutils/DialogTestUtils.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/FragmentController.java b/tests/deviceless/src/com/android/car/settings/testutils/FragmentController.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/FragmentController.java
rename to tests/deviceless/src/com/android/car/settings/testutils/FragmentController.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/ButtonPasswordEditTextPreferenceTest.java b/tests/deviceless/src/com/android/car/settings/wifi/ButtonPasswordEditTextPreferenceTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/ButtonPasswordEditTextPreferenceTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/ButtonPasswordEditTextPreferenceTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/NetworkNamePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/wifi/NetworkNamePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/NetworkNamePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/NetworkNamePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/WifiRequestToggleActivityTest.java b/tests/deviceless/src/com/android/car/settings/wifi/WifiRequestToggleActivityTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/WifiRequestToggleActivityTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/WifiRequestToggleActivityTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/WifiStatusPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/wifi/WifiStatusPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/WifiStatusPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/WifiStatusPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/WifiTetherApBandPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/wifi/WifiTetherApBandPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/WifiTetherApBandPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/WifiTetherApBandPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/WifiTetherAutoOffPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/wifi/WifiTetherAutoOffPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/WifiTetherAutoOffPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/WifiTetherAutoOffPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/WifiTetherBasePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/wifi/WifiTetherBasePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/WifiTetherBasePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/WifiTetherBasePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/WifiTetherNamePreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/wifi/WifiTetherNamePreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/WifiTetherNamePreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/WifiTetherNamePreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/wifi/WifiTetherPasswordPreferenceControllerTest.java b/tests/deviceless/src/com/android/car/settings/wifi/WifiTetherPasswordPreferenceControllerTest.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/wifi/WifiTetherPasswordPreferenceControllerTest.java
rename to tests/deviceless/src/com/android/car/settings/wifi/WifiTetherPasswordPreferenceControllerTest.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowAccountManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowAccountManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowAccountManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowAccountManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowActivityManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowActivityManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowActivityManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowActivityManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowApplicationPackageManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowApplicationPackageManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowApplicationPackageManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowApplicationPackageManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowAutofillServiceInfo.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowAutofillServiceInfo.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowAutofillServiceInfo.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowAutofillServiceInfo.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowBluetoothAdapter.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowBluetoothAdapter.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowBluetoothAdapter.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowBluetoothAdapter.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowBluetoothPan.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowBluetoothPan.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowBluetoothPan.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowBluetoothPan.java
diff --git a/tests/helpers/src/com/android/car/settings/testutils/ShadowCar.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowCar.java
new file mode 100644
index 000000000..4028abd6d
--- /dev/null
+++ b/tests/helpers/src/com/android/car/settings/testutils/ShadowCar.java
@@ -0,0 +1,42 @@
+/*
+ * Copyright (C) 2018 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import static org.robolectric.shadow.api.Shadow.newInstanceOf;
+import android.car.Car;
+import android.content.Context;
+import android.os.Handler;
+import org.robolectric.annotation.Implementation;
+import org.robolectric.annotation.Implements;
+
+/** Robolectric shadow class for {@link Car} */
+@Implements(Car.class)
+public class ShadowCar {
+    @Implementation
+    public static Car createCar(Context context) {
+        return newInstanceOf(Car.class);
+    }
+
+    @Implementation
+    public static Car createCar(
+            Context context,
+            Handler handler,
+            long waitTimeoutMs,
+            Car.CarServiceLifecycleListener statusChangeListener) {
+        return newInstanceOf(Car.class);
+    }
+}
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowCarWifiManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowCarWifiManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowCarWifiManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowCarWifiManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowContentResolver.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowContentResolver.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowContentResolver.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowContentResolver.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowDefaultDialerManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowDefaultDialerManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowDefaultDialerManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowDefaultDialerManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowLocalBroadcastManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowLocalBroadcastManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowLocalBroadcastManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowLocalBroadcastManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowLocaleStore.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowLocaleStore.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowLocaleStore.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowLocaleStore.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowLockPatternUtils.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowLockPatternUtils.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowLockPatternUtils.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowLockPatternUtils.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowPermissionControllerManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowPermissionControllerManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowPermissionControllerManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowPermissionControllerManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowRingtone.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowRingtone.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowRingtone.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowRingtone.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowRingtoneManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowRingtoneManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowRingtoneManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowRingtoneManager.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowSecureSettings.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowSecureSettings.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowSecureSettings.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowSecureSettings.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowSmsApplication.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowSmsApplication.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowSmsApplication.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowSmsApplication.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowTypeface.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowTypeface.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowTypeface.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowTypeface.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowUserHelper.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowUserHelper.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowUserHelper.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowUserHelper.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowUserIconProvider.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowUserIconProvider.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowUserIconProvider.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowUserIconProvider.java
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowUserManager.java b/tests/helpers/src/com/android/car/settings/testutils/ShadowUserManager.java
similarity index 100%
rename from tests/robotests/src/com/android/car/settings/testutils/ShadowUserManager.java
rename to tests/helpers/src/com/android/car/settings/testutils/ShadowUserManager.java
diff --git a/tests/multivalent/Android.bp b/tests/multivalent/Android.bp
new file mode 100644
index 000000000..104ed120c
--- /dev/null
+++ b/tests/multivalent/Android.bp
@@ -0,0 +1,197 @@
+// Copyright (C) 2024 The Android Open Source Project
+//
+// Licensed under the Apache License, Version 2.0 (the "License");
+// you may not use this file except in compliance with the License.
+// You may obtain a copy of the License at
+//
+//      http://www.apache.org/licenses/LICENSE-2.0
+//
+// Unless required by applicable law or agreed to in writing, software
+// distributed under the License is distributed on an "AS IS" BASIS,
+// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+// See the License for the specific language governing permissions and
+// limitations under the License.
+
+package {
+    default_team: "trendy_team_system_experience",
+    default_applicable_licenses: ["Android-Apache-2.0"],
+}
+
+android_robolectric_test {
+    name: "CarSettingsMultivalentRoboTests",
+    srcs: [
+        "src/**/*.kt",
+        // Goal is have `src/**/*.java` (i.e. all tests to work w/ Robolectric)
+        // "src/**/AccountDetailsPreferenceControllerTest.java",
+        "src/**/AccountGroupPreferenceControllerTest.java",
+        "src/**/AddMobileNetworkPreferenceControllerTest.java",
+        // "src/**/AddProfilePreferenceControllerTest.java",
+        "src/**/AllAppsPreferenceControllerTest.java",
+        "src/**/BluetoothStateSwitchPreferenceControllerTest.java",
+        "src/**/CellularFallbackTogglePreferenceControllerTest.java",
+        "src/**/ChooseLockTypePreferenceControllerTest.java",
+        "src/**/ConfirmLockLockoutHelperTest.java",
+        "src/**/DataLimitPreferenceControllerTest.java",
+        "src/**/DataUsageEditTextPreferenceControllerTest.java",
+        "src/**/DataUsageSummaryPreferenceControllerTest.java",
+        "src/**/DataWarningPreferenceControllerTest.java",
+        "src/**/DatePickerPreferenceControllerTest.java",
+        "src/**/DefaultAssistantPickerEntryPreferenceControllerTest.java",
+        "src/**/DomainUrlsUtilsTest.java",
+        "src/**/KeyboardManagementPreferenceControllerTest.java",
+        // "src/**/LanguageBasePreferenceControllerTest.java",
+        "src/**/LegalPreferenceControllerTest.java",
+        "src/**/LocationInfotainmentAppsPreferenceControllerTest.java",
+        "src/**/LocationRecentAccessViewAllPreferenceControllerTest.java",
+        "src/**/LocationServicesPreferenceControllerTest.java",
+        "src/**/LockTypeBasePreferenceControllerTest.java",
+        "src/**/ManageCameraPermissionsPreferenceControllerTest.java",
+        "src/**/ManageMicPermissionsPreferenceControllerTest.java",
+        "src/**/MediaVolumeSliderWorkerTest.java",
+        "src/**/MicTogglePreferenceControllerTest.java",
+        "src/**/MicrophoneRecentAccessViewAllPreferenceControllerTest.java",
+        "src/**/MoreSpecialAccessPreferenceControllerTest.java",
+        "src/**/NotificationsPreferenceControllerTest.java",
+        "src/**/PreferenceControllerTest.java",
+        // "src/**/ProfileDetailsActionButtonsPreferenceControllerTest.java",
+        "src/**/RecentAppsViewAllPreferenceControllerTest.java",
+        "src/**/ResetNetworkEntryPreferenceControllerTest.java",
+        "src/**/SettingsQCRegistryTest.java",
+        // "src/**/StorageApplicationActionButtonsPreferenceControllerTest.java",
+        "src/**/StorageApplicationListPreferenceControllerTest.java",
+        "src/**/StorageSettingsManagerTest.java",
+        "src/**/SubscriptionsChangeListenerTest.java",
+        "src/**/ThemeTogglePreferenceControllerTest.java",
+        "src/**/ThirdPartyLicensePreferenceControllerTest.java",
+        "src/**/TimeZonePickerPreferenceControllerTest.java",
+        "src/**/UnitsBasePreferenceControllerTest.java",
+        "src/**/UnitsPressurePreferenceControllerTest.java",
+        "src/**/WifiTetherPreferenceControllerTest.java",
+        "src/**/testutils/*.java",
+        "src/**/TestBluetoothRequestPermissionActivity.java",
+        "src/**/BaseCarSettingsActivityTestCase.java",
+        "src/**/FakePreferenceController.java",
+        "src/**/PreferenceControllerTestUtil.java",
+        "src/**/SettingsFragmentTestCase.java",
+        "src/**/BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase.java",
+        "src/**/BaseAdminGrantedPermissionsPreferenceControllerTestCase.java",
+        "src/**/BaseEnterprisePreferenceControllerTestCase.java",
+        "src/**/BaseEnterprisePrivacyPreferenceControllerTestCase.java",
+        "src/**/BaseEnterpriseTestCase.java",
+        "src/**/DefaultDeviceAdminReceiver.java",
+        "src/**/FancyDeviceAdminReceiver.java",
+        "src/**/BaseSettingsQCItemTestCase.java",
+        "src/**/BrightnessSliderTestCase.java",
+        "src/**/MobileDataBaseWorkerTestCase.java",
+        "src/**/QCTestUtils.java",
+        "src/**/TestSettingsQCBackgroundWorker.java",
+        "src/**/TestSettingsQCItem.java",
+        "src/**/VolumeSliderTestCase.java",
+        "src/**/WifiBaseWorkerTestCase.java",
+        "src/**/FactoryResetFragmentTestCase.java",
+        "src/**/LegalPreferenceControllerTestCase.java",
+        "src/**/BaseCarSettingsTestActivity.java",
+        "src/**/BaseTestSettingsFragment.java",
+        "src/**/BluetoothTestUtils.java",
+        "src/**/DialogTestUtils.java",
+        "src/**/DualPaneTestActivity.java",
+        "src/**/EmptySettingsFragment.java",
+        "src/**/EnterpriseTestUtils.java",
+        "src/**/PollingCheck.java",
+        "src/**/ResourceTestUtils.java",
+        "src/**/RootTestSettingsFragment.java",
+        "src/**/SinglePaneTestActivity.java",
+        "src/**/TestContentProvider.java",
+        "src/**/TestEventListener.java",
+        "src/**/TestFinishActivity.java",
+        "src/**/TestLifecycleOwner.java",
+        "src/**/TestSettingsFragment1.java",
+        "src/**/TestSettingsFragment2.java",
+        "src/**/TestSettingsScreenLockActivity.java",
+        "src/**/TestTopLevelMenuFragment.java",
+        "src/**/TextDrawable.java",
+        "src/**/WifiDetailsBasePreferenceControllerTestCase.java",
+        ":CarSettingsShadows-srcs",
+    ],
+    libs: [
+        "android.car.test.utils",
+        "android.car",
+        "android.test.base.stubs.system",
+        "android.test.mock.stubs.system",
+        "android.test.runner.stubs.system",
+        "android.test.runner.stubs.system",
+        "androidx.test.core",
+        "androidx.test.ext.junit",
+        "androidx.test.ext.truth",
+        "androidx.test.rules",
+        "androidx.test.runner",
+        "car-helper-lib",
+        "flag-junit",
+        "inline-mockito-robolectric-prebuilt",
+        "mockito-kotlin2",
+        "mockito-target-extended-minus-junit4",
+        "platform-test-annotations",
+        "testng",
+        "truth",
+    ],
+    java_resource_dirs: ["config"],
+    instrumentation_for: "CarSettingsAppForMultivalentTesting",
+    test_options: {
+        timeout: 36000,
+    },
+    upstream: true,
+    strict_mode: false,
+    test_config: "CarSettingsMultivalentRoboTests-AndroidTest.xml",
+}
+
+android_test {
+    name: "CarSettingsMultivalentDeviceTests",
+    certificate: "platform",
+    privileged: true,
+    srcs: [
+        "src/**/*.kt",
+        "src/**/*.java",
+    ],
+    libs: [
+        "android.test.runner.stubs.system",
+        "android.test.base.stubs.system",
+        "android.test.mock.stubs.system",
+    ],
+    static_libs: [
+        "CarSettingsLibForDeviceTesting",
+        "android.car",
+        "android.car.test.utils",
+        "androidx.test.core",
+        "androidx.test.rules",
+        "androidx.test.ext.junit",
+        "androidx.test.ext.truth",
+        "flag-junit",
+        "mockito-kotlin2",
+        "mockito-target-extended-minus-junit4",
+        "platform-test-annotations",
+        "truth",
+        "testng",
+        "car-helper-lib",
+        "collector-device-lib-platform",
+    ],
+    jni_libs: [
+        "libdexmakerjvmtiagent",
+        "libstaticjvmtiagent",
+    ],
+    aaptflags: ["--extra-packages com.android.car.settings"],
+    test_suites: [
+        "device-tests",
+        "automotive-tests",
+    ],
+    compile_multilib: "64",
+    // TODO(b/319708040): re-enable use_resource_processor
+    use_resource_processor: false,
+    test_config: "CarSettingsMultivalentDeviceTests-AndroidTest.xml",
+}
+
+/* Future Ravenwood tests can be added like this if required.
+android_ravenwood_test {
+    name: "CarSettingsMultivalentRavenTests",
+    srcs: [],
+}
+*/
diff --git a/tests/multivalent/AndroidManifest.xml b/tests/multivalent/AndroidManifest.xml
new file mode 100644
index 000000000..7f9001024
--- /dev/null
+++ b/tests/multivalent/AndroidManifest.xml
@@ -0,0 +1,198 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<manifest
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:androidprv="http://schemas.android.com/apk/prv/res/android"
+    android:sharedUserId="android.uid.system"
+    package="com.android.car.settings.tests.unit">
+
+    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
+    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
+    <uses-permission android:name="android.permission.BACKUP"/>
+    <!-- Request legacy Bluetooth permissions on older devices. -->
+    <uses-permission android:name="android.permission.BLUETOOTH"
+                     android:maxSdkVersion="30" />
+    <uses-permission android:name="android.permission.BLUETOOTH_ADMIN"
+                     android:maxSdkVersion="30" />
+    <uses-permission android:name="android.permission.BLUETOOTH_SCAN" />
+    <uses-permission android:name="android.permission.BLUETOOTH_ADVERTISE" />
+    <uses-permission android:name="android.permission.BLUETOOTH_CONNECT" />
+    <uses-permission android:name="android.permission.BLUETOOTH_PRIVILEGED"/>
+    <uses-permission android:name="android.permission.CAR_VENDOR_EXTENSION"/>
+    <uses-permission android:name="android.permission.CHANGE_WIFI_STATE"/>
+    <uses-permission android:name="android.permission.CLEAR_APP_USER_DATA"/>
+    <uses-permission android:name="android.permission.CONTROL_DISPLAY_UNITS"/>
+    <uses-permission android:name="android.permission.DELETE_CACHE_FILES"/>
+    <uses-permission android:name="android.permission.DUMP"/>
+    <uses-permission android:name="android.permission.FORCE_STOP_PACKAGES"/>
+    <uses-permission android:name="android.permission.GET_ACCOUNTS_PRIVILEGED"/>
+    <uses-permission android:name="android.permission.GET_PACKAGE_SIZE"/>
+    <uses-permission android:name="android.permission.INJECT_EVENTS"/>
+    <uses-permission android:name="android.permission.INTERACT_ACROSS_USERS"/>
+    <uses-permission android:name="android.permission.INTERNET"/>
+    <uses-permission android:name="android.permission.MANAGE_ACCOUNTS"/>
+    <uses-permission android:name="android.permission.MANAGE_ROLE_HOLDERS"/>
+    <uses-permission android:name="android.permission.MANAGE_USERS"/>
+    <uses-permission android:name="android.permission.MASTER_CLEAR" />
+    <uses-permission android:name="android.permission.MOUNT_UNMOUNT_FILESYSTEMS"/>
+    <uses-permission android:name="android.permission.NETWORK_SETTINGS" />
+    <uses-permission android:name="android.permission.OVERRIDE_WIFI_CONFIG"/>
+    <uses-permission android:name="android.permission.READ_CONTACTS"/>
+    <uses-permission android:name="android.permission.READ_DISPLAY_UNITS"/>
+    <uses-permission android:name="android.permission.REBOOT"/>
+    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
+    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>
+    <uses-permission android:name="android.permission.REQUEST_DELETE_PACKAGES"/>
+    <uses-permission android:name="android.permission.SET_PREFERRED_APPLICATIONS"/>
+    <uses-permission android:name="android.permission.START_FOREGROUND"/>
+    <uses-permission android:name="android.permission.STATUS_BAR_SERVICE"/>
+    <uses-permission android:name="android.permission.SUGGEST_MANUAL_TIME_AND_ZONE"/>
+    <uses-permission android:name="android.permission.WRITE_SETTINGS"/>
+    <uses-permission android:name="android.permission.WRITE_SECURE_SETTINGS"/>
+    <uses-permission android:name="android.permission.MANAGE_SENSOR_PRIVACY"/>
+    <uses-permission android:name="android.permission.OBSERVE_SENSOR_PRIVACY"/>
+
+    <application
+        android:name="com.android.car.settings.CarSettingsApplication"
+        android:debuggable="true"
+        android:testOnly="true">
+        <uses-library android:name="android.test.runner" />
+
+        <activity
+            android:name="com.android.car.settings.common.SubSettingsActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">
+            <meta-data android:name="com.android.car.settings.SINGLE_PANE" android:value="true"/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <provider
+            android:name="com.android.car.settings.testutils.TestContentProvider"
+            android:authorities="com.android.car.settings.testutils.TestContentProvider"
+            android:exported="true">
+        </provider>
+
+        <activity
+            android:name="com.android.car.settings.testutils.TestFinishActivity">
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.testutils.BaseCarSettingsTestActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.testutils.SinglePaneTestActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">
+            <meta-data android:name="com.android.car.settings.SINGLE_PANE" android:value="true"/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.testutils.DualPaneTestActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">
+            <meta-data android:name="com.android.car.settings.SINGLE_PANE" android:value="false"/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.common.DualPaneBaseCarSettingsActivityTest$TestDualPaneHomepageActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">
+            <meta-data android:name="com.android.car.settings.SINGLE_PANE" android:value="false"/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.common.DualPaneBaseCarSettingsActivityTest$TestDualPaneFragmentActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">
+            <meta-data android:name="com.android.car.settings.SINGLE_PANE" android:value="false"/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.testutils.TestSettingsScreenLockActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">
+            <meta-data android:name="com.android.car.settings.SINGLE_PANE" android:value="true"/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.testutils.TestSubSettingsActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
+        <activity android:name="com.android.car.settings.notifications.NotificationAccessConfirmationActivity"
+            android:taskAffinity="com.android.car.settings.notifications.NotificationAccessConfirmationActivity"
+            android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert" />
+
+        <activity android:name="com.android.car.settings.notifications.NotificationAccessConfirmationActivityTest$TestActivity"
+            android:taskAffinity="com.android.car.settings.notifications.NotificationAccessConfirmationActivity"
+            android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert" />
+
+        <activity
+            android:name="com.android.car.settings.enterprise.ActionDisabledByAdminActivity"
+            android:theme="@style/ActionDialogTheme">
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.system.RegulatoryInfoDisplayActivity"
+            android:theme="@style/CarSettingTheme"
+            android:label="@string/regulatory_labels">
+        </activity>
+
+        <activity android:name="com.android.car.settings.admin.NewUserDisclaimerActivity"
+            android:theme="@android:style/Theme.NoTitleBar.Fullscreen"
+            android:launchMode="singleTask">
+        </activity>
+
+        <activity
+            android:name="com.android.car.settings.bluetooth.TestBluetoothRequestPermissionActivity"
+            android:theme="@style/ActionDialogTheme">
+        </activity>
+
+        <receiver
+            android:name="com.android.car.settings.enterprise.DefaultDeviceAdminReceiver">
+            <meta-data android:name="android.app.device_admin"
+                 android:resource="@xml/empty_device_admin"/>
+        </receiver>
+
+        <receiver
+            android:name="com.android.car.settings.enterprise.FancyDeviceAdminReceiver"
+            android:label="@string/fancy_device_admin_label"
+            android:icon="@drawable/test_icon"
+            android:description="@string/fancy_device_admin_description">
+            <meta-data android:name="android.app.device_admin"
+                 android:resource="@xml/fancy_device_admin"/>
+        </receiver>
+
+    </application>
+
+    <instrumentation android:name="androidx.test.runner.AndroidJUnitRunner"
+                     android:targetPackage="com.android.car.settings.tests.unit"
+                     android:label="Car Settings Unit Tests"/>
+</manifest>
diff --git a/tests/multivalent/CarSettingsMultivalentDeviceTests-AndroidTest.xml b/tests/multivalent/CarSettingsMultivalentDeviceTests-AndroidTest.xml
new file mode 100644
index 000000000..b7e6e41a0
--- /dev/null
+++ b/tests/multivalent/CarSettingsMultivalentDeviceTests-AndroidTest.xml
@@ -0,0 +1,30 @@
+<!--
+  ~ Copyright (C) 2024 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<configuration description="Runs Car Settings Test Cases.">
+    <option name="test-tag" value="CarSettingsMultivalentDeviceTests" />
+    <target_preparer class="com.android.tradefed.targetprep.suite.SuiteApkInstaller">
+        <option name="test-file-name" value="CarSettingsMultivalentDeviceTests.apk"/>
+        <option name="install-arg" value="-t" />
+    </target_preparer>
+
+    <test class="com.android.tradefed.testtype.AndroidJUnitTest">
+        <option name="package" value="com.android.car.settings.tests.unit"/>
+        <option name="runner" value="androidx.test.runner.AndroidJUnitRunner"/>
+        <option name="test-filter-dir" value="/data/data/com.android.car.settings.tests.unit"/>
+        <option name="hidden-api-checks" value="false"/>
+    </test>
+</configuration>
\ No newline at end of file
diff --git a/tests/multivalent/CarSettingsMultivalentRoboTests-AndroidTest.xml b/tests/multivalent/CarSettingsMultivalentRoboTests-AndroidTest.xml
new file mode 100644
index 000000000..59cb38b68
--- /dev/null
+++ b/tests/multivalent/CarSettingsMultivalentRoboTests-AndroidTest.xml
@@ -0,0 +1,24 @@
+<configuration>
+    <device_requirements class="com.android.tradefed.device.DeviceSelectionOptions"/>
+    <device_options class="com.android.tradefed.device.TestDeviceOptions"/>
+    <test class="com.android.tradefed.testtype.IsolatedHostTest">
+        <option name="exclude-paths" value="android/os/nano"/>
+        <option name="exclude-paths" value="java"/>
+        <option name="exclude-paths" value="org/junit"/>
+        <option name="exclude-paths" value="com/google/common/collect/testing/google"/>
+        <option name="jar" value="CarSettingsMultivalentRoboTests.jar"/>
+        <option name="java-flags" value="--add-modules=jdk.compiler"/>
+        <option name="java-flags" value="--add-opens=java.base/java.lang=ALL-UNNAMED"/>
+        <option name="java-flags" value="--add-opens=java.base/java.lang.reflect=ALL-UNNAMED"/>
+        <option name="java-flags" value="--add-opens=java.base/jdk.internal.util.random=ALL-UNNAMED"/>
+        <option name="java-flags" value="--add-opens=java.base/java.io=ALL-UNNAMED"/>
+        <option name="java-folder" value="prebuilts/jdk/jdk21/linux-x86"/>
+        <option name="use-robolectric-resources" value="true"/>
+        <option name="do-not-swallow-runner-errors" value="true"/>
+    </test>
+    <config_desc class="com.android.tradefed.config.ConfigurationDescriptor">
+        <option name="test-suite-tag" value="robolectric"/>
+        <option name="test-suite-tag" value="robolectric-tests"/>
+    </config_desc>
+    <coverage class="com.android.tradefed.testtype.coverage.CoverageOptions"/>
+</configuration>
\ No newline at end of file
diff --git a/tests/multivalent/README.md b/tests/multivalent/README.md
new file mode 100644
index 000000000..0e2eb1ab3
--- /dev/null
+++ b/tests/multivalent/README.md
@@ -0,0 +1,27 @@
+# CarSettings Multivalent Tests
+
+Unit test suite for Settings, SettingsLib with device and deviceless
+capabilities either using Robolectric (or Ravenwood).
+
+## Why Multivalent
+
+There are called multivalent because the same tests can run in mock SDK or real
+device/emulator SDK. Writing tests once and being able to run using different
+SDKs help eliminate duplication and flakiness.
+
+Deviceless tests run faster and are more stable. They provide more reliable and
+quick feedback during development and help catch any regressions early.
+
+## How to run
+
+To run the multivalent Robolectric tests.
+
+```
+$ atest CarSettingsMultivalentRoboTests
+```
+
+To run the multivalent Device tests.
+
+```
+$ atest CarSettingsMultivalentDeviceTests
+```
diff --git a/tests/multivalent/config/robolectric.properties b/tests/multivalent/config/robolectric.properties
new file mode 100644
index 000000000..81fb18d83
--- /dev/null
+++ b/tests/multivalent/config/robolectric.properties
@@ -0,0 +1,19 @@
+#
+# Copyright (C) 2024 Google Inc.
+#
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#      http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+sdk=NEWEST_SDK
+shadows=\
+  com.android.car.settings.testutils.ShadowCar
+looperMode=LEGACY
diff --git a/tests/multivalent/res/drawable/test_icon.xml b/tests/multivalent/res/drawable/test_icon.xml
new file mode 100644
index 000000000..93ab1a775
--- /dev/null
+++ b/tests/multivalent/res/drawable/test_icon.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+  ~ Copyright (C) 2020 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<vector
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="44dp"
+    android:height="44dp"
+    android:viewportHeight="24.0"
+    android:viewportWidth="24.0">
+    <path
+        android:fillColor="#ffffff"
+        android:pathData="M19,6.41L17.59,5 12,10.59 6.41,5 5,6.41 10.59,12 5,17.59 6.41,19 12,13.41 17.59,19 19,17.59 13.41,12z"/>
+</vector>
\ No newline at end of file
diff --git a/tests/multivalent/res/drawable/test_icon_2.png b/tests/multivalent/res/drawable/test_icon_2.png
new file mode 100644
index 000000000..a1cf83e68
Binary files /dev/null and b/tests/multivalent/res/drawable/test_icon_2.png differ
diff --git a/tests/multivalent/res/values/arrays.xml b/tests/multivalent/res/values/arrays.xml
new file mode 100644
index 000000000..7627dc0a0
--- /dev/null
+++ b/tests/multivalent/res/values/arrays.xml
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2021 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<resources>
+    <string-array name="entries" translatable="false">
+        <item>Choose me!</item>
+        <item>No, me!</item>
+        <item>What about me?!</item>
+    </string-array>
+
+    <string-array name="entry_values" translatable="false">
+        <item>alpha</item>
+        <item>beta</item>
+        <item>charlie</item>
+    </string-array>
+
+    <string-array name="settings_qc_provider_package_allowlist">
+        <item>com.android.car.settings.test.unit</item>
+    </string-array>
+</resources>
diff --git a/tests/multivalent/res/values/config.xml b/tests/multivalent/res/values/config.xml
new file mode 100644
index 000000000..c6a04bf61
--- /dev/null
+++ b/tests/multivalent/res/values/config.xml
@@ -0,0 +1,27 @@
+<!--
+  ~ Copyright (C) 2021 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<resources>
+    <!-- Whether exit button in settings' root action bar should be shown or not -->
+    <bool name="config_show_settings_root_exit_icon">true</bool>
+    <!-- Whether the root fragment should actually be root -->
+    <bool name="config_is_root_fragment_root">true</bool>
+    <!--
+        Maximum number of devices to show for paired bluetooth device quick control.
+        Set to -1 for unlimited.
+     -->
+    <integer name="config_qc_bluetooth_device_limit">3</integer>
+</resources>
\ No newline at end of file
diff --git a/res/values-w1400dp/config.xml b/tests/multivalent/res/values/internal_resources.xml
similarity index 72%
rename from res/values-w1400dp/config.xml
rename to tests/multivalent/res/values/internal_resources.xml
index d13c5041c..5ed65c2e7 100644
--- a/res/values-w1400dp/config.xml
+++ b/tests/multivalent/res/values/internal_resources.xml
@@ -16,7 +16,6 @@
 -->
 
 <resources>
-    <bool name="config_global_force_single_pane">false</bool>
-    <string name="config_homepage_fragment_class" translatable="false">com.android.car.settings.bluetooth.BluetoothSettingsFragment</string>
-    <bool name="config_top_level_enable_chevrons">false</bool>
+    <bool name="config_automatic_brightness_available">true</bool>
+    <integer name="config_networkAvoidBadWifi">0</integer>
 </resources>
diff --git a/tests/multivalent/res/values/preference_keys.xml b/tests/multivalent/res/values/preference_keys.xml
new file mode 100644
index 000000000..860b497cf
--- /dev/null
+++ b/tests/multivalent/res/values/preference_keys.xml
@@ -0,0 +1,23 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2021 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<!-- Namespaced with "tpk" (Test Preference Key) to avoid conflicts. -->
+<resources>
+    <!-- SettingsFragmentTest -->
+    <string name="tpk_fake_controller" translatable="false">fake_controller</string>
+    <string name="tpk_edit_text_preference" translatable="false">edit_text_preference</string>
+    <string name="tpk_list_preference" translatable="false">list_preference</string>
+
+</resources>
diff --git a/tests/multivalent/res/values/strings.xml b/tests/multivalent/res/values/strings.xml
new file mode 100644
index 000000000..91a716a60
--- /dev/null
+++ b/tests/multivalent/res/values/strings.xml
@@ -0,0 +1,34 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2021 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<resources>
+    <string name="account_type1_label" translatable="false">Type 1</string>
+    <string name="account_type2_label" translatable="false">Type 2</string>
+    <string name="account_type3_label" translatable="false">Type 3</string>
+
+    <string name="test_positive_button_label" translatable="false">Positive Button</string>
+    <string name="test_negative_button_label" translatable="false">Negative Button</string>
+    <string name="test_neutral_button_label" translatable="false">Neutral Button</string>
+
+    <string name="fancy_device_admin_label" translatable="false">LordOfTheSevenReceiverKingdoms</string>
+    <string name="fancy_device_admin_description" translatable="false">One Receiver to Rule them All</string>
+
+    <string name="test_volume_call" translatable="false">Call Volume</string>
+    <string name="test_volume_music" translatable="false">Music Volume</string>
+    <string name="test_volume_navigation" translatable="false">Navigation Volume</string>
+
+    <string name="bt_profile_name" translatable="false">Profile Name</string>
+</resources>
diff --git a/tests/multivalent/res/xml/empty_device_admin.xml b/tests/multivalent/res/xml/empty_device_admin.xml
new file mode 100644
index 000000000..e033f69a5
--- /dev/null
+++ b/tests/multivalent/res/xml/empty_device_admin.xml
@@ -0,0 +1,16 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2021 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<device-admin xmlns:android="http://schemas.android.com/apk/res/android"/>
diff --git a/tests/multivalent/res/xml/empty_preference_screen.xml b/tests/multivalent/res/xml/empty_preference_screen.xml
new file mode 100644
index 000000000..ddc37bc85
--- /dev/null
+++ b/tests/multivalent/res/xml/empty_preference_screen.xml
@@ -0,0 +1,19 @@
+<!--
+  ~ Copyright (C) 2021 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<PreferenceScreen
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    android:title="empty_preference_screen_title"/>
diff --git a/tests/multivalent/res/xml/fancy_device_admin.xml b/tests/multivalent/res/xml/fancy_device_admin.xml
new file mode 100644
index 000000000..7aca6d91c
--- /dev/null
+++ b/tests/multivalent/res/xml/fancy_device_admin.xml
@@ -0,0 +1,27 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2021 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+<device-admin xmlns:android="http://schemas.android.com/apk/res/android">
+    <uses-policies>
+        <!--  Arbitrary number of policies -->
+        <expire-password/>
+        <encrypted-storage/>
+        <force-lock/>
+        <limit-password/>
+        <reset-password/>
+        <watch-login/>
+        <wipe-data/>
+    </uses-policies>
+</device-admin>
diff --git a/tests/multivalent/res/xml/test_base_settings_fragment.xml b/tests/multivalent/res/xml/test_base_settings_fragment.xml
new file mode 100644
index 000000000..8bfc2e9d4
--- /dev/null
+++ b/tests/multivalent/res/xml/test_base_settings_fragment.xml
@@ -0,0 +1,33 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!--
+    Copyright 2021 The Android Open Source Project
+
+    Licensed under the Apache License, Version 2.0 (the "License");
+    you may not use this file except in compliance with the License.
+    You may obtain a copy of the License at
+
+         http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+
+<PreferenceScreen
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:settings="http://schemas.android.com/apk/res-auto"
+    android:title="screen_title">
+    <Preference
+        android:key="@string/tpk_fake_controller"
+        settings:controller="com.android.car.settings.common.FakePreferenceController"/>
+    <EditTextPreference
+        android:key="@string/tpk_edit_text_preference"/>
+    <ListPreference
+        android:title="@string/tpk_list_preference"
+        android:dialogTitle="@string/tpk_list_preference"
+        android:entries="@array/entries"
+        android:entryValues="@array/entry_values"
+        android:key="@string/tpk_list_preference"/>
+</PreferenceScreen>
diff --git a/tests/multivalent/res/xml/test_car_volume_items.xml b/tests/multivalent/res/xml/test_car_volume_items.xml
new file mode 100644
index 000000000..83b0fd18a
--- /dev/null
+++ b/tests/multivalent/res/xml/test_car_volume_items.xml
@@ -0,0 +1,37 @@
+<?xml version="1.0" encoding="utf-8"?>
+<!-- Copyright (C) 2018 The Android Open Source Project
+
+     Licensed under the Apache License, Version 2.0 (the "License");
+     you may not use this file except in compliance with the License.
+     You may obtain a copy of the License at
+
+          http://www.apache.org/licenses/LICENSE-2.0
+
+     Unless required by applicable law or agreed to in writing, software
+     distributed under the License is distributed on an "AS IS" BASIS,
+     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+     See the License for the specific language governing permissions and
+     limitations under the License.
+-->
+
+<!--
+  We use a separate test file due to the difficulty accessing android internal resources in tests.
+-->
+<carVolumeItems xmlns:car="http://schemas.android.com/apk/res-auto">
+    <item car:usage="voice_communication"
+          car:titleText="@string/test_volume_call"
+          car:icon="@drawable/test_icon"
+          car:mute_icon="@drawable/test_icon" />
+    <item car:usage="voice_communication_signalling"
+          car:titleText="@string/test_volume_call"
+          car:icon="@drawable/test_icon"
+          car:mute_icon="@drawable/test_icon" />
+    <item car:usage="media"
+          car:titleText="@string/test_volume_music"
+          car:icon="@drawable/test_icon"
+          car:mute_icon="@drawable/test_icon" />
+    <item car:usage="assistance_navigation_guidance"
+          car:titleText="@string/test_volume_navigation"
+          car:icon="@drawable/test_icon"
+          car:mute_icon="@drawable/test_icon" />
+</carVolumeItems>
diff --git a/tests/multivalent/res/xml/test_preference_screen.xml b/tests/multivalent/res/xml/test_preference_screen.xml
new file mode 100644
index 000000000..96dc874a7
--- /dev/null
+++ b/tests/multivalent/res/xml/test_preference_screen.xml
@@ -0,0 +1,29 @@
+<!--
+  ~ Copyright (C) 2021 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<PreferenceScreen
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:settings="http://schemas.android.com/apk/res-auto"
+    android:title="test_screen_title">
+    <Preference
+        android:fragment="com.android.car.settings.testutils.TestSettingsFragment1"
+        android:key="pk_test_preference_1"
+        settings:controller="com.android.car.settings.common.DefaultRestrictionsPreferenceController"/>
+    <Preference
+        android:fragment="com.android.car.settings.testutils.TestSettingsFragment2"
+        android:key="pk_test_preference_2"
+        settings:controller="com.android.car.settings.common.DefaultRestrictionsPreferenceController"/>
+</PreferenceScreen>
\ No newline at end of file
diff --git a/tests/multivalent/res/xml/test_top_level_menu_fragment.xml b/tests/multivalent/res/xml/test_top_level_menu_fragment.xml
new file mode 100644
index 000000000..a8db29db5
--- /dev/null
+++ b/tests/multivalent/res/xml/test_top_level_menu_fragment.xml
@@ -0,0 +1,29 @@
+<!--
+  ~ Copyright (C) 2021 The Android Open Source Project
+  ~
+  ~ Licensed under the Apache License, Version 2.0 (the "License");
+  ~ you may not use this file except in compliance with the License.
+  ~ You may obtain a copy of the License at
+  ~
+  ~      http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing, software
+  ~ distributed under the License is distributed on an "AS IS" BASIS,
+  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  ~ See the License for the specific language governing permissions and
+  ~ limitations under the License.
+  -->
+
+<PreferenceScreen
+    xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:settings="http://schemas.android.com/apk/res-auto"
+    android:title="test_top_level_menu_screen_title">
+    <Preference
+        android:fragment="com.android.car.settings.testutils.TestSettingsFragment1"
+        android:key="pk_test_fragment_1"
+        settings:controller="com.android.car.settings.common.DefaultRestrictionsPreferenceController"/>
+    <Preference
+        android:fragment="com.android.car.settings.testutils.TestSettingsFragment2"
+        android:key="pk_test_fragment_2"
+        settings:controller="com.android.car.settings.common.DefaultRestrictionsPreferenceController"/>
+</PreferenceScreen>
\ No newline at end of file
diff --git a/tests/multivalent/src/com/android/car/settings/CarSettingsApplicationTest.java b/tests/multivalent/src/com/android/car/settings/CarSettingsApplicationTest.java
new file mode 100644
index 000000000..1af45c23b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/CarSettingsApplicationTest.java
@@ -0,0 +1,314 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings;
+
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.doAnswer;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyLong;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.Car;
+import android.car.Car.CarServiceLifecycleListener;
+import android.car.CarOccupantZoneManager;
+import android.car.CarOccupantZoneManager.OccupantZoneConfigChangeListener;
+import android.car.CarOccupantZoneManager.OccupantZoneInfo;
+import android.car.VehicleAreaSeat;
+import android.car.media.CarAudioManager;
+import android.content.Context;
+import android.hardware.display.DisplayManagerGlobal;
+import android.view.Display;
+import android.view.DisplayAdjustments;
+import android.view.DisplayInfo;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class CarSettingsApplicationTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private MockitoSession mSession;
+
+    @Mock
+    private Car mCar;
+    @Mock
+    private CarOccupantZoneManager mCarOccupantZoneManager;
+    @Mock
+    private CarAudioManager mCarAudioManager;
+
+    private final OccupantZoneInfo mZoneInfoDriver = new OccupantZoneInfo(0,
+            CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER,
+            VehicleAreaSeat.SEAT_ROW_1_LEFT);
+    private final OccupantZoneInfo mZoneInfoPassenger = new OccupantZoneInfo(1,
+            CarOccupantZoneManager.OCCUPANT_TYPE_FRONT_PASSENGER,
+            VehicleAreaSeat.SEAT_ROW_1_RIGHT);
+    private final int mPrimaryAudioZoneId = 0;
+    private final int mSecondaryAudioZoneId = 1;
+    private final Display mDefaultDisplay = new Display(DisplayManagerGlobal.getInstance(),
+            Display.DEFAULT_DISPLAY, new DisplayInfo(),
+            DisplayAdjustments.DEFAULT_DISPLAY_ADJUSTMENTS);
+    private final Display mSecondaryDisplay = new Display(DisplayManagerGlobal.getInstance(),
+            Display.DEFAULT_DISPLAY + 1, new DisplayInfo(),
+            DisplayAdjustments.DEFAULT_DISPLAY_ADJUSTMENTS);
+
+    private CarSettingsApplication mCarSettingsApplication;
+    private CarServiceLifecycleListener mCarServiceLifecycleListener;
+    private OccupantZoneConfigChangeListener mConfigChangeListener;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSession = mockitoSession().mockStatic(Car.class,
+                withSettings().lenient()).startMocking();
+
+        doAnswer(invocation -> {
+            mCarServiceLifecycleListener = invocation.getArgument(3);
+            return mCar;
+        }).when(() -> Car.createCar(any(), any(), anyLong(), any()));
+
+        doAnswer(invocation -> {
+            mConfigChangeListener = (OccupantZoneConfigChangeListener) invocation.getArgument(0);
+            return null;
+        }).when(mCarOccupantZoneManager).registerOccupantZoneConfigChangeListener(any());
+
+        mCarSettingsApplication = new CarSettingsApplication();
+        mCarSettingsApplication.registerCarServiceLifecycleListener();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceNotReady() {
+        mCarServiceLifecycleListener.onLifecycleChanged(null, false);
+
+        assertThat(mCarSettingsApplication.getCarAudioManager()).isEqualTo(
+                null);
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY);
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                CarAudioManager.INVALID_AUDIO_ZONE);
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_INVALID);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_carAudioManager() {
+        when(mCar.getCarManager(Car.AUDIO_SERVICE)).thenReturn(mCarAudioManager);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getCarAudioManager()).isEqualTo(
+                mCarAudioManager);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_zoneInfoDriver() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoDriver);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_zoneInfoPassenger() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoPassenger);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_FRONT_PASSENGER);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_zoneInfoNull() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(null);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_INVALID);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_primaryAudioZone() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoDriver);
+        when(mCarOccupantZoneManager.getAudioZoneIdForOccupant(
+                mZoneInfoDriver)).thenReturn(mPrimaryAudioZoneId);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                mPrimaryAudioZoneId);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_secondaryAudioZone() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoPassenger);
+        when(mCarOccupantZoneManager.getAudioZoneIdForOccupant(
+                mZoneInfoPassenger)).thenReturn(mSecondaryAudioZoneId);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                mSecondaryAudioZoneId);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_defaultDisplayId() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoDriver);
+        when(mCarOccupantZoneManager.getDisplayForOccupant(mZoneInfoDriver,
+                CarOccupantZoneManager.DISPLAY_TYPE_MAIN)).thenReturn(mDefaultDisplay);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_secondaryDisplayId() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoPassenger);
+        when(mCarOccupantZoneManager.getDisplayForOccupant(mZoneInfoPassenger,
+                CarOccupantZoneManager.DISPLAY_TYPE_MAIN)).thenReturn(mSecondaryDisplay);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY + 1);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceReady_occupantZoneServiceIsNull() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(null);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_INVALID);
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                CarAudioManager.INVALID_AUDIO_ZONE);
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY);
+    }
+
+    @Test
+    public void onLifecycleChanged_carServiceCrashed_usePreviousValues_exceptCarAudioManager() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCar.getCarManager(Car.AUDIO_SERVICE)).thenReturn(mCarAudioManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoDriver);
+        when(mCarOccupantZoneManager.getAudioZoneIdForOccupant(
+                mZoneInfoDriver)).thenReturn(mPrimaryAudioZoneId);
+        when(mCarOccupantZoneManager.getDisplayForOccupant(mZoneInfoDriver,
+                CarOccupantZoneManager.DISPLAY_TYPE_MAIN)).thenReturn(mDefaultDisplay);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getCarAudioManager()).isEqualTo(
+                mCarAudioManager);
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER);
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                mPrimaryAudioZoneId);
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY);
+
+        mCarServiceLifecycleListener.onLifecycleChanged(null, false);
+
+        assertThat(mCarSettingsApplication.getCarAudioManager()).isEqualTo(
+                null);
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER);
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                mPrimaryAudioZoneId);
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY);
+    }
+
+    @Test
+    public void onOccupantZoneConfigChanged_flagDisplay_displayChanged() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoDriver);
+        when(mCarOccupantZoneManager.getDisplayForOccupant(mZoneInfoDriver,
+                CarOccupantZoneManager.DISPLAY_TYPE_MAIN)).thenReturn(mDefaultDisplay);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY);
+
+        when(mCarOccupantZoneManager.getDisplayForOccupant(mZoneInfoDriver,
+                CarOccupantZoneManager.DISPLAY_TYPE_MAIN)).thenReturn(mSecondaryDisplay);
+        mConfigChangeListener.onOccupantZoneConfigChanged(
+                CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_DISPLAY);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneDisplayId()).isEqualTo(
+                Display.DEFAULT_DISPLAY + 1);
+    }
+
+    @Test
+    public void onOccupantZoneConfigChanged_flagUser_zoneChanged() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoDriver);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER);
+
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoPassenger);
+        mConfigChangeListener.onOccupantZoneConfigChanged(
+                CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_USER);
+
+        assertThat(mCarSettingsApplication.getMyOccupantZoneType()).isEqualTo(
+                CarOccupantZoneManager.OCCUPANT_TYPE_FRONT_PASSENGER);
+    }
+
+    @Test
+    public void onOccupantZoneConfigChanged_flagAudio_audioChanged() {
+        when(mCar.getCarManager(Car.CAR_OCCUPANT_ZONE_SERVICE)).thenReturn(mCarOccupantZoneManager);
+        when(mCarOccupantZoneManager.getMyOccupantZone()).thenReturn(mZoneInfoDriver);
+        when(mCarOccupantZoneManager.getAudioZoneIdForOccupant(
+                mZoneInfoDriver)).thenReturn(mPrimaryAudioZoneId);
+        mCarServiceLifecycleListener.onLifecycleChanged(mCar, true);
+
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                mPrimaryAudioZoneId);
+
+        when(mCarOccupantZoneManager.getAudioZoneIdForOccupant(
+                mZoneInfoDriver)).thenReturn(mSecondaryAudioZoneId);
+        mConfigChangeListener.onOccupantZoneConfigChanged(
+                CarOccupantZoneManager.ZONE_CONFIG_CHANGE_FLAG_AUDIO);
+
+        assertThat(mCarSettingsApplication.getMyAudioZoneId()).isEqualTo(
+                mSecondaryAudioZoneId);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsBasePreferenceControllerTest.java
new file mode 100644
index 000000000..946ac2e35
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsBasePreferenceControllerTest.java
@@ -0,0 +1,138 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.accounts.Account;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionIconPreference;
+import com.android.settingslib.accounts.AuthenticatorHelper;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AccountDetailsBasePreferenceControllerTest {
+    private static final String ACCOUNT_NAME = "Name";
+    private static final String ACCOUNT_TYPE = "com.acct";
+    private final Account mAccount = new Account(ACCOUNT_NAME, ACCOUNT_TYPE);
+    private final UserHandle mUserHandle = new UserHandle(0);
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiTwoActionIconPreference mPreference;
+    private AccountDetailsBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private AuthenticatorHelper mAuthenticatorHelper;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiTwoActionIconPreference(mContext);
+        mPreferenceController = new TestAccountDetailsBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Test
+    public void checkInitialized_accountSetAndUserHandleSet_doesNothing() {
+        mPreferenceController.setAccount(mAccount);
+        mPreferenceController.setUserHandle(mUserHandle);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void checkInitialized_nullAccount_throwsIllegalStateException() {
+        mPreferenceController.setUserHandle(mUserHandle);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void checkInitialized_nullUserHandle_throwsIllegalStateException() {
+        mPreferenceController.setAccount(mAccount);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void onCreate_shouldSetTitle() {
+        mPreferenceController.setAccount(mAccount);
+        mPreferenceController.setUserHandle(mUserHandle);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getTitle().toString()).isEqualTo(ACCOUNT_NAME);
+    }
+
+    @Test
+    public void onCreate_shouldSetIcon() {
+        mPreferenceController.setAccount(mAccount);
+        mPreferenceController.setUserHandle(mUserHandle);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mAuthenticatorHelper.getDrawableForType(mContext, mAccount.type)).thenReturn(
+                mContext.getDrawable(R.drawable.ic_add));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getIcon()).isNotNull();
+    }
+
+    private class TestAccountDetailsBasePreferenceController
+            extends AccountDetailsBasePreferenceController {
+
+        TestAccountDetailsBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        AuthenticatorHelper getAuthenticatorHelper() {
+            return mAuthenticatorHelper;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsFragmentTest.java b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsFragmentTest.java
new file mode 100644
index 000000000..c64845445
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsFragmentTest.java
@@ -0,0 +1,136 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.accounts.Account;
+import android.accounts.AccountManager;
+import android.content.pm.UserInfo;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.ToolbarController;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class AccountDetailsFragmentTest {
+    private final Account mAccount = new Account("Name", "com.acct");
+    private final UserInfo mUserInfo = new UserInfo(/* id= */ 0, /* name= */ "name",
+            /* flags= */ 0);
+    private final CharSequence mAccountLabel = "Type 1";
+
+    private AccountDetailsFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MockitoSession mSession;
+
+    @Mock
+    private AccountManager mMockAccountManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+        mSession = ExtendedMockito.mockitoSession().mockStatic(AccountManager.class,
+                withSettings().lenient()).startMocking();
+        when(AccountManager.get(any())).thenReturn(mMockAccountManager);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onActivityCreated_titleShouldBeSet() {
+        addAccounts(/* hasAccount= */ true);
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getTitle().toString()).isEqualTo(mAccountLabel.toString());
+    }
+
+    @Test
+    public void accountExists_accountStillExists_shouldBeTrue() {
+        addAccounts(/* hasAccount= */ true);
+        assertThat(mFragment.accountExists()).isTrue();
+    }
+
+    @Test
+    public void accountExists_accountWasRemoved_shouldBeFalse() {
+        addAccounts(/* hasAccount= */ false);
+        assertThat(mFragment.accountExists()).isFalse();
+    }
+
+    @Test
+    public void onAccountsUpdate_accountDoesNotExist_shouldGoBack() throws Throwable {
+        addAccounts(/* hasAccount= */ false);
+        mActivityTestRule.runOnUiThread(() -> mFragment.onAccountsUpdate(null));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(mActivity.getOnBackPressedFlag()).isTrue();
+    }
+
+    private void setUpFragment() throws Throwable {
+        String accountDetailsFragmentTag = "account_details_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container,
+                            AccountDetailsFragment.newInstance(mAccount, mAccountLabel, mUserInfo),
+                            accountDetailsFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (AccountDetailsFragment) mFragmentManager.findFragmentByTag(
+                accountDetailsFragmentTag);
+    }
+
+    private void addAccounts(boolean hasAccount) {
+        Account[] accounts;
+        if (hasAccount) {
+            accounts = new Account[]{mAccount};
+        } else {
+            accounts = new Account[0];
+        }
+        when(mMockAccountManager.getAccountsByTypeAsUser(anyString(), any())).thenReturn(accounts);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsPreferenceControllerTest.java
new file mode 100644
index 000000000..0ed80a1ee
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsPreferenceControllerTest.java
@@ -0,0 +1,191 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.accounts.Account;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.profiles.ProfileHelper;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionIconPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AccountDetailsPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_MODIFY_ACCOUNTS;
+    private static final String ACCOUNT_NAME = "Name";
+    private static final String ACCOUNT_TYPE = "com.acct";
+    private final Account mAccount = new Account(ACCOUNT_NAME, ACCOUNT_TYPE);
+    private final UserHandle mUserHandle = new UserHandle(0);
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiTwoActionIconPreference mPreference;
+    private AccountDetailsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiTwoActionIconPreference(mContext);
+        mPreferenceController = new TestAccountDetailsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setAccount(mAccount);
+        mPreferenceController.setUserHandle(mUserHandle);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+    }
+
+    @Test
+    public void cannotModifyUsers_demoOrGuestUser_removeAccountButtonShouldNotBeVisible() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(false);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isSecondaryActionVisible()).isFalse();
+    }
+
+    @Test
+    public void cannotModifyUsers_restrictedByUm_removeAccountButtonShouldNotBeVisible() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isSecondaryActionVisible()).isFalse();
+    }
+
+    @Test
+    public void cannotModifyUsers_demoOrGuestAndRestrictedByUm_removeAccountButtonNotVisible() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(false);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isSecondaryActionVisible()).isFalse();
+    }
+
+    @Test
+    public void cannotModifyUsers_restrictedByDpm_removeAccountButtonAvailableForViewing() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isSecondaryActionVisible()).isTrue();
+    }
+
+    @Test
+    public void canModifyUsers_removeAccountButtonShouldBeVisible() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isSecondaryActionVisible()).isTrue();
+        assertThat(mPreference.isSecondaryActionEnabled()).isTrue();
+    }
+
+    @Test
+    public void onRemoveAccountButtonClicked_canModifyUsers_shouldShowConfirmRemoveAccountDialog() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performSecondaryActionClick();
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    @UiThreadTest
+    public void onRemoveAccountButtonClicked_canModifyUsers_restrictedByDpm_showAdminDialog() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performSecondaryActionClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private class TestAccountDetailsPreferenceController
+            extends AccountDetailsPreferenceController {
+
+        TestAccountDetailsPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        ProfileHelper getProfileHelper() {
+            return mMockProfileHelper;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsWithSyncStatusPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsWithSyncStatusPreferenceControllerTest.java
new file mode 100644
index 000000000..a2c75a234
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/AccountDetailsWithSyncStatusPreferenceControllerTest.java
@@ -0,0 +1,251 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.accounts.Account;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.SyncAdapterType;
+import android.content.SyncInfo;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionIconPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.ArrayList;
+import java.util.HashSet;
+import java.util.List;
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class AccountDetailsWithSyncStatusPreferenceControllerTest {
+    private static final int USER_ID = 3;
+    private static final String ACCOUNT_NAME = "Name";
+    private static final String ACCOUNT_TYPE = "com.acct";
+    private static final String AUTHORITY = "authority";
+    private static final String AUTHORITY_2 = "authority2";
+    private final Account mAccount = new Account(ACCOUNT_NAME, ACCOUNT_TYPE);
+    private final UserHandle mUserHandle = new UserHandle(USER_ID);
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiTwoActionIconPreference mPreference;
+    private AccountDetailsWithSyncStatusPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    private List<SyncInfo> mCurrentSyncs;
+    private Set<SyncAdapterType> mSyncableAdapters;
+    private Set<SyncAdapterType> mVisibleSyncAdapters;
+    private List<String> mSyncsRequested;
+    private List<String> mSyncsCanceled;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiTwoActionIconPreference(mContext);
+        mPreferenceController = new TestAccountDetailsWithSyncStatusPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setAccount(mAccount);
+        mPreferenceController.setUserHandle(mUserHandle);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mCurrentSyncs = new ArrayList<>();
+        mVisibleSyncAdapters = new HashSet<>();
+        mSyncableAdapters = new HashSet<>();
+        mSyncsRequested = new ArrayList<>();
+        mSyncsCanceled = new ArrayList<>();
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(AccountSyncHelper.class,
+                withSettings().lenient()).startMocking();
+        when(AccountSyncHelper.getVisibleSyncAdaptersForAccount(mContext, mAccount, mUserHandle))
+                .thenReturn(mVisibleSyncAdapters);
+        when(AccountSyncHelper.getSyncableSyncAdaptersForAccount(mAccount, mUserHandle))
+                .thenReturn(mSyncableAdapters);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_syncIsNotFailing_summaryShouldBeBlank() {
+        setUpVisibleSyncAdapters(AUTHORITY);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo("");
+    }
+
+    @Test
+    public void onCreate_syncIsFailing_summaryShouldBeSet() {
+        setUpVisibleSyncAdapters(AUTHORITY);
+        when(AccountSyncHelper.getSyncState(any(), anyBoolean(), anyBoolean()))
+                .thenReturn(AccountSyncHelper.SyncState.FAILED);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "sync_is_failing"));
+    }
+
+    @Test
+    public void onSyncStatusChanged_summaryShouldUpdated() {
+        setUpVisibleSyncAdapters(AUTHORITY);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo("");
+
+        when(AccountSyncHelper.getSyncState(any(), anyBoolean(), anyBoolean()))
+                .thenReturn(AccountSyncHelper.SyncState.FAILED);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "sync_is_failing"));
+    }
+
+    @Test
+    public void onButtonClicked_doesNotHaveActiveSyncs_shouldSyncSyncableAdapters() {
+        when(AccountSyncHelper.syncIsAllowed(eq(mAccount), anyString(), eq(USER_ID))).thenReturn(
+                true);
+        when(AccountSyncHelper.requestSyncIfAllowed(any(), anyString(),
+                anyInt())).thenCallRealMethod();
+
+        setUpSyncAdapters(AUTHORITY, AUTHORITY_2);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performSecondaryActionClick();
+
+        assertThat(mSyncsRequested).contains(AUTHORITY);
+        assertThat(mSyncsRequested).contains(AUTHORITY_2);
+    }
+
+    @Test
+    public void onButtonClicked_doesNotHaveActiveSyncs_syncNotAllowed_shouldNotSyncAdapter() {
+        when(AccountSyncHelper.syncIsAllowed(mAccount, AUTHORITY, USER_ID)).thenReturn(true);
+        when(AccountSyncHelper.syncIsAllowed(mAccount, AUTHORITY_2, USER_ID)).thenReturn(false);
+        when(AccountSyncHelper.requestSyncIfAllowed(any(), anyString(),
+                anyInt())).thenCallRealMethod();
+
+        setUpSyncAdapters(AUTHORITY, AUTHORITY_2);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performSecondaryActionClick();
+
+        assertThat(mSyncsRequested).contains(AUTHORITY);
+        assertThat(mSyncsRequested).doesNotContain(AUTHORITY_2);
+    }
+
+    @Test
+    public void onButtonClicked_doesHaveActiveSyncs_shouldCancelSyncForSyncableAdapters() {
+        // Add active syncs
+        SyncInfo syncInfo = mock(SyncInfo.class);
+        mCurrentSyncs.add(syncInfo);
+        setUpSyncAdapters(AUTHORITY, AUTHORITY_2);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performSecondaryActionClick();
+
+        assertThat(mSyncsCanceled).contains(AUTHORITY);
+        assertThat(mSyncsCanceled).contains(AUTHORITY_2);
+    }
+
+    private void setUpSyncAdapters(String... authorities) {
+        for (String authority : authorities) {
+            // Adds a sync adapter type that has the right account type and is visible.
+            SyncAdapterType syncAdapterType = new SyncAdapterType(authority,
+                    ACCOUNT_TYPE, /* userVisible= */ true, /* supportsUploading= */ true);
+            mSyncableAdapters.add(syncAdapterType);
+        }
+    }
+
+    private void setUpVisibleSyncAdapters(String... authorities) {
+        for (String authority : authorities) {
+            // Adds a sync adapter type that has the right account type and is visible.
+            SyncAdapterType syncAdapterType = new SyncAdapterType(authority,
+                    ACCOUNT_TYPE, /* userVisible= */ true, /* supportsUploading= */ true);
+            mVisibleSyncAdapters.add(syncAdapterType);
+        }
+    }
+
+    private class TestAccountDetailsWithSyncStatusPreferenceController
+            extends AccountDetailsWithSyncStatusPreferenceController {
+
+        TestAccountDetailsWithSyncStatusPreferenceController(Context context,
+                String preferenceKey, FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        List<SyncInfo> getCurrentSyncs(int userId) {
+            return mCurrentSyncs;
+        }
+
+        @Override
+        void requestSync(String authority, int userId) {
+            if (AccountSyncHelper.requestSyncIfAllowed(getAccount(), authority, userId)) {
+                mSyncsRequested.add(authority);
+            }
+        }
+
+        @Override
+        void cancelSync(String authority, int userId) {
+            mSyncsCanceled.add(authority);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/AccountGroupPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/accounts/AccountGroupPreferenceControllerTest.java
new file mode 100644
index 000000000..5c398ff11
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/AccountGroupPreferenceControllerTest.java
@@ -0,0 +1,473 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static android.content.pm.UserInfo.FLAG_INITIALIZED;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.profiles.ProfileHelper;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+// TODO(b/201465719) add unittest to show ActionDisabledByAdminDialog
+@RunWith(AndroidJUnit4.class)
+public class AccountGroupPreferenceControllerTest {
+    private static final String TEST_USERNAME = "Test Username";
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_MODIFY_ACCOUNTS;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private AccountGroupPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new LogicalPreferenceGroup(mContext);
+        mController = new TestAccountGroupPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_noRestriction_available() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_noRestriction_available_zoneWrite() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("write");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_noRestriction_available_zoneRead() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("read");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_noRestriction_available_zoneHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notCurrentUser_notAvailable() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notCurrentUser_notAvailable_zoneWrite() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("write");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notCurrentUser_notAvailable_zoneRead() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("read");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notCurrentUser_notAvailable_zoneHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByUserType_notAvailable() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByUserType_notAvailable_zoneWrite() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("write");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByUserType_notAvailable_zoneRead() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("read");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByUserType_notAvailable_zoneHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restrictedByUm_notAvailable() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restrictedByUm_notAvailable_zoneWrite() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("write");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restrictedByUm_notAvailable_zoneRead() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("read");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restrictedByUm_notAvailable_zoneHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByDpm_availableForViewing() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByDpm_availableForViewing_zoneWrite() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByDpm_availableForViewing_zoneRead() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByDpm_availableForViewing_zoneHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_restricedByUserTypeAndDpm_notAvailable() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_notAvailable_zoneWrite() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_notAvailable_zoneRead() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_notAvailable_zoneHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_USERNAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mController.setUserInfo(userInfo);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    private class TestAccountGroupPreferenceController extends AccountGroupPreferenceController {
+
+        TestAccountGroupPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        ProfileHelper getProfileHelper() {
+            return mMockProfileHelper;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/AccountListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/accounts/AccountListPreferenceControllerTest.java
new file mode 100644
index 000000000..b5a84166c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/AccountListPreferenceControllerTest.java
@@ -0,0 +1,563 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.accounts.Account;
+import android.accounts.AccountManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.profiles.ProfileHelper;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.accounts.AuthenticatorHelper;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Collections;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+import java.util.Set;
+
+// TODO(b/201465719) add unittest to show ActionDisabledByAdminDialog
+@RunWith(AndroidJUnit4.class)
+public class AccountListPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_MODIFY_ACCOUNTS;
+
+    private static final int USER_ID = 0;
+    private static final String USER_NAME = "name";
+    private static final int NOT_THIS_USER_ID = 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceCategory mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private AccountListPreferenceController mController;
+    private MockitoSession mSession;
+    private Set<String> mAuthenticatedAccountTypes;
+    private Map<String, String> mAccountTypeToLabelMap;
+    private Map<String, List<String>> mAccountTypeToNameMap;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private AuthenticatorHelper mMockAuthenticatorHelper;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private AccountManager mMockAccountManager;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new PreferenceCategory(mContext);
+        screen.addPreference(mPreference);
+        initMocks();
+        mController = new TestAccountListPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_preferenceCategoryTitleShouldBeSet() {
+        mController.onCreate(mLifecycleOwner);
+        String expectedTitle = ResourceTestUtils.getString(mContext, "account_list_title",
+                USER_NAME);
+        assertThat(mPreference.getTitle().toString()).isEqualTo(expectedTitle);
+    }
+
+    @Test
+    public void onCreate_hasNoAccounts_shouldDisplayNoAccountPref() {
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        Preference noAccountPref = mPreference.getPreference(0);
+
+        assertThat(noAccountPref.getTitle().toString()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "no_accounts_added"));
+    }
+
+    @Test
+    public void onCreate_hasAccounts_shouldDisplayAccounts() {
+        addAccount(/* name= */ "Account1", /* type= */ "com.acct1");
+        addAccount(/* name= */ "Account2", /* type= */ "com.acct2");
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        Preference firstPref = mPreference.getPreference(0);
+        assertThat(firstPref.getTitle().toString()).isEqualTo("Account1");
+        assertThat(firstPref.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.account_type1_label));
+
+        Preference secondPref = mPreference.getPreference(1);
+        assertThat(secondPref.getTitle().toString()).isEqualTo("Account2");
+        assertThat(secondPref.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.account_type2_label));
+    }
+
+    @Test
+    public void onCreate_hasUnauthenticatedAccount_shouldNotDisplayAccount() {
+        addAccount(/* name= */ "Account1", /* type= */ "com.acct1");
+        addAccount(/* name= */ "Account2", /* type= */ "com.acct2");
+        addAccount(/* name= */ "Account3", /* type= */ "com.acct3");
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        Preference firstPref = mPreference.getPreference(0);
+        assertThat(firstPref.getTitle().toString()).isEqualTo("Account1");
+        assertThat(firstPref.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.account_type1_label));
+
+        Preference secondPref = mPreference.getPreference(1);
+        assertThat(secondPref.getTitle().toString()).isEqualTo("Account2");
+        assertThat(secondPref.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.account_type2_label));
+    }
+
+    @Test
+    public void onAccountsUpdate_isThisUser_shouldForceUpdate() {
+        addAccount(/* name= */ "Account1", /* type= */ "com.acct1");
+        addAccount(/* name= */ "Account2", /* type= */ "com.acct2");
+
+        mController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        removeAllAccounts();
+        addAccount(/* name= */ "Account3", /* type= */ "com.acct1");
+
+        mController.onAccountsUpdate(new UserHandle(USER_ID));
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        Preference firstPref = mPreference.getPreference(0);
+        assertThat(firstPref.getTitle().toString()).isEqualTo("Account3");
+        assertThat(firstPref.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.account_type1_label));
+    }
+
+    @Test
+    public void onAccountsUpdate_updatedUserIsNotCurrentUser_shouldNotForceUpdate() {
+        addAccount(/* name= */ "Account1", /* type= */ "com.acct1");
+        addAccount(/* name= */ "Account2", /* type= */ "com.acct2");
+
+        mController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        removeAllAccounts();
+        addAccount(/* name= */ "Account3", /* type= */ "com.acct1");
+
+        mController.onAccountsUpdate(new UserHandle(NOT_THIS_USER_ID));
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void onUsersUpdate_shouldForceUpdate() {
+        addAccount(/* name= */ "Account1", /* type= */ "com.acct1");
+        addAccount(/* name= */ "Account2", /* type= */ "com.acct2");
+
+        mController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        removeAllAccounts();
+        addAccount(/* name= */ "Account3", /* type= */ "com.acct1");
+
+        mController.onUsersUpdate();
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        Preference firstPref = mPreference.getPreference(0);
+        assertThat(firstPref.getTitle().toString()).isEqualTo("Account3");
+        assertThat(firstPref.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.account_type1_label));
+    }
+
+    @Test
+    @UiThreadTest
+    public void onAccountPreferenceClicked_shouldLaunchAccountDetailsFragment() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        addAccount(/* name= */ "Account1", /* type= */ "com.acct1");
+        mController.onCreate(mLifecycleOwner);
+
+        Preference firstPref = mPreference.getPreference(0);
+        firstPref.performClick();
+
+        verify(mFragmentController).launchFragment(any(AccountDetailsFragment.class));
+    }
+
+    private void addAccount(String name, String type) {
+        if (mAccountTypeToNameMap.containsKey(type)) {
+            mAccountTypeToNameMap.get(type).add(name);
+        } else {
+            mAccountTypeToNameMap.put(type, Collections.singletonList(name));
+        }
+        updateEnabledAccountTypes();
+    }
+
+    private void removeAllAccounts() {
+        mAccountTypeToNameMap.clear();
+        updateEnabledAccountTypes();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_notAvailable() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_notAvailable_zoneWrite() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_notAvailable_zoneRead() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_notAvailable_zoneHidden() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_notAvailable() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_notAvailable_zoneWrite() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_notAvailable_zoneRead() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_notAvailable_zoneHidden() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_restrictedByDpm_notAvailable() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_restrictedByDpm_notAvailable_zoneWrite() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_restrictedByDpm_notAvailable_zoneRead() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoOrGuest_restrictedByDpm_notAvailable_zoneHidden() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_availableForViewing() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_availableForViewing_zoneWrite() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_availableForViewing_zoneRead() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_availableForViewing_zoneHidden() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_canModifyAccounts_available() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_canModifyAccounts_available_zoneWrite() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_canModifyAccounts_available_zoneRead() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_canModifyAccounts_available_zoneHidden() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    private void initMocks() {
+        mAccountTypeToLabelMap = Map.of(
+                "com.acct1", mContext.getString(R.string.account_type1_label),
+                "com.acct2", mContext.getString(R.string.account_type2_label),
+                "com.acct3", mContext.getString(R.string.account_type3_label));
+        mAuthenticatedAccountTypes = Set.of("com.acct1", "com.acct2");
+        mAccountTypeToNameMap = new HashMap<>();
+        updateEnabledAccountTypes();
+        when(mMockAuthenticatorHelper.getLabelForType(any(), any())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            String type = (String) args[1];
+            return mAuthenticatedAccountTypes.contains(type)
+                    ? mAccountTypeToLabelMap.get(type)
+                    : null;
+        });
+        when(mMockAuthenticatorHelper.getDrawableForType(any(), any())).thenReturn(null);
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(ProfileHelper.class, withSettings().lenient())
+                .mockStatic(AccountManager.class, withSettings().lenient())
+                .startMocking();
+
+        when(ProfileHelper.getInstance(mContext)).thenReturn(mMockProfileHelper);
+        UserInfo userInfo = new UserInfo(USER_ID, USER_NAME, 0);
+        when(mMockProfileHelper.getCurrentProcessUserInfo()).thenReturn(userInfo);
+
+        when(AccountManager.get(mContext)).thenReturn(mMockAccountManager);
+        when(mMockAccountManager.getAccountsByTypeAsUser(any(), any())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            String type = (String) args[0];
+            List<String> accountNames = mAccountTypeToNameMap.get(type);
+            Account[] accounts = new Account[accountNames.size()];
+            for (int i = 0; i < accountNames.size(); i++) {
+                accounts[i] = new Account(accountNames.get(i), type);
+            }
+            return accounts;
+        });
+    }
+
+    private void updateEnabledAccountTypes() {
+        when(mMockAuthenticatorHelper.getEnabledAccountTypes()).thenReturn(
+                mAccountTypeToNameMap.keySet().toArray(new String[0]));
+    }
+
+    private class TestAccountListPreferenceController extends AccountListPreferenceController {
+
+        TestAccountListPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        AuthenticatorHelper createAuthenticatorHelper() {
+            return mMockAuthenticatorHelper;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/AddAccountPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/accounts/AddAccountPreferenceControllerTest.java
new file mode 100644
index 000000000..88366ebc4
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/AddAccountPreferenceControllerTest.java
@@ -0,0 +1,505 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static android.app.Activity.RESULT_OK;
+
+import static com.android.car.settings.accounts.AddAccountPreferenceController.NEW_USER_DISCLAIMER_REQUEST;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ActivityResultCallback;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.profiles.ProfileHelper;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.HashSet;
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class AddAccountPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_MODIFY_ACCOUNTS;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private AddAccountPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private AccountTypesHelper mMockAccountTypesHelper;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private DevicePolicyManager mMockDpm;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mController = new TestAddAccountPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mMockDpm);
+        doNothing().when(mContext).startActivity(any());
+    }
+
+    @Test
+    public void cannotModifyUsers_restrictedByDpm_addAccountButtonShouldBeAvailableForViewing() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void cannotModifyUsers_addAccountButtonShouldBeAvailableForViewing_zoneWrite() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void cannotModifyUsers_addAccountButtonShouldBeAvailableForViewing_zoneRead() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void cannotModifyUsers_addAccountButtonShouldBeAvailableForViewing_zoneHidden() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void newUserDisclaimerUnackowledged_addAccountButtonShouldBeAvailableForViewing() {
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(false);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void newUserDisclaimerUnackowledged_addAccountButtonBeAvailableForViewing_zoneWrite() {
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(false);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void newUserDisclaimerUnackowledged_addAccountButtonBeAvailableForViewing_zoneRead() {
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(false);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void newUserDisclaimerUnackowledged_addAccountButtonBeAvailableForViewing_zoneHidden() {
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(false);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void cannotModifyUsers_restrictedByUm_addAccountButtonShouldBeDisabled() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_restrictedByUm_addAccountButtonShouldBeDisabled_zoneWrite() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_restrictedByUm_addAccountButtonShouldBeDisabled_zoneRead() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_restrictedByUm_addAccountButtonShouldBeDisabled_zoneHidden() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_demoOrGuestAndRestricedByDpm_addAccountButtonShouldBeDisabled() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_addAccountButtonShouldBeDisabled_zoneWrite() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_addAccountButtonShouldBeDisabled_zoneRead() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_addAccountButtonShouldBeDisabled_zoneHidden() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_demoOrGuestUser_addAccountButtonShouldBeDisabled() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_demoOrGuestUser_addAccountButtonShouldBeDisabled_zoneWrite() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_demoOrGuestUser_addAccountButtonShouldBeDisabled_zoneRead() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void cannotModifyUsers_demoOrGuestUser_addAccountButtonShouldBeDisabled_zoneHidden() {
+        when(mMockProfileHelper.isDemoOrGuest()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void canModifyUsers_addAccountButtonShouldBeAvailable() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void canModifyUsers_addAccountButtonShouldBeAvailable_zoneWrite() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void canModifyUsers_addAccountButtonShouldBeAvailable_zoneRead() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void canModifyUsers_addAccountButtonShouldBeAvailable_zoneHidden() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void clickAddAccountButton_shouldOpenChooseAccountFragment() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        verify(mFragmentController).launchFragment(any(ChooseAccountFragment.class));
+    }
+
+    @Test
+    public void clickAddAccountButton_shouldNotOpenChooseAccountFragmentWhenOneTypeAndUnmanaged() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        Set<String> accountSet = new HashSet<>();
+        accountSet.add("TEST_ACCOUNT_TYPE_1");
+        when(mMockAccountTypesHelper.getAuthorizedAccountTypes()).thenReturn(accountSet);
+
+        mController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        ArgumentCaptor<Intent> intentArgumentCaptor = ArgumentCaptor.forClass(
+                Intent.class);
+        verify(mContext).startActivity(intentArgumentCaptor.capture());
+
+        Intent intent = intentArgumentCaptor.getValue();
+        assertThat(intent.getComponent().getClassName()).isEqualTo(
+                AddAccountActivity.class.getName());
+    }
+
+    @Test
+    @UiThreadTest
+    public void clickAddAccountButton_shouldOpenChooseAccountFragmentWhenOneTypeAndManaged() {
+        when(mMockDpm.isDeviceManaged()).thenReturn(true);
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(true);
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        Set<String> accountSet = new HashSet<>();
+        accountSet.add("TEST_ACCOUNT_TYPE_1");
+        when(mMockAccountTypesHelper.getAuthorizedAccountTypes()).thenReturn(accountSet);
+
+        mController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        verify(mFragmentController).launchFragment(any(ChooseAccountFragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void clickAddAccountButton_shouldOpenChooseAccountFragmentWhenTwoTypes() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+        Set<String> accountSet = new HashSet<>();
+        accountSet.add("TEST_ACCOUNT_TYPE_1");
+        accountSet.add("TEST_ACCOUNT_TYPE_2");
+        when(mMockAccountTypesHelper.getAuthorizedAccountTypes()).thenReturn(accountSet);
+
+        mController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        verify(mFragmentController).launchFragment(any(ChooseAccountFragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void disabledClick_restrictedByDpm_dialog() {
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(false);
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        mController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    @Test
+    @UiThreadTest
+    public void disabledClick_newUserDisclaimerUnacknowledged_launchDisclaimer() {
+        when(mMockDpm.isDeviceManaged()).thenReturn(true);
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(false);
+        mController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingNewUserDisclaimerActivity();
+    }
+
+    @Test
+    @UiThreadTest
+    public void processActivityResult_newUserDisclaimer_resultOk_chooseAccountActivity() {
+        when(mMockDpm.isDeviceManaged()).thenReturn(true);
+        when(mMockDpm.isNewUserDisclaimerAcknowledged()).thenReturn(true);
+        mController.onCreate(mLifecycleOwner);
+
+        mController.processActivityResult(NEW_USER_DISCLAIMER_REQUEST, RESULT_OK,
+                /* data= */ null);
+
+        verify(mFragmentController).launchFragment(any(ChooseAccountFragment.class));
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private void assertShowingNewUserDisclaimerActivity() {
+        verify(mFragmentController).startActivityForResult(any(Intent.class),
+                eq(NEW_USER_DISCLAIMER_REQUEST), any(ActivityResultCallback.class));
+    }
+
+    private class TestAddAccountPreferenceController extends AddAccountPreferenceController {
+
+        TestAddAccountPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        ProfileHelper getProfileHelper() {
+            return mMockProfileHelper;
+        }
+
+        @Override
+        AccountTypesHelper getAccountTypesHelper() {
+            return mMockAccountTypesHelper;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/accounts/ChooseAccountPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/accounts/ChooseAccountPreferenceControllerTest.java
new file mode 100644
index 000000000..de9ca9bad
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/accounts/ChooseAccountPreferenceControllerTest.java
@@ -0,0 +1,226 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.accounts;
+
+import static com.android.car.settings.accounts.ChooseAccountPreferenceController.ADD_ACCOUNT_REQUEST_CODE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.accounts.Account;
+import android.accounts.AccountManager;
+import android.accounts.AuthenticatorDescription;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.UserInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ActivityResultCallback;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.profiles.ProfileHelper;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.accounts.AuthenticatorHelper;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Arrays;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class ChooseAccountPreferenceControllerTest {
+    private static final int USER_ID = 0;
+    private static final String USER_NAME = "name";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ChooseAccountPreferenceController mController;
+    private MockitoSession mSession;
+    private Map<String, String> mAccountTypeToLabelMap;
+    private Account[] mAccounts;
+    private AuthenticatorDescription[] mAuthenticatorDescriptions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private AuthenticatorHelper mMockAuthenticatorHelper;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private AccountManager mMockAccountManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        initMocks();
+        mController = new ChooseAccountPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mController.setAuthenticatorHelper(mMockAuthenticatorHelper);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_authenticatorPreferencesShouldBeSet() {
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        Preference acct1Pref = mPreference.getPreference(0);
+        assertThat(acct1Pref.getTitle().toString()).isEqualTo(
+                mContext.getString(R.string.account_type1_label));
+
+        Preference acct2Pref = mPreference.getPreference(1);
+        assertThat(acct2Pref.getTitle().toString()).isEqualTo(
+                mContext.getString(R.string.account_type2_label));
+    }
+
+    @Test
+    public void onAccountsUpdate_currentUserUpdated_shouldForceUpdate() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        mAuthenticatorDescriptions = Arrays.copyOf(mAuthenticatorDescriptions,
+                mAuthenticatorDescriptions.length + 1);
+        mAuthenticatorDescriptions[mAuthenticatorDescriptions.length - 1] =
+                new AuthenticatorDescription("com.acct3", "com.android.car.settings",
+                        R.string.account_type3_label, 0, 0, 0, false);
+        when(mMockAccountManager.getAuthenticatorTypesAsUser(anyInt())).thenReturn(
+                mAuthenticatorDescriptions);
+
+        mAccounts = Arrays.copyOf(mAccounts, mAccounts.length + 1);
+        mAccounts[mAccounts.length - 1] = new Account(
+                mContext.getString(R.string.account_type3_label), "com.acct3");
+        when(mMockAccountManager.getAccountsAsUser(anyInt())).thenReturn(mAccounts);
+
+        mController.getAccountTypesHelper().updateAuthorizedAccountTypes(false);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(3);
+        Preference acct3Pref = mPreference.getPreference(2);
+        assertThat(acct3Pref.getTitle().toString()).isEqualTo(
+                mContext.getString(R.string.account_type3_label));
+    }
+
+    @Test
+    public void onPreferenceClick_shouldStartActivity() {
+        mController.onCreate(mLifecycleOwner);
+        Preference acct1Pref = mPreference.getPreference(0);
+        acct1Pref.performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+
+        verify(mFragmentController).startActivityForResult(captor.capture(),
+                anyInt(), any(ActivityResultCallback.class));
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getComponent().getClassName()).isEqualTo(
+                AddAccountActivity.class.getName());
+        assertThat(intent.getStringExtra(AddAccountActivity.EXTRA_SELECTED_ACCOUNT)).isEqualTo(
+                "com.acct1");
+    }
+
+    @Test
+    public void onAccountAdded_shouldGoBack() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        mController.processActivityResult(ADD_ACCOUNT_REQUEST_CODE, /* resultCode= */ 0, /* data= */
+                null);
+
+        verify(mFragmentController).goBack();
+    }
+
+    private void initMocks() {
+        mAccountTypeToLabelMap = Map.of(
+                "com.acct1", mContext.getString(R.string.account_type1_label),
+                "com.acct2", mContext.getString(R.string.account_type2_label),
+                "com.acct3", mContext.getString(R.string.account_type3_label));
+        when(mMockAuthenticatorHelper.getLabelForType(any(), any())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            return mAccountTypeToLabelMap.get((String) args[1]);
+        });
+        when(mMockAuthenticatorHelper.getDrawableForType(any(), any())).thenReturn(null);
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(ProfileHelper.class, withSettings().lenient())
+                .mockStatic(AccountManager.class, withSettings().lenient())
+                .startMocking();
+
+        when(ProfileHelper.getInstance(mContext)).thenReturn(mMockProfileHelper);
+        UserInfo userInfo = new UserInfo(USER_ID, USER_NAME, 0);
+        when(mMockProfileHelper.getCurrentProcessUserInfo()).thenReturn(userInfo);
+        when(mMockProfileHelper.canCurrentProcessModifyAccounts()).thenReturn(true);
+
+        when(AccountManager.get(mContext)).thenReturn(mMockAccountManager);
+        mAuthenticatorDescriptions = new AuthenticatorDescription[]{
+                new AuthenticatorDescription("com.acct1", "com.android.car.settings",
+                        R.string.account_type1_label, 0, 0, 0, false),
+                new AuthenticatorDescription("com.acct2", "com.android.car.settings",
+                        R.string.account_type2_label, 0, 0, 0, false)
+        };
+        mAccounts = new Account[]{
+                new Account(mContext.getString(R.string.account_type1_label), "com.acct1"),
+                new Account(mContext.getString(R.string.account_type2_label), "com.acct2")
+        };
+        when(mMockAccountManager.getAuthenticatorTypesAsUser(anyInt())).thenReturn(
+                mAuthenticatorDescriptions);
+        when(mMockAccountManager.getAccountsAsUser(anyInt())).thenReturn(mAccounts);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/admin/NewUserDisclaimerActivityTest.java b/tests/multivalent/src/com/android/car/settings/admin/NewUserDisclaimerActivityTest.java
new file mode 100644
index 000000000..bb7921240
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/admin/NewUserDisclaimerActivityTest.java
@@ -0,0 +1,107 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.admin;
+
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.doReturn;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.verify;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.when;
+
+import android.app.AlertDialog;
+import android.car.Car;
+import android.car.admin.CarDevicePolicyManager;
+import android.car.test.mocks.AbstractExtendedMockitoTestCase;
+import android.car.test.mocks.AndroidMockitoHelper;
+import android.content.DialogInterface;
+import android.util.Log;
+import android.widget.Button;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+
+@RunWith(AndroidJUnit4.class)
+public final class NewUserDisclaimerActivityTest extends AbstractExtendedMockitoTestCase {
+    private static final String TAG = NewUserDisclaimerActivityTest.class.getSimpleName();
+
+    // NOTE: Cannot launch activity automatically as we need to mock Car.createCar() first
+    @Rule
+    public ActivityTestRule<NewUserDisclaimerActivity> mActivityRule = new ActivityTestRule(
+            NewUserDisclaimerActivity.class,  /* initialTouchMode= */ false,
+            /* launchActivity= */ false);
+
+    private NewUserDisclaimerActivity mActivity;
+
+    @Mock
+    private CarDevicePolicyManager mCarDevicePolicyManager;
+
+    @Mock
+    private Car mCar;
+
+    public NewUserDisclaimerActivityTest() {
+        super(NewUserDisclaimerActivity.LOG.getTag());
+    }
+
+    @Override
+    protected void onSessionBuilder(CustomMockitoSessionBuilder session) {
+        session.spyStatic(Car.class);
+    }
+
+    @Before
+    public void setFixtures() {
+        Log.v(TAG, "setFixtures(): mocking Car.createCar()");
+        doReturn(mCar).when(() -> Car.createCar(any()));
+
+        when(mCar.getCarManager(Car.CAR_DEVICE_POLICY_SERVICE))
+                .thenReturn(mCarDevicePolicyManager);
+
+        Log.v(TAG, "setFixtures(): launching activitiy");
+        mActivity = mActivityRule.launchActivity(/* intent= */ null);
+
+        // It's called onResume() to show on current user
+        verify(mCarDevicePolicyManager).setUserDisclaimerShown(mActivity.getUser());
+    }
+
+    @Test
+    public void testAccept() throws Exception {
+        AndroidMockitoHelper.syncRunOnUiThread(mActivity, () -> {
+            Button button = getConfirmationDialog().getButton(DialogInterface.BUTTON_POSITIVE);
+            Log.d(TAG, "Clicking accept button: " + button);
+            button.performClick();
+        });
+
+        verify(mCarDevicePolicyManager).setUserDisclaimerAcknowledged(mActivity.getUser());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertWithMessage("activity is finishing").that(mActivity.isFinishing()).isTrue();
+    }
+
+    private AlertDialog getConfirmationDialog() {
+        return (AlertDialog) ((ConfirmationDialogFragment) mActivity.getSupportFragmentManager()
+                .findFragmentByTag(NewUserDisclaimerActivity.DIALOG_TAG))
+                .getDialog();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/AllAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/AllAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..4c587362d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/AllAppsPreferenceControllerTest.java
@@ -0,0 +1,211 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+
+import android.app.usage.UsageStats;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AllAppsPreferenceControllerTest {
+
+    private static final int TEST_APP_COUNT = 3;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private AllAppsPreferenceController mPreferenceController;
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new AllAppsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new Preference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_isUnavailableByDefault() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCreate_isUnavailableByDefault_zoneWrite() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCreate_isUnavailableByDefault_zoneRead() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCreate_isUnavailableByDefault_zoneHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isAvailable() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isAvailable_zoneWrite() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isAvailable_zoneRead() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isAvailable_zoneHidden() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable_zoneWrite() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable_zoneRead() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable_zoneHidden() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onAppCountCallback_summarySet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onInstalledAppCountLoaded(TEST_APP_COUNT);
+
+        assertThat(mPreference.getSummary()).isEqualTo(mContext.getResources().getString(
+                R.string.apps_view_all_apps_title, TEST_APP_COUNT));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/ApplicationActionButtonsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/ApplicationActionButtonsPreferenceControllerTest.java
new file mode 100644
index 000000000..de4b23db7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/ApplicationActionButtonsPreferenceControllerTest.java
@@ -0,0 +1,848 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static android.app.Activity.RESULT_FIRST_USER;
+
+import static com.android.car.settings.applications.ApplicationActionButtonsPreferenceController.DISABLE_CONFIRM_DIALOG_TAG;
+import static com.android.car.settings.applications.ApplicationActionButtonsPreferenceController.FORCE_STOP_CONFIRM_DIALOG_TAG;
+import static com.android.car.settings.applications.ApplicationActionButtonsPreferenceController.UNINSTALL_DEVICE_ADMIN_REQUEST_CODE;
+import static com.android.car.settings.applications.ApplicationActionButtonsPreferenceController.UNINSTALL_REQUEST_CODE;
+import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyList;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.ArgumentMatchers.isNull;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.Manifest;
+import android.app.Activity;
+import android.app.ActivityManager;
+import android.app.admin.DevicePolicyManager;
+import android.app.role.RoleManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.content.pm.Signature;
+import android.content.res.Resources;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ActionButtonInfo;
+import com.android.car.settings.common.ActionButtonsPreference;
+import com.android.car.settings.common.ActivityResultCallback;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.enterprise.DeviceAdminAddActivity;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class ApplicationActionButtonsPreferenceControllerTest {
+
+    private static final String PACKAGE_NAME = "Test Package Name";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private ActionButtonsPreference mActionButtonsPreference;
+    private ApplicationActionButtonsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ApplicationInfo mApplicationInfo;
+    private PackageInfo mPackageInfo;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ApplicationsState mMockAppState;
+    @Mock
+    private ApplicationsState.AppEntry mMockAppEntry;
+    @Mock
+    private DevicePolicyManager mMockDpm;
+    @Mock
+    private PackageManager mMockPm;
+    @Mock
+    private ActivityManager mMockActivityManager;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        setMocks();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mActionButtonsPreference = new ActionButtonsPreference(mContext);
+        mPreferenceController = new ApplicationActionButtonsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Test
+    public void testCheckInitialized_noAppState_throwException() {
+        mPreferenceController.setAppEntry(mMockAppEntry).setPackageName(PACKAGE_NAME);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mActionButtonsPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noAppEntry_throwException() {
+        mPreferenceController.setAppState(mMockAppState).setPackageName(PACKAGE_NAME);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mActionButtonsPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noPackageNameEntry_throwException() {
+        mPreferenceController.setAppEntry(mMockAppEntry).setAppState(mMockAppState);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mActionButtonsPreference));
+    }
+
+    @Test
+    public void onCreate_bundledApp_enabled_showDisableButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getDisableButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "disable_text"));
+    }
+
+    @Test
+    public void onCreate_bundledApp_disabled_showEnableButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ false, /* system= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getDisableButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "enable_text"));
+    }
+
+    @Test
+    public void onCreate_bundledApp_enabled_disableUntilUsed_showsEnableButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+        mApplicationInfo.enabledSetting =
+                PackageManager.COMPONENT_ENABLED_STATE_DISABLED_UNTIL_USED;
+        mMockAppEntry.info = mApplicationInfo;
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getDisableButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "enable_text"));
+    }
+
+    @Test
+    public void onCreate_bundledApp_homePackage_disablesDisableButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+
+        ResolveInfo homeActivity = new ResolveInfo();
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.packageName = PACKAGE_NAME;
+        homeActivity.activityInfo = activityInfo;
+
+        when(mMockPm.getHomeActivities(anyList())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            ((List<ResolveInfo>) args[0]).add(homeActivity);
+            return null;
+        });
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getDisableButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_bundledApp_systemPackage_disablesDisableButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+        mPackageInfo.signatures = new Signature[]{new Signature(PACKAGE_NAME.getBytes())};
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getDisableButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_bundledApp_enabledApp_keepEnabledPackage_disablesDisableButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+
+        ResolveInfo phoneActivity = new ResolveInfo();
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.packageName = PACKAGE_NAME;
+        activityInfo.permission = Manifest.permission.BROADCAST_SMS;
+        phoneActivity.activityInfo = activityInfo;
+
+        RoleManager mockRoleManager = mock(RoleManager.class);
+        when(mContext.getSystemService(RoleManager.class)).thenReturn(mockRoleManager);
+        when(mockRoleManager.getRoleHoldersAsUser(eq(RoleManager.ROLE_DIALER),
+                any(UserHandle.class))).thenReturn(Collections.singletonList(PACKAGE_NAME));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getDisableButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_notSystemApp_showUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "uninstall_text"));
+    }
+
+    @Test
+    public void onCreate_packageHasActiveAdmins_doesNotDisableUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        when(mMockDpm.packageHasActiveAdmins(PACKAGE_NAME)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_deviceProvisioningPackage_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        Resources resources = mock(Resources.class);
+        when(mContext.getResources()).thenReturn(resources);
+        when(resources.getString(com.android.internal.R.string.config_deviceProvisioningPackage))
+                .thenReturn(PACKAGE_NAME);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onStart_uninstallQueued_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        when(mMockDpm.isUninstallInQueue(PACKAGE_NAME)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onStart_noDefaultHome_onlyHomeApp_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        ResolveInfo homeActivity = new ResolveInfo();
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.packageName = PACKAGE_NAME;
+        homeActivity.activityInfo = activityInfo;
+
+        when(mMockPm.getHomeActivities(anyList())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            ((List<ResolveInfo>) args[0]).add(homeActivity);
+            return null;
+        });
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onStart_noDefaultHome_multipleHomeApps_enablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        ResolveInfo homeActivity = new ResolveInfo();
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.packageName = PACKAGE_NAME;
+        homeActivity.activityInfo = activityInfo;
+
+        ResolveInfo altHomeActivity = new ResolveInfo();
+        ActivityInfo altActivityInfo = new ActivityInfo();
+        altActivityInfo.packageName = PACKAGE_NAME + ".Someotherhome";
+        altHomeActivity.activityInfo = altActivityInfo;
+
+        when(mMockPm.getHomeActivities(anyList())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            ((List<ResolveInfo>) args[0]).addAll(Arrays.asList(homeActivity, altHomeActivity));
+            return null;
+        });
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onStart_defaultHomeApp_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        ResolveInfo homeActivity = new ResolveInfo();
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.packageName = PACKAGE_NAME;
+        homeActivity.activityInfo = activityInfo;
+
+        ResolveInfo altHomeActivity = new ResolveInfo();
+        ActivityInfo altActivityInfo = new ActivityInfo();
+        altActivityInfo.packageName = PACKAGE_NAME + ".Someotherhome";
+        altHomeActivity.activityInfo = altActivityInfo;
+
+        when(mMockPm.getHomeActivities(anyList())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            ((List<ResolveInfo>) args[0]).addAll(Arrays.asList(homeActivity, altHomeActivity));
+            return new ComponentName(PACKAGE_NAME, "SomeClass");
+        });
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onStart_appsControlUserRestriction_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        mockDisabledByUserManagerRestriction(UserManager.DISALLOW_APPS_CONTROL);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onStart_appsControlUserRestrictionByDeviceAdmin_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        mockDisabledByDevicePolicyManagerRestriction(UserManager.DISALLOW_APPS_CONTROL);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onStart_uninstallAppsRestriction_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        mockDisabledByUserManagerRestriction(UserManager.DISALLOW_UNINSTALL_APPS);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onStart_uninstallAppsRestrictionByDeviceAdmin_disablesUninstallButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        mockDisabledByDevicePolicyManagerRestriction(UserManager.DISALLOW_UNINSTALL_APPS);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getUninstallButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_forceStopButtonInitialized() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getForceStopButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "force_stop"));
+    }
+
+    @Test
+    public void onCreate_notStopped_enablesForceStopButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getForceStopButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_stopped_disablesForceStopButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ true, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getForceStopButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_packageHasActiveAdmins_disablesForceStopButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        when(mMockDpm.packageHasActiveAdmins(PACKAGE_NAME)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getForceStopButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_appsControlUserRestriction_disablesForceStopButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        mockDisabledByUserManagerRestriction(UserManager.DISALLOW_APPS_CONTROL);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getForceStopButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_appsControlUserRestrictionByDeviceAdmin_disablesForceStopButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        mockDisabledByDevicePolicyManagerRestriction(UserManager.DISALLOW_APPS_CONTROL);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getForceStopButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_packageExplicitlyStopped_queriesPackageRestart() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ true, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mContext).sendOrderedBroadcastAsUser(any(Intent.class),
+                eq(UserHandle.CURRENT),
+                /* receiverPermission= */
+                eq(android.Manifest.permission.HANDLE_QUERY_PACKAGE_RESTART),
+                any(BroadcastReceiver.class),
+                /* scheduler= */ isNull(),
+                eq(Activity.RESULT_CANCELED),
+                /* initialData= */ isNull(),
+                /* initialExtras= */ isNull());
+    }
+
+    @Test
+    public void onCreate_packageExplicitlyStopped_success_enablesForceStopButton() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ true, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mCheckKillProcessesReceiver.setPendingResult(
+                new BroadcastReceiver.PendingResult(Activity.RESULT_OK,
+                        "resultData",
+                        /* resultExtras= */ null,
+                        BroadcastReceiver.PendingResult.TYPE_UNREGISTERED,
+                        /* ordered= */ true,
+                        /* sticky= */ false,
+                        /* token= */ null,
+                        UserHandle.myUserId(),
+                        /* flags= */ 0));
+
+        mPreferenceController.mCheckKillProcessesReceiver.onReceive(mContext, /* intent= */ null);
+
+        assertThat(getForceStopButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_packageExplicitlyStopped_failure_disablesForceStopButton() {
+
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ true, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mCheckKillProcessesReceiver.setPendingResult(
+                new BroadcastReceiver.PendingResult(Activity.RESULT_CANCELED,
+                        "resultData",
+                        /* resultExtras= */ null,
+                        BroadcastReceiver.PendingResult.TYPE_UNREGISTERED,
+                        /* ordered= */ true,
+                        /* sticky= */ false,
+                        /* token= */ null,
+                        UserHandle.myUserId(),
+                        /* flags= */ 0));
+
+        mPreferenceController.mCheckKillProcessesReceiver.onReceive(mContext, /* intent= */ null);
+
+        assertThat(getForceStopButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void forceStopClicked_showsDialog() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getForceStopButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(FORCE_STOP_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    public void forceStopClicked_showsDisabledByDeviceAdminDialog() {
+        mockDisabledByDevicePolicyManagerRestriction(UserManager.DISALLOW_APPS_CONTROL);
+
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getForceStopButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    public void forceStopClicked_notDisabledByDeviceAdminDialog_forDifferentUserRestrictionType() {
+        mockDisabledByDevicePolicyManagerRestriction(UserManager.DISALLOW_UNINSTALL_APPS);
+
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getForceStopButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(FORCE_STOP_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    @UiThreadTest
+    public void forceStopDialogConfirmed_forceStopsPackage() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mForceStopConfirmListener.onConfirm(/* arguments= */ null);
+
+        verify(mMockActivityManager).forceStopPackage(PACKAGE_NAME);
+        verify(mMockAppState).invalidatePackage(eq(PACKAGE_NAME), anyInt());
+    }
+
+    @Test
+    public void disableClicked_showsDialog() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getDisableButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(DISABLE_CONFIRM_DIALOG_TAG));
+    }
+
+
+    @Test
+    public void disableDialogConfirmed_disablesPackage() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mDisableConfirmListener.onConfirm(/* arguments= */ null);
+
+        verify(mMockPm).setApplicationEnabledSetting(PACKAGE_NAME,
+                PackageManager.COMPONENT_ENABLED_STATE_DISABLED_USER, /* flags= */ 0);
+    }
+
+    @Test
+    public void disableClicked_showsDisabledByDeviceAdminDialog() {
+        mockDisabledByDevicePolicyManagerRestriction(UserManager.DISALLOW_APPS_CONTROL);
+
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getDisableButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+        verify(mMockPm, never()).setApplicationEnabledSetting(PACKAGE_NAME,
+                PackageManager.COMPONENT_ENABLED_STATE_DISABLED_USER, /* flags= */ 0);
+    }
+
+    @Test
+    public void enableClicked_enablesPackage() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ false, /* system= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getDisableButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mMockPm).setApplicationEnabledSetting(PACKAGE_NAME,
+                PackageManager.COMPONENT_ENABLED_STATE_DEFAULT, /* flags= */ 0);
+    }
+
+    @Test
+    public void enableClicked_showsDisabledByDeviceAdminDialog() {
+        mockDisabledByDevicePolicyManagerRestriction(UserManager.DISALLOW_APPS_CONTROL);
+
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ false, /* system= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getDisableButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+        verify(mMockPm, never()).setApplicationEnabledSetting(PACKAGE_NAME,
+                PackageManager.COMPONENT_ENABLED_STATE_DEFAULT, /* flags= */ 0);
+    }
+
+    @Test
+    public void uninstallClicked_packageHasActiveAdmins_startsDeviceAdminAddActivity() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+        when(mMockDpm.packageHasActiveAdmins(PACKAGE_NAME)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getUninstallButton().getOnClickListener().onClick(/* view= */ null);
+
+        ArgumentCaptor<Intent> intentArgumentCaptor = ArgumentCaptor.forClass(
+                Intent.class);
+
+        verify(mFragmentController).startActivityForResult(intentArgumentCaptor.capture(),
+                eq(UNINSTALL_DEVICE_ADMIN_REQUEST_CODE),
+                any(ApplicationActionButtonsPreferenceController.class));
+
+        Intent intent = intentArgumentCaptor.getValue();
+        assertThat(intent.getComponent().getClassName())
+                .isEqualTo(DeviceAdminAddActivity.class.getName());
+        assertThat(intent.getStringExtra(DeviceAdminAddActivity.EXTRA_DEVICE_ADMIN_PACKAGE_NAME))
+                .isEqualTo(PACKAGE_NAME);
+    }
+
+    @Test
+    public void uninstallClicked_startsUninstallActivity() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getUninstallButton().getOnClickListener().onClick(/* view= */ null);
+
+        ArgumentCaptor<Intent> intentArgumentCaptor = ArgumentCaptor.forClass(
+                Intent.class);
+
+        verify(mFragmentController).startActivityForResult(intentArgumentCaptor.capture(),
+                eq(UNINSTALL_REQUEST_CODE), any(ActivityResultCallback.class));
+
+        Intent intent = intentArgumentCaptor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_UNINSTALL_PACKAGE);
+        assertThat(intent.getBooleanExtra(Intent.EXTRA_RETURN_RESULT, false)).isTrue();
+        assertThat(intent.getData().toString()).isEqualTo("package:" + PACKAGE_NAME);
+    }
+
+    @Test
+    public void uninstallClicked_showsDisabledByDeviceAdminDialog_forDisallowAppsControl() {
+        testShowingDisabledByDeviceAdminDialogWhenUninstallClicked(
+                UserManager.DISALLOW_APPS_CONTROL);
+    }
+
+    @Test
+    public void uninstallClicked_showsDisabledByDeviceAdminDialog_forDisallowUninstallApps() {
+        testShowingDisabledByDeviceAdminDialogWhenUninstallClicked(
+                UserManager.DISALLOW_UNINSTALL_APPS);
+    }
+
+    private void testShowingDisabledByDeviceAdminDialogWhenUninstallClicked(String restriction) {
+        mockDisabledByDevicePolicyManagerRestriction(restriction);
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        getUninstallButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    public void processActivityResult_uninstall_resultOk_goesBack() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.processActivityResult(UNINSTALL_REQUEST_CODE,
+                Activity.RESULT_OK, /* data= */ null);
+
+        verify(mFragmentController).goBack();
+    }
+
+    @Test
+    public void processActivityResult_uninstallDeviceAdmin_resultOk_goesBack() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.processActivityResult(UNINSTALL_DEVICE_ADMIN_REQUEST_CODE,
+                Activity.RESULT_OK, /* data= */ null);
+
+        verify(mFragmentController).goBack();
+    }
+
+
+    @Test
+    public void processActivityResult_uninstallDeviceAdmin_resultFirstUser_showsDisabledDialog() {
+        setupAndAssignPreference();
+        setApplicationInfo(/* stopped= */ false, /* enabled= */ true, /* system= */ false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.processActivityResult(UNINSTALL_DEVICE_ADMIN_REQUEST_CODE,
+                RESULT_FIRST_USER, /* data= */ null);
+
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private void setMocks() {
+        mPackageInfo = new PackageInfo();
+        mPackageInfo.packageName = PACKAGE_NAME;
+
+        when(mMockAppState.getEntry(eq(PACKAGE_NAME), anyInt())).thenReturn(mMockAppEntry);
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+        when(mContext.getSystemService(Context.ACTIVITY_SERVICE)).thenReturn(mMockActivityManager);
+        when(mContext.getSystemService(Context.DEVICE_POLICY_SERVICE)).thenReturn(mMockDpm);
+        when(mContext.getSystemService(Context.USER_SERVICE)).thenReturn(mMockUserManager);
+
+        PackageInfo systemPackage = new PackageInfo();
+        systemPackage.packageName = "android";
+        systemPackage.signatures = new Signature[]{new Signature(PACKAGE_NAME.getBytes())};
+        ApplicationInfo systemApplicationInfo = new ApplicationInfo();
+        systemApplicationInfo.packageName = "android";
+        systemPackage.applicationInfo = systemApplicationInfo;
+        try {
+            when(mMockPm.getPackageInfo(eq(PACKAGE_NAME), anyInt())).thenReturn(mPackageInfo);
+            when(mMockPm.getPackageInfo("android", PackageManager.GET_SIGNATURES))
+                    .thenReturn(systemPackage);
+        } catch (PackageManager.NameNotFoundException e) {
+            // no-op - don't catch exception inside test
+        }
+    }
+
+    private void setupAndAssignPreference() {
+        mPreferenceController.setAppEntry(mMockAppEntry).setAppState(mMockAppState).setPackageName(
+                PACKAGE_NAME);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mActionButtonsPreference);
+    }
+
+    private void setApplicationInfo(boolean stopped, boolean enabled, boolean system) {
+        mApplicationInfo = new ApplicationInfo();
+        if (stopped) {
+            mApplicationInfo.flags |= ApplicationInfo.FLAG_STOPPED;
+        }
+        if (!enabled) {
+            mApplicationInfo.enabled = false;
+        }
+        if (system) {
+            mApplicationInfo.flags |= ApplicationInfo.FLAG_SYSTEM;
+        }
+        mMockAppEntry.info = mApplicationInfo;
+    }
+
+    private ActionButtonInfo getForceStopButton() {
+        return mActionButtonsPreference.getButton(ActionButtons.BUTTON2);
+    }
+
+    private ActionButtonInfo getDisableButton() {
+        // Same button is used with a different handler. This method is purely for readability.
+        return getUninstallButton();
+    }
+
+    private ActionButtonInfo getUninstallButton() {
+        return mActionButtonsPreference.getButton(ActionButtons.BUTTON1);
+    }
+
+    private void mockDisabledByUserManagerRestriction(String restriction) {
+        when(mMockUserManager.hasUserRestriction(restriction)).thenReturn(true);
+        when(mMockUserManager.hasBaseUserRestriction(eq(restriction), any())).thenReturn(true);
+    }
+
+    private void mockDisabledByDevicePolicyManagerRestriction(String restriction) {
+        when(mMockUserManager.hasUserRestriction(restriction)).thenReturn(true);
+        when(mMockUserManager.hasBaseUserRestriction(eq(restriction), any())).thenReturn(false);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/ApplicationPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/ApplicationPreferenceControllerTest.java
new file mode 100644
index 000000000..05eeb9488
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/ApplicationPreferenceControllerTest.java
@@ -0,0 +1,100 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ApplicationPreferenceControllerTest {
+
+    private static final String PACKAGE_NAME = "Test Package Name";
+
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ApplicationPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ApplicationsState mMockAppState;
+    @Mock
+    private ApplicationsState.AppEntry mMockAppEntry;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        Context context = ApplicationProvider.getApplicationContext();
+        mMockAppEntry.label = PACKAGE_NAME;
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(context);
+        mController = new ApplicationPreferenceController(context,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+
+        when(mMockAppState.getEntry(PACKAGE_NAME, UserHandle.myUserId())).thenReturn(mMockAppEntry);
+    }
+
+    @Test
+    public void testCheckInitialized_noAppState_throwException() {
+        mController.setAppEntry(mMockAppEntry);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mController, mPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noAppEntry_throwException() {
+        mController.setAppState(mMockAppState);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mController, mPreference));
+    }
+
+    @Test
+    public void testRefreshUi_hasResolveInfo_setTitle() {
+        LifecycleOwner lifecycleOwner = new TestLifecycleOwner();
+        mController.setAppEntry(mMockAppEntry);
+        mController.setAppState(mMockAppState);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.onCreate(lifecycleOwner);
+        mController.refreshUi();
+        assertThat(mPreference.getTitle()).isEqualTo(PACKAGE_NAME);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/ApplicationsSettingsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/ApplicationsSettingsPreferenceControllerTest.java
new file mode 100644
index 000000000..94d08ac55
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/ApplicationsSettingsPreferenceControllerTest.java
@@ -0,0 +1,135 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+
+@RunWith(AndroidJUnit4.class)
+public class ApplicationsSettingsPreferenceControllerTest {
+
+    private static final String SOURCE = "source";
+    private static final int UID = 12;
+    private static final String LABEL = "label";
+    private static final String SIZE_STR = "12.34 MB";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreferenceGroup;
+    private ApplicationsSettingsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new ApplicationsSettingsPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void defaultInitialize_hasNoPreference() {
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void onDataLoaded_addPreference_hasOnePreference() {
+        ArrayList<ApplicationsState.AppEntry> apps = new ArrayList<>();
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.uid = UID;
+        appInfo.sourceDir = SOURCE;
+
+        ApplicationsState.AppEntry appEntry = new ApplicationsState.AppEntry(mContext, appInfo,
+                1234L);
+        appEntry.label = LABEL;
+        appEntry.sizeStr = SIZE_STR;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+        apps.add(appEntry);
+
+        mPreferenceController.onDataLoaded(apps);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreferenceGroup.getPreference(0).getTitle()).isEqualTo(LABEL);
+        assertThat(mPreferenceGroup.getPreference(0).getSummary()).isEqualTo(SIZE_STR);
+    }
+
+    @Test
+    @UiThreadTest
+    public void preferenceClick_launchesDetailFragment() {
+        ArrayList<ApplicationsState.AppEntry> apps = new ArrayList<>();
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.uid = UID;
+        appInfo.sourceDir = SOURCE;
+
+        ApplicationsState.AppEntry appEntry = new ApplicationsState.AppEntry(mContext, appInfo,
+                1234L);
+        appEntry.label = LABEL;
+        appEntry.sizeStr = SIZE_STR;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+        apps.add(appEntry);
+
+        mPreferenceController.onDataLoaded(apps);
+
+        Preference preference = mPreferenceGroup.getPreference(0);
+        preference.performClick();
+
+        verify(mFragmentController).launchFragment(any(ApplicationDetailsFragment.class));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/HibernatedAppsItemManagerTest.java b/tests/multivalent/src/com/android/car/settings/applications/HibernatedAppsItemManagerTest.java
new file mode 100644
index 000000000..deba6b1eb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/HibernatedAppsItemManagerTest.java
@@ -0,0 +1,98 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static android.provider.DeviceConfig.NAMESPACE_APP_HIBERNATION;
+
+import static com.android.car.settings.applications.ApplicationsUtils.PROPERTY_APP_HIBERNATION_ENABLED;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.permission.PermissionControllerManager;
+import android.provider.DeviceConfig;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.CountDownLatch;
+import java.util.concurrent.TimeUnit;
+import java.util.function.IntConsumer;
+
+@RunWith(AndroidJUnit4.class)
+public class HibernatedAppsItemManagerTest {
+    private static final int CALLBACK_TIMEOUT_MS = 100;
+
+    private final CountDownLatch mCountDownLatch = new CountDownLatch(1);
+
+    private final TestListener mHibernatedAppsCountListener = new TestListener();
+    @Mock
+    private PackageManager mPackageManager;
+    @Mock
+    private PermissionControllerManager mPermissionControllerManager;
+    @Captor
+    private ArgumentCaptor<IntConsumer> mIntConsumerCaptor;
+    private Context mContext;
+    private HibernatedAppsItemManager mManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                "true", false);
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+        when(mContext.getSystemService(PermissionControllerManager.class))
+                .thenReturn(mPermissionControllerManager);
+        mManager = new HibernatedAppsItemManager(mContext);
+        mManager.setListener(mHibernatedAppsCountListener);
+    }
+
+
+    @Test
+    public void getSummary_getsRightCountForHibernatedPackage() throws Exception {
+        mManager.startLoading();
+        mCountDownLatch.await(CALLBACK_TIMEOUT_MS, TimeUnit.MILLISECONDS);
+        verify(mPermissionControllerManager).getUnusedAppCount(any(), mIntConsumerCaptor.capture());
+        mIntConsumerCaptor.getValue().accept(1);
+        assertThat(mHibernatedAppsCountListener.mResult).isEqualTo(1);
+    }
+
+    private class TestListener implements HibernatedAppsItemManager.HibernatedAppsCountListener {
+        int mResult;
+
+        @Override
+        public void onHibernatedAppsCountLoaded(int hibernatedAppsCount) {
+            mResult = hibernatedAppsCount;
+            mCountDownLatch.countDown();
+        }
+    };
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/HibernatedAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/HibernatedAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..5f5aec272
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/HibernatedAppsPreferenceControllerTest.java
@@ -0,0 +1,176 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static android.provider.DeviceConfig.NAMESPACE_APP_HIBERNATION;
+
+import static com.android.car.settings.applications.ApplicationsUtils.PROPERTY_APP_HIBERNATION_ENABLED;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.apphibernation.AppHibernationManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.provider.DeviceConfig;
+
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.settingslib.utils.StringUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class HibernatedAppsPreferenceControllerTest {
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mPackageManager;
+    @Mock
+    private AppHibernationManager mAppHibernationManager;
+    @Mock
+    private Preference mPreference;
+    private static final String KEY = "key";
+    private Context mContext;
+    private HibernatedAppsPreferenceController mController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                "true", false);
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+        when(mContext.getSystemService(AppHibernationManager.class))
+                .thenReturn(mAppHibernationManager);
+        mPreference = new CarUiPreference(mContext);
+        mController = new HibernatedAppsPreferenceController(mContext, KEY, mFragmentController,
+                mCarUxRestrictions);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureDisabled_shouldNotReturnAvailable() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+
+        assertThat((mController).getAvailabilityStatus()).isNotEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureDisabled_shouldNotReturnAvailable_zoneWrite() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureDisabled_shouldNotReturnAvailable_zoneRead() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureDisabled_shouldNotReturnAvailable_zoneHidden() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureEnabled_shouldReturnAvailable() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "true", /* makeDefault= */ true);
+
+        assertThat((mController).getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureEnabled_shouldReturnAvailable_zoneWrite() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "true", /* makeDefault= */ true);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureEnabled_shouldReturnAvailable_zoneRead() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "true", /* makeDefault= */ true);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureEnabled_shouldReturnAvailable_zoneHidden() {
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "true", /* makeDefault= */ true);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onHibernatedAppsCountCallback_setsSummary() {
+        assignPreference();
+        int totalHibernated = 2;
+
+        mController.onHibernatedAppsCountLoaded(totalHibernated);
+
+        assertThat(mPreference.getSummary()).isEqualTo(StringUtil.getIcuPluralsString(mContext,
+                totalHibernated, R.string.unused_apps_summary));
+    }
+
+    private void assignPreference() {
+        PreferenceControllerTestUtil.assignPreference(mController,
+                mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/HideSystemSwitchPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/HideSystemSwitchPreferenceControllerTest.java
new file mode 100644
index 000000000..09f949007
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/HideSystemSwitchPreferenceControllerTest.java
@@ -0,0 +1,110 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.SharedPreferences;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class HideSystemSwitchPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private SwitchPreference mSwitchPreference;
+    private HideSystemSwitchPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private LifecycleOwner mLifecycleOwner;
+    private SharedPreferences mSharedPreferences;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mSharedPreferences = mContext.getSharedPreferences(
+                AppListFragment.SHARED_PREFERENCE_PATH, Context.MODE_PRIVATE);
+
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new HideSystemSwitchPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+    }
+
+    @After
+    public void tearDown() {
+        mSharedPreferences.edit().clear().apply();
+    }
+
+    @Test
+    public void onStart_sharedPreferenceTrue_switchChecked() {
+        mSharedPreferences.edit().putBoolean(AppListFragment.KEY_HIDE_SYSTEM, true).apply();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onStart_sharedPreferenceFalse_switchUnchecked() {
+        mSharedPreferences.edit().putBoolean(AppListFragment.KEY_HIDE_SYSTEM, false).apply();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onPreferenceClicked_sharedPreferenceToggled() {
+        mSharedPreferences.edit().putBoolean(AppListFragment.KEY_HIDE_SYSTEM, true).apply();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+        assertThat(mSharedPreferences.getBoolean(AppListFragment.KEY_HIDE_SYSTEM,
+                /* defaultValue= */ true)).isFalse();
+
+        mSwitchPreference.performClick();
+        assertThat(mSharedPreferences.getBoolean(AppListFragment.KEY_HIDE_SYSTEM,
+                /* defaultValue= */ false)).isTrue();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/InstalledAppCountItemManagerTest.java b/tests/multivalent/src/com/android/car/settings/applications/InstalledAppCountItemManagerTest.java
new file mode 100644
index 000000000..2d16b31db
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/InstalledAppCountItemManagerTest.java
@@ -0,0 +1,92 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.os.UserManager;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class InstalledAppCountItemManagerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private InstalledAppCountItemManager mInstalledAppCountItemManager;
+
+    @Mock
+    private ApplicationInfo mMockApplicationInfo;
+    @Mock
+    private PackageManager mMockPm;
+    @Mock
+    private UserManager mMockUm;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUm);
+        when(mMockUm.isUserForeground()).thenReturn(true);
+        mInstalledAppCountItemManager = new InstalledAppCountItemManager(mContext);
+    }
+
+    @Test
+    public void isUpdatedSystemApp_isCounted() {
+        mMockApplicationInfo.flags = ApplicationInfo.FLAG_UPDATED_SYSTEM_APP;
+
+        assertThat(mInstalledAppCountItemManager.shouldCountApp(mMockApplicationInfo)).isTrue();
+    }
+
+    @Test
+    public void isSystemApp_userCanOpen_isCounted() {
+        mMockApplicationInfo.flags = ApplicationInfo.FLAG_SYSTEM;
+        List<ResolveInfo> intents = new ArrayList<>();
+        intents.add(new ResolveInfo());
+        when(mMockPm.queryIntentActivitiesAsUser(any(), anyInt(), anyInt())).thenReturn(intents);
+
+        assertThat(mInstalledAppCountItemManager.shouldCountApp(mMockApplicationInfo)).isTrue();
+    }
+
+    @Test
+    public void isSystemApp_userCannotOpen_isNotCounted() {
+        mMockApplicationInfo.flags = ApplicationInfo.FLAG_SYSTEM;
+        List<ResolveInfo> intents = new ArrayList<>();
+        when(mMockPm.queryIntentActivitiesAsUser(any(), anyInt(), anyInt())).thenReturn(intents);
+
+        assertThat(mInstalledAppCountItemManager.shouldCountApp(mMockApplicationInfo)).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/NotificationsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/NotificationsPreferenceControllerTest.java
new file mode 100644
index 000000000..6b0626f6e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/NotificationsPreferenceControllerTest.java
@@ -0,0 +1,285 @@
+/*
+ * Copyright (C) 2019 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.app.INotificationManager;
+import android.app.NotificationChannel;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
+import android.os.Build;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class NotificationsPreferenceControllerTest {
+    private static final String PKG_NAME = "package.name";
+    private static final int UID = 1001010;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private NotificationsPreferenceController mController;
+    private TwoStatePreference mTwoStatePreference;
+    private PackageInfo mPackageInfo;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private INotificationManager mMockNotificationManager;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private NotificationChannel mMockChannel;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mTwoStatePreference = new SwitchPreference(mContext);
+
+        mController = new NotificationsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mTwoStatePreference);
+
+        mController.mNotificationManager = mMockNotificationManager;
+
+        mPackageInfo = new PackageInfo();
+        mPackageInfo.packageName = PKG_NAME;
+
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+        applicationInfo.packageName = PKG_NAME;
+        mPackageInfo.applicationInfo = applicationInfo;
+        mPackageInfo.applicationInfo.uid = UID;
+        mPackageInfo.applicationInfo.targetSdkVersion = Build.VERSION_CODES.TIRAMISU;
+        mController.setPackageInfo(mPackageInfo);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+    }
+
+    @Test
+    public void onCreate_notificationEnabled_isChecked() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onCreate_notificationDisabled_isNotChecked() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(false);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onCreate_importanceLocked_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_noNotificationPermission_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_systemFixedFlag_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_SYSTEM_FIXED);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_policyFixedFlag_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_POLICY_FIXED);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_hasPermissions_isEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(0);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_targetSdkBelow33_systemFixedFlag_isNotEnabled() throws Exception {
+        mPackageInfo.applicationInfo.targetSdkVersion = Build.VERSION_CODES.S;
+
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_SYSTEM_FIXED);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_targetSdkBelow33_policyFixedFlag_isNotEnabled() throws Exception {
+        mPackageInfo.applicationInfo.targetSdkVersion = Build.VERSION_CODES.S;
+
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_POLICY_FIXED);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_targetSdkBelow33_doesNotHavePermission_isEnabled() throws Exception {
+        mPackageInfo.applicationInfo.targetSdkVersion = Build.VERSION_CODES.S;
+
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(0);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void callChangeListener_setEnable_enablingNotification() throws Exception {
+        when(mMockNotificationManager.onlyHasDefaultChannel(PKG_NAME, UID)).thenReturn(false);
+
+        mTwoStatePreference.callChangeListener(true);
+
+        verify(mMockNotificationManager).setNotificationsEnabledForPackage(PKG_NAME, UID, true);
+    }
+
+    @Test
+    public void callChangeListener_setDisable_disablingNotification() throws Exception {
+        when(mMockNotificationManager.onlyHasDefaultChannel(PKG_NAME, UID)).thenReturn(false);
+
+        mTwoStatePreference.callChangeListener(false);
+
+        verify(mMockNotificationManager).setNotificationsEnabledForPackage(PKG_NAME, UID, false);
+    }
+
+    @Test
+    public void callChangeListener_onlyHasDefaultChannel_updateChannel() throws Exception {
+        when(mMockNotificationManager.onlyHasDefaultChannel(PKG_NAME, UID)).thenReturn(true);
+        when(mMockNotificationManager
+                .getNotificationChannelForPackage(
+                        PKG_NAME, UID, NotificationChannel.DEFAULT_CHANNEL_ID, null, true))
+                .thenReturn(mMockChannel);
+
+        mTwoStatePreference.callChangeListener(true);
+
+        verify(mMockNotificationManager)
+                .updateNotificationChannelForPackage(PKG_NAME, UID, mMockChannel);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/PrioritizeAppPerformancePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/PrioritizeAppPerformancePreferenceControllerTest.java
new file mode 100644
index 000000000..d642fb262
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/PrioritizeAppPerformancePreferenceControllerTest.java
@@ -0,0 +1,205 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static android.car.watchdog.PackageKillableState.KILLABLE_STATE_NEVER;
+import static android.car.watchdog.PackageKillableState.KILLABLE_STATE_NO;
+import static android.car.watchdog.PackageKillableState.KILLABLE_STATE_YES;
+
+import static com.android.car.settings.applications.PrioritizeAppPerformancePreferenceController.TURN_ON_PRIORITIZE_APP_PERFORMANCE_DIALOG_TAG;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyLong;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.Car;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.watchdog.CarWatchdogManager;
+import android.car.watchdog.PackageKillableState;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageInfo;
+import android.os.Bundle;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public final class PrioritizeAppPerformancePreferenceControllerTest {
+    private static final String TEST_PKG_NAME = "test.package.name";
+    private static final int TEST_UID = 10012345;
+    private static final int TEST_USER_ID = 100;
+
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+
+    private MockitoSession mMockingSession;
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private PrioritizeAppPerformancePreferenceController mController;
+    private TwoStatePreference mTwoStatePreference;
+
+    @Captor
+    ArgumentCaptor<Car.CarServiceLifecycleListener> mCarLifecycleCaptor;
+    @Captor
+    ArgumentCaptor<ConfirmationDialogFragment> mDialogFragment;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private Car mMockCar;
+    @Mock
+    private CarWatchdogManager mMockManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mMockingSession = mockitoSession()
+                .initMocks(this)
+                .mockStatic(Car.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mTwoStatePreference = new SwitchPreference(mContext);
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mController = new PrioritizeAppPerformancePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, restrictions);
+
+        PreferenceControllerTestUtil.assignPreference(mController, mTwoStatePreference);
+
+        when(Car.createCar(any(), any(), anyLong(), mCarLifecycleCaptor.capture())).then(
+                invocation -> {
+                    Car.CarServiceLifecycleListener listener = mCarLifecycleCaptor.getValue();
+                    listener.onLifecycleChanged(mMockCar, true);
+                    return mMockCar;
+                });
+        when(mMockCar.getCarManager(Car.CAR_WATCHDOG_SERVICE)).thenReturn(mMockManager);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.packageName = TEST_PKG_NAME;
+        packageInfo.applicationInfo = new ApplicationInfo();
+        packageInfo.applicationInfo.uid = TEST_UID;
+        packageInfo.applicationInfo.packageName = TEST_PKG_NAME;
+        mController.setPackageInfo(packageInfo);
+    }
+
+    @After
+    public void tearDown() {
+        mMockingSession.finishMocking();
+    }
+
+    @Test
+    public void onCreate_prioritizeAppPerformance_withKillableStateYes() {
+        when(mMockManager.getPackageKillableStatesAsUser(any())).thenReturn(
+                Collections.singletonList(
+                        new PackageKillableState(TEST_PKG_NAME, TEST_USER_ID, KILLABLE_STATE_YES)));
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isChecked()).isFalse();
+        assertThat(mTwoStatePreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_prioritizeAppPerformance_withKillableStateNo() {
+        when(mMockManager.getPackageKillableStatesAsUser(any())).thenReturn(
+                Collections.singletonList(
+                        new PackageKillableState(TEST_PKG_NAME, TEST_USER_ID, KILLABLE_STATE_NO)));
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isChecked()).isTrue();
+        assertThat(mTwoStatePreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_prioritizeAppPerformance_withKillableStateNever() {
+        when(mMockManager.getPackageKillableStatesAsUser(any())).thenReturn(
+                Collections.singletonList(new PackageKillableState(
+                        TEST_PKG_NAME, TEST_USER_ID, KILLABLE_STATE_NEVER)));
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mTwoStatePreference.isChecked()).isFalse();
+        assertThat(mTwoStatePreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void callChangeListener_turnOffPrioritizeAppPerformance() {
+        when(mMockManager.getPackageKillableStatesAsUser(any())).thenReturn(
+                Collections.singletonList(
+                        new PackageKillableState(TEST_PKG_NAME, TEST_USER_ID, KILLABLE_STATE_NO)));
+        mController.onCreate(mLifecycleOwner);
+        assertThat(mTwoStatePreference.isChecked()).isTrue();
+
+        mTwoStatePreference.performClick();
+
+        verify(mMockManager).setKillablePackageAsUser(
+                TEST_PKG_NAME, UserHandle.getUserHandleForUid(TEST_UID), true);
+        assertThat(mTwoStatePreference.isChecked()).isFalse();
+        assertThat(mTwoStatePreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void callChangeListener_turnOnPrioritizeAppPerformance() {
+        when(mMockManager.getPackageKillableStatesAsUser(any())).thenReturn(
+                Collections.singletonList(
+                        new PackageKillableState(TEST_PKG_NAME, TEST_USER_ID, KILLABLE_STATE_YES)));
+        mController.onCreate(mLifecycleOwner);
+        assertThat(mTwoStatePreference.isChecked()).isFalse();
+
+        mTwoStatePreference.callChangeListener(true);
+
+        verify(mFragmentController).showDialog(
+                mDialogFragment.capture(), eq(TURN_ON_PRIORITIZE_APP_PERFORMANCE_DIALOG_TAG));
+
+        mDialogFragment.getValue().getConfirmListener().onConfirm(new Bundle());
+
+        verify(mMockManager).setKillablePackageAsUser(
+                TEST_PKG_NAME, UserHandle.getUserHandleForUid(TEST_UID), false);
+        assertThat(mTwoStatePreference.isChecked()).isTrue();
+        assertThat(mTwoStatePreference.isEnabled()).isTrue();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/RecentAppsGroupPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsGroupPreferenceControllerTest.java
new file mode 100644
index 000000000..401f6fc29
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsGroupPreferenceControllerTest.java
@@ -0,0 +1,201 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+
+import android.app.usage.UsageStats;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class RecentAppsGroupPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private RecentAppsGroupPreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new RecentAppsGroupPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_isAvailableByDefault() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void onCreate_isAvailableByDefault_zoneWrite() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void onCreate_isAvailableByDefault_zoneRead() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onCreate_isAvailableByDefault_zoneHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isUnavailable() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isUnavailable_zoneWrite() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isUnavailable_zoneRead() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_empty_isUnavailable_zoneHidden() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable_zoneWrite() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable_zoneRead() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onRecentAppsCallback_notEmpty_isUnavailable_zoneHidden() {
+        List<UsageStats> usageStats = new ArrayList<>();
+        usageStats.add(new UsageStats());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onRecentAppStatsLoaded(usageStats);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/RecentAppsItemManagerTest.java b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsItemManagerTest.java
new file mode 100644
index 000000000..531a90ff7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsItemManagerTest.java
@@ -0,0 +1,138 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyLong;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.app.usage.UsageStats;
+import android.app.usage.UsageStatsManager;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.os.UserHandle;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class RecentAppsItemManagerTest {
+
+    private static final String MOCK_PACKAGE_NAME_1 = "pkg1";
+    private static final String MOCK_PACKAGE_NAME_2 = "pkg2";
+    private static final String MOCK_PACKAGE_NAME_3 = "pkg3";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private RecentAppsItemManager mRecentAppsItemManager;
+
+    @Mock
+    private UsageStatsManager mUsageStatsManager;
+    @Mock
+    private ApplicationsState mAppState;
+    @Mock
+    private PackageManager mPackageManager;
+    @Mock
+    private ApplicationsState.AppEntry mAppEntry;
+    @Mock
+    private ApplicationInfo mApplicationInfo;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getApplicationContext()).thenReturn(mContext);
+        when(mContext.getSystemService(UsageStatsManager.class)).thenReturn(mUsageStatsManager);
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+
+        mRecentAppsItemManager = new RecentAppsItemManager(mContext,
+                3 /* maximumApps */, mAppState);
+    }
+
+    @Test
+    public void loadDisplayableRecentApps_oneValidRecentAppSet_shouldHaveOneRecentApp() {
+        final List<UsageStats> stats = new ArrayList<>();
+        final UsageStats stat1 = createUsageStats(MOCK_PACKAGE_NAME_1);
+        stats.add(stat1);
+        // stat1 is valid app.
+        when(mAppState.getEntry(eq(stat1.mPackageName), anyInt()))
+                .thenReturn(mAppEntry);
+        when(mPackageManager.resolveActivity(any(Intent.class), anyInt()))
+                .thenReturn(new ResolveInfo());
+        when(mUsageStatsManager.queryUsageStats(anyInt(), anyLong(), anyLong()))
+                .thenReturn(stats);
+        mAppEntry.info = mApplicationInfo;
+
+        mRecentAppsItemManager.loadDisplayableRecentApps(3);
+
+        assertThat(mRecentAppsItemManager.mRecentApps.size()).isEqualTo(1);
+    }
+
+    @Test
+    public void loadDisplayableRecentApps_oneValidAndTwoInvalidSet_shouldHaveOneRecentApp() {
+        final List<UsageStats> stats = new ArrayList<>();
+        final UsageStats stat1 = createUsageStats(MOCK_PACKAGE_NAME_1);
+        final UsageStats stat2 = createUsageStats(MOCK_PACKAGE_NAME_2);
+        final UsageStats stat3 = createUsageStats(MOCK_PACKAGE_NAME_3);
+        stats.add(stat1);
+        stats.add(stat2);
+        stats.add(stat3);
+
+        // stat1, stat2 are valid apps. stat3 is invalid.
+        when(mAppState.getEntry(stat1.mPackageName, UserHandle.myUserId()))
+                .thenReturn(mAppEntry);
+        when(mAppState.getEntry(stat2.mPackageName, UserHandle.myUserId()))
+                .thenReturn(mAppEntry);
+        when(mAppState.getEntry(stat3.mPackageName, UserHandle.myUserId()))
+                .thenReturn(null);
+        when(mPackageManager.resolveActivity(any(Intent.class), anyInt()))
+                .thenReturn(new ResolveInfo());
+        when(mUsageStatsManager.queryUsageStats(anyInt(), anyLong(), anyLong()))
+                .thenReturn(stats);
+        mAppEntry.info = mApplicationInfo;
+
+        mRecentAppsItemManager.loadDisplayableRecentApps(3);
+
+        // Only stat1. stat2 is skipped because of the package name, stat3 skipped because
+        // it's invalid app.
+        assertThat(mRecentAppsItemManager.mRecentApps.size()).isEqualTo(2);
+    }
+
+    private UsageStats createUsageStats(String packageName) {
+        UsageStats usageStats = new UsageStats();
+        usageStats.mPackageName = packageName;
+        usageStats.mLastTimeUsed = System.currentTimeMillis();
+        return usageStats;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/RecentAppsListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsListPreferenceControllerTest.java
new file mode 100644
index 000000000..48e19dfa7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsListPreferenceControllerTest.java
@@ -0,0 +1,185 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.app.usage.UsageStats;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class RecentAppsListPreferenceControllerTest {
+
+    private static final String MOCK_PACKAGE_NAME_1 = "pkg1";
+    private static final String MOCK_PACKAGE_NAME_2 = "pkg2";
+    private static final String MOCK_PACKAGE_NAME_3 = "pkg3";
+    private static final String MOCK_PACKAGE_NAME_4 = "pkg4";
+
+    private static final String MOCK_APP_NAME_1 = "title1";
+    private static final String MOCK_APP_NAME_2 = "title2";
+    private static final String MOCK_APP_NAME_3 = "title3";
+    private static final String MOCK_APP_NAME_4 = "title4";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private RecentAppsListPreferenceController mPreferenceController;
+    private PreferenceCategory mPreferenceCategory;
+    private CarUxRestrictions mCarUxRestrictions;
+    private int mMaxEntryCount;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private ApplicationsState mMockApplicationsState;
+    @Mock
+    private ApplicationInfo mApplicationInfo;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new RecentAppsListPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockApplicationsState);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceCategory = new PreferenceCategory(mContext);
+        screen.addPreference(mPreferenceCategory);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceCategory);
+
+        mMaxEntryCount = mContext.getResources().getInteger(
+                R.integer.recent_notifications_apps_list_count);
+    }
+
+    @Test
+    public void onRecentAppsLoaded_displaysApps() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        UsageStats usageStats = createUsageStats(MOCK_PACKAGE_NAME_1);
+        List<UsageStats> mUsageStatsList = new ArrayList<>();
+        mUsageStatsList.add(usageStats);
+        ApplicationsState.AppEntry appEntry = createAppEntry(MOCK_APP_NAME_1);
+
+        when(mMockApplicationsState.getEntry(eq(MOCK_PACKAGE_NAME_1), anyInt()))
+                .thenReturn(appEntry);
+
+        mPreferenceController.onRecentAppStatsLoaded(mUsageStatsList);
+
+        assertThat(mPreferenceCategory.getPreference(0).getTitle()).isEqualTo(appEntry.label);
+    }
+
+    @Test
+    public void onRecentAppsLoaded_doesNotDisplayInvalidApps() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        UsageStats usageStats1 = createUsageStats(MOCK_PACKAGE_NAME_1);
+        UsageStats usageStats2 = createUsageStats(MOCK_PACKAGE_NAME_2);
+        List<UsageStats> mUsageStatsList = new ArrayList<>();
+        mUsageStatsList.add(usageStats1);
+        mUsageStatsList.add(usageStats2);
+        ApplicationsState.AppEntry appEntry = createAppEntry(MOCK_APP_NAME_1);
+
+        when(mMockApplicationsState.getEntry(eq(MOCK_PACKAGE_NAME_1), anyInt()))
+                .thenReturn(appEntry);
+        when(mMockApplicationsState.getEntry(eq(MOCK_PACKAGE_NAME_2), anyInt())).thenReturn(null);
+
+        mPreferenceController.onRecentAppStatsLoaded(mUsageStatsList);
+
+        assertThat(mPreferenceCategory.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void onRecentAppsLoaded_moreThanMaximumAllowed_maximumShown() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        UsageStats usageStats1 = createUsageStats(MOCK_PACKAGE_NAME_1);
+        UsageStats usageStats2 = createUsageStats(MOCK_PACKAGE_NAME_2);
+        UsageStats usageStats3 = createUsageStats(MOCK_PACKAGE_NAME_3);
+        UsageStats usageStats4 = createUsageStats(MOCK_PACKAGE_NAME_4);
+        List<UsageStats> mUsageStatsList = new ArrayList<>();
+        mUsageStatsList.add(usageStats1);
+        mUsageStatsList.add(usageStats2);
+        mUsageStatsList.add(usageStats3);
+        mUsageStatsList.add(usageStats4);
+        ApplicationsState.AppEntry appEntry1 = createAppEntry(MOCK_APP_NAME_1);
+        ApplicationsState.AppEntry appEntry2 = createAppEntry(MOCK_APP_NAME_2);
+        ApplicationsState.AppEntry appEntry3 = createAppEntry(MOCK_APP_NAME_3);
+        ApplicationsState.AppEntry appEntry4 = createAppEntry(MOCK_APP_NAME_4);
+
+        when(mMockApplicationsState.getEntry(eq(MOCK_PACKAGE_NAME_1), anyInt()))
+                .thenReturn(appEntry1);
+        when(mMockApplicationsState.getEntry(eq(MOCK_PACKAGE_NAME_2), anyInt()))
+                .thenReturn(appEntry2);
+        when(mMockApplicationsState.getEntry(eq(MOCK_PACKAGE_NAME_3), anyInt()))
+                .thenReturn(appEntry3);
+        when(mMockApplicationsState.getEntry(eq(MOCK_PACKAGE_NAME_4), anyInt()))
+                .thenReturn(appEntry4);
+
+        mPreferenceController.onRecentAppStatsLoaded(mUsageStatsList);
+
+        assertThat(mPreferenceCategory.getPreferenceCount()).isEqualTo(mMaxEntryCount);
+    }
+
+    private UsageStats createUsageStats(String packageName) {
+        UsageStats usageStats = new UsageStats();
+        usageStats.mPackageName = packageName;
+        usageStats.mEndTimeStamp = System.currentTimeMillis();
+        return usageStats;
+    }
+
+    private ApplicationsState.AppEntry createAppEntry(String label) {
+        ApplicationsState.AppEntry appEntry = mock(ApplicationsState.AppEntry.class);
+        appEntry.info = mApplicationInfo;
+        appEntry.label = label;
+        return appEntry;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/RecentAppsViewAllPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsViewAllPreferenceControllerTest.java
new file mode 100644
index 000000000..67a3983e6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/RecentAppsViewAllPreferenceControllerTest.java
@@ -0,0 +1,78 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class RecentAppsViewAllPreferenceControllerTest {
+
+    private static final int TEST_APP_COUNT = 3;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private RecentAppsViewAllPreferenceController mPreferenceController;
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new RecentAppsViewAllPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new Preference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_isUnavailableByDefault() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onInstalledAppCountLoaded(TEST_APP_COUNT);
+
+        assertThat(mPreference.getTitle()).isEqualTo(mContext.getResources().getString(
+                R.string.apps_view_all_apps_title, TEST_APP_COUNT));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/StoragePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/StoragePreferenceControllerTest.java
new file mode 100644
index 000000000..4ffd88cdf
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/StoragePreferenceControllerTest.java
@@ -0,0 +1,186 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StoragePreferenceControllerTest {
+
+    private static final String PACKAGE_NAME = "Test Package Name";
+    private static final String SIZE_STR = "1.4Mb";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private StoragePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private ApplicationsState mMockApplicationsState;
+    @Mock
+    private ApplicationsState.AppEntry mMockAppEntry;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new StoragePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+    }
+
+    @Test
+    public void testCheckInitialized_noApplicationsEntry_throwException() {
+        mPreferenceController.setAppState(mMockApplicationsState);
+        mPreferenceController.setPackageName(PACKAGE_NAME);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noApplicationsState_throwException() {
+        mPreferenceController.setAppEntry(mMockAppEntry);
+        mPreferenceController.setPackageName(PACKAGE_NAME);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noPackageName_throwException() {
+        mPreferenceController.setAppEntry(mMockAppEntry);
+        mPreferenceController.setAppState(mMockApplicationsState);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void onCreate_nullSize_calculatingSummary() {
+        when(mMockApplicationsState.getEntry(PACKAGE_NAME, UserHandle.myUserId()))
+                .thenReturn(mMockAppEntry);
+        mPreferenceController.setAppEntry(mMockAppEntry);
+        mPreferenceController.setAppState(mMockApplicationsState);
+        mPreferenceController.setPackageName(PACKAGE_NAME);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.memory_calculating_size));
+    }
+
+    @Test
+    public void onCreate_validApp_sizeSummary() {
+        when(mMockApplicationsState.getEntry(PACKAGE_NAME, UserHandle.myUserId()))
+                .thenReturn(mMockAppEntry);
+        mMockAppEntry.sizeStr = SIZE_STR;
+        mPreferenceController.setAppEntry(mMockAppEntry);
+        mPreferenceController.setAppState(mMockApplicationsState);
+        mPreferenceController.setPackageName(PACKAGE_NAME);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.storage_type_internal, SIZE_STR));
+    }
+
+    @Test
+    public void onCreate_lateAppLoad_updateSummary() {
+        when(mMockApplicationsState.getEntry(PACKAGE_NAME, UserHandle.myUserId()))
+                .thenReturn(mMockAppEntry);
+        mPreferenceController.setAppEntry(mMockAppEntry);
+        mPreferenceController.setAppState(mMockApplicationsState);
+        mPreferenceController.setPackageName(PACKAGE_NAME);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.memory_calculating_size));
+
+        mMockAppEntry.sizeStr = SIZE_STR;
+        mPreferenceController.mApplicationStateCallbacks.onAllSizesComputed();
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.storage_type_internal, SIZE_STR));
+    }
+
+    @Test
+    public void onCreate_packageSizeChange_updateSummary() {
+        when(mMockApplicationsState.getEntry(PACKAGE_NAME, UserHandle.myUserId()))
+                .thenReturn(mMockAppEntry);
+        mPreferenceController.setAppEntry(mMockAppEntry);
+        mPreferenceController.setAppState(mMockApplicationsState);
+        mPreferenceController.setPackageName(PACKAGE_NAME);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.memory_calculating_size));
+
+        mMockAppEntry.sizeStr = SIZE_STR;
+        mPreferenceController.mApplicationStateCallbacks.onPackageSizeChanged(PACKAGE_NAME);
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.storage_type_internal, SIZE_STR));
+    }
+
+    @Test
+    public void onCreate_otherPackageSizeChange_doesNotUpdateSummary() {
+        when(mMockApplicationsState.getEntry(PACKAGE_NAME, UserHandle.myUserId()))
+                .thenReturn(mMockAppEntry);
+        mPreferenceController.setAppEntry(mMockAppEntry);
+        mPreferenceController.setAppState(mMockApplicationsState);
+        mPreferenceController.setPackageName(PACKAGE_NAME);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.memory_calculating_size));
+
+        mMockAppEntry.sizeStr = SIZE_STR;
+        mPreferenceController.mApplicationStateCallbacks.onPackageSizeChanged("other_package");
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(R.string.memory_calculating_size));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/appinfo/AppAllServicesPreferenceControllerTest.kt b/tests/multivalent/src/com/android/car/settings/applications/appinfo/AppAllServicesPreferenceControllerTest.kt
new file mode 100644
index 000000000..81527496a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/appinfo/AppAllServicesPreferenceControllerTest.kt
@@ -0,0 +1,162 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.appinfo
+
+import android.car.drivingstate.CarUxRestrictions
+import android.content.Context
+import android.content.Intent
+import android.content.pm.PackageManager
+import android.content.pm.ResolveInfo
+import android.location.LocationManager
+import androidx.test.core.app.ApplicationProvider
+import androidx.test.ext.junit.runners.AndroidJUnit4
+import com.android.car.settings.common.FragmentController
+import com.android.car.settings.common.PreferenceController.AVAILABLE
+import com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE
+import com.android.car.settings.common.PreferenceControllerTestUtil
+import org.junit.Test
+import org.junit.runner.RunWith
+import org.mockito.ArgumentMatcher
+import org.mockito.kotlin.argThat
+import org.mockito.kotlin.doReturn
+import org.mockito.kotlin.eq
+import org.mockito.kotlin.mock
+import org.mockito.kotlin.spy
+import org.mockito.kotlin.whenever
+
+@RunWith(AndroidJUnit4::class)
+class AppAllServicesPreferenceControllerTest {
+    private val mockFragmentController = mock<FragmentController>()
+    private val mockPackageManager = mock<PackageManager>()
+    private val mockResolveInfo = mock<ResolveInfo>()
+    private val mockLocationManager = mock<LocationManager>()
+    private val context = spy(ApplicationProvider.getApplicationContext<Context>()) {
+        on { packageManager } doReturn mockPackageManager
+        on { getSystemService(LocationManager::class.java) } doReturn mockLocationManager
+    }
+    private val carUxRestrictions = CarUxRestrictions.Builder(
+        /* reqOpt = */ true,
+        CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+        /* time = */ 0
+    ).build()
+    private val controller = AppAllServicesPreferenceController(
+        context,
+        preferenceKey,
+        mockFragmentController,
+        carUxRestrictions
+    )
+
+    @Test
+    fun getAvailabilityStatus_shouldReturnAvailable() {
+        controller.setPackageName(primaryPackageName)
+        val intent = getFeaturesIntent(primaryPackageName)
+        whenever(
+            mockPackageManager.resolveActivity(matchIntent(intent), /* flags = */ eq(0))
+        ) doReturn mockResolveInfo
+        whenever(
+            mockLocationManager.isProviderPackage(null, primaryPackageName, null)
+        ) doReturn true
+
+        PreferenceControllerTestUtil.assertAvailability(controller.availabilityStatus, AVAILABLE)
+    }
+
+    @Test
+    fun getAvailabilityStatus_isNotLocationProvider_shouldReturnConditionallyUnavailable() {
+        controller.setPackageName(primaryPackageName)
+        val intent = getFeaturesIntent(primaryPackageName)
+        whenever(
+            mockPackageManager.resolveActivity(matchIntent(intent), /* flags = */ eq(0))
+        ) doReturn mockResolveInfo
+        whenever(
+            mockLocationManager.isProviderPackage(null, primaryPackageName, null)
+        ) doReturn false
+
+        PreferenceControllerTestUtil.assertAvailability(
+            controller.availabilityStatus,
+            CONDITIONALLY_UNAVAILABLE
+        )
+    }
+
+    @Test
+    fun getAvailabilityStatus_canNotHandleIntent_shouldReturnConditionallyUnavailable() {
+        controller.setPackageName(primaryPackageName)
+        val intent = getFeaturesIntent(secondaryPackageName)
+        // Trying to match with a package that cannot handle the intent
+        whenever(
+            mockPackageManager.resolveActivity(matchIntent(intent), /* flags = */ eq(0))
+        ) doReturn mockResolveInfo
+        whenever(
+            mockLocationManager.isProviderPackage(null, primaryPackageName, null)
+        ) doReturn true
+
+        PreferenceControllerTestUtil.assertAvailability(
+            controller.availabilityStatus,
+            CONDITIONALLY_UNAVAILABLE
+        )
+    }
+
+    @Test
+    fun getAvailabilityStatus_shouldReturnConditionallyUnavailable() {
+        controller.setPackageName(primaryPackageName)
+        val intent = getFeaturesIntent(secondaryPackageName)
+        whenever(
+            mockPackageManager.resolveActivity(matchIntent(intent), /* flags = */ eq(0))
+        ) doReturn mockResolveInfo
+        whenever(
+            mockLocationManager.isProviderPackage(null, primaryPackageName, null)
+        ) doReturn false
+
+        PreferenceControllerTestUtil.assertAvailability(
+            controller.availabilityStatus,
+            CONDITIONALLY_UNAVAILABLE
+        )
+    }
+
+    @Test
+    fun canPackageHandleIntent_nullPackageInfo_shouldNotCrash() {
+        controller.setPackageName(null)
+
+        // no crash
+        PreferenceControllerTestUtil.assertAvailability(
+            controller.availabilityStatus,
+            CONDITIONALLY_UNAVAILABLE
+        )
+    }
+
+    private fun getFeaturesIntent(pkgName: String?): Intent {
+        return Intent(Intent.ACTION_VIEW_APP_FEATURES).apply {
+            `package` = pkgName
+        }
+    }
+
+    private fun matchIntent(incoming: Intent): Intent {
+        return argThat(IntentEqualityMatcher(incoming))
+    }
+
+    private class IntentEqualityMatcher (private val baseIntent: Intent) : ArgumentMatcher<Intent> {
+        override fun matches(argument: Intent?): Boolean {
+            return baseIntent.`package` == argument?.`package` &&
+                baseIntent.action == argument?.action
+        }
+    }
+
+    private companion object {
+        const val primaryPackageName = "Package1"
+        const val secondaryPackageName = "Package2"
+        const val preferenceKey = "pref_key"
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/appinfo/HibernationSwitchPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/appinfo/HibernationSwitchPreferenceControllerTest.java
new file mode 100644
index 000000000..ac283f3c7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/appinfo/HibernationSwitchPreferenceControllerTest.java
@@ -0,0 +1,261 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.appinfo;
+
+import static android.app.AppOpsManager.MODE_ALLOWED;
+import static android.app.AppOpsManager.MODE_DEFAULT;
+import static android.app.AppOpsManager.MODE_IGNORED;
+import static android.app.AppOpsManager.OPSTR_AUTO_REVOKE_PERMISSIONS_IF_UNUSED;
+import static android.provider.DeviceConfig.NAMESPACE_APP_HIBERNATION;
+
+import static com.android.car.settings.applications.ApplicationsUtils.PROPERTY_APP_HIBERNATION_ENABLED;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.AppOpsManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.provider.DeviceConfig;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class HibernationSwitchPreferenceControllerTest {
+    private static final int PACKAGE_UID = 1;
+    private static final String INVALID_PACKAGE_NAME = "invalid_package";
+    private static final String KEY = "key";
+    private static final String VALID_PACKAGE_NAME = "package";
+    private static final String EXEMPTED_PACKAGE_NAME = "exempted_package";
+    private static final String UNEXEMPTED_PACKAGE_NAME = "unexempted_package";
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private AppOpsManager mAppOpsManager;
+    @Mock
+    private PackageManager mPackageManager;
+    @Mock
+    private SwitchPreference mPreference;
+
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private HibernationSwitchPreferenceController mController;
+    private Context mContext;
+
+    @Before
+    public void setUp() throws PackageManager.NameNotFoundException {
+        MockitoAnnotations.initMocks(this);
+
+        mLifecycleOwner = new TestLifecycleOwner();
+        mContext = spy(ApplicationProvider.getApplicationContext());
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mContext.getSystemService(Context.APP_OPS_SERVICE)).thenReturn(mAppOpsManager);
+        when(mPackageManager.getPackageUid(eq(VALID_PACKAGE_NAME), anyInt()))
+                .thenReturn(PACKAGE_UID);
+        when(mPackageManager.getPackageUid(eq(INVALID_PACKAGE_NAME), anyInt()))
+                .thenThrow(new PackageManager.NameNotFoundException());
+        when(mPackageManager.getTargetSdkVersion(eq(EXEMPTED_PACKAGE_NAME)))
+                .thenReturn(android.os.Build.VERSION_CODES.Q);
+        when(mPackageManager.getTargetSdkVersion(eq(UNEXEMPTED_PACKAGE_NAME)))
+                .thenReturn(android.os.Build.VERSION_CODES.S);
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "true", /* makeDefault= */ true);
+        mController = new HibernationSwitchPreferenceController(
+                mContext, KEY, mFragmentController, mCarUxRestrictions);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureNotEnabled_shouldNotReturnAvailable() {
+        mController.setPackageName(VALID_PACKAGE_NAME);
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+
+        assertThat(mController.getAvailabilityStatus()).isNotEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureNotEnabled_shouldNotReturnAvailable_zoneWrite() {
+        mController.setAvailabilityStatusForZone("write");
+        mController.setPackageName(VALID_PACKAGE_NAME);
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureNotEnabled_shouldNotReturnAvailable_zoneRead() {
+        mController.setAvailabilityStatusForZone("read");
+        mController.setPackageName(VALID_PACKAGE_NAME);
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureNotEnabled_shouldNotReturnAvailable_zoneHidden() {
+        mController.setAvailabilityStatusForZone("hidden");
+        mController.setPackageName(VALID_PACKAGE_NAME);
+        DeviceConfig.setProperty(NAMESPACE_APP_HIBERNATION, PROPERTY_APP_HIBERNATION_ENABLED,
+                /* value= */ "false", /* makeDefault= */ true);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_invalidPackage_shouldReturnNotAvailable() {
+        mController.setPackageName(INVALID_PACKAGE_NAME);
+
+        assertThat(mController.getAvailabilityStatus()).isNotEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_invalidPackage_shouldReturnNotAvailable_zoneWrite() {
+        mController.setAvailabilityStatusForZone("write");
+        mController.setPackageName(INVALID_PACKAGE_NAME);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_invalidPackage_shouldReturnNotAvailable_zoneRead() {
+        mController.setAvailabilityStatusForZone("read");
+        mController.setPackageName(INVALID_PACKAGE_NAME);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_invalidPackage_shouldReturnNotAvailable_zoneHidden() {
+        mController.setAvailabilityStatusForZone("hidden");
+        mController.setPackageName(INVALID_PACKAGE_NAME);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_validPackage_shouldReturnAvailable() {
+        mController.setPackageName(VALID_PACKAGE_NAME);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_validPackage_shouldReturnAvailable_zoneWrite() {
+        mController.setAvailabilityStatusForZone("write");
+        mController.setPackageName(VALID_PACKAGE_NAME);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_validPackage_shouldReturnAvailable_zoneRead() {
+        mController.setAvailabilityStatusForZone("read");
+        mController.setPackageName(VALID_PACKAGE_NAME);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_validPackage_shouldReturnAvailable_zoneHidden() {
+        mController.setAvailabilityStatusForZone("hidden");
+        mController.setPackageName(VALID_PACKAGE_NAME);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void updateState_exemptedByDefaultPackage_shouldNotCheck() {
+        assignPreference();
+        when(mAppOpsManager.unsafeCheckOpNoThrow(
+                eq(OPSTR_AUTO_REVOKE_PERMISSIONS_IF_UNUSED), anyInt(), eq(EXEMPTED_PACKAGE_NAME)))
+                .thenReturn(MODE_DEFAULT);
+        mController.setPackageName(EXEMPTED_PACKAGE_NAME);
+
+        mController.onCreate(mLifecycleOwner);
+
+        verify(mPreference).setChecked(false);
+    }
+
+    @Test
+    public void updateState_exemptedPackageOverrideByUser_shouldCheck() {
+        assignPreference();
+        when(mAppOpsManager.unsafeCheckOpNoThrow(
+                eq(OPSTR_AUTO_REVOKE_PERMISSIONS_IF_UNUSED), anyInt(), eq(EXEMPTED_PACKAGE_NAME)))
+                .thenReturn(MODE_ALLOWED);
+        mController.setPackageName(EXEMPTED_PACKAGE_NAME);
+
+        mController.onCreate(mLifecycleOwner);
+
+        verify(mPreference).setChecked(true);
+    }
+
+    @Test
+    public void updateState_unexemptedPackageOverrideByUser_shouldNotCheck() {
+        assignPreference();
+        when(mAppOpsManager.unsafeCheckOpNoThrow(
+                eq(OPSTR_AUTO_REVOKE_PERMISSIONS_IF_UNUSED), anyInt(), eq(UNEXEMPTED_PACKAGE_NAME)))
+                .thenReturn(MODE_IGNORED);
+        mController.setPackageName(UNEXEMPTED_PACKAGE_NAME);
+
+        mController.onCreate(mLifecycleOwner);
+
+        verify(mPreference).setChecked(false);
+    }
+
+    private void assignPreference() {
+        PreferenceControllerTestUtil.assignPreference(mController,
+                mPreference);
+    }
+}
+
diff --git a/tests/multivalent/src/com/android/car/settings/applications/assist/AssistConfigBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/assist/AssistConfigBasePreferenceControllerTest.java
new file mode 100644
index 000000000..181d332fe
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/assist/AssistConfigBasePreferenceControllerTest.java
@@ -0,0 +1,231 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.assist;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ComponentName;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.net.Uri;
+import android.os.UserHandle;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.internal.app.AssistUtils;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AssistConfigBasePreferenceControllerTest {
+
+    private static final String TEST_PACKAGE_NAME = "com.test.package";
+    private static final String TEST_SERVICE = "TestService";
+    private final int mUserId = UserHandle.myUserId();
+    private static final Uri ASSIST_URI = Settings.Secure.getUriFor(Settings.Secure.ASSISTANT);
+    private static final Uri ASSIST_STRUCTURE_URI =
+            Settings.Secure.getUriFor(Settings.Secure.ASSIST_STRUCTURE_ENABLED);
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private TwoStatePreference mPreference;
+    private TestAssistConfigBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ComponentName mComponentName;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private AssistUtils mMockAssistUtils;
+    @Mock
+    private ContentResolver mMockContentResolver;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mComponentName = new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE);
+
+        mPreference = new SwitchPreference(mContext);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new TestAssistConfigBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockAssistUtils);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasAssistComponent_isAvailable() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(mComponentName);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasAssistComponent_isAvailable_zoneWrite() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(mComponentName);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasAssistComponent_isAvailable_zoneRead() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(mComponentName);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasAssistComponent_isAvailable_zoneHidden() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(mComponentName);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAssistComponent_conditionallyUnavailable() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAssistComponent_conditionallyUnavailable_zoneWrite() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAssistComponent_conditionallyUnavailable_zoneRead() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAssistComponent_conditionallyUnavailable_zoneHidden() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onStart_registersObserver() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(mComponentName);
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mMockContentResolver).registerContentObserver(eq(ASSIST_URI), eq(false),
+                any());
+        verify(mMockContentResolver).registerContentObserver(eq(ASSIST_STRUCTURE_URI),
+                eq(false), any());
+    }
+
+    @Test
+    public void onStop_unregistersObserver() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(mComponentName);
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockContentResolver).unregisterContentObserver(any());
+    }
+
+    @Test
+    public void onChange_changeRegisteredSetting_callsRefreshUi() {
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(mComponentName);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        int currentCount = mPreferenceController.getNumCallsToUpdateState();
+        mPreferenceController.mSettingObserver
+                .onChange(/* selfChange= */ false, ASSIST_STRUCTURE_URI);
+
+        assertThat(mPreferenceController.getNumCallsToUpdateState())
+                .isEqualTo(currentCount + 1);
+    }
+
+    private static class TestAssistConfigBasePreferenceController extends
+            AssistConfigBasePreferenceController {
+
+        private int mNumCallsToUpdateState;
+
+        TestAssistConfigBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions,
+                AssistUtils assistUtils) {
+            super(context, preferenceKey, fragmentController, uxRestrictions, assistUtils);
+            mNumCallsToUpdateState = 0;
+        }
+
+        public int getNumCallsToUpdateState() {
+            return mNumCallsToUpdateState;
+        }
+
+        @Override
+        protected void updateState(TwoStatePreference preference) {
+            mNumCallsToUpdateState++;
+        }
+
+        @Override
+        protected List<Uri> getSettingUris() {
+            return Collections.singletonList(ASSIST_STRUCTURE_URI);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/assist/DefaultVoiceInputPickerEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/assist/DefaultVoiceInputPickerEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..4cfec7acc
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/assist/DefaultVoiceInputPickerEntryPreferenceControllerTest.java
@@ -0,0 +1,356 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.assist;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ComponentName;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.content.Intent;
+import android.net.Uri;
+import android.os.UserHandle;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionIconPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.internal.app.AssistUtils;
+import com.android.settingslib.applications.DefaultAppInfo;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class DefaultVoiceInputPickerEntryPreferenceControllerTest {
+
+    private static final String TEST_PACKAGE = "com.android.car.settings.testutils";
+    private static final String TEST_ASSIST = "TestAssistService";
+    private static final String TEST_VOICE = "TestVoiceService";
+    private static final Uri ASSIST_URI = Settings.Secure.getUriFor(Settings.Secure.ASSISTANT);
+    private final int mUserId = UserHandle.myUserId();
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiTwoActionIconPreference mPreference;
+    private DefaultVoiceInputPickerEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private AssistUtils mMockAssistUtils;
+    @Mock
+    private VoiceInputInfoProvider mMockVoiceInputInfoProvider;
+    @Mock
+    private VoiceInputInfoProvider.VoiceInputInfo mMockVoiceInputInfo;
+    @Mock
+    private ContentResolver mMockContentResolver;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mPreference = new CarUiTwoActionIconPreference(mContext);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DefaultVoiceInputPickerEntryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockVoiceInputInfoProvider, mMockAssistUtils);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                VoiceInputUtils.class, withSettings().lenient()).startMocking();
+
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_ASSIST));
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_sameComponents_returnsConditionallyUnavailable() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_sameComponents_returnsConditionallyUnavailable_zoneWrite() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_sameComponents_returnsConditionallyUnavailable_zoneRead() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_sameComponents_returnsConditionallyUnavailable_zoneHidden() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_VOICE));
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_bothNull_returnsConditionallyUnavailable() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(null);
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_bothNull_returnsConditionallyUnavailable_zoneWrite() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(null);
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_bothNull_returnsConditionallyUnavailable_zoneRead() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(null);
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_bothNull_returnsConditionallyUnavailable_zoneHidden() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(null);
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentComponents_returnsAvailable() {
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentComponents_returnsAvailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentComponents_returnsAvailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentComponents_returnsAvailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onStart_registersObserver() {
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mMockContentResolver).registerContentObserver(eq(ASSIST_URI), eq(false),
+                any());
+    }
+
+    @Test
+    public void onStop_unregistersObserver() {
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockContentResolver).unregisterContentObserver(any());
+    }
+
+    @Test
+    public void onChange_changeRegisteredSetting_callsRefreshUi() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(PreferenceController.AVAILABLE);
+
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_ASSIST));
+        mPreferenceController.mSettingObserver.onChange(/* selfChange= */ false,
+                Settings.Secure.getUriFor(Settings.Secure.ASSISTANT));
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onChange_changeRegisteredSetting_callsRefreshUi_zoneWrite() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_ASSIST));
+        mPreferenceController.mSettingObserver.onChange(/* selfChange= */ false,
+                Settings.Secure.getUriFor(Settings.Secure.ASSISTANT));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onChange_changeRegisteredSetting_callsRefreshUi_zoneRead() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_ASSIST));
+        mPreferenceController.mSettingObserver.onChange(/* selfChange= */ false,
+                Settings.Secure.getUriFor(Settings.Secure.ASSISTANT));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onChange_changeRegisteredSetting_callsRefreshUi_zoneHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE, TEST_ASSIST));
+        mPreferenceController.mSettingObserver.onChange(/* selfChange= */ false,
+                Settings.Secure.getUriFor(Settings.Secure.ASSISTANT));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getCurrentDefaultAppInfo_providerHasCurrentService_returnsValidDefaultAppInfo() {
+        when(mMockVoiceInputInfoProvider.getInfoForComponent(any()))
+                .thenReturn(mMockVoiceInputInfo);
+
+        assertThat(mPreferenceController.getCurrentDefaultAppInfo()).isNotNull();
+    }
+
+    @Test
+    public void getCurrentDefaultAppInfo_providerHasNoService_returnsNull() {
+        when(mMockVoiceInputInfoProvider.getInfoForComponent(any())).thenReturn(null);
+        assertThat(mPreferenceController.getCurrentDefaultAppInfo()).isNull();
+    }
+
+    @Test
+    public void getSettingIntent_nullInput_returnsNull() {
+        assertThat(mPreferenceController.getSettingIntent(null)).isEqualTo(null);
+    }
+
+    @Test
+    public void getSettingIntent_inputIsWrongType_returnsNull() {
+        DefaultAppInfo info = mock(DefaultAppInfo.class);
+        assertThat(mPreferenceController.getSettingIntent(info)).isEqualTo(null);
+    }
+
+    @Test
+    public void getSettingIntent_validInput_returnsIntent() {
+        Intent intent = new Intent();
+        DefaultVoiceInputServiceInfo info = mock(DefaultVoiceInputServiceInfo.class);
+        when(info.getSettingIntent()).thenReturn(intent);
+
+        assertThat(mPreferenceController.getSettingIntent(info)).isEqualTo(intent);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/assist/DefaultVoiceInputPickerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/assist/DefaultVoiceInputPickerPreferenceControllerTest.java
new file mode 100644
index 000000000..9b9aed312
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/assist/DefaultVoiceInputPickerPreferenceControllerTest.java
@@ -0,0 +1,239 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.assist;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ComponentName;
+import android.content.Context;
+import android.os.UserHandle;
+import android.provider.Settings;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.internal.app.AssistUtils;
+import com.android.settingslib.applications.DefaultAppInfo;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class DefaultVoiceInputPickerPreferenceControllerTest {
+
+    private static final String TEST_PACKAGE_NAME = "com.test.package";
+    private static final String TEST_SERVICE = "TestService";
+    private static final String TEST_OTHER_SERVICE = "TestOtherService";
+    private static final String TEST_RECOGNIZER = "TestRecognizer";
+    private final int mUserId = UserHandle.myUserId();
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LogicalPreferenceGroup mPreference;
+    private DefaultVoiceInputPickerPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private AssistUtils mMockAssistUtils;
+    @Mock
+    private VoiceInputInfoProvider mMockVoiceInputInfoProvider;
+    @Mock
+    private VoiceInputInfoProvider.VoiceInteractionInfo mMockVoiceInteractionInfo;
+    @Mock
+    private VoiceInputInfoProvider.VoiceRecognitionInfo mMockVoiceRecognitionInfo;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                VoiceInputUtils.class, withSettings().lenient()).startMocking();
+
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE));
+        when(mMockAssistUtils.getAssistComponentForUser(mUserId)).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE));
+
+        mPreference = new LogicalPreferenceGroup(mContext);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DefaultVoiceInputPickerPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockAssistUtils, mMockVoiceInputInfoProvider);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getCandidates_voiceInteractionService_hasOneElement() {
+        when(mMockVoiceInputInfoProvider.getVoiceInteractionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceInteractionInfo));
+        when(mMockVoiceInteractionInfo.getComponentName()).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE));
+        when(mMockVoiceInputInfoProvider.getVoiceRecognitionInfoList()).thenReturn(
+                Collections.emptyList());
+
+        assertThat(mPreferenceController.getCandidates()).hasSize(1);
+    }
+
+    @Test
+    public void getCandidates_voiceRecognitionService_hasOneElement() {
+        when(mMockVoiceInputInfoProvider.getVoiceInteractionInfoList()).thenReturn(
+                Collections.emptyList());
+        when(mMockVoiceInputInfoProvider.getVoiceRecognitionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceRecognitionInfo));
+
+        assertThat(mPreferenceController.getCandidates()).hasSize(1);
+    }
+
+    @Test
+    public void getCandidates_oneIsSameAsAssistant_hasTwoElements() {
+        when(mMockVoiceInputInfoProvider.getVoiceInteractionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceInteractionInfo));
+        when(mMockVoiceInteractionInfo.getComponentName()).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE));
+        when(mMockVoiceInputInfoProvider.getVoiceRecognitionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceRecognitionInfo));
+
+        assertThat(mPreferenceController.getCandidates()).hasSize(2);
+    }
+
+    @Test
+    public void getCandidates_oneIsSameAsAssistant_sameOneIsEnabled() {
+        when(mMockVoiceInputInfoProvider.getVoiceInteractionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceInteractionInfo));
+        when(mMockVoiceInteractionInfo.getComponentName()).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE));
+        when(mMockVoiceInputInfoProvider.getVoiceRecognitionInfoList()).thenReturn(
+                Collections.emptyList());
+
+        List<DefaultAppInfo> defaultAppInfo = mPreferenceController.getCandidates();
+        assertThat(defaultAppInfo).hasSize(1);
+
+        assertThat(defaultAppInfo.get(0)).isNotNull();
+        assertThat(defaultAppInfo.get(0).enabled).isTrue();
+    }
+
+    @Test
+    public void getCandidates_oneIsSameAsAssistant_differentOneIsDisabled() {
+        when(mMockVoiceInputInfoProvider.getVoiceInteractionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceInteractionInfo));
+        when(mMockVoiceInteractionInfo.getComponentName()).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_OTHER_SERVICE));
+        when(mMockVoiceInputInfoProvider.getVoiceRecognitionInfoList()).thenReturn(
+                Collections.emptyList());
+
+        List<DefaultAppInfo> defaultAppInfo = mPreferenceController.getCandidates();
+        assertThat(defaultAppInfo).hasSize(1);
+
+        assertThat(defaultAppInfo.get(0)).isNotNull();
+        assertThat(defaultAppInfo.get(0).enabled).isFalse();
+    }
+
+    @Test
+    public void getCandidates_voiceRecognitionInfo_IsEnabled() {
+        when(mMockVoiceInputInfoProvider.getVoiceInteractionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceInteractionInfo));
+        when(mMockVoiceInteractionInfo.getComponentName()).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE));
+        when(mMockVoiceInputInfoProvider.getVoiceRecognitionInfoList()).thenReturn(
+                Collections.singletonList(mMockVoiceRecognitionInfo));
+        when(mMockVoiceRecognitionInfo.getComponentName()).thenReturn(
+                new ComponentName(TEST_PACKAGE_NAME, TEST_OTHER_SERVICE));
+
+        DefaultAppInfo defaultAppInfo = null;
+        for (DefaultAppInfo info : mPreferenceController.getCandidates()) {
+            if (info.componentName.equals(
+                    new ComponentName(TEST_PACKAGE_NAME, TEST_OTHER_SERVICE))) {
+                defaultAppInfo = info;
+            }
+        }
+        assertThat(defaultAppInfo).isNotNull();
+        assertThat(defaultAppInfo.enabled).isTrue();
+    }
+
+    @Test
+    public void getCurrentDefaultKey_defaultIsNull_returnsNull() {
+        ExtendedMockito.when(VoiceInputUtils.getCurrentService(mContext)).thenReturn(null);
+
+        assertThat(mPreferenceController.getCurrentDefaultKey()).isNull();
+    }
+
+    @Test
+    public void getCurrentDefaultKey_defaultExists_returnsComponentName() {
+        ComponentName cn = new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE);
+
+        assertThat(mPreferenceController.getCurrentDefaultKey()).isEqualTo(cn.flattenToString());
+    }
+
+    @Test
+    public void setCurrentDefault_typeVoiceInteractionInfo_setsServices() {
+        when(mMockVoiceInputInfoProvider.getInfoForComponent(any()))
+                .thenReturn(mMockVoiceInteractionInfo);
+        when(mMockVoiceInteractionInfo.getPackageName()).thenReturn(TEST_PACKAGE_NAME);
+        when(mMockVoiceInteractionInfo.getRecognitionService()).thenReturn(TEST_RECOGNIZER);
+        String key = new ComponentName(TEST_PACKAGE_NAME, TEST_SERVICE).flattenToString();
+        String recognizer = new ComponentName(TEST_PACKAGE_NAME, TEST_RECOGNIZER).flattenToString();
+        mPreferenceController.setCurrentDefault(key);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_INTERACTION_SERVICE)).isEqualTo(key);
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_RECOGNITION_SERVICE)).isEqualTo(recognizer);
+    }
+
+    @Test
+    public void setCurrentDefault_typeVoiceRecognitionInfo_setsRecognitionService() {
+        when(mMockVoiceInputInfoProvider.getInfoForComponent(any()))
+                .thenReturn(mMockVoiceRecognitionInfo);
+        String key = new ComponentName(TEST_PACKAGE_NAME, TEST_RECOGNIZER).flattenToString();
+        mPreferenceController.setCurrentDefault(key);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_INTERACTION_SERVICE)).isEmpty();
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_RECOGNITION_SERVICE)).isEqualTo(key);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/assist/ScreenshotContextPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/assist/ScreenshotContextPreferenceControllerTest.java
new file mode 100644
index 000000000..8f1c61d08
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/assist/ScreenshotContextPreferenceControllerTest.java
@@ -0,0 +1,132 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.assist;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiSwitchPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ScreenshotContextPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private TwoStatePreference mPreference;
+    private ScreenshotContextPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mPreference = new CarUiSwitchPreference(mContext);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new ScreenshotContextPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_screenshotEnabled_preferenceChecked() {
+        mPreference.setChecked(false);
+
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_SCREENSHOT_ENABLED, 1);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_screenshotDisabled_preferenceUnchecked() {
+        mPreference.setChecked(true);
+
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_SCREENSHOT_ENABLED, 0);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_structureEnabled_preferenceEnabled() {
+        mPreference.setEnabled(false);
+
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 1);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_structureDisabled_preferenceDisabled() {
+        mPreference.setEnabled(true);
+
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 0);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void callChangeListener_toggleTrue_screenshotEnabled() {
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_SCREENSHOT_ENABLED, 0);
+        mPreference.callChangeListener(true);
+
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_SCREENSHOT_ENABLED, 0)).isEqualTo(1);
+    }
+
+    @Test
+    public void callChangeListener_toggleFalse_screenshotDisabled() {
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_SCREENSHOT_ENABLED, 1);
+        mPreference.callChangeListener(false);
+
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_SCREENSHOT_ENABLED, 1)).isEqualTo(0);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/assist/TextContextPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/assist/TextContextPreferenceControllerTest.java
new file mode 100644
index 000000000..ce093a909
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/assist/TextContextPreferenceControllerTest.java
@@ -0,0 +1,110 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.assist;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiSwitchPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class TextContextPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private TwoStatePreference mPreference;
+    private TextContextPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mPreference = new CarUiSwitchPreference(mContext);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new TextContextPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_contextEnabled_preferenceChecked() {
+        mPreference.setChecked(false);
+
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 1);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_contextDisabled_preferenceUnchecked() {
+        mPreference.setChecked(true);
+
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 0);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void callChangeListener_toggleTrue_contextEnabled() {
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 0);
+        mPreference.callChangeListener(true);
+
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 0)).isEqualTo(1);
+    }
+
+    @Test
+    public void callChangeListener_toggleFalse_contextDisabled() {
+        Settings.Secure.putInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 1);
+        mPreference.callChangeListener(false);
+
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.ASSIST_STRUCTURE_ENABLED, 1)).isEqualTo(0);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/assist/VoiceInputInfoProviderTest.java b/tests/multivalent/src/com/android/car/settings/applications/assist/VoiceInputInfoProviderTest.java
new file mode 100644
index 000000000..8f69395e5
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/assist/VoiceInputInfoProviderTest.java
@@ -0,0 +1,115 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.assist;
+
+
+import static com.android.car.settings.applications.assist.VoiceInputInfoProvider.VOICE_INTERACTION_SERVICE_TAG;
+import static com.android.car.settings.applications.assist.VoiceInputInfoProvider.VOICE_RECOGNITION_SERVICE_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.content.pm.ServiceInfo;
+import android.service.voice.VoiceInteractionServiceInfo;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class VoiceInputInfoProviderTest {
+
+    private static final String TEST_PACKAGE = "test.package";
+    private static final String TEST_CLASS = "Class1";
+    private static final String TEST_RECOGNITION_SERVICE = "Recognition1";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private VoiceInputInfoProvider mVoiceInputInfoProvider;
+
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+    }
+
+    @Test
+    public void getInteractionInfoList_hasElement() {
+        ResolveInfo resolveInfo = new ResolveInfo();
+        resolveInfo.serviceInfo = new ServiceInfo();
+        resolveInfo.serviceInfo.packageName = TEST_PACKAGE;
+        resolveInfo.serviceInfo.name = TEST_CLASS;
+        resolveInfo.serviceInfo.permission = Manifest.permission.BIND_VOICE_INTERACTION;
+
+        List<ResolveInfo> resolveInfoList = new ArrayList<>();
+        resolveInfoList.add(resolveInfo);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.queryIntentServices(VOICE_INTERACTION_SERVICE_TAG,
+                PackageManager.GET_META_DATA)).thenReturn(resolveInfoList);
+
+        mVoiceInputInfoProvider = new TestVoiceInputInfoProvider(mContext);
+
+        assertThat(mVoiceInputInfoProvider.getVoiceInteractionInfoList()).hasSize(1);
+    }
+
+    @Test
+    public void getRecognitionInfoList_hasElement() {
+        ResolveInfo otherInfo = new ResolveInfo();
+        otherInfo.serviceInfo = new ServiceInfo();
+        otherInfo.serviceInfo.packageName = TEST_PACKAGE;
+        otherInfo.serviceInfo.name = TEST_RECOGNITION_SERVICE;
+
+        List<ResolveInfo> resolveInfoList = new ArrayList<>();
+        resolveInfoList.add(otherInfo);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.queryIntentServices(VOICE_RECOGNITION_SERVICE_TAG,
+                PackageManager.GET_META_DATA)).thenReturn(resolveInfoList);
+
+        mVoiceInputInfoProvider = new TestVoiceInputInfoProvider(mContext);
+
+        assertThat(mVoiceInputInfoProvider.getVoiceRecognitionInfoList()).hasSize(1);
+    }
+
+    private static class TestVoiceInputInfoProvider extends VoiceInputInfoProvider {
+
+        TestVoiceInputInfoProvider(Context context) {
+            super(context);
+        }
+
+        @Override
+        boolean hasParseError(VoiceInteractionServiceInfo voiceInteractionServiceInfo) {
+            return false;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/assist/VoiceInputUtilsTest.java b/tests/multivalent/src/com/android/car/settings/applications/assist/VoiceInputUtilsTest.java
new file mode 100644
index 000000000..2036e5784
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/assist/VoiceInputUtilsTest.java
@@ -0,0 +1,78 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.assist;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.ComponentName;
+import android.content.Context;
+import android.provider.Settings;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class VoiceInputUtilsTest {
+
+    private static final String TEST_PACKAGE = "test.package";
+    private static final String TEST_CLASS_1 = "Class1";
+    private static final String TEST_CLASS_2 = "Class2";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+
+    @Test
+    public void getCurrentService_nullInteraction_nullRecognition_returnsNull() {
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_INTERACTION_SERVICE, null);
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_RECOGNITION_SERVICE, null);
+        assertThat(VoiceInputUtils.getCurrentService(mContext)).isNull();
+    }
+
+    @Test
+    public void getCurrentService_emptyInteraction_emptyRecognition_returnsNull() {
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_INTERACTION_SERVICE, "");
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_RECOGNITION_SERVICE, "");
+        assertThat(VoiceInputUtils.getCurrentService(mContext)).isNull();
+    }
+
+    @Test
+    public void getCurrentService_hasInteraction_returnsInteraction() {
+        ComponentName interaction = new ComponentName(TEST_PACKAGE, TEST_CLASS_1);
+        ComponentName recognition = new ComponentName(TEST_PACKAGE, TEST_CLASS_2);
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_INTERACTION_SERVICE, interaction.flattenToString());
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_RECOGNITION_SERVICE, recognition.flattenToString());
+        assertThat(VoiceInputUtils.getCurrentService(mContext)).isEqualTo(interaction);
+    }
+
+    @Test
+    public void getCurrentService_noInteraction_hasRecognition_returnsRecogntion() {
+        ComponentName recognition = new ComponentName(TEST_PACKAGE, TEST_CLASS_2);
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_INTERACTION_SERVICE, "");
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.VOICE_RECOGNITION_SERVICE, recognition.flattenToString());
+        assertThat(VoiceInputUtils.getCurrentService(mContext)).isEqualTo(recognition);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppEntryBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppEntryBasePreferenceControllerTest.java
new file mode 100644
index 000000000..1fda403dd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppEntryBasePreferenceControllerTest.java
@@ -0,0 +1,136 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.defaultapps;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.annotation.Nullable;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.settingslib.applications.DefaultAppInfo;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DefaultAppEntryBasePreferenceControllerTest {
+    private static final CharSequence TEST_LABEL = "Test Label";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private TestDefaultAppEntryBasePreferenceController mController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new CarUiPreference(mContext);
+        mController = new TestDefaultAppEntryBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+    }
+
+    @Test
+    public void refreshUi_hasDefaultAppWithLabel_summaryAndIconAreSet() {
+        DefaultAppInfo defaultAppInfo = mock(DefaultAppInfo.class);
+        when(defaultAppInfo.loadLabel()).thenReturn(TEST_LABEL);
+        when(defaultAppInfo.loadIcon()).thenReturn(mContext.getDrawable(R.drawable.test_icon));
+        mController.setCurrentDefaultAppInfo(defaultAppInfo);
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        assertThat(mPreference.getSummary()).isEqualTo(TEST_LABEL);
+        assertThat(mPreference.getIcon()).isNotNull();
+    }
+
+    @Test
+    public void refreshUi_hasDefaultAppWithoutLabel_summaryAndIconAreNotSet() {
+        DefaultAppInfo defaultAppInfo = mock(DefaultAppInfo.class);
+        when(defaultAppInfo.loadLabel()).thenReturn(null);
+        when(defaultAppInfo.loadIcon()).thenReturn(null);
+        mController.setCurrentDefaultAppInfo(defaultAppInfo);
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.app_list_preference_none));
+        assertThat(mPreference.getIcon()).isNull();
+    }
+
+    @Test
+    public void refreshUi_hasNoDefaultApp_summaryAndIconAreNotSet() {
+        mController.setCurrentDefaultAppInfo(null);
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.app_list_preference_none));
+        assertThat(mPreference.getIcon()).isNull();
+    }
+
+    private static class TestDefaultAppEntryBasePreferenceController extends
+            DefaultAppEntryBasePreferenceController<Preference> {
+
+        private DefaultAppInfo mDefaultAppInfo;
+
+        TestDefaultAppEntryBasePreferenceController(Context context,
+                String preferenceKey, FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected Class<Preference> getPreferenceType() {
+            return Preference.class;
+        }
+
+        @Nullable
+        @Override
+        protected DefaultAppInfo getCurrentDefaultAppInfo() {
+            return mDefaultAppInfo;
+        }
+
+        protected void setCurrentDefaultAppInfo(DefaultAppInfo defaultAppInfo) {
+            mDefaultAppInfo = defaultAppInfo;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppUtilsTest.java b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppUtilsTest.java
new file mode 100644
index 000000000..90f069172
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppUtilsTest.java
@@ -0,0 +1,79 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.defaultapps;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.graphics.drawable.Drawable;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class DefaultAppUtilsTest {
+
+    @Test
+    public void setSafeIcon_smallerThanLimit() {
+        Context context = ApplicationProvider.getApplicationContext();
+        Drawable drawable = context.getDrawable(R.drawable.test_icon_2);
+        int height = drawable.getMinimumHeight();
+        int width = drawable.getMinimumWidth();
+
+        // Set to some value larger than current height or width;
+        int testMaxDimensions = Math.max(height, width) + 1;
+        Drawable icon = DefaultAppUtils.getSafeIcon(drawable, testMaxDimensions);
+
+        assertThat(icon.getMinimumHeight()).isEqualTo(height);
+        assertThat(icon.getMinimumWidth()).isEqualTo(width);
+    }
+
+    @Test
+    public void setSafeIcon_largerThanLimit() {
+        Context context = ApplicationProvider.getApplicationContext();
+        Drawable drawable = context.getDrawable(R.drawable.test_icon_2);
+        int height = drawable.getMinimumHeight();
+        int width = drawable.getMinimumWidth();
+
+        // Set to some value smaller than current height or width;
+        int testMaxDimensions = Math.min(height, width) - 5;
+        Drawable icon = DefaultAppUtils.getSafeIcon(drawable, testMaxDimensions);
+
+        assertThat(icon.getMinimumHeight()).isEqualTo(testMaxDimensions);
+        assertThat(icon.getMinimumWidth()).isEqualTo(testMaxDimensions);
+    }
+
+    @Test
+    public void setSafeIcon_noChangeForVectorDrawable() {
+        Context context = ApplicationProvider.getApplicationContext();
+        Drawable drawable = context.getDrawable(R.drawable.test_icon);
+        int height = drawable.getMinimumHeight();
+        int width = drawable.getMinimumWidth();
+
+        // Set to some value smaller than current height or width;
+        int testMaxDimensions = Math.min(height, width) - 1;
+        Drawable icon = DefaultAppUtils.getSafeIcon(drawable, testMaxDimensions);
+
+        assertThat(icon.getMinimumHeight()).isEqualTo(height);
+        assertThat(icon.getMinimumWidth()).isEqualTo(width);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppsPickerBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppsPickerBasePreferenceControllerTest.java
new file mode 100644
index 000000000..ca794e219
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAppsPickerBasePreferenceControllerTest.java
@@ -0,0 +1,308 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.defaultapps;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiRadioButtonPreference;
+import com.android.settingslib.applications.DefaultAppInfo;
+
+import com.google.android.collect.Lists;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class DefaultAppsPickerBasePreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private TestDefaultAppsPickerBasePreferenceController mController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mController = new TestDefaultAppsPickerBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreferenceGroup);
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_noCandidates_hasSingleNoneElement() {
+        mController.setCurrentDefault("");
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        // Has the "None" element.
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+
+        Preference preference = mPreferenceGroup.getPreference(0);
+        assertThat(preference.getTitle()).isEqualTo(
+                mContext.getString(R.string.app_list_preference_none));
+        assertThat(preference.getIcon()).isNotNull();
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_noCandidates_noNoneElement() {
+        mController.setCurrentDefault("");
+        mController.setIncludeNonePreference(false);
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        // None element removed.
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_hasAdditionalCandidate_hasTwoElements() {
+        String testKey = "testKey";
+
+        DefaultAppInfo testApp = mock(DefaultAppInfo.class);
+        when(testApp.getKey()).thenReturn(testKey);
+        mController.setTestCandidates(Lists.newArrayList(testApp));
+
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_hasAdditionalCandidateAsDefault_secondElementIsSelected() {
+        String testKey = "testKey";
+
+        DefaultAppInfo testApp = mock(DefaultAppInfo.class);
+        when(testApp.getKey()).thenReturn(testKey);
+        mController.setTestCandidates(Lists.newArrayList(testApp));
+        mController.setCurrentDefault(testKey);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        CarUiRadioButtonPreference preference = mPreferenceGroup.findPreference(testKey);
+        assertThat(preference.isChecked()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_currentDefaultApp_nothingHappened() {
+        String testKey = "testKey";
+
+        DefaultAppInfo testApp = mock(DefaultAppInfo.class);
+        when(testApp.getKey()).thenReturn(testKey);
+        mController.setTestCandidates(Lists.newArrayList(testApp));
+        mController.setCurrentDefault(testKey);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        CarUiRadioButtonPreference currentDefault = mPreferenceGroup.findPreference(testKey);
+        CarUiRadioButtonPreference otherOption =
+                (CarUiRadioButtonPreference) mPreferenceGroup.getPreference(0);
+
+        assertThat(currentDefault.isChecked()).isTrue();
+        assertThat(otherOption.isChecked()).isFalse();
+
+        currentDefault.performClick();
+
+        currentDefault = mPreferenceGroup.findPreference(testKey);
+        otherOption = (CarUiRadioButtonPreference) mPreferenceGroup.getPreference(0);
+
+        assertThat(currentDefault.isChecked()).isTrue();
+        assertThat(otherOption.isChecked()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_otherOptionNoMessage_otherOptionSelected() {
+        String testKey = "testKey";
+
+        DefaultAppInfo testApp = mock(DefaultAppInfo.class);
+        when(testApp.getKey()).thenReturn(testKey);
+        mController.setTestCandidates(Lists.newArrayList(testApp));
+        mController.setCurrentDefault(testKey);
+        mController.setTestMessage(null);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        CarUiRadioButtonPreference currentDefault = mPreferenceGroup.findPreference(testKey);
+        CarUiRadioButtonPreference otherOption =
+                (CarUiRadioButtonPreference) mPreferenceGroup.getPreference(0);
+
+        assertThat(currentDefault.isChecked()).isTrue();
+        assertThat(otherOption.isChecked()).isFalse();
+
+        otherOption.performClick();
+
+        currentDefault = mPreferenceGroup.findPreference(testKey);
+        otherOption = (CarUiRadioButtonPreference) mPreferenceGroup.getPreference(0);
+
+        assertThat(currentDefault.isChecked()).isFalse();
+        assertThat(otherOption.isChecked()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_otherOptionHasMessage_dialogOpened() {
+        String testKey = "testKey";
+
+        DefaultAppInfo testApp = mock(DefaultAppInfo.class);
+        when(testApp.getKey()).thenReturn(testKey);
+        mController.setTestCandidates(Lists.newArrayList(testApp));
+        mController.setCurrentDefault(testKey);
+        mController.setTestMessage("Non-empty message");
+
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        CarUiRadioButtonPreference currentDefault = mPreferenceGroup.findPreference(testKey);
+        CarUiRadioButtonPreference otherOption =
+                (CarUiRadioButtonPreference) mPreferenceGroup.getPreference(0);
+
+        assertThat(currentDefault.isChecked()).isTrue();
+        assertThat(otherOption.isChecked()).isFalse();
+
+        otherOption.performClick();
+
+        verify(mFragmentController).showDialog(
+                any(ConfirmationDialogFragment.class),
+                eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_otherOptionNoMessage_newKeySet() {
+        String testKey = "testKey";
+
+        DefaultAppInfo testApp = mock(DefaultAppInfo.class);
+        when(testApp.getKey()).thenReturn(testKey);
+        mController.setTestCandidates(Lists.newArrayList(testApp));
+
+        // Currently, the testApp is the default selection.
+        mController.setCurrentDefault(testKey);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.refreshUi();
+
+        // This preference represents the "None" option.
+        CarUiRadioButtonPreference otherOption =
+                (CarUiRadioButtonPreference) mPreferenceGroup.getPreference(0);
+        assertThat(mController.getCurrentDefaultKey()).isEqualTo(testKey);
+
+        otherOption.performClick();
+        assertThat(mController.getCurrentDefaultKey()).isEqualTo("");
+    }
+
+    private static class TestDefaultAppsPickerBasePreferenceController extends
+            DefaultAppsPickerBasePreferenceController {
+
+        private List<DefaultAppInfo> mCandidates;
+        private String mKey;
+        private CharSequence mMessage;
+        private boolean mIncludeNone = true;
+
+        TestDefaultAppsPickerBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        public void setTestCandidates(List<DefaultAppInfo> candidates) {
+            mCandidates = candidates;
+        }
+
+        public void setTestMessage(String s) {
+            mMessage = s;
+        }
+
+        public void setIncludeNonePreference(boolean include) {
+            mIncludeNone = include;
+        }
+
+        @Override
+        protected List<DefaultAppInfo> getCandidates() {
+            return mCandidates;
+        }
+
+        @Override
+        protected String getCurrentDefaultKey() {
+            return mKey;
+        }
+
+        @Override
+        protected void setCurrentDefault(String key) {
+            mKey = key;
+        }
+
+        @Override
+        protected CharSequence getConfirmationMessage(DefaultAppInfo info) {
+            return mMessage;
+        }
+
+        @Override
+        protected boolean includeNonePreference() {
+            return mIncludeNone;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAssistantPickerEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAssistantPickerEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..196e308f3
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/defaultapps/DefaultAssistantPickerEntryPreferenceControllerTest.java
@@ -0,0 +1,210 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.defaultapps;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.role.RoleManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionIconPreference;
+import com.android.settingslib.applications.DefaultAppInfo;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class DefaultAssistantPickerEntryPreferenceControllerTest {
+
+    private static final String TEST_PACKAGE = "com.android.car.settings.testutils";
+    private static final String TEST_CLASS = "BaseTestActivity";
+    private static final String TEST_COMPONENT =
+            new ComponentName(TEST_PACKAGE, TEST_CLASS).flattenToString();
+    private final int mUserId = UserHandle.myUserId();
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiTwoActionIconPreference mPreference;
+    private TestDefaultAssistantPickerEntryPreferenceController mController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private RoleManager mMockRoleManager;
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(RoleManager.class)).thenReturn(mMockRoleManager);
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.queryIntentServices(any(), eq(PackageManager.GET_META_DATA)))
+                .thenReturn(Collections.emptyList());
+        doNothing().when(mContext).startActivity(any());
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new CarUiTwoActionIconPreference(mContext);
+        mController = new TestDefaultAssistantPickerEntryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        mController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void getCurrentDefaultAppInfo_noAssistant_returnsNull() {
+        when(mMockRoleManager.getRoleHolders(RoleManager.ROLE_ASSISTANT))
+                .thenReturn(Collections.emptyList());
+
+        DefaultAppInfo info = mController.getCurrentDefaultAppInfo();
+
+        assertThat(info).isNull();
+    }
+
+    @Test
+    public void getCurrentDefaultAppInfo_hasService_returnsDefaultAppInfo() {
+        when(mMockRoleManager.getRoleHolders(RoleManager.ROLE_ASSISTANT))
+                .thenReturn(Collections.singletonList(TEST_PACKAGE));
+        when(mMockPackageManager.queryIntentServices(any(), eq(PackageManager.GET_META_DATA)))
+                .thenReturn(Collections.singletonList(new ResolveInfo()));
+        mController.setSettingsActivity(TEST_CLASS);
+
+        DefaultAppInfo info = mController.getCurrentDefaultAppInfo();
+
+        assertThat(info.getKey()).isEqualTo(TEST_COMPONENT);
+    }
+
+    @Test
+    public void getSettingIntent_noAssistant_returnsNull() {
+        when(mMockRoleManager.getRoleHolders(RoleManager.ROLE_ASSISTANT))
+                .thenReturn(Collections.emptyList());
+        DefaultAppInfo info = new DefaultAppInfo(mContext, mContext.getPackageManager(),
+                mUserId, ComponentName.unflattenFromString(TEST_COMPONENT));
+
+        Intent settingIntent = mController.getSettingIntent(info);
+
+        assertThat(settingIntent).isNull();
+    }
+
+    @Test
+    public void getSettingIntent_hasAssistant_noAssistSupport_returnsNull() {
+        when(mMockRoleManager.getRoleHolders(RoleManager.ROLE_ASSISTANT))
+                .thenReturn(Collections.singletonList(TEST_PACKAGE));
+        when(mMockPackageManager.queryIntentServices(any(), eq(PackageManager.GET_META_DATA)))
+                .thenReturn(Collections.singletonList(new ResolveInfo()));
+        DefaultAppInfo info = new DefaultAppInfo(mContext, mContext.getPackageManager(),
+                mUserId, ComponentName.unflattenFromString(TEST_COMPONENT));
+
+        Intent settingIntent = mController.getSettingIntent(info);
+
+        assertThat(settingIntent).isNull();
+    }
+
+    @Test
+    public void getSettingIntent_hasAssistant_supportsAssist_hasSettingsActivity_returnsIntent() {
+        when(mMockRoleManager.getRoleHolders(RoleManager.ROLE_ASSISTANT))
+                .thenReturn(Collections.singletonList(TEST_PACKAGE));
+        when(mMockPackageManager.queryIntentServices(any(), eq(PackageManager.GET_META_DATA)))
+                .thenReturn(Collections.singletonList(new ResolveInfo()));
+        mController.setSettingsActivity(TEST_CLASS);
+        DefaultAppInfo info = new DefaultAppInfo(mContext, mContext.getPackageManager(),
+                mUserId, ComponentName.unflattenFromString(TEST_COMPONENT));
+
+        Intent result = mController.getSettingIntent(info);
+
+        assertThat(result.getAction()).isEqualTo(Intent.ACTION_MAIN);
+        assertThat(result.getComponent()).isEqualTo(
+                new ComponentName(TEST_PACKAGE, TEST_CLASS));
+    }
+
+    @Test
+    public void performClick_permissionControllerExists_startsPermissionController() {
+        String testPackage = "com.test.permissions";
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(testPackage);
+
+        mController.handlePreferenceClicked(mPreference);
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(argumentCaptor.capture());
+        Intent intent = argumentCaptor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_DEFAULT_APP);
+        assertThat(intent.getPackage()).isEqualTo(testPackage);
+        assertThat(intent.getStringExtra(Intent.EXTRA_ROLE_NAME)).isEqualTo(
+                RoleManager.ROLE_ASSISTANT);
+    }
+
+    @Test
+    public void performClick_permissionControllerDoesntExist_doesNotStartPermissionController() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(null);
+
+        mController.handlePreferenceClicked(mPreference);
+
+        verify(mContext, never()).startActivity(any());
+    }
+
+    private static class TestDefaultAssistantPickerEntryPreferenceController extends
+            DefaultAssistantPickerEntryPreferenceController {
+
+        private String mSettingsActivity;
+
+        TestDefaultAssistantPickerEntryPreferenceController(Context context,
+                String preferenceKey, FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        public void setSettingsActivity(String activity) {
+            mSettingsActivity = activity;
+        }
+
+        @Override
+        String getAssistSettingsActivity(PackageManager pm, ResolveInfo resolveInfo) {
+            return mSettingsActivity;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/AppLinkStatePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/AppLinkStatePreferenceControllerTest.java
new file mode 100644
index 000000000..402d8ca8a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/AppLinkStatePreferenceControllerTest.java
@@ -0,0 +1,237 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.managedomainurls;
+
+import static android.content.pm.PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_ALWAYS;
+import static android.content.pm.PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_ASK;
+import static android.content.pm.PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_NEVER;
+import static android.content.pm.PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_UNDEFINED;
+
+import static com.android.car.settings.applications.managedomainurls.AppLaunchSettingsBasePreferenceController.sBrowserIntent;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class AppLinkStatePreferenceControllerTest {
+
+    private static final String TEST_PACKAGE_NAME = "com.example.test";
+    private static final int TEST_PACKAGE_ID = 1;
+    private static final String TEST_PATH = "TEST_PATH";
+    private final int mUserId = UserHandle.myUserId();
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private AppLinkStatePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mPreference = new ListPreference(mContext);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new AppLinkStatePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockPackageManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_isBrowserApp_isDisabled() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        setupIsBrowserApp(true);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_noDomainUrls_isDisabled() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        info.privateFlags = 0;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        setupIsBrowserApp(false);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_hasDomainUrls_isEnabled() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        info.privateFlags = ApplicationInfo.PRIVATE_FLAG_HAS_DOMAIN_URLS;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        setupIsBrowserApp(false);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_hasDomainUrls_defaultState_entrySetToAsk() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        info.privateFlags = ApplicationInfo.PRIVATE_FLAG_HAS_DOMAIN_URLS;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        setupIsBrowserApp(false);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE_NAME, mUserId))
+                .thenReturn(INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_UNDEFINED);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getEntry()).isEqualTo(
+                mContext.getString(R.string.app_link_open_ask));
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_hasDomainUrls_askState_entrySetToAsk() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        info.privateFlags = ApplicationInfo.PRIVATE_FLAG_HAS_DOMAIN_URLS;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        setupIsBrowserApp(false);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE_NAME, mUserId))
+                .thenReturn(INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_ASK);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getEntry()).isEqualTo(
+                mContext.getString(R.string.app_link_open_ask));
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_hasDomainUrls_alwaysState_entrySetToAlways() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        info.privateFlags = ApplicationInfo.PRIVATE_FLAG_HAS_DOMAIN_URLS;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        setupIsBrowserApp(false);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE_NAME, mUserId))
+                .thenReturn(INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_ALWAYS);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getEntry()).isEqualTo(
+                mContext.getString(R.string.app_link_open_always));
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_hasDomainUrls_neverState_entrySetToNever() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        info.privateFlags = ApplicationInfo.PRIVATE_FLAG_HAS_DOMAIN_URLS;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        setupIsBrowserApp(false);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE_NAME, mUserId))
+                .thenReturn(INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_NEVER);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getEntry()).isEqualTo(
+                mContext.getString(R.string.app_link_open_never));
+    }
+
+    private void setupIsBrowserApp(boolean isBrowserApp) {
+        ResolveInfo resolveInfo = new ResolveInfo();
+        resolveInfo.activityInfo = new ActivityInfo();
+        resolveInfo.handleAllWebDataURI = isBrowserApp;
+        sBrowserIntent.setPackage(TEST_PACKAGE_NAME);
+
+        when(mMockPackageManager.queryIntentActivitiesAsUser(sBrowserIntent,
+                PackageManager.MATCH_ALL, mUserId)).thenReturn(
+                Collections.singletonList(resolveInfo));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/ClearDefaultsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/ClearDefaultsPreferenceControllerTest.java
new file mode 100644
index 000000000..9b8779fad
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/ClearDefaultsPreferenceControllerTest.java
@@ -0,0 +1,200 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.managedomainurls;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.hardware.usb.IUsbManager;
+import android.os.RemoteException;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.applications.AppUtils;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class ClearDefaultsPreferenceControllerTest {
+
+    private static final String TEST_PACKAGE_NAME = "com.example.test";
+    private static final String TEST_OTHER_PACKAGE_NAME = "com.example.other.test";
+    private static final int TEST_PACKAGE_ID = 1;
+    private static final String TEST_PATH = "TEST_PATH";
+    private final int mUserId = UserHandle.myUserId();
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private ClearDefaultsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private IUsbManager mMockIUsbManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mPreference = new CarUiPreference(mContext);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new ClearDefaultsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockPackageManager, mMockIUsbManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                AppUtils.class, withSettings().lenient()).startMocking();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_hasPreferredActivities_hasSummary() {
+        ExtendedMockito.when(AppUtils.hasPreferredActivities(mMockPackageManager,
+                TEST_PACKAGE_NAME)).thenReturn(true);
+
+        setupPreferenceController();
+
+        assertThat(mPreference.getSummary().toString()).isNotEmpty();
+    }
+
+    @Test
+    public void onCreate_isDefaultBrowser_hasSummary() {
+        ExtendedMockito.when(AppUtils.hasPreferredActivities(mMockPackageManager,
+                TEST_PACKAGE_NAME)).thenReturn(false);
+        when(mMockPackageManager.getDefaultBrowserPackageNameAsUser(mUserId))
+                .thenReturn(TEST_PACKAGE_NAME);
+
+        setupPreferenceController();
+
+        assertThat(mPreference.getSummary().toString()).isNotEmpty();
+    }
+
+    @Test
+    public void onCreate_hasUsbDefaults_hasSummary() throws RemoteException {
+        ExtendedMockito.when(AppUtils.hasPreferredActivities(mMockPackageManager,
+                TEST_PACKAGE_NAME)).thenReturn(false);
+        when(mMockPackageManager.getDefaultBrowserPackageNameAsUser(mUserId))
+                .thenReturn(TEST_OTHER_PACKAGE_NAME);
+        when(mMockIUsbManager.hasDefaults(TEST_PACKAGE_NAME, mUserId)).thenReturn(true);
+
+        setupPreferenceController();
+
+        assertThat(mPreference.getSummary().toString()).isNotEmpty();
+    }
+
+    @Test
+    public void onCreate_autoLaunchDisabled_hasNoSummary() throws RemoteException {
+        ExtendedMockito.when(AppUtils.hasPreferredActivities(mMockPackageManager,
+                TEST_PACKAGE_NAME)).thenReturn(false);
+        when(mMockPackageManager.getDefaultBrowserPackageNameAsUser(mUserId))
+                .thenReturn(TEST_OTHER_PACKAGE_NAME);
+        when(mMockIUsbManager.hasDefaults(TEST_PACKAGE_NAME, mUserId)).thenReturn(false);
+
+        setupPreferenceController();
+
+        assertThat(mPreference.getSummary()).isNull();
+    }
+
+    @Test
+    public void performClick_hasUsbManager_hasPreferredActivities_clearsPreferredActivities() {
+        ExtendedMockito.when(AppUtils.hasPreferredActivities(mMockPackageManager,
+                TEST_PACKAGE_NAME)).thenReturn(true);
+        when(mMockPackageManager.getDefaultBrowserPackageNameAsUser(mUserId))
+                .thenReturn(TEST_OTHER_PACKAGE_NAME);
+
+        setupPreferenceController();
+        mPreference.performClick();
+
+        verify(mMockPackageManager).clearPackagePreferredActivities(TEST_PACKAGE_NAME);
+    }
+
+    @Test
+    public void performClick_hasUsbManager_isDefaultBrowser_clearsDefaultBrowser() {
+        ExtendedMockito.when(AppUtils.hasPreferredActivities(mMockPackageManager,
+                TEST_PACKAGE_NAME)).thenReturn(false);
+        when(mMockPackageManager.getDefaultBrowserPackageNameAsUser(mUserId))
+                .thenReturn(TEST_PACKAGE_NAME);
+
+        setupPreferenceController();
+        mPreference.performClick();
+
+        verify(mMockPackageManager).setDefaultBrowserPackageNameAsUser(/* packageName= */ null,
+                mUserId);
+    }
+
+    @Test
+    public void performClick_hasUsbDefaults_clearsUsbDefaults() throws RemoteException {
+        ExtendedMockito.when(AppUtils.hasPreferredActivities(mMockPackageManager,
+                TEST_PACKAGE_NAME)).thenReturn(false);
+        when(mMockPackageManager.getDefaultBrowserPackageNameAsUser(mUserId))
+                .thenReturn(TEST_OTHER_PACKAGE_NAME);
+        when(mMockIUsbManager.hasDefaults(TEST_PACKAGE_NAME, mUserId)).thenReturn(true);
+
+        setupPreferenceController();
+        mPreference.performClick();
+
+        verify(mMockIUsbManager).clearDefaults(TEST_PACKAGE_NAME, mUserId);
+    }
+
+    private void setupPreferenceController() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+
+        mPreferenceController.setAppEntry(entry);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainAppPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainAppPreferenceControllerTest.java
new file mode 100644
index 000000000..1e10e01e4
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainAppPreferenceControllerTest.java
@@ -0,0 +1,157 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.managedomainurls;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+
+@RunWith(AndroidJUnit4.class)
+public class DomainAppPreferenceControllerTest {
+
+    private static final String TEST_PACKAGE_NAME = "com.android.test.package";
+    private static final int TEST_PACKAGE_ID = 1;
+    private static final String TEST_LABEL = "Test App";
+    private static final String TEST_PATH = "TEST_PATH";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private DomainAppPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private ApplicationsState mMockApplicationsState;
+    @Mock
+    private ApplicationsState.Session mMockSession;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DomainAppPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockApplicationsState, mMockPackageManager);
+    }
+
+    @Test
+    public void checkInitialized_noLifecycle_throwsError() {
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreferenceGroup));
+    }
+
+    @Test
+    public void onRebuildComplete_sessionLoadsValues_preferenceGroupHasValues() {
+        setupPreferenceController();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        ArrayList<ApplicationsState.AppEntry> apps = new ArrayList<>();
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+        entry.label = TEST_LABEL;
+        apps.add(entry);
+        mPreferenceController.mApplicationStateCallbacks.onRebuildComplete(apps);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_startsApplicationLaunchSettingsFragmentWithPackageName() {
+        setupPreferenceController();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        ArrayList<ApplicationsState.AppEntry> apps = new ArrayList<>();
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        ApplicationsState.AppEntry entry = new ApplicationsState.AppEntry(mContext, info,
+                TEST_PACKAGE_ID);
+        entry.label = TEST_LABEL;
+        apps.add(entry);
+        mPreferenceController.mApplicationStateCallbacks.onRebuildComplete(apps);
+
+        Preference preference = mPreferenceGroup.getPreference(0);
+        preference.performClick();
+
+        ArgumentCaptor<ApplicationLaunchSettingsFragment> captor = ArgumentCaptor.forClass(
+                ApplicationLaunchSettingsFragment.class);
+        verify(mMockFragmentController).launchFragment(captor.capture());
+
+        String pkgName = captor.getValue().getArguments().getString(
+                ApplicationLaunchSettingsFragment.ARG_PACKAGE_NAME);
+        assertThat(pkgName).isEqualTo(TEST_PACKAGE_NAME);
+    }
+
+    private void setupPreferenceController() {
+        when(mMockApplicationsState.newSession(any(), any())).thenReturn(mMockSession);
+        mPreferenceController.setLifecycle(mLifecycleOwner.getLifecycle());
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainUrlsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainUrlsPreferenceControllerTest.java
new file mode 100644
index 000000000..f61943555
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainUrlsPreferenceControllerTest.java
@@ -0,0 +1,191 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.managedomainurls;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.os.UserHandle;
+import android.util.ArraySet;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class DomainUrlsPreferenceControllerTest {
+    private static final String TEST_PACKAGE_NAME = "com.example.test";
+    private static final int TEST_PACKAGE_ID = 1;
+    private static final String TEST_PATH = "TEST_PATH";
+    private static final String TEST_DOMAIN = "example.com";
+    private static final String TEST_SUMMARY = "test_summary";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private DomainUrlsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    private ApplicationsState.AppEntry mAppEntry;
+    private ArraySet<String> mMockDomains;
+    private boolean mIsBrowserApp;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new TestDomainUrlsPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = TEST_PACKAGE_NAME;
+        info.uid = TEST_PACKAGE_ID;
+        info.sourceDir = TEST_PATH;
+        mAppEntry = new ApplicationsState.AppEntry(mContext, info, TEST_PACKAGE_ID);
+        mMockDomains = new ArraySet<>();
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(DomainUrlsUtils.class,
+                withSettings().lenient()).startMocking();
+        when(DomainUrlsUtils.getHandledDomains(any(PackageManager.class),
+                eq(TEST_PACKAGE_NAME))).thenReturn(mMockDomains);
+        when(DomainUrlsUtils.getDomainsSummary(mContext, TEST_PACKAGE_NAME, UserHandle.myUserId(),
+                mMockDomains)).thenReturn(TEST_SUMMARY);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_isBrowserApp_isDisabled() {
+        mIsBrowserApp = true;
+        mMockDomains.add(TEST_DOMAIN);
+        mPreferenceController.setAppEntry(mAppEntry);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_isEnabled() {
+        mIsBrowserApp = false;
+        mMockDomains.add(TEST_DOMAIN);
+        mPreferenceController.setAppEntry(mAppEntry);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_hasNoDomains_isDisabled() {
+        mIsBrowserApp = false;
+        mPreferenceController.setAppEntry(mAppEntry);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_isBrowserApp_summarySet() {
+        mIsBrowserApp = true;
+        mMockDomains.add(TEST_DOMAIN);
+        mPreferenceController.setAppEntry(mAppEntry);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(TEST_SUMMARY);
+    }
+
+    @Test
+    public void onCreate_isNotBrowserApp_summarySet() {
+        mIsBrowserApp = false;
+        mMockDomains.add(TEST_DOMAIN);
+        mPreferenceController.setAppEntry(mAppEntry);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(TEST_SUMMARY);
+    }
+
+    @Test
+    public void performClick_isNotBrowserApp_opensDialog() {
+        mIsBrowserApp = false;
+        mMockDomains.add(TEST_DOMAIN);
+        mPreferenceController.setAppEntry(mAppEntry);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        verify(mFragmentController).showDialog(
+                any(ConfirmationDialogFragment.class), eq(ConfirmationDialogFragment.TAG));
+    }
+
+    private class TestDomainUrlsPreferenceController extends DomainUrlsPreferenceController {
+
+        TestDomainUrlsPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected boolean isBrowserApp() {
+            return mIsBrowserApp;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainUrlsUtilsTest.java b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainUrlsUtilsTest.java
new file mode 100644
index 000000000..3689637cd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/managedomainurls/DomainUrlsUtilsTest.java
@@ -0,0 +1,177 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.managedomainurls;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+import android.content.pm.IntentFilterVerificationInfo;
+import android.content.pm.PackageManager;
+import android.util.ArraySet;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public class DomainUrlsUtilsTest {
+
+    private static final String TEST_PACKAGE = "com.test.android.Package";
+    private static final int USER_ID = 10;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+    }
+
+    @Test
+    public void getDomainsSummary_domainStatusSetToNever_showNoneText() {
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE, USER_ID))
+                .thenReturn(PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_NEVER);
+
+        assertThat(DomainUrlsUtils.getDomainsSummary(mContext, TEST_PACKAGE, USER_ID,
+                new ArraySet<>())).isEqualTo(mContext.getString(R.string.domain_urls_summary_none));
+    }
+
+    @Test
+    public void getDomainsSummary_domainStatusSet_noDomains_showNoneText() {
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE, USER_ID))
+                .thenReturn(PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_ALWAYS_ASK);
+
+        assertThat(DomainUrlsUtils.getDomainsSummary(mContext, TEST_PACKAGE, USER_ID,
+                new ArraySet<>())).isEqualTo(mContext.getString(R.string.domain_urls_summary_none));
+    }
+
+    @Test
+    public void getDomainsSummary_domainStatusSet_oneDomain_showSingleDomain() {
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE, USER_ID))
+                .thenReturn(PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_ALWAYS_ASK);
+        ArraySet<String> domains = new ArraySet<>();
+        domains.add("test.domain.com");
+
+        assertThat(DomainUrlsUtils.getDomainsSummary(mContext, TEST_PACKAGE, USER_ID,
+                domains)).isEqualTo(
+                mContext.getString(R.string.domain_urls_summary_one, domains.valueAt(0)));
+    }
+
+    @Test
+    public void getDomainsSummary_domainStatusSet_multipleDomain_showMultipleDomains() {
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.getIntentVerificationStatusAsUser(TEST_PACKAGE, USER_ID))
+                .thenReturn(PackageManager.INTENT_FILTER_DOMAIN_VERIFICATION_STATUS_ALWAYS_ASK);
+        ArraySet<String> domains = new ArraySet<>();
+        domains.add("test.domain.com");
+        domains.add("test.domain2.com");
+
+        assertThat(DomainUrlsUtils.getDomainsSummary(mContext, TEST_PACKAGE, USER_ID,
+                domains)).isEqualTo(
+                mContext.getString(R.string.domain_urls_summary_some, domains.valueAt(0)));
+    }
+
+    @Test
+    public void getHandledDomains_includeIntentFilterVerificationInfoDomains() {
+        String domain = "test.domain.com";
+        ArraySet<String> domains = new ArraySet<>();
+        domains.add(domain);
+        IntentFilterVerificationInfo info = new IntentFilterVerificationInfo(TEST_PACKAGE, domains);
+        when(mMockPackageManager.getIntentFilterVerifications(TEST_PACKAGE))
+                .thenReturn(Arrays.asList(info));
+        when(mMockPackageManager.getAllIntentFilters(TEST_PACKAGE)).thenReturn(null);
+
+        assertThat(DomainUrlsUtils.getHandledDomains(mMockPackageManager, TEST_PACKAGE))
+                .hasSize(1);
+        assertThat(DomainUrlsUtils.getHandledDomains(mMockPackageManager, TEST_PACKAGE))
+                .contains(domain);
+    }
+
+    @Test
+    public void getHandledDomains_includeBrowsableIntentFiltersWithHttpDataScheme() {
+        String domain = "test.domain.com";
+        String port = "80";
+        IntentFilter filter = new IntentFilter();
+        filter.addCategory(Intent.CATEGORY_BROWSABLE);
+        filter.addDataScheme(IntentFilter.SCHEME_HTTP);
+        filter.addDataAuthority(new IntentFilter.AuthorityEntry(domain, port));
+        when(mMockPackageManager.getIntentFilterVerifications(TEST_PACKAGE))
+                .thenReturn(null);
+        when(mMockPackageManager.getAllIntentFilters(TEST_PACKAGE))
+                .thenReturn(Arrays.asList(filter));
+
+        assertThat(DomainUrlsUtils.getHandledDomains(mMockPackageManager, TEST_PACKAGE))
+                .hasSize(1);
+        assertThat(DomainUrlsUtils.getHandledDomains(mMockPackageManager, TEST_PACKAGE))
+                .contains(domain);
+    }
+
+    @Test
+    public void getHandledDomains_includeBrowsableIntentFiltersWithHttpsDataScheme() {
+        String domain = "test.domain.com";
+        String port = "80";
+        IntentFilter filter = new IntentFilter();
+        filter.addCategory(Intent.CATEGORY_BROWSABLE);
+        filter.addDataScheme(IntentFilter.SCHEME_HTTPS);
+        filter.addDataAuthority(new IntentFilter.AuthorityEntry(domain, port));
+        when(mMockPackageManager.getIntentFilterVerifications(TEST_PACKAGE))
+                .thenReturn(null);
+        when(mMockPackageManager.getAllIntentFilters(TEST_PACKAGE))
+                .thenReturn(Arrays.asList(filter));
+
+        assertThat(DomainUrlsUtils.getHandledDomains(mMockPackageManager, TEST_PACKAGE))
+                .hasSize(1);
+        assertThat(DomainUrlsUtils.getHandledDomains(mMockPackageManager, TEST_PACKAGE))
+                .contains(domain);
+    }
+
+    @Test
+    public void getHandledDomains_excludeBrowsableIntentFiltersWithOtherDataScheme() {
+        PackageManager pm = mock(PackageManager.class);
+        String domain = "test.domain.com";
+        String port = "80";
+        IntentFilter filter = new IntentFilter();
+        filter.addCategory(Intent.CATEGORY_BROWSABLE);
+        filter.addDataAuthority(new IntentFilter.AuthorityEntry(domain, port));
+        when(mMockPackageManager.getIntentFilterVerifications(TEST_PACKAGE))
+                .thenReturn(null);
+        when(mMockPackageManager.getAllIntentFilters(TEST_PACKAGE))
+                .thenReturn(Arrays.asList(filter));
+
+        assertThat(DomainUrlsUtils.getHandledDomains(pm, TEST_PACKAGE)).isEmpty();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/performance/PerfImpactingAppsItemManagerTest.java b/tests/multivalent/src/com/android/car/settings/applications/performance/PerfImpactingAppsItemManagerTest.java
new file mode 100644
index 000000000..c16773f12
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/performance/PerfImpactingAppsItemManagerTest.java
@@ -0,0 +1,99 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.performance;
+
+import static android.car.settings.CarSettings.Secure.KEY_PACKAGES_DISABLED_ON_RESOURCE_OVERUSE;
+
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.provider.Settings;
+
+import androidx.test.core.app.ApplicationProvider;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.concurrent.CountDownLatch;
+import java.util.concurrent.TimeUnit;
+
+public class PerfImpactingAppsItemManagerTest {
+    private static final int CALLBACK_TIMEOUT_MS = 100;
+    private static final String TEST_PKG_NAME = "test.package.name";
+    private static final String TEST_PRIVILEGE_PKG_NAME = "test.privilege.package.name";
+    private static final String TEST_DISABLED_PACKAGES_SETTING_STRING = TEST_PKG_NAME + ";"
+            + TEST_PRIVILEGE_PKG_NAME;
+
+    private final CountDownLatch mCountDownLatch = new CountDownLatch(1);
+
+    private final TestListener mPerfImpactingAppsListener = new TestListener();
+
+    private MockitoSession mMockingSession;
+
+    private Context mContext;
+    private PerfImpactingAppsItemManager mManager;
+
+    @Before
+    public void setUp() {
+        mMockingSession = mockitoSession()
+                .initMocks(this)
+                .mockStatic(Settings.Secure.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+
+        when(Settings.Secure.getString(any(), eq(KEY_PACKAGES_DISABLED_ON_RESOURCE_OVERUSE)))
+                .thenReturn(TEST_DISABLED_PACKAGES_SETTING_STRING);
+
+        mManager = new PerfImpactingAppsItemManager(mContext);
+        mManager.addListener(mPerfImpactingAppsListener);
+    }
+
+    @After
+    public void tearDown() {
+        mMockingSession.finishMocking();
+    }
+
+    @Test
+    public void startLoading_getDisabledPackagesCount() throws Exception {
+        mManager.startLoading();
+        mCountDownLatch.await(CALLBACK_TIMEOUT_MS, TimeUnit.MILLISECONDS);
+
+        assertThat(mPerfImpactingAppsListener.mResult).isEqualTo(2);
+    }
+
+    private class TestListener implements PerfImpactingAppsItemManager.PerfImpactingAppsListener {
+        int mResult;
+
+        @Override
+        public void onPerfImpactingAppsLoaded(int disabledPackagesCount) {
+            mResult = disabledPackagesCount;
+            mCountDownLatch.countDown();
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/performance/PerfImpactingAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/performance/PerfImpactingAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..eb391c26a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/performance/PerfImpactingAppsPreferenceControllerTest.java
@@ -0,0 +1,329 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.performance;
+
+import static android.car.settings.CarSettings.Secure.KEY_PACKAGES_DISABLED_ON_RESOURCE_OVERUSE;
+import static android.provider.Settings.ACTION_APPLICATION_DETAILS_SETTINGS;
+
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.verify;
+
+import static com.google.common.truth.Truth.assertThat;
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyLong;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verifyNoMoreInteractions;
+import static org.mockito.Mockito.when;
+
+import android.car.Car;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.watchdog.CarWatchdogManager;
+import android.car.watchdog.PackageKillableState;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.net.Uri;
+import android.os.UserHandle;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionTextPreference;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.io.File;
+import java.util.List;
+import java.util.stream.Collectors;
+
+@RunWith(AndroidJUnit4.class)
+public final class PerfImpactingAppsPreferenceControllerTest {
+    private static final int TEST_USER_ID = 100;
+    private static final int TEST_PKG_UID = 10000001;
+    private static final String TEST_PKG_NAME = "test.package.name";
+    private static final int TEST_PRIVILEGE_PKG_UID = 10000002;
+    private static final String TEST_PRIVILEGE_PKG_NAME = "test.privilege.package.name";
+    private static final String TEST_DISABLED_PACKAGES_SETTING_STRING =
+            TEST_PKG_NAME + ";" + TEST_PRIVILEGE_PKG_NAME;
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+
+    private MockitoSession mMockingSession;
+    private LifecycleOwner mLifecycleOwner;
+    private PerfImpactingAppsPreferenceController mController;
+    private LogicalPreferenceGroup mPreferenceGroup;
+
+    @Captor
+    private ArgumentCaptor<Car.CarServiceLifecycleListener> mCarLifecycleCaptor;
+    @Captor
+    private ArgumentCaptor<ConfirmationDialogFragment> mDialogFragmentCaptor;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private Car mMockCar;
+    @Mock
+    private CarWatchdogManager mMockCarWatchdogManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mMockingSession = mockitoSession()
+                .initMocks(this)
+                .mockStatic(Car.class)
+                .mockStatic(Settings.Secure.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mDialogFragmentCaptor = ArgumentCaptor.forClass(ConfirmationDialogFragment.class);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(Car.createCar(any(), any(), anyLong(), mCarLifecycleCaptor.capture())).then(
+                invocation -> {
+                    Car.CarServiceLifecycleListener listener = mCarLifecycleCaptor.getValue();
+                    listener.onLifecycleChanged(mMockCar, true);
+                    return mMockCar;
+                });
+        when(mMockCar.getCarManager(Car.CAR_WATCHDOG_SERVICE)).thenReturn(mMockCarWatchdogManager);
+        when(mMockCarWatchdogManager.getPackageKillableStatesAsUser(
+                UserHandle.getUserHandleForUid(TEST_PKG_UID)))
+                .thenReturn(List.of(
+                        new PackageKillableState(TEST_PKG_NAME, TEST_USER_ID,
+                                PackageKillableState.KILLABLE_STATE_YES),
+                        new PackageKillableState(TEST_PRIVILEGE_PKG_NAME, TEST_USER_ID,
+                                PackageKillableState.KILLABLE_STATE_NEVER)));
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+
+        mController = new PerfImpactingAppsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, restrictions);
+
+        PreferenceControllerTestUtil.assignPreference(mController, mPreferenceGroup);
+
+        initController();
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        (new File(mContext.getDataDir(), TEST_PKG_NAME)).delete();
+        (new File(mContext.getDataDir(), TEST_PRIVILEGE_PKG_NAME)).delete();
+
+        mMockingSession.finishMocking();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClick_primaryAppAction_sendAppDetailIntent() {
+        doNothing().when(mContext).startActivity(any());
+
+        Preference actualPreference = mPreferenceGroup.getPreference(0);
+
+        Preference.OnPreferenceClickListener onPreferenceClickListener =
+                actualPreference.getOnPreferenceClickListener();
+
+        onPreferenceClickListener.onPreferenceClick(actualPreference);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+        Intent intent = captor.getValue();
+        assertThat(intent).isNotNull();
+        assertWithMessage("Intent action").that(intent.getAction())
+                .isEqualTo(ACTION_APPLICATION_DETAILS_SETTINGS);
+        assertWithMessage("Intent data").that(intent.getData())
+                .isEqualTo(Uri.parse("package:" + TEST_PKG_NAME));
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClick_showConfirmationDialog_prioritizeApp() {
+        CarUiTwoActionTextPreference actualPreference =
+                (CarUiTwoActionTextPreference) mPreferenceGroup.getPreference(0);
+
+        actualPreference.performSecondaryActionClick();
+
+        verify(mMockFragmentController).showDialog(mDialogFragmentCaptor.capture(), anyString());
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentCaptor.getValue();
+
+        assertThat(dialogFragment).isNotNull();
+
+        dialogFragment.onClick(dialogFragment.getDialog(), DialogInterface.BUTTON_POSITIVE);
+
+        verify(mMockCarWatchdogManager).setKillablePackageAsUser(TEST_PKG_NAME,
+                UserHandle.getUserHandleForUid(TEST_PKG_UID),
+                /* isKillable= */ false);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClick_showConfirmationDialog_prioritizePrivilegedApp() {
+        CarUiTwoActionTextPreference actualPreference =
+                (CarUiTwoActionTextPreference) mPreferenceGroup.getPreference(1);
+
+        actualPreference.performSecondaryActionClick();
+
+        verify(mMockFragmentController).showDialog(mDialogFragmentCaptor.capture(), anyString());
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentCaptor.getValue();
+
+        assertThat(dialogFragment).isNotNull();
+
+        dialogFragment.onClick(dialogFragment.getDialog(), DialogInterface.BUTTON_POSITIVE);
+
+        verify(mMockPackageManager).setApplicationEnabledSetting(TEST_PRIVILEGE_PKG_NAME,
+                PackageManager.COMPONENT_ENABLED_STATE_ENABLED, /* flags= */ 0);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClick_showConfirmationDialog_cancel() {
+        CarUiTwoActionTextPreference actualPreference =
+                (CarUiTwoActionTextPreference) mPreferenceGroup.getPreference(1);
+
+        actualPreference.performSecondaryActionClick();
+
+        verify(mMockFragmentController).showDialog(mDialogFragmentCaptor.capture(), anyString());
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentCaptor.getValue();
+
+        assertThat(dialogFragment).isNotNull();
+
+        dialogFragment.onClick(dialogFragment.getDialog(), DialogInterface.BUTTON_NEGATIVE);
+
+        verify(mMockPackageManager, never())
+                .setApplicationEnabledSetting(anyString(), anyInt(), anyInt());
+        verifyNoMoreInteractions(mMockCarWatchdogManager);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onCreate_perfImpactingApps_withNoPackages() {
+        when(Settings.Secure.getString(any(), eq(KEY_PACKAGES_DISABLED_ON_RESOURCE_OVERUSE)))
+                .thenReturn("");
+
+        mController.onDestroy(mLifecycleOwner);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertWithMessage("Preference group count")
+                .that(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    private void initController() {
+        List<ResolveInfo> expectedResultInfos = getResultInfos();
+
+        when(Settings.Secure.getString(any(), eq(KEY_PACKAGES_DISABLED_ON_RESOURCE_OVERUSE)))
+                .thenReturn(TEST_DISABLED_PACKAGES_SETTING_STRING);
+        when(mMockPackageManager.queryIntentActivities(any(), any()))
+                .thenReturn(expectedResultInfos);
+
+        mController.onCreate(mLifecycleOwner);
+
+        List<CarUiTwoActionTextPreference> expectedPreferences =
+                getPreferences(expectedResultInfos);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(expectedPreferences.size());
+
+        for (int idx = 0; idx < expectedPreferences.size(); idx++) {
+            assertThatPreferenceAreEqual(idx,
+                    (CarUiTwoActionTextPreference) mPreferenceGroup.getPreference(idx),
+                    expectedPreferences.get(idx));
+        }
+    }
+
+    private List<CarUiTwoActionTextPreference> getPreferences(List<ResolveInfo> resolveInfos) {
+        return resolveInfos.stream().map(
+                resolveInfo ->
+                        new PerfImpactingAppsPreferenceController.PerformanceImpactingAppPreference(
+                                mContext, resolveInfo.activityInfo.applicationInfo))
+                .collect(Collectors.toList());
+    }
+
+    private List<ResolveInfo> getResultInfos() {
+        // Non-privileged Package
+        ResolveInfo resolveInfo1 = new ResolveInfo();
+        resolveInfo1.activityInfo = new ActivityInfo();
+        resolveInfo1.activityInfo.applicationInfo = new ApplicationInfo();
+        resolveInfo1.activityInfo.applicationInfo.uid = TEST_PKG_UID;
+        resolveInfo1.activityInfo.applicationInfo.packageName = TEST_PKG_NAME;
+
+        File appFile = new File(mContext.getDataDir(), TEST_PKG_NAME);
+        assertWithMessage("%s dir", TEST_PKG_NAME).that(appFile.mkdir()).isTrue();
+
+        resolveInfo1.activityInfo.applicationInfo.sourceDir = appFile.getAbsolutePath();
+
+        // Privileged Package
+        ResolveInfo resolveInfo2 = new ResolveInfo();
+        resolveInfo2.activityInfo = new ActivityInfo();
+        resolveInfo2.activityInfo.applicationInfo = new ApplicationInfo();
+        resolveInfo2.activityInfo.applicationInfo.uid = TEST_PRIVILEGE_PKG_UID;
+        resolveInfo2.activityInfo.applicationInfo.packageName = TEST_PRIVILEGE_PKG_NAME;
+
+        appFile = new File(mContext.getDataDir(), TEST_PRIVILEGE_PKG_NAME);
+        assertWithMessage("%s dir", TEST_PRIVILEGE_PKG_NAME).that(appFile.mkdir()).isTrue();
+
+        resolveInfo2.activityInfo.applicationInfo.sourceDir = appFile.getAbsolutePath();
+
+        return List.of(resolveInfo1, resolveInfo2);
+    }
+
+    private static void assertThatPreferenceAreEqual(int index, CarUiTwoActionTextPreference p1,
+            CarUiTwoActionTextPreference p2) {
+        assertWithMessage("Preference %s key", index).that(p1.getKey()).isEqualTo(p2.getKey());
+        assertWithMessage("Preference %s title", index).that(p1.getTitle().toString())
+                .isEqualTo(p2.getTitle().toString());
+        assertWithMessage("Preference %s secondary action text", index)
+                .that(p2.getSecondaryActionText().toString())
+                .isEqualTo(p2.getSecondaryActionText().toString());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppEntryListManagerTest.java b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppEntryListManagerTest.java
new file mode 100644
index 000000000..10222bb29
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppEntryListManagerTest.java
@@ -0,0 +1,163 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.specialaccess;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.os.Looper;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AppEntryListManagerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private AppEntryListManager mAppEntryListManager;
+
+    @Mock
+    private ApplicationsState mMockApplicationsState;
+    @Mock
+    private ApplicationsState.Session mMockSession;
+    @Mock
+    private AppEntryListManager.ExtraInfoBridge mMockExtraInfoBridge;
+    @Mock
+    private AppEntryListManager.AppFilterProvider mMockFilterProvider;
+    @Mock
+    private AppEntryListManager.Callback mMockCallback;
+    @Captor
+    private ArgumentCaptor<ApplicationsState.Callbacks> mSessionCallbacksCaptor;
+    @Captor
+    private ArgumentCaptor<List<ApplicationsState.AppEntry>> mEntriesCaptor;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mMockApplicationsState.newSession(mSessionCallbacksCaptor.capture()))
+                .thenReturn(mMockSession);
+        when(mMockApplicationsState.getBackgroundLooper()).thenReturn(Looper.getMainLooper());
+
+        mAppEntryListManager = new AppEntryListManager(mContext, mMockApplicationsState);
+        mAppEntryListManager.init(mMockExtraInfoBridge, mMockFilterProvider, mMockCallback);
+    }
+
+    @Test
+    public void start_resumesSession() {
+        mAppEntryListManager.start();
+
+        verify(mMockSession).onResume();
+    }
+
+    @Test
+    public void onPackageListChanged_loadsExtraInfo() {
+        mSessionCallbacksCaptor.getValue().onPackageListChanged();
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        verify(mMockExtraInfoBridge).loadExtraInfo(any());
+    }
+
+    @Test
+    public void onLoadEntriesComplete_loadsExtraInfo() {
+        mSessionCallbacksCaptor.getValue().onLoadEntriesCompleted();
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        verify(mMockExtraInfoBridge).loadExtraInfo(any());
+    }
+
+    @Test
+    public void stop_pausesSession() {
+        mAppEntryListManager.stop();
+
+        verify(mMockSession).onPause();
+    }
+
+    @Test
+    public void destroy_destroysSession() {
+        mAppEntryListManager.destroy();
+
+        verify(mMockSession).onDestroy();
+    }
+
+    @Test
+    public void forceUpdate_loadsExtraInfo() {
+        ArrayList<ApplicationsState.AppEntry> entries = new ArrayList<>();
+        entries.add(mock(ApplicationsState.AppEntry.class));
+        when(mMockSession.getAllApps()).thenReturn(entries);
+
+        mAppEntryListManager.forceUpdate();
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        verify(mMockExtraInfoBridge).loadExtraInfo(entries);
+    }
+
+    @Test
+    public void forceUpdate_forEntry_loadsExtraInfo() {
+        ApplicationsState.AppEntry entry = mock(ApplicationsState.AppEntry.class);
+
+        mAppEntryListManager.forceUpdate(entry);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        verify(mMockExtraInfoBridge).loadExtraInfo(mEntriesCaptor.capture());
+        assertThat(mEntriesCaptor.getValue()).containsExactly(entry);
+    }
+
+    @Test
+    public void loadingFinished_rebuildsSession() {
+        ApplicationsState.AppFilter appFilter = mock(ApplicationsState.AppFilter.class);
+        when(mMockFilterProvider.getAppFilter()).thenReturn(appFilter);
+
+        mSessionCallbacksCaptor.getValue().onLoadEntriesCompleted();
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        verify(mMockSession).rebuild(eq(appFilter),
+                eq(ApplicationsState.ALPHA_COMPARATOR), /* foreground= */ eq(false));
+    }
+
+    @Test
+    public void onRebuildComplete_callsCallback() {
+        ArrayList<ApplicationsState.AppEntry> entries = new ArrayList<>();
+        entries.add(mock(ApplicationsState.AppEntry.class));
+
+        mSessionCallbacksCaptor.getValue().onRebuildComplete(entries);
+
+        verify(mMockCallback).onAppEntryListChanged(entries);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppOpsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppOpsPreferenceControllerTest.java
new file mode 100644
index 000000000..ff165db7f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppOpsPreferenceControllerTest.java
@@ -0,0 +1,305 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.specialaccess;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.Manifest;
+import android.app.AppOpsManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.os.Looper;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.preference.TwoStatePreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AppOpsPreferenceControllerTest {
+
+    private static final int APP_OP_CODE = AppOpsManager.OP_WRITE_SETTINGS;
+    private static final String PERMISSION = Manifest.permission.WRITE_SETTINGS;
+    private static final int NEGATIVE_MODE = AppOpsManager.MODE_ERRORED;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private AppOpsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private AppOpsManager mMockAppOpsManager;
+    @Mock
+    private AppEntryListManager mMockAppEntryListManager;
+    @Mock
+    private ApplicationsState mMockApplicationsState;
+    @Captor
+    private ArgumentCaptor<AppEntryListManager.Callback> mCallbackCaptor;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mMockApplicationsState.getBackgroundLooper()).thenReturn(Looper.getMainLooper());
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new AppOpsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockAppOpsManager);
+    }
+
+    @Test
+    public void checkInitialized_noOpCode_throwsIllegalStateException() {
+        mPreferenceController.init(AppOpsManager.OP_NONE, PERMISSION, NEGATIVE_MODE);
+
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil
+                        .assignPreference(mPreferenceController, mPreferenceGroup));
+    }
+
+    @Test
+    public void checkInitialized_noPermission_throwsIllegalStateException() {
+        mPreferenceController.init(APP_OP_CODE, /* permission= */ null, NEGATIVE_MODE);
+
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil
+                        .assignPreference(mPreferenceController, mPreferenceGroup));
+    }
+
+    @Test
+    public void checkInitialized_noNegativeOpMode_throwsIllegalStateException() {
+        mPreferenceController.init(APP_OP_CODE, PERMISSION, /* negativeOpMode= */-1);
+
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil
+                        .assignPreference(mPreferenceController, mPreferenceGroup));
+    }
+
+    @Test
+    public void onStart_startsListManager() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mMockAppEntryListManager).start();
+    }
+
+    @Test
+    public void onStop_stopsListManager() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockAppEntryListManager).stop();
+    }
+
+    @Test
+    public void onDestroy_destroysListManager() {
+        setupPreferenceController();
+        mPreferenceController.onDestroy(mLifecycleOwner);
+
+        verify(mMockAppEntryListManager).destroy();
+    }
+
+    @Test
+    public void onAppEntryListChanged_addsPreferencesForEntries() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        List<ApplicationsState.AppEntry> entries = Arrays.asList(
+                createAppEntry("test.package", /* uid= */ 1, /* isOpPermissible= */ true),
+                createAppEntry("another.test.package", /* uid= */ 2, /* isOpPermissible= */ false));
+
+        mCallbackCaptor.getValue().onAppEntryListChanged(entries);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+        assertThat(((TwoStatePreference) mPreferenceGroup.getPreference(0)).isChecked()).isTrue();
+        assertThat(((TwoStatePreference) mPreferenceGroup.getPreference(1)).isChecked()).isFalse();
+    }
+
+    @Test
+    public void onPreferenceChange_checkedState_setsAppOpModeAllowed() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        String packageName = "test.package";
+        int uid = 1;
+        List<ApplicationsState.AppEntry> entries = Collections.singletonList(
+                createAppEntry(packageName, uid, /* isOpPermissible= */ false));
+        mCallbackCaptor.getValue().onAppEntryListChanged(entries);
+        TwoStatePreference appPref = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+
+        appPref.performClick();
+
+        verify(mMockAppOpsManager).setMode(APP_OP_CODE, uid, packageName,
+                AppOpsManager.MODE_ALLOWED);
+    }
+
+    @Test
+    public void onPreferenceChange_uncheckedState_setsNegativeAppOpMode() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        String packageName = "test.package";
+        int uid = 1;
+        List<ApplicationsState.AppEntry> entries = Collections.singletonList(
+                createAppEntry(packageName, uid, /* isOpPermissible= */ true));
+        mCallbackCaptor.getValue().onAppEntryListChanged(entries);
+        TwoStatePreference appPref = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+
+        appPref.performClick();
+
+        verify(mMockAppOpsManager).setMode(APP_OP_CODE, uid, packageName,
+                NEGATIVE_MODE);
+    }
+
+    @Test
+    public void onPreferenceChange_updatesEntry() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        List<ApplicationsState.AppEntry> entries = Collections.singletonList(
+                createAppEntry("test.package", /* uid= */ 1, /* isOpPermissible= */ false));
+        mCallbackCaptor.getValue().onAppEntryListChanged(entries);
+        TwoStatePreference appPref = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+
+        appPref.performClick();
+
+        verify(mMockAppEntryListManager).forceUpdate(entries.get(0));
+    }
+
+    @Test
+    public void showSystem_updatesEntries() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mPreferenceController.setShowSystem(true);
+
+        verify(mMockAppEntryListManager).forceUpdate();
+    }
+
+    @Test
+    public void appFilter_showingSystemApps_keepsSystemEntries() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setShowSystem(true);
+        ArgumentCaptor<AppEntryListManager.AppFilterProvider> filterCaptor =
+                ArgumentCaptor.forClass(AppEntryListManager.AppFilterProvider.class);
+        verify(mMockAppEntryListManager).init(any(), filterCaptor.capture(), any());
+        ApplicationsState.AppFilter filter = filterCaptor.getValue().getAppFilter();
+
+        ApplicationsState.AppEntry systemApp = createAppEntry("test.package",
+                /* uid= */ 1, /* isOpPermissible= */false);
+        systemApp.info.flags |= ApplicationInfo.FLAG_SYSTEM;
+
+        assertThat(filter.filterApp(systemApp)).isTrue();
+    }
+
+    @Test
+    public void appFilter_notShowingSystemApps_removesSystemEntries() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        // Not showing system by default.
+        ArgumentCaptor<AppEntryListManager.AppFilterProvider> filterCaptor =
+                ArgumentCaptor.forClass(AppEntryListManager.AppFilterProvider.class);
+        verify(mMockAppEntryListManager).init(any(), filterCaptor.capture(), any());
+        ApplicationsState.AppFilter filter = filterCaptor.getValue().getAppFilter();
+
+        ApplicationsState.AppEntry systemApp = createAppEntry("test.package",
+                /* uid= */ 1, /* isOpPermissible= */false);
+        systemApp.info.flags |= ApplicationInfo.FLAG_SYSTEM;
+
+        assertThat(filter.filterApp(systemApp)).isFalse();
+    }
+
+    @Test
+    public void appFilter_removesNullExtraInfoEntries() {
+        setupPreferenceController();
+        mPreferenceController.onStart(mLifecycleOwner);
+        ArgumentCaptor<AppEntryListManager.AppFilterProvider> filterCaptor =
+                ArgumentCaptor.forClass(AppEntryListManager.AppFilterProvider.class);
+        verify(mMockAppEntryListManager).init(any(), filterCaptor.capture(), any());
+        ApplicationsState.AppFilter filter = filterCaptor.getValue().getAppFilter();
+
+        ApplicationsState.AppEntry appEntry = createAppEntry("test.package",
+                /* uid= */ 1, /* isOpPermissible= */false);
+        appEntry.extraInfo = null;
+
+        assertThat(filter.filterApp(appEntry)).isFalse();
+    }
+
+    private ApplicationsState.AppEntry createAppEntry(String packageName, int uid,
+            boolean isOpPermissible) {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = packageName;
+        info.uid = uid;
+
+        AppStateAppOpsBridge.PermissionState extraInfo = mock(
+                AppStateAppOpsBridge.PermissionState.class);
+        when(extraInfo.isPermissible()).thenReturn(isOpPermissible);
+
+        ApplicationsState.AppEntry appEntry = mock(ApplicationsState.AppEntry.class);
+        appEntry.info = info;
+        appEntry.label = packageName;
+        appEntry.extraInfo = extraInfo;
+
+        return appEntry;
+    }
+
+    private void setupPreferenceController() {
+        mPreferenceController.init(APP_OP_CODE, PERMISSION, NEGATIVE_MODE);
+        mPreferenceController.mAppEntryListManager = mMockAppEntryListManager;
+
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        verify(mMockAppEntryListManager).init(any(AppStateAppOpsBridge.class), any(),
+                mCallbackCaptor.capture());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppStateAppOpsBridgeTest.java b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppStateAppOpsBridgeTest.java
new file mode 100644
index 000000000..a8f76c04e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppStateAppOpsBridgeTest.java
@@ -0,0 +1,341 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.specialaccess;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.Manifest;
+import android.app.AppOpsManager;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.IPackageManager;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ParceledListSlice;
+import android.os.RemoteException;
+import android.os.UserHandle;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.AdditionalMatchers;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AppStateAppOpsBridgeTest {
+
+    private static final int APP_OP_CODE = AppOpsManager.OP_WRITE_SETTINGS;
+    private static final String PERMISSION = Manifest.permission.WRITE_SETTINGS;
+    private static final int USER_ID1 = 1;
+    private static final int USER_ID2 = 2;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private AppOpsManager mAppOpsManager;
+    private AppStateAppOpsBridge mBridge;
+    private ParceledListSlice<PackageInfo> mParceledListSlice1;
+    private ParceledListSlice<PackageInfo> mParceledListSlice2;
+    private List<PackageInfo> mPackages;
+    private MockitoSession mSession;
+
+    @Mock
+    private IPackageManager mMockIPackageManager;
+    @Mock
+    private AppOpsManager mMockAppOpsManager;
+
+    @Before
+    public void setUp() throws RemoteException {
+        MockitoAnnotations.initMocks(this);
+        mPackages = new ArrayList<>();
+        mParceledListSlice1 = new ParceledListSlice<>(mPackages);
+        when(mMockIPackageManager.getPackagesHoldingPermissions(
+                AdditionalMatchers.aryEq(new String[]{PERMISSION}),
+                eq((long) PackageManager.GET_PERMISSIONS),
+                eq(USER_ID1)))
+                .thenReturn(mParceledListSlice1);
+
+        mAppOpsManager = (AppOpsManager) mContext.getSystemService(Context.APP_OPS_SERVICE);
+        UserHandle userHandle = UserHandle.of(USER_ID1);
+        mBridge = new AppStateAppOpsBridge(mContext, APP_OP_CODE, PERMISSION, mMockIPackageManager,
+                Collections.singletonList(userHandle), mMockAppOpsManager);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                UserHandle.class, withSettings().lenient()).startMocking();
+
+        ExtendedMockito.when(UserHandle.getUserId(USER_ID1)).thenReturn(USER_ID1);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void androidPackagesIgnored() throws RemoteException {
+        String packageName = "android";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        addPackageWithPermission(packageInfo, AppOpsManager.MODE_ALLOWED);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNull();
+    }
+
+    @Test
+    public void selfPackageIgnored() throws RemoteException {
+        String packageName = mContext.getPackageName();
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        addPackageWithPermission(packageInfo, AppOpsManager.MODE_ALLOWED);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNull();
+    }
+
+    @Test
+    public void packagesNotRequestingPermissionIgnored() throws RemoteException {
+        String packageName = "test.package";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        packageInfo.requestedPermissions = null;
+        mPackages.add(packageInfo);
+        when(mMockIPackageManager.isPackageAvailable(packageInfo.packageName, USER_ID1))
+                .thenReturn(true);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNull();
+    }
+
+    @Test
+    public void additionalAppOpPermissionPackagesIncluded() throws RemoteException {
+        String packageName = "test.package";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        when(mMockIPackageManager.isPackageAvailable(packageInfo.packageName, USER_ID1))
+                .thenReturn(true);
+        packageInfo.requestedPermissions = new String[]{PERMISSION};
+
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+        assertThat(mPackages.contains(packageInfo)).isFalse();
+        assertThat(entry.extraInfo).isNull();
+
+        when(mMockIPackageManager.getAppOpPermissionPackages(PERMISSION, USER_ID1))
+                .thenReturn(new String[]{packageName});
+        when(mMockIPackageManager.getPackageInfo(
+                eq(packageName),
+                eq((long) PackageManager.GET_PERMISSIONS),
+                eq(USER_ID1)))
+                .thenReturn(packageInfo);
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+        assertThat(entry.extraInfo).isNotNull();
+    }
+
+    @Test
+    public void unavailablePackageIgnored() throws RemoteException {
+        String packageName = "test.package";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        addPackageWithPermission(packageInfo, AppOpsManager.MODE_ALLOWED);
+        when(mMockIPackageManager.isPackageAvailable(packageInfo.packageName, USER_ID1))
+                .thenReturn(false);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNull();
+    }
+
+    @Test
+    public void loadsAppOpsExtraInfo_modeAllowed_isPermissible() throws RemoteException {
+        String packageName = "test.package";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        addPackageWithPermission(packageInfo, AppOpsManager.MODE_ALLOWED);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+        assertThat(entry.extraInfo).isNull();
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNotNull();
+        assertThat(((AppStateAppOpsBridge.PermissionState) entry.extraInfo).isPermissible())
+                .isTrue();
+    }
+
+    @Test
+    public void loadsAppOpsExtraInfo_modeDefault_isPermissible() throws RemoteException {
+        String packageName = "test.package";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        addPackageWithPermission(packageInfo, AppOpsManager.MODE_DEFAULT);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+        assertThat(entry.extraInfo).isNull();
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNotNull();
+        assertThat(((AppStateAppOpsBridge.PermissionState) entry.extraInfo).isPermissible())
+                .isTrue();
+    }
+
+    @Test
+    public void loadsAppOpsExtraInfo_modeIgnored_isNotPermissible() throws RemoteException {
+        ExtendedMockito.when(UserHandle.getUserId(anyInt())).thenReturn(USER_ID1);
+
+        String packageName = "test.package";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        addPackageWithPermission(packageInfo, AppOpsManager.MODE_IGNORED);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+        assertThat(entry.extraInfo).isNull();
+
+        mockPackageOps(packageName, USER_ID1, AppOpsManager.MODE_IGNORED);
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNotNull();
+        assertThat(((AppStateAppOpsBridge.PermissionState) entry.extraInfo).isPermissible())
+                .isFalse();
+    }
+
+    @Test
+    public void loadsAppOpsExtraInfo_multipleApps() throws RemoteException {
+        String packageName1 = "test.package1";
+        PackageInfo packageInfo1 = createPackageInfo(packageName1, USER_ID1);
+        addPackageWithPermission(packageInfo1, AppOpsManager.MODE_ALLOWED);
+        ApplicationsState.AppEntry entry1 = createAppEntry(packageInfo1);
+
+        String packageName2 = "test.package2";
+        PackageInfo packageInfo2 = createPackageInfo(packageName2, USER_ID2);
+        addPackageWithPermission(packageInfo2, AppOpsManager.MODE_ALLOWED);
+        ApplicationsState.AppEntry entry2 = createAppEntry(packageInfo2);
+        ExtendedMockito.when(UserHandle.getUserId(USER_ID2)).thenReturn(USER_ID1);
+
+        mBridge.loadExtraInfo(Arrays.asList(entry1, entry2));
+
+        assertThat(entry1.extraInfo).isNotNull();
+        assertThat(entry2.extraInfo).isNotNull();
+    }
+
+    @Test
+    public void loadsAppOpExtraInfo_multipleProfiles() throws RemoteException {
+        String packageName1 = "test.package1";
+        PackageInfo packageInfo1 = createPackageInfo(packageName1, USER_ID1);
+        addPackageWithPermission(packageInfo1, AppOpsManager.MODE_ALLOWED);
+        ApplicationsState.AppEntry entry1 = createAppEntry(packageInfo1);
+
+        // Add a package for another profile.
+        String packageName2 = "test.package2";
+        PackageInfo packageInfo2 = createPackageInfo(packageName2, USER_ID2);
+        mParceledListSlice2 = new ParceledListSlice<>(Collections.singletonList(packageInfo2));
+        when(mMockIPackageManager.getPackagesHoldingPermissions(
+                AdditionalMatchers.aryEq(new String[]{PERMISSION}),
+                eq((long) PackageManager.GET_PERMISSIONS),
+                eq(USER_ID2)))
+                .thenReturn(mParceledListSlice2);
+        when(mMockIPackageManager.isPackageAvailable(packageInfo2.packageName,
+                USER_ID2)).thenReturn(true);
+        mAppOpsManager.setMode(APP_OP_CODE, packageInfo2.applicationInfo.uid,
+                packageInfo2.packageName, AppOpsManager.MODE_ALLOWED);
+        ApplicationsState.AppEntry entry2 = createAppEntry(packageInfo2);
+        ExtendedMockito.when(UserHandle.getUserId(USER_ID2)).thenReturn(USER_ID2);
+
+        // Recreate the bridge so it has all user profiles.
+        UserHandle userHandle1 = new UserHandle(USER_ID1);
+        UserHandle userHandle2 = new UserHandle(USER_ID2);
+        mBridge = new AppStateAppOpsBridge(mContext, APP_OP_CODE, PERMISSION, mMockIPackageManager,
+                Arrays.asList(userHandle1, userHandle2), mMockAppOpsManager);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mBridge.loadExtraInfo(Arrays.asList(entry1, entry2));
+
+        assertThat(entry1.extraInfo).isNotNull();
+        assertThat(entry2.extraInfo).isNotNull();
+    }
+
+    @Test
+    public void appEntryNotIncluded_extraInfoCleared() {
+        String packageName = "test.package";
+        PackageInfo packageInfo = createPackageInfo(packageName, USER_ID1);
+        ApplicationsState.AppEntry entry = createAppEntry(packageInfo);
+        entry.extraInfo = new Object();
+
+        mBridge.loadExtraInfo(Collections.singletonList(entry));
+
+        assertThat(entry.extraInfo).isNull();
+    }
+
+    private PackageInfo createPackageInfo(String packageName, int uid) {
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+        applicationInfo.packageName = packageName;
+        applicationInfo.uid = uid;
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.packageName = packageName;
+        packageInfo.applicationInfo = applicationInfo;
+        packageInfo.requestedPermissions = new String[]{PERMISSION};
+        packageInfo.requestedPermissionsFlags = new int[]{PackageInfo.REQUESTED_PERMISSION_GRANTED};
+
+        return packageInfo;
+    }
+
+    private void addPackageWithPermission(PackageInfo packageInfo, int mode)
+            throws RemoteException {
+        mPackages.add(packageInfo);
+        when(mMockIPackageManager.isPackageAvailable(packageInfo.packageName,
+                USER_ID1)).thenReturn(true);
+        mAppOpsManager.setMode(APP_OP_CODE, packageInfo.applicationInfo.uid,
+                packageInfo.packageName, mode);
+    }
+
+    private ApplicationsState.AppEntry createAppEntry(PackageInfo packageInfo) {
+        ApplicationsState.AppEntry appEntry = mock(ApplicationsState.AppEntry.class);
+        appEntry.info = packageInfo.applicationInfo;
+        return appEntry;
+    }
+
+    private void mockPackageOps(String packageName, int uid, int mode) {
+        AppOpsManager.OpEntry opEntry = mock(AppOpsManager.OpEntry.class);
+        when(opEntry.getMode()).thenReturn(mode);
+        AppOpsManager.PackageOps packageOps = new AppOpsManager.PackageOps(packageName, uid,
+                Collections.singletonList(opEntry));
+        List<AppOpsManager.PackageOps> packageOpsList = Collections.singletonList(packageOps);
+        when(mMockAppOpsManager.getPackagesForOps((int[]) any())).thenReturn(packageOpsList);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppStatePremiumSmsBridgeTest.java b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppStatePremiumSmsBridgeTest.java
new file mode 100644
index 000000000..3aa494424
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/AppStatePremiumSmsBridgeTest.java
@@ -0,0 +1,81 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.specialaccess;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.content.pm.ApplicationInfo;
+import android.telephony.SmsManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public class AppStatePremiumSmsBridgeTest {
+
+    private AppStatePremiumSmsBridge mBridge;
+
+    @Mock
+    private SmsManager mSmsManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mBridge = new AppStatePremiumSmsBridge(mSmsManager);
+    }
+
+    @Test
+    public void loadExtraInfo() {
+        String package1 = "test.package1";
+        ApplicationsState.AppEntry appEntry1 = createAppEntry(package1);
+        int value1 = SmsManager.PREMIUM_SMS_CONSENT_ALWAYS_ALLOW;
+        when(mSmsManager.getPremiumSmsConsent(package1)).thenReturn(value1);
+
+        String package2 = "test.package2";
+        ApplicationsState.AppEntry appEntry2 = createAppEntry(package2);
+        int value2 = SmsManager.PREMIUM_SMS_CONSENT_NEVER_ALLOW;
+        when(mSmsManager.getPremiumSmsConsent(package2)).thenReturn(value2);
+
+        mBridge.loadExtraInfo(Arrays.asList(appEntry1, appEntry2));
+
+        assertThat(appEntry1.extraInfo).isEqualTo(value1);
+        assertThat(appEntry2.extraInfo).isEqualTo(value2);
+    }
+
+    private ApplicationsState.AppEntry createAppEntry(String packageName) {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = packageName;
+
+        ApplicationsState.AppEntry appEntry = mock(ApplicationsState.AppEntry.class);
+        appEntry.info = info;
+        appEntry.label = packageName;
+
+        return appEntry;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/specialaccess/MoreSpecialAccessPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/MoreSpecialAccessPreferenceControllerTest.java
new file mode 100644
index 000000000..c9a838814
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/MoreSpecialAccessPreferenceControllerTest.java
@@ -0,0 +1,251 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.specialaccess;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class MoreSpecialAccessPreferenceControllerTest {
+
+    private static final String PACKAGE = "test.package";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private Intent mIntent;
+    private ResolveInfo mResolveInfo;
+    private MoreSpecialAccessPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mIntent = new Intent(Intent.ACTION_MANAGE_SPECIAL_APP_ACCESSES);
+        mIntent.setPackage(PACKAGE);
+
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+        applicationInfo.packageName = PACKAGE;
+        applicationInfo.name = "TestClass";
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.applicationInfo = applicationInfo;
+
+        mResolveInfo = new ResolveInfo();
+        mResolveInfo.activityInfo = activityInfo;
+    }
+
+    @Test
+    public void getAvailabilityStatus_noPermissionController_returnsUnsupportedOnDevice() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(null);
+        setUpPreferenceController();
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noPermissionController_zoneWrite() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(null);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noPermissionController_zoneRead() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(null);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noPermissionController_zoneHidden() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(null);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noResolvedActivity_returnsUnsupportedOnDevice() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(null);
+        setUpPreferenceController();
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noResolvedActivity_returnsUnsupportedOnDevice_zoneWrite() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(null);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noResolvedActivity_returnsUnsupportedOnDevice_zoneRead() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(null);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noResolvedActivity_returnsUnsupportedOnDevice_zoneHidden() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(null);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_resolvedActivity_returnsAvailable() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(mResolveInfo);
+        setUpPreferenceController();
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_resolvedActivity_returnsAvailable_zoneWrite() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(mResolveInfo);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_resolvedActivity_returnsAvailable_zoneRead() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(mResolveInfo);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_resolvedActivity_returnsAvailable_zoneHidden() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(mResolveInfo);
+        setUpPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void preferenceClicked_startsResolvedActivity() {
+        when(mMockPackageManager.getPermissionControllerPackageName()).thenReturn(PACKAGE);
+        when(mMockPackageManager.resolveActivity(any(), eq(PackageManager.MATCH_DEFAULT_ONLY)))
+                .thenReturn(mResolveInfo);
+        doNothing().when(mContext).startActivity(any());
+        setUpPreferenceController();
+
+        mPreference.performClick();
+
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_SPECIAL_APP_ACCESSES);
+        assertThat(intent.getPackage()).isEqualTo(PACKAGE);
+    }
+
+    private void setUpPreferenceController() {
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new MoreSpecialAccessPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockPackageManager);
+
+        mPreference = new CarUiPreference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/specialaccess/NotificationAccessPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/NotificationAccessPreferenceControllerTest.java
new file mode 100644
index 000000000..6d3641970
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/NotificationAccessPreferenceControllerTest.java
@@ -0,0 +1,272 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.specialaccess;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.app.NotificationManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ServiceInfo;
+import android.content.res.Resources;
+import android.os.AsyncTask;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.preference.TwoStatePreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.PollingCheck;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class NotificationAccessPreferenceControllerTest {
+
+    private static final String PACKAGE_NAME = "com.android.test.package";
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private NotificationAccessPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ServiceInfo mListenerServiceInfo;
+    private ComponentName mListenerComponent;
+    private ApplicationInfo mApplicationInfo;
+    private NotificationManager mNotificationManager;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private Resources mMockResources;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mNotificationManager = spy(mContext.getSystemService(NotificationManager.class));
+        mPreferenceController = new NotificationAccessPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mNotificationManager);
+
+        PreferenceControllerTestUtil
+                .assignPreference(mPreferenceController, mPreferenceGroup);
+
+        mListenerServiceInfo = new ServiceInfo();
+        mListenerServiceInfo.permission = Manifest.permission.BIND_NOTIFICATION_LISTENER_SERVICE;
+        mListenerServiceInfo.packageName = PACKAGE_NAME;
+        mListenerServiceInfo.name = "SomeListenerService";
+        mListenerServiceInfo.nonLocalizedLabel = "label";
+        mApplicationInfo = new ApplicationInfo();
+        mApplicationInfo.uid = 123;
+        mApplicationInfo.name = "SomeApplicationInfo";
+        mListenerServiceInfo.applicationInfo = mApplicationInfo;
+
+        mListenerComponent = new ComponentName(mListenerServiceInfo.packageName,
+                mListenerServiceInfo.name);
+    }
+
+    @Test
+    public void onStart_loadsListenerServices_preferenceEnabled()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */true, mListenerServiceInfo);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onStart_loadsFixedPackage_preferenceDisabled()
+            throws PackageManager.NameNotFoundException {
+        String[] fixedPackages = new String[] {PACKAGE_NAME};
+        when(mContext.getResources()).thenReturn(mMockResources);
+        when(mMockResources.getStringArray(anyInt()))
+                .thenReturn(fixedPackages);
+        mPreferenceController = new NotificationAccessPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mNotificationManager);
+
+        PreferenceControllerTestUtil
+                .assignPreference(mPreferenceController, mPreferenceGroup);
+
+        setupPreferenceController(/* permissionGranted= */ true, mListenerServiceInfo);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onStart_serviceAccessGranted_setsPreferenceChecked()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */true, mListenerServiceInfo);
+
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onStart_serviceAccessNotGranted_setsPreferenceUnchecked()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */false, mListenerServiceInfo);
+
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void preferenceClicked_serviceAccessGranted_showsRevokeConfirmDialog()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */true, mListenerServiceInfo);
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+
+        preference.performClick();
+
+        verify(mMockFragmentController).showDialog(any(
+                ConfirmationDialogFragment.class),
+                eq(NotificationAccessPreferenceController.REVOKE_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    public void preferenceClicked_serviceAccessNotGranted_showsGrantConfirmDialog()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */false, mListenerServiceInfo);
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+
+        preference.performClick();
+
+        verify(mMockFragmentController).showDialog(any(
+                ConfirmationDialogFragment.class),
+                eq(NotificationAccessPreferenceController.GRANT_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    public void revokeConfirmed_revokesNotificationAccess()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */true, mListenerServiceInfo);
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+        preference.performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(NotificationAccessPreferenceController.REVOKE_CONFIRM_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(/* dialog= */ null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(mNotificationManager.isNotificationListenerAccessGranted(mListenerComponent))
+                .isFalse();
+    }
+
+    @Test
+    public void revokeConfirmed_notificationPolicyAccessNotGranted_removesAutomaticZenRules()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */true, mListenerServiceInfo);
+
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+        preference.performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(NotificationAccessPreferenceController.REVOKE_CONFIRM_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        mNotificationManager.setNotificationPolicyAccessGranted(
+                mListenerServiceInfo.packageName, /* granted= */ false);
+        dialogFragment.onClick(/* dialog= */ null, DialogInterface.BUTTON_POSITIVE);
+
+        PollingCheck.waitFor(
+                () -> mPreferenceController.mAsyncTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mNotificationManager).removeAutomaticZenRules(any());
+    }
+
+    @Test
+    public void grantConfirmed_grantsNotificationAccess()
+            throws PackageManager.NameNotFoundException {
+        setupPreferenceController(/* permissionGranted= */false, mListenerServiceInfo);
+        TwoStatePreference preference = (TwoStatePreference) mPreferenceGroup.getPreference(0);
+        preference.performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(NotificationAccessPreferenceController.GRANT_CONFIRM_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(/* dialog= */ null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(mNotificationManager.isNotificationListenerAccessGranted(mListenerComponent))
+                .isTrue();
+    }
+
+    private void setupPreferenceController(boolean permissionGranted, ServiceInfo serviceInfo)
+            throws PackageManager.NameNotFoundException {
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mMockPackageManager.getApplicationInfoAsUser(mListenerServiceInfo.packageName,
+                /* flags= */ 0, UserHandle.myUserId())).thenReturn(mApplicationInfo);
+
+        mNotificationManager.setNotificationListenerAccessGranted(mListenerComponent,
+                /* granted= */ permissionGranted);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onServicesReloaded(Collections.singletonList(serviceInfo));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/applications/specialaccess/PremiumSmsAccessPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/PremiumSmsAccessPreferenceControllerTest.java
new file mode 100644
index 000000000..423614239
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/applications/specialaccess/PremiumSmsAccessPreferenceControllerTest.java
@@ -0,0 +1,203 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.applications.specialaccess;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.os.Looper;
+import android.telephony.SmsManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class PremiumSmsAccessPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private PremiumSmsAccessPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private AppEntryListManager mMockAppEntryListManager;
+    @Mock
+    private ApplicationsState mMockApplicationsState;
+    @Mock
+    private SmsManager mMockSmsManager;
+    @Captor
+    private ArgumentCaptor<AppEntryListManager.Callback> mCallbackCaptor;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        when(mMockApplicationsState.getBackgroundLooper()).thenReturn(Looper.getMainLooper());
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new PremiumSmsAccessPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockSmsManager, mMockAppEntryListManager);
+
+        PreferenceControllerTestUtil
+                .assignPreference(mPreferenceController, mPreferenceGroup);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockAppEntryListManager).init(any(AppStatePremiumSmsBridge.class), any(),
+                mCallbackCaptor.capture());
+    }
+
+    @Test
+    public void onStart_startsListManager() {
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mMockAppEntryListManager).start();
+    }
+
+    @Test
+    public void onStop_stopsListManager() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockAppEntryListManager).stop();
+    }
+
+    @Test
+    public void onDestroy_destroysListManager() {
+        mPreferenceController.onDestroy(mLifecycleOwner);
+
+        verify(mMockAppEntryListManager).destroy();
+    }
+
+    @Test
+    public void onAppEntryListChanged_addsPreferencesForEntries() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        List<ApplicationsState.AppEntry> entries = Arrays.asList(
+                createAppEntry("test.package", /* uid= */ 1,
+                        SmsManager.PREMIUM_SMS_CONSENT_ALWAYS_ALLOW),
+                createAppEntry("another.test.package", /* uid= */ 2,
+                        SmsManager.PREMIUM_SMS_CONSENT_NEVER_ALLOW));
+
+        mCallbackCaptor.getValue().onAppEntryListChanged(entries);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+        assertThat(((ListPreference) mPreferenceGroup.getPreference(0)).getValue()).isEqualTo(
+                String.valueOf(SmsManager.PREMIUM_SMS_CONSENT_ALWAYS_ALLOW));
+        assertThat(((ListPreference) mPreferenceGroup.getPreference(1)).getValue()).isEqualTo(
+                String.valueOf(SmsManager.PREMIUM_SMS_CONSENT_NEVER_ALLOW));
+    }
+
+    @Test
+    public void onPreferenceChange_setsPremiumSmsPermission() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        String packageName = "test.package";
+        List<ApplicationsState.AppEntry> entries = Collections.singletonList(
+                createAppEntry(packageName, /* uid= */ 1,
+                        SmsManager.PREMIUM_SMS_CONSENT_NEVER_ALLOW));
+        mCallbackCaptor.getValue().onAppEntryListChanged(entries);
+        Preference appPref = mPreferenceGroup.getPreference(0);
+        int updatedValue = SmsManager.PREMIUM_SMS_CONSENT_ASK_USER;
+
+        appPref.getOnPreferenceChangeListener().onPreferenceChange(appPref,
+                String.valueOf(updatedValue));
+
+        verify(mMockSmsManager).setPremiumSmsConsent(packageName, updatedValue);
+    }
+
+    @Test
+    public void onPreferenceChange_updatesEntry() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        List<ApplicationsState.AppEntry> entries = Collections.singletonList(
+                createAppEntry("test.package", /* uid= */ 1,
+                        SmsManager.PREMIUM_SMS_CONSENT_NEVER_ALLOW));
+        mCallbackCaptor.getValue().onAppEntryListChanged(entries);
+        Preference appPref = mPreferenceGroup.getPreference(0);
+
+        appPref.getOnPreferenceChangeListener().onPreferenceChange(appPref,
+                String.valueOf(SmsManager.PREMIUM_SMS_CONSENT_ASK_USER));
+
+        verify(mMockAppEntryListManager).forceUpdate(entries.get(0));
+    }
+
+    @Test
+    public void appFilter_removesUnknownStates() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        ArgumentCaptor<AppEntryListManager.AppFilterProvider> filterCaptor =
+                ArgumentCaptor.forClass(AppEntryListManager.AppFilterProvider.class);
+        verify(mMockAppEntryListManager).init(any(), filterCaptor.capture(), any());
+        ApplicationsState.AppFilter filter = filterCaptor.getValue().getAppFilter();
+        ApplicationsState.AppEntry unknownStateApp = createAppEntry("test.package", /* uid= */ 1,
+                SmsManager.PREMIUM_SMS_CONSENT_UNKNOWN);
+
+        assertThat(filter.filterApp(unknownStateApp)).isFalse();
+    }
+
+    private ApplicationsState.AppEntry createAppEntry(String packageName, int uid, int smsState) {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = packageName;
+        info.uid = uid;
+
+        ApplicationsState.AppEntry appEntry = mock(ApplicationsState.AppEntry.class);
+        appEntry.info = info;
+        appEntry.label = packageName;
+        appEntry.extraInfo = smsState;
+
+        return appEntry;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothAddressPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothAddressPreferenceControllerTest.java
new file mode 100644
index 000000000..071c0c306
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothAddressPreferenceControllerTest.java
@@ -0,0 +1,90 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothAdapter;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothAddressPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private BluetoothAddressPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private CarUiPreference mPreference;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private BluetoothAdapter mBluetoothAdapter;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new BluetoothAddressPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mBluetoothAdapter);
+
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+    }
+
+    @Test
+    public void refreshUi_setsAddress() {
+        String address = "address";
+        when(mBluetoothAdapter.getAddress()).thenReturn(address);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.bluetooth_vehicle_mac_address, address));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothBondedDevicesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothBondedDevicesPreferenceControllerTest.java
new file mode 100644
index 000000000..6e805b7a9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothBondedDevicesPreferenceControllerTest.java
@@ -0,0 +1,443 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothDevice;
+import android.bluetooth.BluetoothProfile;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.os.UserManager;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.MultiActionPreference;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.ToggleButtonActionItem;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothAdapter;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+import com.android.settingslib.bluetooth.LocalBluetoothProfile;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.Arrays;
+import java.util.Collection;
+import java.util.List;
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothBondedDevicesPreferenceControllerTest {
+    private static final String TEST_RESTRICTION = UserManager.DISALLOW_CONFIG_BLUETOOTH;
+
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private PreferenceGroup mPreferenceGroup;
+    private BluetoothBondedDevicesPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private LocalBluetoothProfile mPhoneProfile;
+    private LocalBluetoothProfile mMediaProfile;
+    private LocalBluetoothManager mLocalBluetoothManager;
+    private Collection<CachedBluetoothDevice> mCachedDevices;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CachedBluetoothDevice mBondedCachedDevice;
+    @Mock
+    private BluetoothDevice mBondedDevice;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private CachedBluetoothDeviceManager mCachedDeviceManager;
+    @Mock
+    private LocalBluetoothAdapter mLocalBluetoothAdapter;
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        Context mSpiedContext = spy(mContext);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mBondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDED);
+        when(mBondedCachedDevice.getDevice()).thenReturn(mBondedDevice);
+
+        mPhoneProfile =
+                new BluetoothTestUtils.TestLocalBluetoothProfile(BluetoothProfile.HEADSET_CLIENT);
+        mMediaProfile =
+                new BluetoothTestUtils.TestLocalBluetoothProfile(BluetoothProfile.A2DP_SINK);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(List.of(mPhoneProfile, mMediaProfile));
+
+        BluetoothDevice unbondedDevice = mock(BluetoothDevice.class);
+        when(unbondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        CachedBluetoothDevice unbondedCachedDevice = mock(CachedBluetoothDevice.class);
+        when(unbondedCachedDevice.getDevice()).thenReturn(unbondedDevice);
+
+        mCachedDevices = Arrays.asList(mBondedCachedDevice, unbondedCachedDevice);
+
+        mLocalBluetoothManager = spy(BluetoothUtils.getLocalBtManager(mSpiedContext));
+        when(mLocalBluetoothManager.getCachedDeviceManager()).thenReturn(mCachedDeviceManager);
+        when(mCachedDeviceManager.getCachedDevicesCopy()).thenReturn(mCachedDevices);
+        when(mLocalBluetoothManager.getBluetoothAdapter()).thenReturn(mLocalBluetoothAdapter);
+        when(mLocalBluetoothAdapter.getBondedDevices()).thenReturn(Set.of(mBondedDevice));
+
+        when(mSpiedContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mSpiedContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mSpiedContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mSpiedContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new BluetoothBondedDevicesPreferenceController(mSpiedContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mLocalBluetoothManager, mUserManager);
+
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void showsOnlyBondedDevices() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+        assertThat(devicePreference.getCachedDevice()).isEqualTo(mBondedCachedDevice);
+    }
+
+    @Test
+    public void onDeviceBondStateChanged_refreshesUi() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+
+        // Unbond the only bonded device.
+        when(mBondedCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mBondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mLocalBluetoothAdapter.getBondedDevices()).thenReturn(Set.of());
+        mPreferenceController.onDeviceBondStateChanged(mBondedCachedDevice,
+                BluetoothDevice.BOND_NONE);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onDeviceClicked_connected_launchesDeviceDetailsFragment() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        verify(mFragmentController).launchFragment(
+                any(BluetoothDeviceDetailsFragment.class));
+    }
+
+    @Test
+    public void bluetoothButtonClicked_connected_disconnectsFromDevice() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        ToggleButtonActionItem bluetoothButton = devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1);
+        assertThat(bluetoothButton.isVisible()).isTrue();
+        bluetoothButton.onClick();
+
+        verify(mBondedCachedDevice).disconnect();
+    }
+
+    @Test
+    public void bluetoothButtonClicked_notConnected_connectsToDevice() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(false);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        ToggleButtonActionItem bluetoothButton = devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1);
+        assertThat(bluetoothButton.isEnabled()).isTrue();
+        bluetoothButton.onClick();
+
+        verify(mBondedCachedDevice).connect();
+    }
+
+    @Test
+    public void phoneButtonClicked_phoneProfile_enabled() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        ToggleButtonActionItem phoneButton = devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2);
+        assertThat(phoneButton.isEnabled()).isTrue();
+        assertThat(mPhoneProfile.isEnabled(mBondedDevice)).isFalse();
+        phoneButton.onClick();
+
+        assertThat(mPhoneProfile.isEnabled(mBondedDevice)).isTrue();
+    }
+
+    @Test
+    public void mediaButtonClicked_mediaProfile_enabled() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        ToggleButtonActionItem mediaButton = devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3);
+        mediaButton.onClick();
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(mMediaProfile.isEnabled(mBondedDevice)).isTrue();
+    }
+
+    @Test
+    public void actionButtons_disallowConfigBluetooth_bluetoothActionStaysDisabled() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1).isEnabled()).isTrue();
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2).isEnabled()).isFalse();
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3).isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_hasRestrictions_actionButtonDisabled() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(restrictions);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1).isEnabled()).isTrue();
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2).isEnabled()).isFalse();
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3).isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_restrictionToggled_actionButtonsEnabled() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(restrictions);
+
+        CarUxRestrictions noRestrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_BASELINE, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(noRestrictions);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1).isEnabled()).isTrue();
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2).isEnabled()).isTrue();
+        assertThat(devicePreference.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3).isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onUxRestrictionsNoSetup_phoneItemClicked_showsToast() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(restrictions);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Due to the limitations of the testing environment, onBindViewHolder() is never called and
+        // thus certain fields are never set. Manually set it here.
+        ToggleButtonActionItem phoneItem =
+                devicePreference.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2);
+        String toastText = mContext.getResources()
+                .getString(R.string.car_ui_restricted_while_driving);
+        phoneItem.setRestrictedOnClickListener(p -> Toast.makeText(mContext, toastText,
+                        Toast.LENGTH_LONG).show());
+        phoneItem.setPreference(devicePreference);
+
+        phoneItem.onClick();
+
+        ExtendedMockito.verify(() -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    @Test
+    public void onUxRestrictionsNoSetup_mediaItemClicked_showsToast() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(restrictions);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Due to the limitations of the testing environment, onBindViewHolder() is never called and
+        // thus certain fields are never set. Manually set them here.
+        ToggleButtonActionItem mediaItem =
+                devicePreference.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3);
+        String toastText = mContext.getResources()
+                .getString(R.string.car_ui_restricted_while_driving);
+        mediaItem.setRestrictedOnClickListener(p -> Toast.makeText(mContext, toastText,
+                Toast.LENGTH_LONG).show());
+        mediaItem.setPreference(devicePreference);
+
+        mediaItem.onClick();
+
+        ExtendedMockito.verify(() -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    @Test
+    public void onUxRestrictionsDisallowConfigBluetooth_phoneItemClicked_showsDialog() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        String toastText = mContext.getResources().getString(R.string.action_unavailable);
+
+        devicePreference.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2).onClick();
+
+        verify(mFragmentController).showDialog(any(), any());
+    }
+
+    @Test
+    public void onUxRestrictionsDisallowConfigBluetooth_mediaItemClicked_showsDialog() {
+        when(mBondedCachedDevice.isConnected()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        String toastText = mContext.getResources().getString(R.string.action_unavailable);
+
+        devicePreference.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3).onClick();
+
+        verify(mFragmentController).showDialog(any(), any());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceActionButtonsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceActionButtonsPreferenceControllerTest.java
new file mode 100644
index 000000000..80835594d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceActionButtonsPreferenceControllerTest.java
@@ -0,0 +1,182 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ActionButtonInfo;
+import com.android.car.settings.common.ActionButtonsPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothDeviceActionButtonsPreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private ActionButtonsPreference mActionButtonsPreference;
+    private BluetoothDeviceActionButtonsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CachedBluetoothDevice mCachedDevice;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        String address = "00:11:22:33:AA:BB";
+        when(mCachedDevice.getAddress()).thenReturn(address);
+
+        mActionButtonsPreference = new ActionButtonsPreference(mContext);
+        mPreferenceController = new BluetoothDeviceActionButtonsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setCachedDevice(mCachedDevice);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mActionButtonsPreference);
+    }
+
+    @Test
+    public void forgetButtonClicked_unpairsDevice() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        findForgetButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mCachedDevice).unpair();
+    }
+
+    @Test
+    public void forgetButtonClicked_goesBack() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        findForgetButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).goBack();
+    }
+
+    @Test
+    public void connectionButtonClicked_deviceConnected_disconnectsDevice() {
+        when(mCachedDevice.isConnected()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        findConnectionButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mCachedDevice).disconnect();
+    }
+
+    @Test
+    public void connectionButtonClicked_deviceNotConnected_connectsDevice() {
+        when(mCachedDevice.isConnected()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        findConnectionButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mCachedDevice).connect();
+    }
+
+    @Test
+    public void deviceConnected_connectionButtonShowsDisconnect() {
+        when(mCachedDevice.isConnected()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(findConnectionButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "disconnect"));
+    }
+
+    @Test
+    public void deviceNotConnected_connectionButtonShowsConnect() {
+        when(mCachedDevice.isConnected()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(findConnectionButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "connect"));
+    }
+
+    @Test
+    public void deviceBusy_connectionButtonDisabled() {
+        when(mCachedDevice.isBusy()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(findConnectionButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void deviceNotBusy_connectionButtonEnabled() {
+        when(mCachedDevice.isBusy()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(findConnectionButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void deviceAttributesChanged_updatesConnectionButtonState() {
+        when(mCachedDevice.isBusy()).thenReturn(true);
+        ArgumentCaptor<CachedBluetoothDevice.Callback> callbackCaptor = ArgumentCaptor.forClass(
+                CachedBluetoothDevice.Callback.class);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        assertThat(findConnectionButton().isEnabled()).isFalse();
+        verify(mCachedDevice).registerCallback(callbackCaptor.capture());
+
+        when(mCachedDevice.isBusy()).thenReturn(false);
+        callbackCaptor.getValue().onDeviceAttributesChanged();
+
+        assertThat(findConnectionButton().isEnabled()).isTrue();
+    }
+
+    private ActionButtonInfo findForgetButton() {
+        return mActionButtonsPreference.getButton(ActionButtons.BUTTON2);
+    }
+
+    private ActionButtonInfo findConnectionButton() {
+        return mActionButtonsPreference.getButton(ActionButtons.BUTTON1);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceAddressPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceAddressPreferenceControllerTest.java
new file mode 100644
index 000000000..326c222ba
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceAddressPreferenceControllerTest.java
@@ -0,0 +1,90 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothDeviceAddressPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private BluetoothDeviceAddressPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private CarUiPreference mPreference;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CachedBluetoothDevice mCachedBluetoothDevice;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new BluetoothDeviceAddressPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setCachedDevice(mCachedBluetoothDevice);
+
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+    }
+
+    @Test
+    public void refreshUi_setsAddress() {
+        String address = "address";
+        when(mCachedBluetoothDevice.getAddress()).thenReturn(address);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.bluetooth_device_mac_address, address));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceNamePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceNamePreferenceControllerTest.java
new file mode 100644
index 000000000..b99c7bbe5
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceNamePreferenceControllerTest.java
@@ -0,0 +1,188 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothClass;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.os.Parcel;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.StringJoiner;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothDeviceNamePreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private BluetoothDeviceNamePreferenceController mPreferenceController;
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    private BluetoothClass createBtClass(int deviceClass) {
+        Parcel p = Parcel.obtain();
+        p.writeInt(deviceClass);
+        p.setDataPosition(0); // reset position of parcel before passing to constructor
+
+        BluetoothClass bluetoothClass = BluetoothClass.CREATOR.createFromParcel(p);
+        p.recycle();
+        return bluetoothClass;
+    }
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CachedBluetoothDevice mCachedDevice;
+    @Mock
+    private CachedBluetoothDeviceManager mCachedDeviceManager;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreference.setSelectable(true);
+        mPreferenceController = new TestBluetoothDeviceNamePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setCachedDevice(mCachedDevice);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_setsDeviceNameAsTitle() {
+        String name = "name";
+        when(mCachedDevice.getName()).thenReturn(name);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getTitle()).isEqualTo(name);
+    }
+
+    @Test
+    public void refreshUi_connected_setsCarConnectionSummaryAsSummary() {
+        String summary = "summary";
+        when(mCachedDevice.isConnected()).thenReturn(true);
+        when(mCachedDevice.getCarConnectionSummary()).thenReturn(summary);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getSummary()).isEqualTo(summary);
+    }
+
+    @Test
+    public void refreshUi_notConnectedsetsCarConnectionSummaryAsSummary() {
+        String summary = "summary";
+        when(mCachedDevice.isConnected()).thenReturn(false);
+        when(mCachedDevice.getCarConnectionSummary()).thenReturn(summary);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getSummary()).isEqualTo(summary);
+    }
+
+    @Test
+    public void refreshUi_setsIcon() {
+        when(mCachedDevice.getBtClass()).thenReturn(
+                createBtClass(BluetoothClass.Device.Major.PHONE));
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getIcon()).isNotNull();
+    }
+
+    @Test
+    public void refreshUi_hearingAidDevice_setsBatteryStatusesAsSummary() {
+        String summary = "summary";
+        when(mCachedDevice.isConnected()).thenReturn(true);
+        when(mCachedDevice.getCarConnectionSummary()).thenReturn(summary);
+        String otherSummary = "other summary";
+        when(mCachedDeviceManager.getSubDeviceSummary(mCachedDevice)).thenReturn("other summary");
+
+        mPreferenceController.refreshUi();
+
+        String expected = new StringJoiner(System.lineSeparator()).add(summary).add(
+                otherSummary).toString();
+        assertThat(mPreference.getSummary()).isEqualTo(expected);
+    }
+
+    @Test
+    public void preferenceClicked_launchesRenameDialog() {
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        verify(mFragmentController).showDialog(any(RemoteRenameDialogFragment.class),
+                eq(RemoteRenameDialogFragment.TAG));
+    }
+
+    @Test
+    public void preferenceClicked_handled() {
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.getOnPreferenceClickListener()
+                .onPreferenceClick(mPreference)).isTrue();
+    }
+
+    private class TestBluetoothDeviceNamePreferenceController
+            extends BluetoothDeviceNamePreferenceController {
+
+        TestBluetoothDeviceNamePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CachedBluetoothDeviceManager getCachedDeviceManager() {
+            return mCachedDeviceManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePickerFragmentTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePickerFragmentTest.java
new file mode 100644
index 000000000..baa284f71
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePickerFragmentTest.java
@@ -0,0 +1,135 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.ToolbarController;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.BluetoothEventManager;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothDevicePickerFragmentTest {
+    private BluetoothDevicePickerFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MockitoSession mSession;
+
+    @Mock
+    private LocalBluetoothManager mMockManager;
+    @Mock
+    private BluetoothEventManager mMockEventManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                BluetoothUtils.class, withSettings().lenient()).startMocking();
+        when(BluetoothUtils.getLocalBtManager(any())).thenReturn(
+                mMockManager);
+        when(mMockManager.getEventManager()).thenReturn(mMockEventManager);
+        CachedBluetoothDeviceManager cbdm = mock(CachedBluetoothDeviceManager.class);
+        when(mMockManager.getCachedDeviceManager()).thenReturn(cbdm);
+        setUpFragment();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onStart_setsBluetoothManagerForegroundActivity() {
+        verify(mMockManager).setForegroundActivity(mFragment.requireActivity());
+    }
+
+    @Test
+    public void onStart_showsProgressBar() {
+        ToolbarController toolbar = mActivity.getToolbar();
+
+        assertThat(toolbar.getProgressBar().isVisible()).isTrue();
+    }
+
+    @Test
+    public void onStop_clearsBluetoothManagerForegroundActivity() throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragment.onStop();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockManager).setForegroundActivity(null);
+    }
+
+    @Test
+    public void onStop_hidesProgressBar() throws Throwable {
+        ToolbarController toolbar = mActivity.getToolbar();
+        toolbar.getProgressBar().setVisible(true);
+
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragment.onStop();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(toolbar.getProgressBar().isVisible()).isFalse();
+    }
+
+    private void setUpFragment() throws Throwable {
+        String bluetoothDevicePickerFragmentTag = "bluetooth_device_picker_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new BluetoothDevicePickerFragment(),
+                            bluetoothDevicePickerFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (BluetoothDevicePickerFragment)
+                mFragmentManager.findFragmentByTag(bluetoothDevicePickerFragmentTag);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePickerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePickerPreferenceControllerTest.java
new file mode 100644
index 000000000..7df244c4d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePickerPreferenceControllerTest.java
@@ -0,0 +1,404 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.inOrder;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothDevice;
+import android.bluetooth.BluetoothDevicePicker;
+import android.bluetooth.BluetoothManager;
+import android.bluetooth.BluetoothUuid;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.os.IBinder;
+import android.os.ParcelUuid;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.BluetoothEventManager;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.InOrder;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothDevicePickerPreferenceControllerTest {
+    private static final String ALLOWED_LAUNCH_PACKAGE = "com.android.car.settings.tests.unit";
+    private static final String DEFAULT_LAUNCH_PACKAGE = "test.package";
+    private static final String DEFAULT_LAUNCH_CLASS = "TestClass";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private PreferenceGroup mPreferenceGroup;
+    private BluetoothDevicePickerPreferenceController mPreferenceController;
+    private MockitoSession mSession;
+
+    @Mock
+    private LocalBluetoothManager mLocalBluetoothManager;
+    @Mock
+    private BluetoothEventManager mBluetoothEventManager;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CachedBluetoothDevice mUnbondedCachedDevice;
+    @Mock
+    private BluetoothDevice mUnbondedDevice;
+    @Mock
+    private CachedBluetoothDevice mBondedCachedDevice;
+    @Mock
+    private BluetoothDevice mBondedDevice;
+    @Mock
+    private CachedBluetoothDeviceManager mCachedDeviceManager;
+    @Mock
+    private BluetoothAdapter mMockBluetoothAdapter;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        when(mLocalBluetoothManager.getCachedDeviceManager()).thenReturn(mCachedDeviceManager);
+        when(mLocalBluetoothManager.getEventManager()).thenReturn(mBluetoothEventManager);
+        when(mUnbondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mUnbondedCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mUnbondedCachedDevice.getDevice()).thenReturn(mUnbondedDevice);
+        when(mBondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDED);
+        when(mBondedCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDED);
+        when(mBondedCachedDevice.getDevice()).thenReturn(mBondedDevice);
+        when(mCachedDeviceManager.getCachedDevicesCopy()).thenReturn(
+                Arrays.asList(mUnbondedCachedDevice, mBondedCachedDevice));
+        // Make bonded device appear first in the list.
+        when(mBondedCachedDevice.compareTo(mUnbondedCachedDevice)).thenReturn(-1);
+        when(mUnbondedCachedDevice.compareTo(mBondedCachedDevice)).thenReturn(1);
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(BluetoothUtils.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        when(BluetoothUtils.getLocalBtManager(mContext)).thenReturn(mLocalBluetoothManager);
+        when(BluetoothUtils.shouldEnableBTScanning(eq(mContext), any())).thenReturn(true);
+        BluetoothManager bluetoothManager = mock(BluetoothManager.class);
+        when(bluetoothManager.getAdapter()).thenReturn(mMockBluetoothAdapter);
+        when(mContext.getSystemService(BluetoothManager.class)).thenReturn(bluetoothManager);
+
+        mPreferenceController = new TestBluetoothDevicePickerPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController,
+                mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void checkInitialized_noLaunchIntentSet_throwsIllegalStateException() {
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreferenceGroup));
+    }
+
+    @Test
+    public void onStart_appliesFilterType() {
+        // Setup device to pass the filter.
+        when(mBondedDevice.getUuids()).thenReturn(new ParcelUuid[]{BluetoothUuid.A2DP_SINK});
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ false,
+                BluetoothDevicePicker.FILTER_TYPE_AUDIO, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(((BluetoothDevicePreference) mPreferenceGroup.getPreference(
+                0)).getCachedDevice()).isEqualTo(mBondedCachedDevice);
+    }
+
+    @Test
+    public void onDeviceClicked_callingPackageEqualToLaunchPackage_setsClassName() {
+        ComponentName component = new ComponentName(ALLOWED_LAUNCH_PACKAGE, DEFAULT_LAUNCH_CLASS);
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, component.getPackageName(),
+                component.getClassName());
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).sendBroadcast(captor.capture());
+        Intent pickedIntent = captor.getValue();
+        assertThat(pickedIntent.getAction()).isEqualTo(
+                BluetoothDevicePicker.ACTION_DEVICE_SELECTED);
+        assertThat(pickedIntent.getComponent()).isEqualTo(component);
+        assertThat((BluetoothDevice) pickedIntent.getParcelableExtra(
+                BluetoothDevice.EXTRA_DEVICE)).isEqualTo(mBondedDevice);
+    }
+
+    @Test
+    public void onDeviceClicked_callingPackageNotEqualToLaunchPackage_doesNotSetClassName() {
+        ComponentName component = new ComponentName(DEFAULT_LAUNCH_PACKAGE, DEFAULT_LAUNCH_CLASS);
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, component.getPackageName(),
+                component.getClassName());
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).sendBroadcast(captor.capture());
+        Intent pickedIntent = captor.getValue();
+        assertThat(pickedIntent.getAction()).isEqualTo(
+                BluetoothDevicePicker.ACTION_DEVICE_SELECTED);
+        assertThat(pickedIntent.getComponent()).isEqualTo(null);
+        assertThat((BluetoothDevice) pickedIntent.getParcelableExtra(
+                BluetoothDevice.EXTRA_DEVICE)).isEqualTo(mBondedDevice);
+    }
+
+    @Test
+    public void onDeviceClicked_bondedDevice_goesBack() {
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        verify(mFragmentController).goBack();
+    }
+
+    @Test
+    public void onDeviceClicked_unbondedDevice_doesNotNeedAuth_sendsPickedIntent() {
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ false,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(1);
+
+        devicePreference.performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).sendBroadcast(captor.capture());
+        Intent pickedIntent = captor.getValue();
+        assertThat(pickedIntent.getAction()).isEqualTo(
+                BluetoothDevicePicker.ACTION_DEVICE_SELECTED);
+    }
+
+    @Test
+    public void onDeviceClicked_unbondedDevice_needsAuth_startsPairing() {
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(1);
+
+        devicePreference.performClick();
+
+        verify(mUnbondedCachedDevice).startPairing();
+    }
+
+    @Test
+    public void onDeviceClicked_unbondedDevice_needsAuth_pairingStartFails_resumesScanning() {
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        verify(mMockBluetoothAdapter).startDiscovery();
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(1);
+        when(mUnbondedCachedDevice.startPairing()).thenReturn(false);
+
+        Mockito.clearInvocations(mMockBluetoothAdapter);
+        devicePreference.performClick();
+        InOrder inOrder = inOrder(mMockBluetoothAdapter);
+        inOrder.verify(mMockBluetoothAdapter).setScanMode(BluetoothAdapter.SCAN_MODE_CONNECTABLE);
+        inOrder.verify(mMockBluetoothAdapter).startDiscovery();
+    }
+
+    @Test
+    public void onDeviceBondStateChanged_selectedDeviceBonded_sendsPickedIntent() {
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(1);
+
+        // Select device.
+        devicePreference.performClick();
+        // Device bonds.
+        mPreferenceController.onDeviceBondStateChanged(
+                devicePreference.getCachedDevice(), BluetoothDevice.BOND_BONDED);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).sendBroadcast(captor.capture());
+        Intent pickedIntent = captor.getValue();
+        assertThat(pickedIntent.getAction()).isEqualTo(
+                BluetoothDevicePicker.ACTION_DEVICE_SELECTED);
+    }
+
+    @Test
+    public void onDeviceBondStateChanged_selectedDeviceBonded_goesBack() {
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(1);
+
+        // Select device.
+        devicePreference.performClick();
+        // Device bonds.
+        mPreferenceController.onDeviceBondStateChanged(
+                devicePreference.getCachedDevice(), BluetoothDevice.BOND_BONDED);
+
+        verify(mFragmentController).goBack();
+    }
+
+    @Test
+    public void onDestroy_noDeviceSelected_sendsNullPickedIntent() {
+        Intent launchIntent = createLaunchIntent(/* needsAuth= */ true,
+                BluetoothDevicePicker.FILTER_TYPE_ALL, DEFAULT_LAUNCH_PACKAGE,
+                DEFAULT_LAUNCH_CLASS);
+        mPreferenceController.setLaunchIntent(launchIntent);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mPreferenceController.onDestroy(mLifecycleOwner);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).sendBroadcast(captor.capture());
+        Intent pickedIntent = captor.getValue();
+        assertThat(pickedIntent.getAction()).isEqualTo(
+                BluetoothDevicePicker.ACTION_DEVICE_SELECTED);
+        assertThat((BluetoothDevice) pickedIntent.getParcelableExtra(
+                BluetoothDevice.EXTRA_DEVICE)).isNull();
+    }
+
+    private Intent createLaunchIntent(boolean needAuth, int filterType, String packageName,
+            String className) {
+        Intent intent = new Intent(BluetoothDevicePicker.ACTION_LAUNCH);
+        intent.putExtra(BluetoothDevicePicker.EXTRA_NEED_AUTH, needAuth);
+        intent.putExtra(BluetoothDevicePicker.EXTRA_FILTER_TYPE, filterType);
+        intent.putExtra(BluetoothDevicePicker.EXTRA_LAUNCH_PACKAGE, packageName);
+        intent.putExtra(BluetoothDevicePicker.EXTRA_LAUNCH_CLASS, className);
+        return intent;
+    }
+
+    private static class TestBluetoothDevicePickerPreferenceController
+            extends BluetoothDevicePickerPreferenceController {
+
+        TestBluetoothDevicePickerPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        String getCallingAppPackageName(IBinder activityToken) {
+            return ALLOWED_LAUNCH_PACKAGE;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePreferenceTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePreferenceTest.java
new file mode 100644
index 000000000..77359ff1b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDevicePreferenceTest.java
@@ -0,0 +1,274 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothClass;
+import android.content.Context;
+import android.os.Parcel;
+import android.os.SystemProperties;
+
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.MultiActionPreference;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.LocalBluetoothProfile;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothDevicePreferenceTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private BluetoothDevicePreference mPreference;
+
+    private BluetoothClass createBtClass(int deviceClass) {
+        Parcel p = Parcel.obtain();
+        p.writeInt(deviceClass);
+        p.setDataPosition(0); // reset position of parcel before passing to constructor
+
+        BluetoothClass bluetoothClass = BluetoothClass.CREATOR.createFromParcel(p);
+        p.recycle();
+        return bluetoothClass;
+    }
+
+    @Mock
+    private CachedBluetoothDevice mCachedDevice;
+    @Mock
+    private LocalBluetoothProfile mProfile;
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+
+    @Before
+    public void setUp() {
+        mPreference = new BluetoothDevicePreference(mContext, mCachedDevice);
+    }
+
+    @Test
+    public void actionIsHiddenByDefault() {
+        assertThat(mPreference.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .isVisible()).isFalse();
+        assertThat(mPreference.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .isVisible()).isFalse();
+        assertThat(mPreference.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .isVisible()).isFalse();
+    }
+
+    @Test
+    public void onAttached_registersDeviceCallback() {
+        mPreference.onAttached();
+
+        verify(mCachedDevice).registerCallback(any(CachedBluetoothDevice.Callback.class));
+    }
+
+    @Test
+    public void onAttached_setsDeviceNameAsTitle() {
+        String name = "name";
+        when(mCachedDevice.getName()).thenReturn(name);
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.getTitle()).isEqualTo(name);
+    }
+
+    @Test
+    public void onAttached_notConnected_setsCarConnectionSummaryAsSummary() {
+        String summary = "summary";
+        when(mCachedDevice.isConnected()).thenReturn(false);
+        when(mCachedDevice.getCarConnectionSummary(anyBoolean(), anyBoolean())).thenReturn(summary);
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.getSummary()).isEqualTo(summary);
+    }
+
+    @Test
+    public void onAttached_connected_setsCarConnectionSummaryAsSummary() {
+        when(mCachedDevice.isConnected()).thenReturn(true);
+        String summary = "summary";
+        when(mCachedDevice.getCarConnectionSummary(anyBoolean(), anyBoolean())).thenReturn(summary);
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.getSummary()).isEqualTo(summary);
+    }
+
+    @Test
+    public void onAttached_connected_carConnectionSummaryIsNull_setsSummary() {
+        when(mCachedDevice.isConnected()).thenReturn(true);
+
+        String summary = "Summary";
+        when(mCachedDevice.getCarConnectionSummary(anyBoolean(), anyBoolean())).thenReturn(summary);
+        when(mCachedDevice.getProfiles()).thenReturn(Collections.singletonList(mProfile));
+        when(mProfile.getDrawableResource(any()))
+                .thenReturn(com.android.internal.R.drawable.ic_settings_bluetooth);
+        mPreference.onAttached();
+
+        // Null device type descriptions aren't added to the summary when device is connected
+        assertThat(mPreference.getSummary()).isEqualTo(summary);
+    }
+
+    @Test
+    public void onAttached_setsIcon() {
+        when(mCachedDevice.getBtClass()).thenReturn(
+                createBtClass(BluetoothClass.Device.Major.PHONE));
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.getIcon()).isNotNull();
+    }
+
+    @Test
+    public void onAttached_deviceNotBusy_setsEnabled() {
+        when(mCachedDevice.isBusy()).thenReturn(false);
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onAttached_deviceBusy_setsNotEnabled() {
+        when(mCachedDevice.isBusy()).thenReturn(true);
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onAttached_deviceNameNotHumanReadable_setsHidden() {
+        SystemProperties.set("persist.bluetooth.showdeviceswithoutnames", Boolean.FALSE.toString());
+        when(mCachedDevice.hasHumanReadableName()).thenReturn(false);
+        mPreference = new BluetoothDevicePreference(mContext, mCachedDevice);
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onAttached_deviceNameNotHumanReadable_showWithoutNamesTrue_setsShown() {
+        SystemProperties.set("persist.bluetooth.showdeviceswithoutnames", Boolean.TRUE.toString());
+        when(mCachedDevice.hasHumanReadableName()).thenReturn(false);
+        mPreference = new BluetoothDevicePreference(mContext, mCachedDevice);
+
+        mPreference.onAttached();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void onDetached_unregistersDeviceCallback() {
+        ArgumentCaptor<CachedBluetoothDevice.Callback> callbackCaptor = ArgumentCaptor.forClass(
+                CachedBluetoothDevice.Callback.class);
+        mPreference.onAttached();
+        verify(mCachedDevice).registerCallback(callbackCaptor.capture());
+
+        mPreference.onDetached();
+
+        verify(mCachedDevice).unregisterCallback(callbackCaptor.getValue());
+    }
+
+    @Test
+    public void onDeviceAttributesChanged_refreshesUi() {
+        String name = "name";
+        when(mCachedDevice.getName()).thenReturn(name);
+        String summary = "summary";
+        when(mCachedDevice.getCarConnectionSummary(anyBoolean(), anyBoolean())).thenReturn(summary);
+        when(mCachedDevice.isBusy()).thenReturn(false);
+        ArgumentCaptor<CachedBluetoothDevice.Callback> callbackCaptor = ArgumentCaptor.forClass(
+                CachedBluetoothDevice.Callback.class);
+        mPreference.onAttached();
+        verify(mCachedDevice).registerCallback(callbackCaptor.capture());
+
+        assertThat(mPreference.getTitle()).isEqualTo(name);
+        assertThat(mPreference.getSummary()).isEqualTo(summary);
+        assertThat(mPreference.isEnabled()).isTrue();
+
+        String updatedName = "updatedName";
+        when(mCachedDevice.getName()).thenReturn(updatedName);
+        String updatedSummary = "updatedSummary";
+        when(mCachedDevice.getCarConnectionSummary(anyBoolean(), anyBoolean()))
+                .thenReturn(updatedSummary);
+        when(mCachedDevice.isBusy()).thenReturn(true);
+
+        callbackCaptor.getValue().onDeviceAttributesChanged();
+
+        assertThat(mPreference.getTitle()).isEqualTo(updatedName);
+        assertThat(mPreference.getSummary()).isEqualTo(updatedSummary);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void equals_devicesEqual_returnsTrue() {
+        BluetoothDevicePreference otherPreference = new BluetoothDevicePreference(mContext,
+                mCachedDevice);
+
+        assertThat(mPreference.equals(otherPreference)).isTrue();
+    }
+
+    @Test
+    public void equals_devicesNotEqual_returnsFalse() {
+        BluetoothDevicePreference otherPreference = new BluetoothDevicePreference(mContext,
+                mock(CachedBluetoothDevice.class));
+
+        assertThat(mPreference.equals(otherPreference)).isFalse();
+    }
+
+    @Test
+    public void compareTo_sameType_usesDeviceCompareTo() {
+        CachedBluetoothDevice otherDevice = mock(CachedBluetoothDevice.class);
+        BluetoothDevicePreference otherPreference = new BluetoothDevicePreference(mContext,
+                otherDevice);
+        when(mCachedDevice.compareTo(otherDevice)).thenReturn(1);
+        when(otherDevice.compareTo(mCachedDevice)).thenReturn(-1);
+
+        assertThat(mPreference.compareTo(otherPreference)).isEqualTo(1);
+        assertThat(otherPreference.compareTo(mPreference)).isEqualTo(-1);
+    }
+
+    @Test
+    public void compareTo_differentType_fallsBackToDefaultCompare() {
+        mPreference.setOrder(1);
+        Preference otherPreference = new Preference(mContext);
+        otherPreference.setOrder(2);
+
+        assertThat(mPreference.compareTo(otherPreference)).isEqualTo(-1);
+        verify(mCachedDevice, never()).compareTo(any());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilesPreferenceControllerMockTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilesPreferenceControllerMockTest.java
new file mode 100644
index 000000000..592bd2aff
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilesPreferenceControllerMockTest.java
@@ -0,0 +1,322 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothDevice;
+import android.bluetooth.BluetoothProfile;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.LocalBluetoothProfile;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public final class BluetoothDeviceProfilesPreferenceControllerMockTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_BLUETOOTH;
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private final LifecycleOwner mLifecycleOwner = new TestLifecycleOwner();
+
+    private BluetoothDeviceProfilesPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private PreferenceGroup mPreferenceGroup;
+    private MockitoSession mSession;
+
+    @Mock
+    private BluetoothDevice mDevice;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Toast mMockToast;
+    @Mock
+    private CachedBluetoothDevice mCachedDevice;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        when(mCachedDevice.getDevice()).thenReturn(mDevice);
+
+        LocalBluetoothProfile profile =
+                new BluetoothTestUtils.TestLocalBluetoothProfile(BluetoothProfile.HEADSET_CLIENT);
+        when(mCachedDevice.getProfiles()).thenReturn(List.of(profile));
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new BluetoothDeviceProfilesPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+
+        mPreferenceController.setCachedDevice(mCachedDevice);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser() {
+        EnterpriseTestUtils.mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser_zoneWrite() {
+        EnterpriseTestUtils.mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser_zoneRead() {
+        EnterpriseTestUtils.mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser_zoneHidden() {
+        EnterpriseTestUtils.mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser_zoneWrite() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser_zoneRead() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser_zoneHidden() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneWrite() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneRead() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneHidden() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(pref.isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByDpm_dialog() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        BluetoothDeviceProfilePreference pref =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        pref.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingBlockedToast() {
+        String toastText = mContext.getResources().getString(R.string.action_unavailable);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilesPreferenceControllerTest.java
new file mode 100644
index 000000000..1be334522
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothDeviceProfilesPreferenceControllerTest.java
@@ -0,0 +1,296 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothDevice;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.os.UserManager;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+import com.android.settingslib.bluetooth.LocalBluetoothProfile;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.Arrays;
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothDeviceProfilesPreferenceControllerTest {
+
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private PreferenceGroup mPreferenceGroup;
+    private BluetoothDeviceProfilesPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private LocalBluetoothManager mLocalBluetoothManager;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CachedBluetoothDevice mBondedCachedDevice;
+    @Mock
+    private BluetoothDevice mBondedDevice;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mLocalBluetoothManager = spy(BluetoothUtils.getLocalBtManager(mContext));
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new BluetoothDeviceProfilesPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mLocalBluetoothManager, mUserManager);
+
+        when(mBondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDED);
+        when(mBondedCachedDevice.getDevice()).thenReturn(mBondedDevice);
+        mPreferenceController.setCachedDevice(mBondedCachedDevice);
+
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void refreshUi_addsNewProfiles() {
+        LocalBluetoothProfile profile1 = mock(LocalBluetoothProfile.class);
+        when(profile1.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile1));
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+
+        LocalBluetoothProfile profile2 = mock(LocalBluetoothProfile.class);
+        when(profile2.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Arrays.asList(profile1, profile2));
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+        BluetoothDeviceProfilePreference profilePreference =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(1);
+        assertThat(profilePreference.getProfile()).isEqualTo(profile2);
+    }
+
+    @Test
+    public void refreshUi_removesRemovedProfiles() {
+        LocalBluetoothProfile profile1 = mock(LocalBluetoothProfile.class);
+        when(profile1.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        LocalBluetoothProfile profile2 = mock(LocalBluetoothProfile.class);
+        when(profile2.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Arrays.asList(profile1, profile2));
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile2));
+        when(mBondedCachedDevice.getRemovedProfiles())
+                .thenReturn(Collections.singletonList(profile1));
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        BluetoothDeviceProfilePreference profilePreference =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        assertThat(profilePreference.getProfile()).isEqualTo(profile2);
+    }
+
+    @Test
+    public void refreshUi_profiles_showsPreference() {
+        LocalBluetoothProfile profile = mock(LocalBluetoothProfile.class);
+        when(profile.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile));
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.isVisible()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_noProfiles_hidesPreference() {
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.emptyList());
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.isVisible()).isFalse();
+    }
+
+    @Test
+    public void profileChecked_setsProfilePreferred() {
+        LocalBluetoothProfile profile = mock(LocalBluetoothProfile.class);
+        when(profile.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile));
+        mPreferenceController.refreshUi();
+
+        BluetoothDeviceProfilePreference profilePreference =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        profilePreference.refreshUi();
+
+        assertThat(profilePreference.isChecked()).isFalse();
+        profilePreference.performClick();
+
+        verify(profile).setEnabled(mBondedDevice, true);
+    }
+
+    @Test
+    public void profileChecked_connectsToProfile() {
+        LocalBluetoothProfile profile = mock(LocalBluetoothProfile.class);
+        when(profile.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile));
+        mPreferenceController.refreshUi();
+
+        BluetoothDeviceProfilePreference profilePreference =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        profilePreference.refreshUi();
+
+        assertThat(profilePreference.isChecked()).isFalse();
+        profilePreference.performClick();
+
+        verify(profile).setEnabled(mBondedDevice, true);
+    }
+
+    @Test
+    public void profileUnchecked_setsProfileNotPreferred() {
+        LocalBluetoothProfile profile = mock(LocalBluetoothProfile.class);
+        when(profile.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(profile.isEnabled(mBondedDevice)).thenReturn(true);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile));
+        mPreferenceController.refreshUi();
+
+        BluetoothDeviceProfilePreference profilePreference =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        profilePreference.refreshUi();
+
+        assertThat(profilePreference.isChecked()).isTrue();
+        profilePreference.performClick();
+
+        verify(profile).setEnabled(mBondedDevice, false);
+    }
+
+    @Test
+    public void profileUnchecked_disconnectsFromProfile() {
+        LocalBluetoothProfile profile = mock(LocalBluetoothProfile.class);
+        when(profile.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(profile.isEnabled(mBondedDevice)).thenReturn(true);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile));
+        mPreferenceController.refreshUi();
+
+        BluetoothDeviceProfilePreference profilePreference =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        profilePreference.refreshUi();
+
+        assertThat(profilePreference.isChecked()).isTrue();
+        profilePreference.performClick();
+
+        verify(profile).setEnabled(mBondedDevice, false);
+    }
+
+    @Test
+    public void profileDisabled_showsDialog() {
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_CONFIG_BLUETOOTH))
+                .thenReturn(true);
+        when(mBondedCachedDevice.isBusy()).thenReturn(true);
+        LocalBluetoothProfile profile = mock(LocalBluetoothProfile.class);
+        when(profile.getNameResource(mBondedDevice)).thenReturn(R.string.bt_profile_name);
+        when(profile.isEnabled(mBondedDevice)).thenReturn(true);
+        when(mBondedCachedDevice.getProfiles()).thenReturn(Collections.singletonList(profile));
+        mPreferenceController.refreshUi();
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(restrictions);
+
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        BluetoothDeviceProfilePreference profilePreference =
+                (BluetoothDeviceProfilePreference) mPreferenceGroup.getPreference(0);
+        profilePreference.refreshUi();
+        profilePreference.performClick();
+
+        verify(mFragmentController).showDialog(any(), any());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothPairingSelectionFragmentTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothPairingSelectionFragmentTest.java
new file mode 100644
index 000000000..133a29751
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothPairingSelectionFragmentTest.java
@@ -0,0 +1,180 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothDevice;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.ToolbarController;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.BluetoothEventManager;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothPairingSelectionFragmentTest {
+    private BluetoothPairingSelectionFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MockitoSession mSession;
+
+    @Mock
+    private LocalBluetoothManager mMockManager;
+    @Mock
+    private BluetoothEventManager mMockEventManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                BluetoothUtils.class, withSettings().lenient()).startMocking();
+        when(BluetoothUtils.getLocalBtManager(any())).thenReturn(
+                mMockManager);
+        when(mMockManager.getEventManager()).thenReturn(mMockEventManager);
+        CachedBluetoothDeviceManager cbdm = mock(CachedBluetoothDeviceManager.class);
+        when(mMockManager.getCachedDeviceManager()).thenReturn(cbdm);
+        setUpFragment();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onStart_setsBluetoothManagerForegroundActivity() {
+        verify(mMockManager).setForegroundActivity(mFragment.requireActivity());
+    }
+
+    @Test
+    public void onStart_registersEventListener() {
+        verify(mMockEventManager).registerCallback(mFragment.mCallback);
+    }
+
+    @Test
+    public void onStart_showsProgressBar() {
+        ToolbarController toolbar = mActivity.getToolbar();
+
+        assertThat(toolbar.getProgressBar().isVisible()).isTrue();
+    }
+
+    @Test
+    public void onStop_clearsBluetoothManagerForegroundActivity() throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragment.onStop();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockManager).setForegroundActivity(null);
+    }
+
+    @Test
+    public void onStop_unregistersEventListener() throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragment.onStop();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockEventManager).registerCallback(mFragment.mCallback);
+        verify(mMockEventManager).unregisterCallback(mFragment.mCallback);
+    }
+
+    @Test
+    public void onStop_hidesProgressBar() throws Throwable {
+        ToolbarController toolbar = mActivity.getToolbar();
+        toolbar.getProgressBar().setVisible(true);
+
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragment.onStop();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(toolbar.getProgressBar().isVisible()).isFalse();
+    }
+
+    @Test
+    public void onDeviceBondStateChanged_deviceBonded_goesBack() throws Throwable {
+        verify(mMockEventManager).registerCallback(mFragment.mCallback);
+
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragment.mCallback.onDeviceBondStateChanged(mock(CachedBluetoothDevice.class),
+                    BluetoothDevice.BOND_BONDED);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(mActivity.getOnBackPressedFlag()).isTrue();
+    }
+
+    @Test
+    public void onBluetoothDisabled_goesBack() throws Throwable {
+        verify(mMockEventManager).registerCallback(mFragment.mCallback);
+
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragment.mCallback.onBluetoothStateChanged(BluetoothAdapter.STATE_OFF);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(mActivity.getOnBackPressedFlag()).isTrue();
+    }
+
+    private void setUpFragment() throws Throwable {
+        String bluetoothPairingSelectionFragmentTag = "bluetooth_pairing_selection_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new BluetoothPairingSelectionFragment(),
+                            bluetoothPairingSelectionFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (BluetoothPairingSelectionFragment)
+                mFragmentManager.findFragmentByTag(bluetoothPairingSelectionFragmentTag);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothRequestPermissionActivityTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothRequestPermissionActivityTest.java
new file mode 100644
index 000000000..3f2ce6b11
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothRequestPermissionActivityTest.java
@@ -0,0 +1,343 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.android.car.settings.bluetooth.BluetoothRequestPermissionActivity.DEFAULT_DISCOVERABLE_TIMEOUT;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.bluetooth.BluetoothAdapter;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.widget.Button;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.LocalBluetoothAdapter;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothRequestPermissionActivityTest {
+    private static final String PACKAGE_NAME = "pkg.test";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private TestBluetoothRequestPermissionActivity mActivity;
+    private MockitoSession mSession;
+
+    @Rule
+    public ActivityTestRule<TestBluetoothRequestPermissionActivity> mActivityTestRule =
+            new ActivityTestRule<>(TestBluetoothRequestPermissionActivity.class, false, false);
+    @Mock
+    private LocalBluetoothManager mMockLocalBluetoothManager;
+    @Mock
+    private LocalBluetoothAdapter mMockLocalBluetoothAdapter;
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+
+        // Fields that need to be mocked in activity's onCreate(). Workaround since ActivityTestRule
+        // doesn't create the activity instance or context until launched, so the fields can't be
+        // mocked normally.
+        TestBluetoothRequestPermissionActivity.PACKAGE_MANAGER = mMockPackageManager;
+        TestBluetoothRequestPermissionActivity.CALLING_PACKAGE = PACKAGE_NAME;
+
+        when(mMockPackageManager.getApplicationInfo(PACKAGE_NAME, 0))
+                .thenReturn(new ApplicationInfo());
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                LocalBluetoothManager.class, withSettings().lenient()).startMocking();
+        ExtendedMockito.when(LocalBluetoothManager.getInstance(any(), any()))
+                .thenReturn(mMockLocalBluetoothManager);
+        when(mMockLocalBluetoothManager.getBluetoothAdapter())
+                .thenReturn(mMockLocalBluetoothAdapter);
+        when(mMockLocalBluetoothAdapter.setScanMode(
+                BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE, DEFAULT_DISCOVERABLE_TIMEOUT))
+                .thenReturn(false);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_requestDisableIntent_hasDisableRequestType() {
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getRequestType()).isEqualTo(
+                BluetoothRequestPermissionActivity.REQUEST_DISABLE);
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_hasDiscoverableRequestType() {
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getRequestType()).isEqualTo(
+                BluetoothRequestPermissionActivity.REQUEST_ENABLE_DISCOVERABLE);
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_noTimeoutSpecified_hasDefaultTimeout() {
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getTimeout()).isEqualTo(
+                DEFAULT_DISCOVERABLE_TIMEOUT);
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_timeoutSpecified_hasTimeout() {
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        intent.putExtra(BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION,
+                BluetoothRequestPermissionActivity.MAX_DISCOVERABLE_TIMEOUT);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getTimeout()).isEqualTo(
+                BluetoothRequestPermissionActivity.MAX_DISCOVERABLE_TIMEOUT);
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_bypassforSetup_startsDiscoverableScan() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = createSetupWizardIntent();
+        mActivityTestRule.launchActivity(intent);
+
+        verify(mMockLocalBluetoothAdapter).setScanMode(
+                BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE, DEFAULT_DISCOVERABLE_TIMEOUT);
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_bypassforSetup_turningOn_noDialog() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_TURNING_ON);
+        Intent intent = createSetupWizardIntent();
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentDialog()).isNull();
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_bypassforSetup_turningOn_receiverRegistered() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_TURNING_ON);
+        Intent intent = createSetupWizardIntent();
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentReceiver()).isNotNull();
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_bypassforSetup_turningOn_enableDiscovery() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_TURNING_ON);
+
+        Intent intent = createSetupWizardIntent();
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        // Simulate bluetooth callback from STATE_TURNING_ON to STATE_ON
+        Intent stateChangedIntent = new Intent();
+        stateChangedIntent.putExtra(BluetoothAdapter.EXTRA_STATE, BluetoothAdapter.STATE_ON);
+        mActivity.getCurrentReceiver().onReceive(mContext, stateChangedIntent);
+
+        verify(mMockLocalBluetoothAdapter).setScanMode(
+                BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE, DEFAULT_DISCOVERABLE_TIMEOUT);
+    }
+
+    @Test
+    public void onCreate_requestDiscoverableIntent_bypassforGeneric_noScanModeChange() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        intent.putExtra(BluetoothRequestPermissionActivity.EXTRA_BYPASS_CONFIRM_DIALOG, true);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        verify(mMockLocalBluetoothAdapter, never()).setScanMode(
+                BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE, DEFAULT_DISCOVERABLE_TIMEOUT);
+    }
+
+    @Test
+    public void onCreate_requestEnableIntent_hasEnableRequestType() {
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getRequestType()).isEqualTo(
+                BluetoothRequestPermissionActivity.REQUEST_ENABLE);
+    }
+
+    @Test
+    public void onCreate_bluetoothOff_requestDisableIntent_noDialog() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_OFF);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentDialog()).isNull();
+    }
+
+    @Test
+    public void onCreate_bluetoothOn_requestDisableIntent_startsDialog() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentDialog()).isNotNull();
+        assertThat(mActivity.getCurrentDialog().isShowing()).isTrue();
+    }
+
+    @Test
+    public void onCreate_bluetoothOff_requestDiscoverableIntent_startsDialog() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_OFF);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentDialog()).isNotNull();
+        assertThat(mActivity.getCurrentDialog().isShowing()).isTrue();
+    }
+
+    @Test
+    public void onCreate_bluetoothOn_requestDiscoverableIntent_startsDialog() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentDialog()).isNotNull();
+        assertThat(mActivity.getCurrentDialog().isShowing()).isTrue();
+    }
+
+    @Test
+    public void onCreate_bluetoothOff_requestEnableIntent_startsDialog() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_OFF);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentDialog()).isNotNull();
+        assertThat(mActivity.getCurrentDialog().isShowing()).isTrue();
+    }
+
+    @Test
+    public void onCreate_bluetoothOn_requestEnableIntent_noDialog() {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        assertThat(mActivity.getCurrentDialog()).isNull();
+    }
+
+    @Test
+    public void onPositiveClick_disableDialog_disables() throws Throwable {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        Button button = mActivity.getCurrentDialog().getButton(DialogInterface.BUTTON_POSITIVE);
+        mActivityTestRule.runOnUiThread(button::performClick);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockLocalBluetoothAdapter).disable();
+    }
+
+    @Test
+    public void onPositiveClick_discoverableDialog_scanModeSet() throws Throwable {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        Button button = mActivity.getCurrentDialog().getButton(DialogInterface.BUTTON_POSITIVE);
+        mActivityTestRule.runOnUiThread(button::performClick);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockLocalBluetoothAdapter).setScanMode(
+                BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE, DEFAULT_DISCOVERABLE_TIMEOUT);
+    }
+
+    @Test
+    public void onPositiveClick_enableDialog_enables() throws Throwable {
+        when(mMockLocalBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_OFF);
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
+        mActivityTestRule.launchActivity(intent);
+        mActivity = mActivityTestRule.getActivity();
+
+        Button button = mActivity.getCurrentDialog().getButton(DialogInterface.BUTTON_POSITIVE);
+        mActivityTestRule.runOnUiThread(button::performClick);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockLocalBluetoothAdapter).enable();
+    }
+
+    private Intent createSetupWizardIntent() {
+        ResolveInfo resolveInfo = new ResolveInfo();
+        resolveInfo.activityInfo = new ActivityInfo();
+        resolveInfo.activityInfo.packageName = PACKAGE_NAME;
+
+        when(mMockPackageManager.queryIntentActivities(any(), anyInt()))
+                .thenReturn(Collections.singletonList(resolveInfo));
+
+        Intent intent = new Intent(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
+        intent.setComponent(new ComponentName(mContext,
+                TestBluetoothRequestPermissionActivity.class));
+        intent.putExtra(BluetoothRequestPermissionActivity.EXTRA_BYPASS_CONFIRM_DIALOG, true);
+        return intent;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothScanningDevicesGroupPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothScanningDevicesGroupPreferenceControllerTest.java
new file mode 100644
index 000000000..5903cf5d6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothScanningDevicesGroupPreferenceControllerTest.java
@@ -0,0 +1,402 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static android.os.UserManager.DISALLOW_CONFIG_BLUETOOTH;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothDevice;
+import android.bluetooth.BluetoothManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.BluetoothDeviceFilter;
+import com.android.settingslib.bluetooth.BluetoothEventManager;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothScanningDevicesGroupPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private PreferenceGroup mPreferenceGroup;
+    private TestBluetoothScanningDevicesGroupPreferenceController mController;
+    private MockitoSession mSession;
+
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private LocalBluetoothManager mMockManager;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private BluetoothAdapter mBluetoothAdapter;
+    @Mock
+    private CachedBluetoothDevice mCachedDevice;
+    @Mock
+    private BluetoothEventManager mBluetoothEventManager;
+    @Mock
+    private BluetoothDevice mDevice;
+    @Mock
+    private CachedBluetoothDeviceManager mCachedDeviceManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        when(mBluetoothAdapter.startDiscovery()).then(invocation -> {
+            when(mBluetoothAdapter.isDiscovering()).thenReturn(true);
+            return true;
+        });
+        when(mBluetoothAdapter.cancelDiscovery()).then(invocation -> {
+            when(mBluetoothAdapter.isDiscovering()).thenReturn(false);
+            return true;
+        });
+        BluetoothManager bluetoothManager = mock(BluetoothManager.class);
+        when(bluetoothManager.getAdapter()).thenReturn(mBluetoothAdapter);
+        when(mContext.getSystemService(BluetoothManager.class)).thenReturn(bluetoothManager);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                BluetoothUtils.class, withSettings().lenient()).startMocking();
+        when(BluetoothUtils.getLocalBtManager(any())).thenReturn(
+                mMockManager);
+        when(BluetoothUtils.shouldEnableBTScanning(eq(mContext), any())).thenReturn(true);
+        when(mDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mCachedDevice.getDevice()).thenReturn(mDevice);
+        when(mCachedDeviceManager.getCachedDevicesCopy()).thenReturn(
+                Collections.singletonList(mCachedDevice));
+        when(mMockManager.getCachedDeviceManager()).thenReturn(mCachedDeviceManager);
+        when(mMockManager.getEventManager()).thenReturn(mBluetoothEventManager);
+
+        mController = new TestBluetoothScanningDevicesGroupPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController,
+                mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreferenceGroup);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void disallowConfigBluetooth_doesNotStartScanning() {
+        when(mUserManager.hasUserRestriction(DISALLOW_CONFIG_BLUETOOTH)).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        verify(mBluetoothAdapter, never()).startDiscovery();
+        // User can't scan, but they can still see known devices.
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void onScanningStateChanged_scanningEnabled_receiveStopped_restartsScanning() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        verify(mBluetoothAdapter).startDiscovery();
+
+        Mockito.clearInvocations(mBluetoothAdapter);
+        mBluetoothAdapter.cancelDiscovery();
+        mController.onScanningStateChanged(/* started= */ false);
+        // start discovery should be called a second time after the state change
+        verify(mBluetoothAdapter).startDiscovery();
+    }
+
+    @Test
+    public void onScanningStateChanged_scanningDisabled_receiveStopped_doesNothing() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        verify(mBluetoothAdapter).startDiscovery();
+        // Set a device bonding to disable scanning.
+        when(mCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDING);
+        mController.refreshUi();
+        verify(mBluetoothAdapter).cancelDiscovery();
+
+        Mockito.clearInvocations(mBluetoothAdapter);
+        mController.onScanningStateChanged(/* started= */ false);
+        verify(mBluetoothAdapter, never()).startDiscovery();
+    }
+
+    @Test
+    public void onDeviceBondStateChanged_refreshesUi() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        verify(mBluetoothAdapter).startDiscovery();
+
+        // Change state to bonding to cancel scanning on refresh.
+        when(mCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDING);
+        when(mDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDING);
+        mController.onDeviceBondStateChanged(mCachedDevice, BluetoothDevice.BOND_BONDING);
+
+        verify(mBluetoothAdapter).cancelDiscovery();
+    }
+
+    @Test
+    public void onDeviceClicked_callsInternal() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        assertThat(mController.getLastClickedDevice()).isEquivalentAccordingToCompareTo(
+                devicePreference.getCachedDevice());
+    }
+
+    @Test
+    public void onDeviceClicked_cancelsScanning() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+        verify(mBluetoothAdapter).startDiscovery();
+
+        devicePreference.performClick();
+
+        verify(mBluetoothAdapter).cancelDiscovery();
+    }
+
+    @Test
+    public void refreshUi_noDeviceBonding_startsScanning() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        mController.refreshUi();
+
+        verify(mBluetoothAdapter).startDiscovery();
+    }
+
+    @Test
+    public void refreshUi_noDeviceBonding_enablesGroup() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        mController.refreshUi();
+
+        assertThat(mPreferenceGroup.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_noDeviceBonding_setsScanModeConnectableDiscoverable() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        mController.refreshUi();
+
+        verify(mBluetoothAdapter).setScanMode(BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE);
+    }
+
+    @Test
+    public void refreshUi_notValidCallingPackage_doesNotSetScanMode() {
+        when(BluetoothUtils.shouldEnableBTScanning(eq(mContext), any())).thenReturn(false);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        mController.refreshUi();
+
+        verify(mBluetoothAdapter, never())
+                .setScanMode(BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE);
+    }
+
+    @Test
+    public void refreshUi_deviceBonding_stopsScanning() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        when(mCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDING);
+
+        mController.refreshUi();
+
+        verify(mBluetoothAdapter).cancelDiscovery();
+    }
+
+    @Test
+    public void refreshUi_deviceBonding_disablesGroup() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        when(mCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDING);
+
+        mController.refreshUi();
+
+        assertThat(mPreferenceGroup.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_deviceBonding_setsScanModeConnectable() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        when(mCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDING);
+
+        mController.refreshUi();
+
+        verify(mBluetoothAdapter).setScanMode(BluetoothAdapter.SCAN_MODE_CONNECTABLE);
+    }
+
+    @Test
+    public void onStop_stopsScanning() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        verify(mBluetoothAdapter).startDiscovery();
+
+        mController.onStop(mLifecycleOwner);
+
+        verify(mBluetoothAdapter).cancelDiscovery();
+    }
+
+    @Test
+    public void onStop_clearsNonBondedDevices() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.onStop(mLifecycleOwner);
+
+        verify(mCachedDeviceManager).clearNonBondedDevices();
+    }
+
+    @Test
+    public void onStop_clearsGroup() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isGreaterThan(0);
+
+        mController.onStop(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void onStop_setsScanModeConnectable() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        Mockito.clearInvocations(mBluetoothAdapter);
+        mController.onStop(mLifecycleOwner);
+
+        verify(mBluetoothAdapter).setScanMode(BluetoothAdapter.SCAN_MODE_CONNECTABLE);
+    }
+
+    @Test
+    public void discoverableScanModeTimeout_controllerStarted_resetsDiscoverableScanMode() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        when(mBluetoothAdapter.getScanMode()).thenReturn(BluetoothAdapter.SCAN_MODE_CONNECTABLE);
+        mContext.sendBroadcast(new Intent(BluetoothAdapter.ACTION_SCAN_MODE_CHANGED));
+
+        verify(mBluetoothAdapter).setScanMode(BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE);
+    }
+
+    @Test
+    public void discoverableScanModeTimeout_controllerStopped_doesNotResetDiscoverableScanMode() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.onStop(mLifecycleOwner);
+
+        Mockito.clearInvocations(mBluetoothAdapter);
+        when(mBluetoothAdapter.getScanMode()).thenReturn(BluetoothAdapter.SCAN_MODE_CONNECTABLE);
+        mContext.sendBroadcast(new Intent(BluetoothAdapter.ACTION_SCAN_MODE_CHANGED));
+
+        verify(mBluetoothAdapter, never())
+                .setScanMode(BluetoothAdapter.SCAN_MODE_CONNECTABLE_DISCOVERABLE);
+    }
+
+    private static final class TestBluetoothScanningDevicesGroupPreferenceController extends
+            BluetoothScanningDevicesGroupPreferenceController {
+
+        private CachedBluetoothDevice mLastClickedDevice;
+
+        TestBluetoothScanningDevicesGroupPreferenceController(Context context,
+                String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected void onDeviceClickedInternal(CachedBluetoothDevice cachedDevice) {
+            mLastClickedDevice = cachedDevice;
+        }
+
+        CachedBluetoothDevice getLastClickedDevice() {
+            return mLastClickedDevice;
+        }
+
+        @Override
+        protected BluetoothDeviceFilter.Filter getDeviceFilter() {
+            return BluetoothDeviceFilter.ALL_FILTER;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothStateSwitchPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothStateSwitchPreferenceControllerTest.java
new file mode 100644
index 000000000..6d81be161
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothStateSwitchPreferenceControllerTest.java
@@ -0,0 +1,362 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static android.os.UserManager.DISALLOW_BLUETOOTH;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.any;
+import static org.mockito.Mockito.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothAdapter;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothStateSwitchPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_BLUETOOTH;
+
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SwitchPreference mSwitchPreference;
+    private BluetoothStateSwitchPreferenceController mPreferenceController;
+    private LocalBluetoothManager mLocalBluetoothManager;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private PackageManager mPackageManager;
+
+    @Mock
+    private UserManager mUserManager;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mLocalBluetoothManager = LocalBluetoothManager.getInstance(mContext, /* onInitCallback= */
+                null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new BluetoothStateSwitchPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(true);
+    }
+
+    @Test
+    public void onStart_setsBluetoothManagerForegroundActivity() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mLocalBluetoothManager.getForegroundActivity()).isEqualTo(mContext);
+    }
+
+    @Test
+    public void onStop_clearsBluetoothManagerForegroundActivity() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        assertThat(mLocalBluetoothManager.getForegroundActivity()).isNull();
+    }
+
+    @Test
+    public void onStart_initializesSwitchState() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mSwitchPreference.isChecked()).isEqualTo(
+                BluetoothAdapter.getDefaultAdapter().isEnabled());
+    }
+
+    @Test
+    public void switchClicked_disabled_checksAndDisablesSwitch() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mSwitchPreference.setChecked(false);
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ false);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_bluetoothFeatureDisabled() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noRestrictions() {
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        EnterpriseTestUtils.mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void restrictedByDpm_availabilityIsAvailableForViewing() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void restrictedByDpm_availabilityIsAvailableForViewing_zoneWrite() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void restrictedByDpm_availabilityIsAvailableForViewing_zoneRead() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void restrictedByDpm_availabilityIsAvailableForViewing_zoneHidden() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void restrictedByDpm_disableSwitchPreference() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mSwitchPreference.setEnabled(true);
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void restrictedByDpm_showsDisabledByAdminDialog() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        mSwitchPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(), eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    public void switchClicked_enabled_unchecksAndDisablesSwitch() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mSwitchPreference.setChecked(true);
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void stateChanged_turningOn_setsSwitchChecked() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_TURNING_ON);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void stateChanged_turningOn_setsSwitchDisabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_TURNING_ON);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void stateChanged_on_setsSwitchChecked() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_ON);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void stateChanged_on_setsSwitchEnabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_ON);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void stateChanged_turningOff_setsSwitchUnchecked() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_TURNING_OFF);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void stateChanged_turningOff_setsSwitchDisabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_TURNING_OFF);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void stateChanged_off_setsSwitchUnchecked() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_OFF);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void stateChanged_off_setsSwitchEnabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_OFF);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void stateChanged_on_userRestricted_setsSwitchDisabled() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        when(mUserManager.hasUserRestriction(DISALLOW_BLUETOOTH)).thenReturn(true);
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_ON);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void stateChanged_off_userRestricted_setsSwitchDisabled() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        when(mUserManager.hasUserRestriction(DISALLOW_BLUETOOTH)).thenReturn(true);
+
+        mPreferenceController.handleStateChanged(BluetoothAdapter.STATE_OFF);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onPolicyChanged_enabled_setsSwitchEnabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mSwitchPreference.setEnabled(false);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onPolicyChanged_disabled_setsSwitchDisabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mSwitchPreference.setEnabled(true);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothUnbondedDevicesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothUnbondedDevicesPreferenceControllerTest.java
new file mode 100644
index 000000000..c27776d55
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothUnbondedDevicesPreferenceControllerTest.java
@@ -0,0 +1,270 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static android.os.UserManager.DISALLOW_CONFIG_BLUETOOTH;
+
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assume.assumeTrue;
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothClass;
+import android.bluetooth.BluetoothDevice;
+import android.bluetooth.BluetoothManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.content.res.Resources;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BluetoothTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.BluetoothEventManager;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Arrays;
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothUnbondedDevicesPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private PreferenceGroup mPreferenceGroup;
+    private BluetoothUnbondedDevicesPreferenceController mController;
+    private int[] mUnbondedDeviceFilter;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CachedBluetoothDevice mUnbondedCachedDevice;
+    @Mock
+    private BluetoothDevice mUnbondedDevice;
+    @Mock
+    private BluetoothClass mBluetoothClass;
+    @Mock
+    private CachedBluetoothDeviceManager mCachedDeviceManager;
+    @Mock
+    private LocalBluetoothManager mLocalBluetoothManager;
+    @Mock
+    private BluetoothEventManager mBluetoothEventManager;
+    @Mock
+    private BluetoothAdapter mBluetoothAdapter;
+    @Mock
+    private UserManager mUserManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mUnbondedDeviceFilter = new int[]{};
+        Resources resources = spy(mContext.getResources());
+        when(mContext.getResources()).thenReturn(resources);
+        when(resources.getIntArray(R.array.config_unbonded_device_filter_allowlist))
+                .thenReturn(mUnbondedDeviceFilter);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        // Ensure bluetooth is available and enabled.
+        assumeTrue(mContext.getPackageManager().hasSystemFeature(PackageManager.FEATURE_BLUETOOTH));
+        BluetoothTestUtils.setBluetoothState(mContext, /* enable= */ true);
+
+        when(mUnbondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mUnbondedCachedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_NONE);
+        when(mUnbondedCachedDevice.getDevice()).thenReturn(mUnbondedDevice);
+        when(mBluetoothClass.getMajorDeviceClass()).thenReturn(BluetoothClass.Device.Major.PHONE);
+        when(mUnbondedDevice.getBluetoothClass()).thenReturn(mBluetoothClass);
+        BluetoothDevice bondedDevice = mock(BluetoothDevice.class);
+        when(bondedDevice.getBondState()).thenReturn(BluetoothDevice.BOND_BONDED);
+        when(mBluetoothAdapter.getBondedDevices()).thenReturn(Collections.singleton(bondedDevice));
+        BluetoothManager bluetoothManager = mock(BluetoothManager.class);
+        when(bluetoothManager.getAdapter()).thenReturn(mBluetoothAdapter);
+        when(mContext.getSystemService(BluetoothManager.class)).thenReturn(bluetoothManager);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        CachedBluetoothDevice bondedCachedDevice = mock(CachedBluetoothDevice.class);
+        when(bondedCachedDevice.getDevice()).thenReturn(bondedDevice);
+        when(mCachedDeviceManager.getCachedDevicesCopy()).thenReturn(
+                Arrays.asList(mUnbondedCachedDevice, bondedCachedDevice));
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                BluetoothUtils.class, withSettings().lenient()).startMocking();
+        when(BluetoothUtils.getLocalBtManager(any())).thenReturn(
+                mLocalBluetoothManager);
+        when(mLocalBluetoothManager.getCachedDeviceManager()).thenReturn(mCachedDeviceManager);
+        when(mLocalBluetoothManager.getEventManager()).thenReturn(mBluetoothEventManager);
+
+        mController = new BluetoothUnbondedDevicesPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController,
+                mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreferenceGroup);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void showsUnbondedDevices() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+        assertThat(devicePreference.getCachedDevice()).isEqualTo(mUnbondedCachedDevice);
+    }
+
+    @Test
+    public void configUnbondedDeviceFilterIncludesPhones_showsUnbondedPhones() {
+        mUnbondedDeviceFilter = new int[] {BluetoothClass.Device.Major.PHONE};
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+        assertThat(devicePreference.getCachedDevice()).isEqualTo(mUnbondedCachedDevice);
+    }
+
+    @Test
+    public void onDeviceClicked_startsPairing() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        verify(mUnbondedCachedDevice).startPairing();
+    }
+
+    @Test
+    public void onDeviceClicked_pairingStartFails_resumesScanning() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+        when(mUnbondedCachedDevice.startPairing()).thenReturn(false);
+        verify(mBluetoothAdapter).startDiscovery();
+
+        Mockito.clearInvocations(mBluetoothAdapter);
+        devicePreference.performClick();
+
+        verify(mBluetoothAdapter).startDiscovery();
+    }
+
+    @Test
+    public void onDeviceClicked_requestsPhonebookAccess() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        when(mUnbondedCachedDevice.startPairing()).thenReturn(true);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        verify(mUnbondedDevice).setPhonebookAccessPermission(BluetoothDevice.ACCESS_ALLOWED);
+    }
+
+    @Test
+    public void onDeviceClicked_requestsMessageAccess() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        when(mUnbondedCachedDevice.startPairing()).thenReturn(true);
+        BluetoothDevicePreference devicePreference =
+                (BluetoothDevicePreference) mPreferenceGroup.getPreference(0);
+
+        devicePreference.performClick();
+
+        verify(mUnbondedDevice).setMessageAccessPermission(BluetoothDevice.ACCESS_ALLOWED);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disallowConfigBluetooth_disabledForUser() {
+        when(mUserManager.hasUserRestriction(DISALLOW_CONFIG_BLUETOOTH)).thenReturn(true);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disallowConfigBluetooth_disabledForUser_zoneWrite() {
+        when(mUserManager.hasUserRestriction(DISALLOW_CONFIG_BLUETOOTH)).thenReturn(true);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disallowConfigBluetooth_disabledForUser_zoneRead() {
+        when(mUserManager.hasUserRestriction(DISALLOW_CONFIG_BLUETOOTH)).thenReturn(true);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disallowConfigBluetooth_disabledForUser_zoneHidden() {
+        when(mUserManager.hasUserRestriction(DISALLOW_CONFIG_BLUETOOTH)).thenReturn(true);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothUtilsTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothUtilsTest.java
new file mode 100644
index 000000000..f29e47ac8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/BluetoothUtilsTest.java
@@ -0,0 +1,85 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.res.Resources;
+import android.os.UserManager;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public final class BluetoothUtilsTest {
+    private static final String SYSTEM_UI_PACKAGE_NAME = "com.package.systemui";
+    private static final String SYSTEM_UI_COMPONENT_NAME = "com.package.systemui/testclass";
+    private static final String ALLOWED_PACKAGE_NAME = "com.allowed.package";
+    private static final String DISALLOWED_PACKAGE_NAME = "not.real.package";
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Resources mMockResources;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mContext.getResources()).thenReturn(mMockResources);
+        when(mMockResources.getString(anyInt())).thenReturn(SYSTEM_UI_COMPONENT_NAME);
+
+        String[] allowedPackages = new String[1];
+        allowedPackages[0] = ALLOWED_PACKAGE_NAME;
+        when(mMockResources.getStringArray(anyInt())).thenReturn(allowedPackages);
+    }
+
+    @Test
+    public void isSystemCallingPackage_shouldEnableBluetoothScanning() {
+        String settingsPackage = mContext.getPackageName();
+
+        assertThat(BluetoothUtils.shouldEnableBTScanning(mContext, settingsPackage))
+                .isEqualTo(true);
+        assertThat(BluetoothUtils.shouldEnableBTScanning(mContext, SYSTEM_UI_PACKAGE_NAME))
+                .isEqualTo(true);
+    }
+
+    @Test
+    public void isAllowedCallingPackage_shouldEnableBluetoothScanning() {
+        assertThat(BluetoothUtils.shouldEnableBTScanning(mContext, ALLOWED_PACKAGE_NAME))
+                .isEqualTo(true);
+    }
+
+    @Test
+    public void isNotAllowedCallingPackage_shouldNotEnableBluetoothScanning() {
+        assertThat(BluetoothUtils.shouldEnableBTScanning(mContext, DISALLOWED_PACKAGE_NAME))
+                .isEqualTo(false);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/PairNewDevicePreferenceControllerUnitTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/PairNewDevicePreferenceControllerUnitTest.java
new file mode 100644
index 000000000..4926bfca3
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/PairNewDevicePreferenceControllerUnitTest.java
@@ -0,0 +1,278 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.content.res.Resources;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.Settings;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+
+public final class PairNewDevicePreferenceControllerUnitTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_BLUETOOTH;
+
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SwitchPreference mSwitchPreference;
+    private PairNewDevicePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private UserManager mUserManager;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Mock
+    private PackageManager mMockPm;
+
+    @Mock
+    private Resources mResources;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new PairNewDevicePreferenceController(mContext, /* preferenceKey= */
+                "key", mFragmentController, mCarUxRestrictions);
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mSwitchPreference.setFragment(FragmentController.class.getCanonicalName());
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+    }
+
+    @Test
+    public void restrictedByDpm_availabilityIsAvailableForViewing() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void restrictedByDpm_availabilityIsAvailableForViewing_zoneWrite() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    @UiThreadTest
+    public void restrictedByDpm_availabilityIsAvailableForViewing_zoneRead() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void restrictedByDpm_availabilityIsAvailableForViewing_zoneHidden() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void restrictedByDpm_showsDisabledByAdminDialog() {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    @Test
+    public void preferenceClicked_triggersCustomPairingFlow_whenSystemApplicationIsFound() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+
+        Intent intent = new Intent(Settings.ACTION_PAIR_DEVICE_SETTINGS);
+        mSwitchPreference.setIntent(intent);
+
+        String packageName = "some.test.package";
+
+        when(mContext.getResources()).thenReturn(mResources);
+        when(mResources.getBoolean(
+                R.bool.config_use_custom_pair_device_flow)).thenReturn(true);
+        when(mMockPm.queryIntentActivities(eq(intent), anyInt())).thenReturn(
+                Collections.singletonList(createSystemResolveInfo(packageName)));
+
+        doNothing().when(mContext).startActivity(any());
+
+        assertThat(mSwitchPreference.getOnPreferenceClickListener().onPreferenceClick(
+                mSwitchPreference)).isTrue();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent capturedIntent = captor.getValue();
+        assertThat(capturedIntent.getAction()).isEqualTo(Settings.ACTION_PAIR_DEVICE_SETTINGS);
+        assertThat(capturedIntent.getPackage()).isEqualTo(packageName);
+    }
+
+    @Test
+    public void preferenceClicked_triggersDefaultPairingFlow_whenNoMatchingApplicationsFound() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        Intent intent = new Intent();
+        intent.setAction(Settings.ACTION_PAIR_DEVICE_SETTINGS);
+        mSwitchPreference.setIntent(intent);
+
+        when(mContext.getResources()).thenReturn(mResources);
+        when(mResources.getBoolean(
+                R.bool.config_use_custom_pair_device_flow)).thenReturn(true);
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+        when(mMockPm.queryIntentActivities(eq(intent), anyInt())).thenReturn(
+                Collections.emptyList());
+
+        assertThat(mSwitchPreference.getOnPreferenceClickListener().onPreferenceClick(
+                mSwitchPreference)).isFalse();
+
+        verify(mContext, never()).startActivity(any());
+    }
+
+    @Test
+    public void preferenceClicked_triggersDefaultPairingFlow_whenNonSystemApplicationIsFound() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+
+        Intent intent = new Intent(Settings.ACTION_PAIR_DEVICE_SETTINGS);
+        mSwitchPreference.setIntent(intent);
+
+        String packageName = "some.test.package";
+
+        when(mContext.getResources()).thenReturn(mResources);
+        when(mResources.getBoolean(
+                R.bool.config_use_custom_pair_device_flow)).thenReturn(true);
+        when(mMockPm.queryIntentActivities(eq(intent), anyInt())).thenReturn(
+                Collections.singletonList(createNonSystemResolveInfo(packageName)));
+
+        doNothing().when(mContext).startActivity(any());
+
+        assertThat(mSwitchPreference.getOnPreferenceClickListener().onPreferenceClick(
+                mSwitchPreference)).isFalse();
+
+        verify(mContext, never()).startActivity(any());
+    }
+
+    @Test
+    public void preferenceClicked_triggersDefaultPairingFlow_whenCustomPairingFlowIsDisabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        when(mContext.getResources()).thenReturn(mResources);
+        when(mResources.getBoolean(
+                R.bool.config_use_custom_pair_device_flow)).thenReturn(false);
+
+        assertThat(mSwitchPreference.getOnPreferenceClickListener().onPreferenceClick(
+                mSwitchPreference)).isFalse();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(), eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private ResolveInfo createSystemResolveInfo(String packageName) {
+        ResolveInfo resolveInfo = createNonSystemResolveInfo(packageName);
+        resolveInfo.activityInfo.applicationInfo.flags |= ApplicationInfo.FLAG_SYSTEM;
+        return resolveInfo;
+    }
+
+    private ResolveInfo createNonSystemResolveInfo(String packageName) {
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.applicationInfo = applicationInfo;
+
+        ResolveInfo resolveInfo = new ResolveInfo();
+        resolveInfo.activityInfo = activityInfo;
+        resolveInfo.activityInfo.packageName = packageName;
+
+        return resolveInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/TestBluetoothRequestPermissionActivity.java b/tests/multivalent/src/com/android/car/settings/bluetooth/TestBluetoothRequestPermissionActivity.java
new file mode 100644
index 000000000..9edd56318
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/TestBluetoothRequestPermissionActivity.java
@@ -0,0 +1,40 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import android.content.pm.PackageManager;
+
+public class TestBluetoothRequestPermissionActivity extends BluetoothRequestPermissionActivity {
+    // Fields that need to be mocked in onCreate()
+    public static PackageManager PACKAGE_MANAGER;
+    public static String CALLING_PACKAGE;
+
+    @Override
+    public PackageManager getPackageManager() {
+        return PACKAGE_MANAGER;
+    }
+
+    @Override
+    public String getCallingPackage() {
+        return CALLING_PACKAGE;
+    }
+
+    @Override
+    public String getLaunchedFromPackage() {
+        return CALLING_PACKAGE;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/bluetooth/UwbTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/bluetooth/UwbTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..dedc60d16
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/bluetooth/UwbTogglePreferenceControllerTest.java
@@ -0,0 +1,129 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.bluetooth;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.uwb.UwbManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UwbTogglePreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SwitchPreference mPreference;
+    private LifecycleOwner mLifecycleOwner;
+    private UwbTogglePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UwbManager mMockUwbManager;
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(UwbManager.class)).thenReturn(mMockUwbManager);
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new UwbTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreference = new SwitchPreference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_noAvailableOnDevice() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_UWB)).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testDefaultAvailabilityStatus_availableOnDevice() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_UWB)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testUpdateState_stateChecked() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_UWB)).thenReturn(true);
+        when(mMockUwbManager.isUwbEnabled()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testUpdateState_stateNotChecked() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_UWB)).thenReturn(true);
+        when(mMockUwbManager.isUwbEnabled()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_enableUWB() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_UWB)).thenReturn(true);
+        when(mMockUwbManager.isUwbEnabled()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.handlePreferenceChanged(mPreference, true);
+
+        verify(mMockUwbManager).setUwbEnabled(true);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/ActionButtonsPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/common/ActionButtonsPreferenceTest.java
new file mode 100644
index 000000000..bc1af04ce
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/ActionButtonsPreferenceTest.java
@@ -0,0 +1,349 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.graphics.drawable.Drawable;
+import android.view.View;
+import android.widget.ImageView;
+import android.widget.TextView;
+import android.widget.Toast;
+
+import androidx.preference.PreferenceViewHolder;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoSession;
+
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public class ActionButtonsPreferenceTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private View mRootView;
+    private ActionButtonsPreference mPref;
+    private PreferenceViewHolder mHolder;
+    private MockitoSession mSession;
+
+    @Before
+    public void setUp() {
+        mRootView = View.inflate(mContext, R.layout.action_buttons_preference, /* parent= */ null);
+        mHolder = PreferenceViewHolder.createInstanceForTests(mRootView);
+        mPref = new ActionButtonsPreference(mContext);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(Toast.class).startMocking();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onBindViewHolder_setTitle_shouldShowButtonByDefault() {
+        mPref.getButton(ActionButtons.BUTTON1).setText(R.string.settings_label);
+        mPref.getButton(ActionButtons.BUTTON2).setText(R.string.settings_label);
+        mPref.getButton(ActionButtons.BUTTON3).setText(R.string.settings_label);
+        mPref.getButton(ActionButtons.BUTTON4).setText(R.string.settings_label);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button2).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button3).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button4).getVisibility())
+                .isEqualTo(View.VISIBLE);
+    }
+
+    @Test
+    public void onBindViewHolder_setIcon_shouldShowButtonByDefault() {
+        mPref.getButton(ActionButtons.BUTTON1).setIcon(R.drawable.ic_lock);
+        mPref.getButton(ActionButtons.BUTTON2).setIcon(R.drawable.ic_lock);
+        mPref.getButton(ActionButtons.BUTTON3).setIcon(R.drawable.ic_lock);
+        mPref.getButton(ActionButtons.BUTTON4).setIcon(R.drawable.ic_lock);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button2).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button3).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button4).getVisibility())
+                .isEqualTo(View.VISIBLE);
+    }
+
+    @Test
+    public void onBindViewHolder_notSetTitleOrIcon_shouldNotShowButtonByDefault() {
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button2).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button3).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button4).getVisibility())
+                .isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_setVisibleIsGoneAndSetTitle_shouldNotShowButton() {
+        mPref.getButton(ActionButtons.BUTTON1).setText(R.string.settings_label).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON2).setText(R.string.settings_label).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON3).setText(R.string.settings_label).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON4).setText(R.string.settings_label).setVisible(false);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button2).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button3).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button4).getVisibility())
+                .isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_setVisibleIsGoneAndSetIcon_shouldNotShowButton() {
+        mPref.getButton(ActionButtons.BUTTON1).setIcon(R.drawable.ic_lock).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON2).setIcon(R.drawable.ic_lock).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON3).setIcon(R.drawable.ic_lock).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON4).setIcon(R.drawable.ic_lock).setVisible(false);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button2).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button3).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button4).getVisibility())
+                .isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_setVisibility_shouldUpdateButtonVisibility() {
+        mPref.getButton(ActionButtons.BUTTON1).setText(R.string.settings_label).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON2).setText(R.string.settings_label).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON3).setText(R.string.settings_label).setVisible(false);
+        mPref.getButton(ActionButtons.BUTTON4).setText(R.string.settings_label).setVisible(false);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button2).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button3).getVisibility())
+                .isEqualTo(View.GONE);
+        assertThat(mRootView.findViewById(R.id.button4).getVisibility())
+                .isEqualTo(View.GONE);
+
+        mPref.getButton(ActionButtons.BUTTON1).setVisible(true);
+        mPref.getButton(ActionButtons.BUTTON2).setVisible(true);
+        mPref.getButton(ActionButtons.BUTTON3).setVisible(true);
+        mPref.getButton(ActionButtons.BUTTON4).setVisible(true);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button2).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button3).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(mRootView.findViewById(R.id.button4).getVisibility())
+                .isEqualTo(View.VISIBLE);
+    }
+
+    @Test
+    public void onBindViewHolder_setEnabled_shouldEnableButton() {
+        mPref.getButton(ActionButtons.BUTTON1).setEnabled(true);
+        mPref.getButton(ActionButtons.BUTTON2).setEnabled(false);
+        mPref.getButton(ActionButtons.BUTTON3).setEnabled(true);
+        mPref.getButton(ActionButtons.BUTTON4).setEnabled(false);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.button1).isEnabled()).isTrue();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button1Icon),
+                        android.R.attr.state_enabled)).isTrue();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button1Text),
+                        android.R.attr.state_enabled)).isTrue();
+        assertThat(mRootView.findViewById(R.id.button2).isEnabled()).isFalse();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button2Icon),
+                        android.R.attr.state_enabled)).isFalse();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button2Text),
+                        android.R.attr.state_enabled)).isFalse();
+        assertThat(mRootView.findViewById(R.id.button3).isEnabled()).isTrue();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button3Icon),
+                android.R.attr.state_enabled)).isTrue();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button3Text),
+                android.R.attr.state_enabled)).isTrue();
+        assertThat(mRootView.findViewById(R.id.button4).isEnabled()).isFalse();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button4Icon),
+                android.R.attr.state_enabled)).isFalse();
+        assertThat(containsDrawableState(mRootView.findViewById(R.id.button4Text),
+                android.R.attr.state_enabled)).isFalse();
+    }
+
+    @Test
+    public void onBindViewHolder_setText_shouldShowSameText() {
+        mPref.getButton(ActionButtons.BUTTON1).setText(R.string.settings_label);
+        mPref.getButton(ActionButtons.BUTTON2).setText(R.string.settings_label);
+        mPref.getButton(ActionButtons.BUTTON3).setText(R.string.settings_label);
+        mPref.getButton(ActionButtons.BUTTON4).setText(R.string.settings_label);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(((TextView) mRootView.findViewById(R.id.button1Text)).getText())
+                .isEqualTo(mContext.getText(R.string.settings_label));
+        assertThat(((TextView) mRootView.findViewById(R.id.button2Text)).getText())
+                .isEqualTo(mContext.getText(R.string.settings_label));
+        assertThat(((TextView) mRootView.findViewById(R.id.button3Text)).getText())
+                .isEqualTo(mContext.getText(R.string.settings_label));
+        assertThat(((TextView) mRootView.findViewById(R.id.button4Text)).getText())
+                .isEqualTo(mContext.getText(R.string.settings_label));
+    }
+
+    @Test
+    public void onBindViewHolder_setButtonIcon_iconMustDisplayAboveText() {
+        mPref.getButton(ActionButtons.BUTTON1).setText(R.string.settings_label).setIcon(
+                R.drawable.ic_lock);
+
+        mPref.onBindViewHolder(mHolder);
+        Drawable icon = ((ImageView) mRootView.findViewById(R.id.button1Icon)).getDrawable();
+
+        assertThat(icon).isNotNull();
+    }
+
+    @Test
+    public void onButtonClicked_shouldOnlyTriggerListenerIfEnabled() {
+        mPref.getButton(ActionButtons.BUTTON1).setEnabled(true);
+        mPref.getButton(ActionButtons.BUTTON2).setEnabled(false);
+
+        View.OnClickListener enabledListener = mock(View.OnClickListener.class);
+        View.OnClickListener disabledListener = mock(View.OnClickListener.class);
+        mPref.getButton(ActionButtons.BUTTON1).setOnClickListener(enabledListener);
+        mPref.getButton(ActionButtons.BUTTON2).setOnClickListener(disabledListener);
+
+        mPref.onBindViewHolder(mHolder);
+
+        mPref.getButton(ActionButtons.BUTTON1).performClick(null);
+        verify(enabledListener).onClick(any());
+
+        mPref.getButton(ActionButtons.BUTTON2).performClick(null);
+        verify(disabledListener, never()).onClick(any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void onButtonClicked_makesToastIfPreferenceRestricted() {
+        Toast mockToast = mock(Toast.class);
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mockToast);
+
+        mPref.setUxRestricted(true);
+        mPref.getButton(ActionButtons.BUTTON1).setEnabled(true);
+
+        View.OnClickListener listener = mock(View.OnClickListener.class);
+        mPref.getButton(ActionButtons.BUTTON1).setOnClickListener(listener);
+
+        mPref.onBindViewHolder(mHolder);
+
+        mPref.getButton(ActionButtons.BUTTON1).performClick(null);
+        verify(listener, never()).onClick(any());
+
+        verify(mockToast).show();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onButtonClicked_disabled_uxRestricted_shouldDoNothing() {
+        mPref.setUxRestricted(true);
+        mPref.getButton(ActionButtons.BUTTON1).setEnabled(false);
+
+        View.OnClickListener listener = mock(View.OnClickListener.class);
+        mPref.getButton(ActionButtons.BUTTON1).setOnClickListener(listener);
+
+        mPref.onBindViewHolder(mHolder);
+
+        mPref.getButton(ActionButtons.BUTTON1).performClick(null);
+        verify(listener, never()).onClick(any());
+
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), anyString(), anyInt()), never());
+    }
+
+    @Test
+    public void setButtonIcon_iconResourceIdIsZero_shouldNotDisplayIcon() {
+        mPref.getButton(ActionButtons.BUTTON1).setText(R.string.settings_label).setIcon(0);
+
+        mPref.onBindViewHolder(mHolder);
+        Drawable icon = ((ImageView) mRootView.findViewById(R.id.button1Icon)).getDrawable();
+
+        assertThat(icon).isNull();
+    }
+
+    @Test
+    public void setButtonIcon_iconResourceIdNotExisting_shouldNotDisplayIconAndCrash() {
+        mPref.getButton(ActionButtons.BUTTON1).setText(R.string.settings_label).setIcon(
+                999999999 /* not existing id */);
+        // Should not crash here
+        mPref.onBindViewHolder(mHolder);
+        Drawable icon = ((ImageView) mRootView.findViewById(R.id.button1Icon)).getDrawable();
+
+        assertThat(icon).isNull();
+    }
+
+    private boolean containsDrawableState(View view, int state) {
+        if (view == null) {
+            return false;
+        }
+        int[] drawableStates = view.getDrawableState();
+        return Arrays.stream(drawableStates).anyMatch(x -> x == state);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/BaseCarSettingsActivityTestCase.java b/tests/multivalent/src/com/android/car/settings/common/BaseCarSettingsActivityTestCase.java
new file mode 100644
index 000000000..14ff68a2e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/BaseCarSettingsActivityTestCase.java
@@ -0,0 +1,64 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static org.testng.Assert.assertThrows;
+
+import android.content.Context;
+
+import androidx.fragment.app.DialogFragment;
+import androidx.fragment.app.FragmentManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.preference.PreferenceFragment;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+
+@RunWith(AndroidJUnit4.class)
+abstract class BaseCarSettingsActivityTestCase<T extends BaseCarSettingsTestActivity> {
+    protected Context mContext = ApplicationProvider.getApplicationContext();
+    protected BaseCarSettingsTestActivity mActivity;
+    protected TopLevelMenuFragment mTopLevelFragment;
+    protected FragmentManager mFragmentManager;
+
+    abstract ActivityTestRule<T> getActivityTestRule();
+
+    @Before
+    public void setUp() throws Throwable {
+        mActivity = getActivityTestRule().getActivity();
+        mFragmentManager = mActivity.getSupportFragmentManager();
+    }
+
+    @Test
+    public void launchFragment_dialogFragment_throwsError() {
+        DialogFragment dialogFragment = new DialogFragment();
+
+        assertThrows(IllegalArgumentException.class,
+                () -> mActivity.launchFragment(dialogFragment));
+    }
+
+    protected PreferenceFragment getCurrentFragment() {
+        return (PreferenceFragment) mFragmentManager.findFragmentById(R.id.fragment_container);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/ColoredTwoActionSwitchPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/common/ColoredTwoActionSwitchPreferenceTest.java
new file mode 100644
index 000000000..5c8b9ad39
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/ColoredTwoActionSwitchPreferenceTest.java
@@ -0,0 +1,96 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static junit.framework.Assert.assertTrue;
+
+import android.content.Context;
+import android.view.View;
+import android.widget.Switch;
+import android.widget.TextView;
+
+import androidx.preference.PreferenceViewHolder;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class ColoredTwoActionSwitchPreferenceTest {
+    private static final String ACTION_TEXT = "action";
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private View mRootView;
+    private ColoredTwoActionSwitchPreference mPref;
+    private PreferenceViewHolder mHolder;
+
+    @Before
+    public void setUp() {
+        mRootView = View.inflate(mContext,
+                R.layout.colored_two_action_switch_preference, /* parent= */ null);
+        mHolder = PreferenceViewHolder.createInstanceForTests(mRootView);
+        mPref = new ColoredTwoActionSwitchPreference(mContext);
+    }
+
+    @Test
+    public void onBindViewHolder_noSetActionText_shouldNotBeVisible() {
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.action_text).getVisibility())
+                .isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_setActionText_shouldBeVisible() {
+        mPref.setActionText(ACTION_TEXT);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.action_text).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(((TextView) mRootView.findViewById(R.id.action_text)).getText())
+                .isEqualTo(ACTION_TEXT);
+    }
+
+    @Test
+    public void setSecondaryActionChecked_setToTrue_switchSetToTrue() {
+        mPref.setSecondaryActionChecked(true);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertTrue(((Switch) mRootView.findViewById(
+                R.id.colored_preference_secondary_action_concrete)).isChecked());
+    }
+
+    @Test
+    public void setIsWarning_setToTrue_yellowActionText() {
+        mPref.setIsWarning(true);
+        mPref.setActionText(ACTION_TEXT);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(((TextView) mRootView.findViewById(R.id.action_text)).getText())
+                .isEqualTo(ACTION_TEXT);
+        assertThat(((TextView) mRootView.findViewById(R.id.action_text)).getTextColors())
+                .isEqualTo(mPref.getWarningTextColor());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/ConfirmationDialogFragmentTest.java b/tests/multivalent/src/com/android/car/settings/common/ConfirmationDialogFragmentTest.java
new file mode 100644
index 000000000..09ffa3ab2
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/ConfirmationDialogFragmentTest.java
@@ -0,0 +1,195 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+
+import android.app.AlertDialog;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.os.Bundle;
+import android.view.View;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.DialogTestUtils;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ConfirmationDialogFragmentTest {
+
+    private static final String TEST_ARG_KEY = "arg_key";
+    private static final String TEST_ARG_VALUE = "arg_value";
+    private static final String TEST_TITLE = "Test Title";
+    private static final String TEST_MESSAGE = "Test Message";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private ConfirmationDialogFragment mFragment;
+    private ConfirmationDialogFragment.Builder mDialogFragmentBuilder;
+    private FragmentManager mFragmentManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule = new ActivityTestRule<>(
+            BaseCarSettingsTestActivity.class);
+
+    @Mock
+    private ConfirmationDialogFragment.ConfirmListener mConfirmListener;
+    @Mock
+    private ConfirmationDialogFragment.RejectListener mRejectListener;
+    @Mock
+    private ConfirmationDialogFragment.DismissListener mDismissListener;
+
+    @Before
+    public void setup() {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        mDialogFragmentBuilder = new ConfirmationDialogFragment.Builder(mContext);
+        mDialogFragmentBuilder.setTitle(TEST_TITLE);
+        mDialogFragmentBuilder.setMessage(TEST_MESSAGE);
+        mDialogFragmentBuilder.addArgumentString(TEST_ARG_KEY, TEST_ARG_VALUE);
+    }
+
+    @Test
+    public void buildDialogFragment_hasTitleAndMessage() throws Throwable {
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentBuilder.build();
+        launchDialogFragment(dialogFragment);
+
+        // TODO(b/148687802): Figure out why title returns empty string.
+        // assertThat(DialogTestUtils.getTitle(dialogFragment)).isEqualTo(TEST_TITLE);
+        assertThat(DialogTestUtils.getMessage(dialogFragment)).isEqualTo(TEST_MESSAGE);
+    }
+
+    @Test
+    public void buildDialogFragment_positiveButtonSet_negativeAndNeutralButtonNotVisible()
+            throws Throwable {
+        mDialogFragmentBuilder.setPositiveButton(R.string.test_positive_button_label, null);
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentBuilder.build();
+        launchDialogFragment(dialogFragment);
+
+        AlertDialog dialog = (AlertDialog) mFragment.getDialog();
+        assertThat(dialog.getButton(DialogInterface.BUTTON_POSITIVE).getVisibility()).isEqualTo(
+                View.VISIBLE);
+        assertThat(dialog.getButton(DialogInterface.BUTTON_NEGATIVE).getVisibility()).isEqualTo(
+                View.GONE);
+        assertThat(dialog.getButton(DialogInterface.BUTTON_NEUTRAL).getVisibility()).isEqualTo(
+                View.GONE);
+    }
+
+    @Test
+    public void buildDialogFragment_negativeButtonSet_positiveAndNeutralButtonNotVisible()
+            throws Throwable {
+        mDialogFragmentBuilder.setNegativeButton(R.string.test_negative_button_label, null);
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentBuilder.build();
+        launchDialogFragment(dialogFragment);
+
+        AlertDialog dialog = (AlertDialog) mFragment.getDialog();
+        assertThat(dialog.getButton(DialogInterface.BUTTON_POSITIVE).getVisibility()).isEqualTo(
+                View.GONE);
+        assertThat(dialog.getButton(DialogInterface.BUTTON_NEGATIVE).getVisibility()).isEqualTo(
+                View.VISIBLE);
+        assertThat(dialog.getButton(DialogInterface.BUTTON_NEUTRAL).getVisibility()).isEqualTo(
+                View.GONE);
+    }
+
+    @Test
+    public void buildDialogFragment_neutralButtonSet_positiveAndNegativeButtonNotVisible()
+            throws Throwable {
+        mDialogFragmentBuilder.setNeutralButton(R.string.test_neutral_button_label, null);
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentBuilder.build();
+        launchDialogFragment(dialogFragment);
+
+        AlertDialog dialog = (AlertDialog) mFragment.getDialog();
+        assertThat(dialog.getButton(DialogInterface.BUTTON_POSITIVE).getVisibility()).isEqualTo(
+                View.GONE);
+        assertThat(dialog.getButton(DialogInterface.BUTTON_NEGATIVE).getVisibility()).isEqualTo(
+                View.GONE);
+        assertThat(dialog.getButton(DialogInterface.BUTTON_NEUTRAL).getVisibility()).isEqualTo(
+                View.VISIBLE);
+    }
+
+    @Test
+    public void clickPositiveButton_callsCallbackWithArgs() throws Throwable {
+        mDialogFragmentBuilder.setPositiveButton(R.string.test_positive_button_label,
+                mConfirmListener);
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentBuilder.build();
+        launchDialogFragment(dialogFragment);
+
+        AlertDialog dialog = (AlertDialog) mFragment.getDialog();
+        mActivityTestRule.runOnUiThread(() ->
+                dialog.getButton(DialogInterface.BUTTON_POSITIVE).performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        ArgumentCaptor<Bundle> bundle = ArgumentCaptor.forClass(Bundle.class);
+        verify(mConfirmListener).onConfirm(bundle.capture());
+        assertThat(bundle.getValue().getString(TEST_ARG_KEY)).isEqualTo(TEST_ARG_VALUE);
+    }
+
+    @Test
+    public void clickNegativeButton_callsCallbackWithArgs() throws Throwable {
+        mDialogFragmentBuilder.setNegativeButton(R.string.test_negative_button_label,
+                mRejectListener);
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentBuilder.build();
+        launchDialogFragment(dialogFragment);
+
+        AlertDialog dialog = (AlertDialog) mFragment.getDialog();
+        mActivityTestRule.runOnUiThread(() ->
+                dialog.getButton(DialogInterface.BUTTON_NEGATIVE).performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        ArgumentCaptor<Bundle> bundle = ArgumentCaptor.forClass(Bundle.class);
+        verify(mRejectListener).onReject(bundle.capture());
+        assertThat(bundle.getValue().getString(TEST_ARG_KEY)).isEqualTo(TEST_ARG_VALUE);
+    }
+
+    @Test
+    public void dismissDialog_callsCallbackWithArgs() throws Throwable {
+        mDialogFragmentBuilder.setDismissListener(mDismissListener);
+        ConfirmationDialogFragment dialogFragment = mDialogFragmentBuilder.build();
+        launchDialogFragment(dialogFragment);
+
+        AlertDialog dialog = (AlertDialog) mFragment.getDialog();
+        mActivityTestRule.runOnUiThread(() -> dialog.dismiss());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        dialog.dismiss();
+        ArgumentCaptor<Bundle> bundle = ArgumentCaptor.forClass(Bundle.class);
+        verify(mDismissListener).onDismiss(bundle.capture(), eq(false));
+        assertThat(bundle.getValue().getString(TEST_ARG_KEY)).isEqualTo(TEST_ARG_VALUE);
+    }
+
+    private void launchDialogFragment(ConfirmationDialogFragment dialog) throws Throwable {
+        mActivityTestRule.runOnUiThread(
+                () -> dialog.show(mFragmentManager,
+                        ConfirmationDialogFragment.TAG));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (ConfirmationDialogFragment) mFragmentManager.findFragmentByTag(
+                ConfirmationDialogFragment.TAG);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/DualPaneBaseCarSettingsActivityTest.java b/tests/multivalent/src/com/android/car/settings/common/DualPaneBaseCarSettingsActivityTest.java
new file mode 100644
index 000000000..bb0c90c43
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/DualPaneBaseCarSettingsActivityTest.java
@@ -0,0 +1,63 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.content.Intent;
+
+import androidx.preference.Preference;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.BaseTestSettingsFragment;
+import com.android.car.settings.testutils.DualPaneTestActivity;
+
+import org.junit.Rule;
+import org.junit.Test;
+
+public class DualPaneBaseCarSettingsActivityTest
+        extends BaseCarSettingsActivityTestCase<DualPaneTestActivity> {
+
+    @Rule
+    public ActivityTestRule<DualPaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(DualPaneTestActivity.class);
+
+    @Override
+    ActivityTestRule<DualPaneTestActivity> getActivityTestRule() {
+        return mActivityTestRule;
+    }
+
+    @Test
+    public void onPreferenceStartFragment_startsActivity() throws Throwable {
+        Preference pref = new Preference(mContext);
+        pref.setFragment(BaseTestSettingsFragment.class.getName());
+
+        BaseCarSettingsTestActivity spiedActivity = spy(mActivity);
+        verify(spiedActivity, never()).startActivity(any(Intent.class));
+
+        mActivityTestRule.runOnUiThread(() ->
+                spiedActivity.onPreferenceStartFragment(/* caller= */ null, pref));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(spiedActivity).startActivity(any(Intent.class));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/DualPaneSettingsFragmentTest.java b/tests/multivalent/src/com/android/car/settings/common/DualPaneSettingsFragmentTest.java
new file mode 100644
index 000000000..c1de251e0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/DualPaneSettingsFragmentTest.java
@@ -0,0 +1,59 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assert.assertNotNull;
+
+import android.content.Intent;
+
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.DualPaneTestActivity;
+
+import org.junit.Rule;
+import org.junit.Test;
+
+import java.util.concurrent.atomic.AtomicReference;
+
+public class DualPaneSettingsFragmentTest extends SettingsFragmentTestCase<DualPaneTestActivity> {
+
+    @Rule
+    public ActivityTestRule<DualPaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(DualPaneTestActivity.class);
+
+    @Override
+    ActivityTestRule<DualPaneTestActivity> getActivityTestRule() {
+        return mActivityTestRule;
+    }
+
+    @Test
+    public void launchFragment_startsActivity() throws Throwable {
+        AtomicReference<TestSettingsFragment> otherFragment = new AtomicReference<>();
+        getActivityTestRule().runOnUiThread(() -> {
+            otherFragment.set(new TestSettingsFragment());
+            mFragment.onCreate(null);
+            mFragment.launchFragment(otherFragment.get());
+        });
+        Intent intent = mActivity.getStartActivityListener().getLastValue();
+        assertNotNull(intent);
+        assertNotNull(intent.getComponent());
+        assertThat(intent.getComponent().getClassName()).isEqualTo(
+                SubSettingsActivity.class.getName());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/DualPaneSubSettingsActivityTest.java b/tests/multivalent/src/com/android/car/settings/common/DualPaneSubSettingsActivityTest.java
new file mode 100644
index 000000000..7c1cd333a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/DualPaneSubSettingsActivityTest.java
@@ -0,0 +1,173 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentManager;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.BaseTestSettingsFragment;
+import com.android.car.settings.testutils.TestSubSettingsActivity;
+import com.android.car.ui.toolbar.NavButtonMode;
+import com.android.car.ui.toolbar.ToolbarController;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.concurrent.atomic.AtomicReference;
+
+@RunWith(AndroidJUnit4.class)
+public class DualPaneSubSettingsActivityTest {
+    Context mContext = ApplicationProvider.getApplicationContext();
+    TestSubSettingsActivity mActivity;
+    FragmentManager mFragmentManager;
+
+    @Rule
+    public ActivityTestRule<TestSubSettingsActivity> mActivityTestRule =
+            new ActivityTestRule<>(TestSubSettingsActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivity.getSupportFragmentManager();
+    }
+
+    @Test
+    public void onPreferenceStartFragment_updateFragmentContainer() throws Throwable {
+        Preference pref = new Preference(mContext);
+        pref.setFragment(BaseTestSettingsFragment.class.getName());
+
+        SubSettingsActivity spiedActivity = spy(mActivity);
+        verify(spiedActivity, never()).updateFragmentContainer(any(Fragment.class));
+
+        mActivityTestRule.runOnUiThread(() ->
+                spiedActivity.onPreferenceStartFragment(/* caller= */ null, pref));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(spiedActivity).updateFragmentContainer(any(Fragment.class));
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_topFragmentInBackStackHasUpdatedUxRestrictions()
+            throws Throwable {
+        CarUxRestrictions oldUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                /* timestamp= */ 0
+        ).build();
+
+        CarUxRestrictions newUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP,
+                /* timestamp= */ 0
+        ).build();
+
+        AtomicReference<BaseTestSettingsFragment> fragmentA = new AtomicReference<>();
+        AtomicReference<BaseTestSettingsFragment> fragmentB = new AtomicReference<>();
+
+        mActivityTestRule.runOnUiThread(() -> {
+            fragmentA.set(new BaseTestSettingsFragment());
+            fragmentB.set(new BaseTestSettingsFragment());
+            mActivity.launchFragment(fragmentA.get());
+            mActivity.onUxRestrictionsChanged(oldUxRestrictions);
+            mActivity.launchFragment(fragmentB.get());
+            mActivity.onUxRestrictionsChanged(newUxRestrictions);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(
+                fragmentB.get().getUxRestrictions().isSameRestrictions(newUxRestrictions)).isTrue();
+    }
+
+    @Test
+    public void onBackStackChanged_uxRestrictionsChanged_currentFragmentHasUpdatedUxRestrictions()
+            throws Throwable {
+        CarUxRestrictions oldUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                /* timestamp= */ 0
+        ).build();
+
+        CarUxRestrictions newUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP,
+                /* timestamp= */ 0
+        ).build();
+
+        AtomicReference<BaseTestSettingsFragment> fragmentA = new AtomicReference<>();
+        AtomicReference<BaseTestSettingsFragment> fragmentB = new AtomicReference<>();
+
+        mActivityTestRule.runOnUiThread(() -> {
+            fragmentA.set(new BaseTestSettingsFragment());
+            fragmentB.set(new BaseTestSettingsFragment());
+            mActivity.launchFragment(fragmentA.get());
+            mActivity.onUxRestrictionsChanged(oldUxRestrictions);
+            mActivity.launchFragment(fragmentB.get());
+            mActivity.onUxRestrictionsChanged(newUxRestrictions);
+            mActivity.goBack();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(
+                fragmentA.get().getUxRestrictions().isSameRestrictions(newUxRestrictions)).isTrue();
+    }
+
+    @Test
+    public void getToolbar_updateFragmentContainer_navButtonAlwaysBack() throws Throwable {
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.BACK);
+
+        BaseTestSettingsFragment fragment1 = new BaseTestSettingsFragment();
+        mActivityTestRule.runOnUiThread(() -> {
+            mActivity.updateFragmentContainer(fragment1);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mActivityTestRule.runOnUiThread(() -> {
+            fragment1.setupToolbar(fragment1.getToolbar());
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.BACK);
+
+
+        assertThat(toolbar.getNavButtonMode()).isEqualTo(NavButtonMode.BACK);
+
+        mActivityTestRule.runOnUiThread(() -> mActivity.goBack());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.BACK);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/EntityHeaderPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/common/EntityHeaderPreferenceTest.java
new file mode 100644
index 000000000..a85d5dc33
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/EntityHeaderPreferenceTest.java
@@ -0,0 +1,110 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.view.View;
+import android.widget.ImageView;
+import android.widget.TextView;
+
+import androidx.preference.PreferenceViewHolder;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class EntityHeaderPreferenceTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private View mRootView;
+    private EntityHeaderPreference mPref;
+    private PreferenceViewHolder mHolder;
+
+    @Before
+    public void setUp() {
+        mRootView = View.inflate(mContext, R.layout.entity_header_preference, /* parent= */ null);
+        mHolder = PreferenceViewHolder.createInstanceForTests(mRootView);
+        mPref = new EntityHeaderPreference(mContext);
+    }
+
+    @Test
+    public void onBindViewHolder_noSetIcon_shouldNotBeVisible() {
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.entity_header_icon).getVisibility())
+                .isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_noSetTitle_shouldNotBeVisible() {
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.entity_header_title).getVisibility())
+                .isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_noSetSummary_shouldNotBeVisible() {
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.entity_header_summary).getVisibility())
+                .isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_setIcon_shouldShowIcon() {
+        mPref.setIcon(R.drawable.ic_lock);
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.entity_header_icon).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(((ImageView) mRootView.findViewById(R.id.entity_header_icon)).getDrawable())
+                .isNotNull();
+    }
+
+    @Test
+    public void onBindViewHolder_setLabel_shouldShowSameText() {
+        mPref.setTitle(mContext.getText(R.string.settings_label));
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.entity_header_title).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(((TextView) mRootView.findViewById(R.id.entity_header_title)).getText())
+                .isEqualTo(mContext.getText(R.string.settings_label));
+    }
+
+    @Test
+    public void onBindViewHolder_setSummary_shouldShowSameText() {
+        mPref.setSummary(mContext.getText(R.string.settings_label));
+
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mRootView.findViewById(R.id.entity_header_summary).getVisibility())
+                .isEqualTo(View.VISIBLE);
+        assertThat(((TextView) mRootView.findViewById(R.id.entity_header_summary)).getText())
+                .isEqualTo(mContext.getText(R.string.settings_label));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java b/tests/multivalent/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
new file mode 100644
index 000000000..b9a782f6a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
@@ -0,0 +1,267 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.android.car.settings.common.ExtraSettingsLoader.META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_KEY_ORDER;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_URI;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_SUMMARY;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_SUMMARY_URI;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_TITLE;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_TITLE_URI;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.os.Bundle;
+
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class ExtraSettingsLoaderTest {
+    private static final String META_DATA_PREFERENCE_CATEGORY = "com.android.settings.category";
+    private static final String FAKE_CATEGORY = "fake_category";
+    private static final String FAKE_TITLE = "fake_title";
+    private static final String FAKE_TITLE1 = "fake_title1";
+    private static final String FAKE_TITLE2 = "fake_title2";
+    private static final String FAKE_SUMMARY = "fake_summary";
+    private static final String TEST_CONTENT_PROVIDER =
+            "content://com.android.car.settings.testutils.TestContentProvider";
+    private static final String DEVICE_CATEGORY = "com.android.settings.category.ia.device";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private ExtraSettingsLoader mExtraSettingsLoader;
+
+    @Mock
+    private PackageManager mPm;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mExtraSettingsLoader = new ExtraSettingsLoader(mContext);
+        mExtraSettingsLoader.setPackageManager(mPm);
+    }
+
+    private ResolveInfo createResolveInfo(String packageName, String className, Bundle metaData,
+            boolean isSystem) {
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.packageName = packageName;
+        activityInfo.name = className;
+        activityInfo.metaData = metaData;
+
+        ResolveInfo resolveInfoSystem = new ResolveInfo();
+        resolveInfoSystem.system = isSystem;
+        resolveInfoSystem.activityInfo = activityInfo;
+
+        return resolveInfoSystem;
+    }
+
+    private Map<Preference, Bundle> executeLoadPreferences(List<ResolveInfo> resolveInfoList,
+            String category) {
+        Intent intent = new Intent();
+        intent.putExtra(META_DATA_PREFERENCE_CATEGORY, category);
+
+        when(mPm.queryIntentActivitiesAsUser(eq(intent), eq(PackageManager.GET_META_DATA),
+                anyInt())).thenReturn(resolveInfoList);
+        return mExtraSettingsLoader.loadPreferences(intent);
+    }
+
+    @Test
+    public void testLoadPreference_uriResources_shouldNotLoadStaticResources() {
+        Bundle bundle = new Bundle();
+        bundle.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE);
+        bundle.putString(META_DATA_PREFERENCE_SUMMARY, FAKE_SUMMARY);
+        bundle.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+        bundle.putString(META_DATA_PREFERENCE_TITLE_URI, TEST_CONTENT_PROVIDER);
+        bundle.putString(META_DATA_PREFERENCE_SUMMARY_URI, TEST_CONTENT_PROVIDER);
+        bundle.putString(META_DATA_PREFERENCE_ICON_URI, TEST_CONTENT_PROVIDER);
+
+        ResolveInfo resolveInfoSystem = createResolveInfo("package_name", "class_name",
+                bundle, /* isSystem= */ true);
+
+        Map<Preference, Bundle> preferenceToBundleMap =
+                executeLoadPreferences(Collections.singletonList(resolveInfoSystem), FAKE_CATEGORY);
+
+        assertThat(preferenceToBundleMap).hasSize(1);
+
+        for (Preference p : preferenceToBundleMap.keySet()) {
+            assertThat(p.getTitle()).isNull();
+            assertThat(p.getSummary()).isNull();
+            assertThat(p.getIcon()).isNull();
+        }
+    }
+
+    @Test
+    public void testLoadPreference_sortPreferences_byMetadata() {
+        Bundle bundle1 = new Bundle();
+        bundle1.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE1);
+        bundle1.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+        bundle1.putInt(META_DATA_KEY_ORDER, 1);
+
+        ResolveInfo resolveInfoSystem1 = createResolveInfo("package_name1", "class_name1",
+                bundle1, /* isSystem= */ true);
+
+        Bundle bundle2 = new Bundle();
+        bundle2.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE2);
+        bundle2.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+        bundle2.putInt(META_DATA_KEY_ORDER, 2);
+
+        ResolveInfo resolveInfoSystem2 = createResolveInfo("package_name2", "class_name2",
+                bundle2, /* isSystem= */ true);
+
+        List<ResolveInfo> resolveInfoList = new ArrayList<>();
+        resolveInfoList.add(resolveInfoSystem1);
+        resolveInfoList.add(resolveInfoSystem2);
+
+        Map<Preference, Bundle> preferenceToBundleMap =
+                executeLoadPreferences(resolveInfoList, FAKE_CATEGORY);
+
+        assertThat(preferenceToBundleMap).hasSize(2);
+
+        Iterator<Preference> iter = preferenceToBundleMap.keySet().iterator();
+        assertThat(iter.next().getTitle().toString()).isEqualTo(FAKE_TITLE2);
+        assertThat(iter.next().getTitle().toString()).isEqualTo(FAKE_TITLE1);
+    }
+
+    @Test
+    public void testLoadPreference_sortPreferences_byPackageName() {
+        Bundle bundle1 = new Bundle();
+        bundle1.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE1);
+        bundle1.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+
+        ResolveInfo resolveInfoSystem1 = createResolveInfo("package_name1", "class_name1",
+                bundle1, /* isSystem= */ true);
+
+        Bundle bundle2 = new Bundle();
+        bundle2.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE2);
+        bundle2.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+
+        ResolveInfo resolveInfoSystem2 = createResolveInfo("package_name2", "class_name2",
+                bundle2, /* isSystem= */ true);
+
+        List<ResolveInfo> resolveInfoList = new ArrayList<>();
+        resolveInfoList.add(resolveInfoSystem2);
+        resolveInfoList.add(resolveInfoSystem1);
+
+        Map<Preference, Bundle> preferenceToBundleMap =
+                executeLoadPreferences(resolveInfoList, FAKE_CATEGORY);
+
+        assertThat(preferenceToBundleMap).hasSize(2);
+
+        Iterator<Preference> iter = preferenceToBundleMap.keySet().iterator();
+        assertThat(iter.next().getTitle().toString()).isEqualTo(FAKE_TITLE1);
+        assertThat(iter.next().getTitle().toString()).isEqualTo(FAKE_TITLE2);
+    }
+
+    @Test
+    public void testLoadPreference_sortPreferences_prioritizeMetadata() {
+        Bundle bundle1 = new Bundle();
+        bundle1.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE1);
+        bundle1.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+
+        ResolveInfo resolveInfoSystem1 = createResolveInfo("package_name1", "class_name1",
+                bundle1, /* isSystem= */ true);
+
+        Bundle bundle2 = new Bundle();
+        bundle2.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE2);
+        bundle2.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+        bundle2.putInt(META_DATA_KEY_ORDER, 2);
+
+        ResolveInfo resolveInfoSystem2 = createResolveInfo("package_name2", "class_name2",
+                bundle2, /* isSystem= */ true);
+
+        List<ResolveInfo> resolveInfoList = new ArrayList<>();
+        resolveInfoList.add(resolveInfoSystem1);
+        resolveInfoList.add(resolveInfoSystem2);
+
+        Map<Preference, Bundle> preferenceToBundleMap =
+                executeLoadPreferences(resolveInfoList, FAKE_CATEGORY);
+
+        assertThat(preferenceToBundleMap).hasSize(2);
+
+        Iterator<Preference> iter = preferenceToBundleMap.keySet().iterator();
+        assertThat(iter.next().getTitle().toString()).isEqualTo(FAKE_TITLE2);
+        assertThat(iter.next().getTitle().toString()).isEqualTo(FAKE_TITLE1);
+    }
+
+    @Test
+    public void testLoadPreference_isTopLevel_topLevelMetadataSet() {
+        Bundle bundle = new Bundle();
+        bundle.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE);
+        bundle.putString(META_DATA_PREFERENCE_SUMMARY, FAKE_SUMMARY);
+        bundle.putString(META_DATA_PREFERENCE_CATEGORY, DEVICE_CATEGORY);
+
+        ResolveInfo resolveInfo = createResolveInfo("package_name", "class_name",
+                bundle, /* isSystem= */ true);
+
+        Map<Preference, Bundle> preferenceToBundleMap = executeLoadPreferences(
+                Collections.singletonList(resolveInfo), DEVICE_CATEGORY);
+
+        assertThat(preferenceToBundleMap).hasSize(1);
+        for (Bundle b : preferenceToBundleMap.values()) {
+            assertThat(b.getBoolean(META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS)).isTrue();
+        }
+    }
+
+    @Test
+    public void testLoadPreference_notSystem_notLoaded() {
+        Bundle bundle = new Bundle();
+        bundle.putString(META_DATA_PREFERENCE_TITLE, FAKE_TITLE);
+        bundle.putString(META_DATA_PREFERENCE_CATEGORY, FAKE_CATEGORY);
+
+        ResolveInfo resolveInfo = createResolveInfo("package_name1", "class_name1",
+                bundle, /* isSystem= */ false);
+
+        Map<Preference, Bundle> preferenceToBundleMap =
+                executeLoadPreferences(Collections.singletonList(resolveInfo), FAKE_CATEGORY);
+
+        assertThat(preferenceToBundleMap).hasSize(0);
+    }
+
+    @Test
+    public void testLoadPreference_noMetaData_notLoaded() {
+        ResolveInfo resolveInfo = createResolveInfo("package_name1", "class_name1",
+                /* metaData= */ null, /* isSystem= */ true);
+
+        Map<Preference, Bundle> preferenceToBundleMap =
+                executeLoadPreferences(Collections.singletonList(resolveInfo), FAKE_CATEGORY);
+
+        assertThat(preferenceToBundleMap).hasSize(0);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/ExtraSettingsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/common/ExtraSettingsPreferenceControllerTest.java
new file mode 100644
index 000000000..c0c06c9e6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/ExtraSettingsPreferenceControllerTest.java
@@ -0,0 +1,345 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.android.car.settings.common.ExtraSettingsPreferenceController.META_DATA_DISTRACTION_OPTIMIZED;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_URI;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_SUMMARY_URI;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_TITLE_URI;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.inOrder;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.graphics.drawable.Drawable;
+import android.os.Bundle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestContentProvider;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.car.ui.preference.UxRestrictablePreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.InOrder;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.util.HashMap;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class ExtraSettingsPreferenceControllerTest {
+    private static final Intent FAKE_INTENT = new Intent();
+    private static final CarUxRestrictions NO_SETUP_UX_RESTRICTIONS =
+            new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                    CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, /* timestamp= */ 0).build();
+
+    private static final CarUxRestrictions BASELINE_UX_RESTRICTIONS =
+            new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                    CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+    private static final CarUxRestrictions NO_UX_RESTRICTIONS =
+            new CarUxRestrictions.Builder(/* reqOpt= */ false,
+                    CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+    private static final String TEST_PROVIDER =
+            "content://com.android.car.settings.testutils.TestContentProvider";
+
+    private LifecycleOwner mLifecycleOwner;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private PreferenceManager mPreferenceManager;
+    private PreferenceScreen mScreen;
+    private FakeExtraSettingsPreferenceController mPreferenceController;
+    private CarUiPreference mPreference;
+    private Map<Preference, Bundle> mPreferenceBundleMap;
+    private Bundle mMetaData;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ExtraSettingsLoader mExtraSettingsLoaderMock;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        MockitoAnnotations.initMocks(this);
+
+        mPreferenceController = new FakeExtraSettingsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController,
+                BASELINE_UX_RESTRICTIONS);
+
+        mPreferenceManager = new PreferenceManager(mContext);
+        mScreen = mPreferenceManager.createPreferenceScreen(mContext);
+        mScreen.setIntent(FAKE_INTENT);
+        mPreferenceController.setPreference(mScreen);
+        mPreference = spy(new CarUiPreference(mContext));
+        mPreference.setIntent(new Intent().setPackage("com.android.car.settings"));
+
+        mPreferenceBundleMap = new HashMap<>();
+        mMetaData = new Bundle();
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_restricted_preferenceRestricted() {
+        mMetaData.putBoolean(META_DATA_DISTRACTION_OPTIMIZED, false);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Mockito.reset(mPreference);
+        mPreferenceController.onUxRestrictionsChanged(NO_SETUP_UX_RESTRICTIONS);
+
+        verify((UxRestrictablePreference) mPreference).setUxRestricted(true);
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_unrestricted_preferenceUnrestricted() {
+        mMetaData.putBoolean(META_DATA_DISTRACTION_OPTIMIZED, false);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Mockito.reset(mPreference);
+        mPreferenceController.onUxRestrictionsChanged(NO_UX_RESTRICTIONS);
+
+        verify((UxRestrictablePreference) mPreference).setUxRestricted(false);
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_restricted_viewOnly_preferenceUnrestricted() {
+        mMetaData.putBoolean(META_DATA_DISTRACTION_OPTIMIZED, false);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.setAvailabilityStatus(PreferenceController.AVAILABLE_FOR_VIEWING);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Mockito.reset(mPreference);
+        mPreferenceController.onUxRestrictionsChanged(NO_SETUP_UX_RESTRICTIONS);
+
+        verify((UxRestrictablePreference) mPreference).setUxRestricted(false);
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_distractionOptimized_preferenceUnrestricted() {
+        mMetaData.putBoolean(META_DATA_DISTRACTION_OPTIMIZED, true);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Mockito.reset(mPreference);
+        mPreferenceController.onUxRestrictionsChanged(NO_SETUP_UX_RESTRICTIONS);
+
+        verify((UxRestrictablePreference) mPreference).setUxRestricted(false);
+    }
+
+    @Test
+    public void onCreate_hasDynamicTitleData_placeholderAdded() {
+        mMetaData.putString(META_DATA_PREFERENCE_TITLE_URI, TEST_PROVIDER);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mPreference).setTitle(
+                ResourceTestUtils.getString(mContext, "empty_placeholder"));
+    }
+
+    @Test
+    public void onCreate_hasDynamicSummaryData_placeholderAdded() {
+        mMetaData.putString(META_DATA_PREFERENCE_SUMMARY_URI, TEST_PROVIDER);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mPreference).setSummary(
+                ResourceTestUtils.getString(mContext, "empty_placeholder"));
+    }
+
+    @Test
+    public void onCreate_hasDynamicIconData_placeholderAdded() {
+        mMetaData.putString(META_DATA_PREFERENCE_ICON_URI, TEST_PROVIDER);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mPreference).setIcon(R.drawable.ic_placeholder);
+    }
+
+    @Test
+    public void onCreate_hasDynamicTitleData_TitleSet() {
+        mMetaData.putString(META_DATA_PREFERENCE_TITLE_URI,
+                TEST_PROVIDER + "/getText/textKey");
+
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getTitle()).isEqualTo(TestContentProvider.TEST_TEXT_CONTENT);
+    }
+
+    @Test
+    public void onCreate_hasDynamicSummaryData_summarySet() {
+        mMetaData.putString(META_DATA_PREFERENCE_SUMMARY_URI,
+                TEST_PROVIDER + "/getText/textKey");
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(TestContentProvider.TEST_TEXT_CONTENT);
+    }
+
+    @Test
+    public void onCreate_hasDynamicIconData_iconSet() {
+        mMetaData.putString(META_DATA_PREFERENCE_ICON_URI,
+                TEST_PROVIDER + "/getIcon/iconKey");
+
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        InOrder inOrder = inOrder(mPreference);
+        inOrder.verify(mPreference).setIcon(R.drawable.ic_placeholder);
+        inOrder.verify(mPreference).setIcon(any(Drawable.class));
+    }
+
+    @Test
+    public void onStart_hasDynamicTitleData_observerAdded() {
+        mMetaData.putString(META_DATA_PREFERENCE_TITLE_URI, TEST_PROVIDER);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.mObservers.size()).isEqualTo(1);
+    }
+
+    @Test
+    public void onStart_hasDynamicSummaryData_observerAdded() {
+        mMetaData.putString(META_DATA_PREFERENCE_SUMMARY_URI, TEST_PROVIDER);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.mObservers.size()).isEqualTo(1);
+    }
+
+    @Test
+    public void onStart_hasDynamicIconData_observerAdded() {
+        mMetaData.putString(META_DATA_PREFERENCE_ICON_URI, TEST_PROVIDER);
+        mPreferenceBundleMap.put(mPreference, mMetaData);
+        when(mExtraSettingsLoaderMock.loadPreferences(FAKE_INTENT)).thenReturn(
+                mPreferenceBundleMap);
+        mPreferenceController.setExtraSettingsLoader(mExtraSettingsLoaderMock);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.mObservers.size()).isEqualTo(1);
+    }
+
+    private static class FakeExtraSettingsPreferenceController extends
+            ExtraSettingsPreferenceController {
+
+        private int mAvailabilityStatus;
+
+        FakeExtraSettingsPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+            mAvailabilityStatus = AVAILABLE;
+        }
+
+        @Override
+        void executeBackgroundTask(Runnable r) {
+            // run task immediately on main thread
+            r.run();
+        }
+
+        @Override
+        void executeUiTask(Runnable r) {
+            // run task immediately on main thread
+            r.run();
+        }
+
+        @Override
+        protected int getDefaultAvailabilityStatus() {
+            return mAvailabilityStatus;
+        }
+
+        public void setAvailabilityStatus(int availabilityStatus) {
+            mAvailabilityStatus = availabilityStatus;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/FakePreferenceController.java b/tests/multivalent/src/com/android/car/settings/common/FakePreferenceController.java
new file mode 100644
index 000000000..442a816c8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/FakePreferenceController.java
@@ -0,0 +1,195 @@
+/*
+ * Copyright 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.preference.Preference;
+
+import java.util.HashSet;
+import java.util.Set;
+
+/**
+ * Concrete {@link PreferenceController} with methods for verifying behavior in tests.
+ */
+public class FakePreferenceController extends PreferenceController<Preference> {
+
+    @AvailabilityStatus
+    private int mAvailabilityStatus;
+    private int mCheckInitializedCallCount;
+    private int mOnCreateInternalCallCount;
+    private int mOnStartInternalCallCount;
+    private int mOnResumeInternalCallCount;
+    private int mOnPauseInternalCallCount;
+    private int mOnStopInternalCallCount;
+    private int mOnDestroyInternalCallCount;
+    private int mUpdateStateCallCount;
+    private Preference mUpdateStateArg;
+    private int mHandlePreferenceChangedCallCount;
+    private Preference mHandlePreferenceChangedPreferenceArg;
+    private Object mHandlePreferenceChangedValueArg;
+    private int mHandlePreferenceClickedCallCount;
+    private Preference mHandlePreferenceClickedArg;
+    private boolean mAllIgnoresUxRestrictions = false;
+    private Set<String> mPreferencesIgnoringUxRestrictions = new HashSet<>();
+
+    public FakePreferenceController(Context context, String preferenceKey,
+            FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+        super(context, preferenceKey, fragmentController, uxRestrictions);
+        mAvailabilityStatus = super.getAvailabilityStatus();
+    }
+
+    @Override
+    protected Class<Preference> getPreferenceType() {
+        return Preference.class;
+    }
+
+    @Override
+    protected void checkInitialized() {
+        mCheckInitializedCallCount++;
+    }
+
+    int getCheckInitializedCallCount() {
+        return mCheckInitializedCallCount;
+    }
+
+    @Override
+    @AvailabilityStatus
+    protected int getDefaultAvailabilityStatus() {
+        return mAvailabilityStatus;
+    }
+
+    void setAvailabilityStatus(@AvailabilityStatus int availabilityStatus) {
+        mAvailabilityStatus = availabilityStatus;
+    }
+
+    @Override
+    protected void onCreateInternal() {
+        mOnCreateInternalCallCount++;
+    }
+
+    int getOnCreateInternalCallCount() {
+        return mOnCreateInternalCallCount;
+    }
+
+    @Override
+    protected void onStartInternal() {
+        mOnStartInternalCallCount++;
+    }
+
+    int getOnStartInternalCallCount() {
+        return mOnStartInternalCallCount;
+    }
+
+    @Override
+    protected void onResumeInternal() {
+        mOnResumeInternalCallCount++;
+    }
+
+    int getOnResumeInternalCallCount() {
+        return mOnResumeInternalCallCount;
+    }
+
+    @Override
+    protected void onPauseInternal() {
+        mOnPauseInternalCallCount++;
+    }
+
+    int getOnPauseInternalCallCount() {
+        return mOnPauseInternalCallCount;
+    }
+
+    @Override
+    protected void onStopInternal() {
+        mOnStopInternalCallCount++;
+    }
+
+    int getOnStopInternalCallCount() {
+        return mOnStopInternalCallCount;
+    }
+
+    @Override
+    protected void onDestroyInternal() {
+        mOnDestroyInternalCallCount++;
+    }
+
+    int getOnDestroyInternalCallCount() {
+        return mOnDestroyInternalCallCount;
+    }
+
+    @Override
+    protected void updateState(Preference preference) {
+        mUpdateStateArg = preference;
+        mUpdateStateCallCount++;
+    }
+
+    Preference getUpdateStateArg() {
+        return mUpdateStateArg;
+    }
+
+    int getUpdateStateCallCount() {
+        return mUpdateStateCallCount;
+    }
+
+    @Override
+    protected boolean handlePreferenceChanged(Preference preference, Object newValue) {
+        mHandlePreferenceChangedCallCount++;
+        mHandlePreferenceChangedPreferenceArg = preference;
+        mHandlePreferenceChangedValueArg = newValue;
+        return super.handlePreferenceChanged(preference, newValue);
+    }
+
+    int getHandlePreferenceChangedCallCount() {
+        return mHandlePreferenceChangedCallCount;
+    }
+
+    Preference getHandlePreferenceChangedPreferenceArg() {
+        return mHandlePreferenceChangedPreferenceArg;
+    }
+
+    Object getHandlePreferenceChangedValueArg() {
+        return mHandlePreferenceChangedValueArg;
+    }
+
+    @Override
+    protected boolean handlePreferenceClicked(Preference preference) {
+        mHandlePreferenceClickedCallCount++;
+        mHandlePreferenceClickedArg = preference;
+        return super.handlePreferenceClicked(preference);
+    }
+
+    int getHandlePreferenceClickedCallCount() {
+        return mHandlePreferenceClickedCallCount;
+    }
+
+    Preference getHandlePreferenceClickedArg() {
+        return mHandlePreferenceClickedArg;
+    }
+
+    @Override
+    protected boolean isUxRestrictionsIgnored(boolean allIgnores, Set preferencesThatIgnore) {
+        return super.isUxRestrictionsIgnored(mAllIgnoresUxRestrictions,
+                mPreferencesIgnoringUxRestrictions);
+    }
+
+    protected void setUxRestrictionsIgnoredConfig(boolean allIgnore, Set preferencesThatIgnore) {
+        mAllIgnoresUxRestrictions = allIgnore;
+        mPreferencesIgnoringUxRestrictions = preferencesThatIgnore;
+    }
+
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/LogicalRootPreferenceGroupTest.java b/tests/multivalent/src/com/android/car/settings/common/LogicalRootPreferenceGroupTest.java
new file mode 100644
index 000000000..979792ccd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/LogicalRootPreferenceGroupTest.java
@@ -0,0 +1,120 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class LogicalRootPreferenceGroupTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LogicalRootPreferenceGroup mPreferenceGroup;
+    private PreferenceScreen mPreferenceScreen;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        mPreferenceScreen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalRootPreferenceGroup(mContext);
+        mPreferenceGroup.setKey("group1");
+        mPreferenceScreen.addPreference(mPreferenceGroup);
+    }
+
+    @Test
+    public void addPreference_toParent_notToGroup() {
+        Preference preference = new Preference(mContext);
+        preference.setTitle("Title1");
+        mPreferenceGroup.addPreference(preference);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+        assertThat(mPreferenceScreen.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreferenceScreen.getPreference(1).getTitle())
+                .isEqualTo(preference.getTitle());
+    }
+
+    @Test
+    public void injectPreferencesToParent_whenOrderingAsAdded() {
+        // adding second preference to screen
+        mPreferenceScreen.setOrderingAsAdded(true);
+        Preference preference0 = new Preference(mContext);
+        preference0.setTitle("Title0");
+        mPreferenceScreen.addPreference(preference0);
+
+        // Preference to insert
+        Preference insertedPreference1 = new Preference(mContext);
+        insertedPreference1.setTitle("Title1");
+        mPreferenceGroup.addPreference(insertedPreference1);
+
+        Preference insertedPreference2 = new Preference(mContext);
+        insertedPreference2.setTitle("Title2");
+        mPreferenceGroup.addPreference(insertedPreference2);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+        assertThat(mPreferenceScreen.getPreferenceCount()).isEqualTo(4);
+        assertThat(mPreferenceScreen.getPreference(0).getOrder())
+                .isEqualTo(0);
+        assertThat(mPreferenceScreen.getPreference(1).getOrder())
+                .isEqualTo(3);
+        // this is insertedPreference1, but with order 1
+        assertThat(mPreferenceScreen.getPreference(2).getOrder())
+                .isEqualTo(1);
+        assertThat(mPreferenceScreen.getPreference(2).getTitle())
+                .isEqualTo(insertedPreference1.getTitle());
+
+        // this is insertedPreference2, but with order 2
+        assertThat(mPreferenceScreen.getPreference(3).getOrder())
+                .isEqualTo(2);
+        assertThat(mPreferenceScreen.getPreference(3).getTitle())
+                .isEqualTo(insertedPreference2.getTitle());
+    }
+
+    @Test
+    public void injectPreferencesToParent_NotOrderingAsAdded_fail() {
+        // adding second preference to screen
+        mPreferenceScreen.setOrderingAsAdded(false);
+        Preference preference0 = new Preference(mContext);
+        preference0.setTitle("Title1");
+        mPreferenceScreen.addPreference(preference0);
+
+        // Preference to append
+        Preference appendedPreference = new Preference(mContext);
+        appendedPreference.setTitle("Title2");
+        mPreferenceGroup.addPreference(appendedPreference);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+        assertThat(mPreferenceScreen.getPreferenceCount()).isEqualTo(3);
+        assertThat(mPreferenceScreen.getPreference(0).getKey())
+                .isEqualTo(mPreferenceGroup.getKey());
+        assertThat(mPreferenceScreen.getPreference(1).getTitle())
+                .isEqualTo(preference0.getTitle());
+        assertThat(mPreferenceScreen.getPreference(2).getTitle())
+                .isEqualTo(appendedPreference.getTitle());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/MultiActionPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/common/MultiActionPreferenceTest.java
new file mode 100644
index 000000000..d40211673
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/MultiActionPreferenceTest.java
@@ -0,0 +1,288 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.ArgumentMatchers.nullable;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.res.TypedArray;
+import android.util.AttributeSet;
+import android.view.View;
+
+import androidx.preference.PreferenceViewHolder;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class MultiActionPreferenceTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private View mRootView;
+    private MultiActionPreference mPref;
+    private PreferenceViewHolder mHolder;
+
+    @Mock
+    private TypedArray mTypedArray;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mRootView = View.inflate(mContext, R.layout.multi_action_preference, null);
+        mHolder = PreferenceViewHolder.createInstanceForTests(mRootView);
+        // Mocked int and boolean values from TypedArray seem to be 0, so default values can't be
+        // used. Must manually set tested values
+        doReturn(mTypedArray).when(mContext).obtainStyledAttributes(nullable(AttributeSet.class),
+                eq(R.styleable.MultiActionPreference));
+    }
+
+    @Test
+    @UiThreadTest
+    public void onBindViewHolder_actionItemsNullByDefault() {
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_one),
+                anyInt())).thenReturn(-1);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_two),
+                anyInt())).thenReturn(-1);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_three),
+                anyInt())).thenReturn(-1);
+        mPref = new MultiActionPreference(mContext);
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1))
+                .isNull();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2))
+                .isNull();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3))
+                .isNull();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onBindViewHolder_toggleButtons_attributesVisible() {
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_one),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_two),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_three),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getBoolean(eq(R.styleable.MultiActionPreference_action_item_one_shown),
+                anyBoolean())).thenReturn(true);
+        when(mTypedArray.getBoolean(eq(R.styleable.MultiActionPreference_action_item_two_shown),
+                anyBoolean())).thenReturn(true);
+        when(mTypedArray.getBoolean(eq(R.styleable.MultiActionPreference_action_item_three_shown),
+                anyBoolean())).thenReturn(true);
+        mPref = new MultiActionPreference(mContext);
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .isVisible()).isTrue();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2)
+                .isVisible()).isTrue();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3)
+                .isVisible()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onBindViewHolder_toggleButtons_attributesEnabled() {
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_one),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_two),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_three),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_one_enabled), anyBoolean()))
+                .thenReturn(true);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_two_enabled), anyBoolean()))
+                .thenReturn(true);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_three_enabled), anyBoolean()))
+                .thenReturn(true);
+        mPref = new MultiActionPreference(mContext);
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .isEnabled()).isTrue();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2)
+                .isEnabled()).isTrue();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3)
+                .isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onBindViewHolder_toggleButtons_attributesNotVisible() {
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_one),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_two),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_three),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getBoolean(eq(R.styleable.MultiActionPreference_action_item_one_shown),
+                anyBoolean())).thenReturn(false);
+        when(mTypedArray.getBoolean(eq(R.styleable.MultiActionPreference_action_item_two_shown),
+                anyBoolean())).thenReturn(false);
+        when(mTypedArray.getBoolean(eq(R.styleable.MultiActionPreference_action_item_three_shown),
+                anyBoolean())).thenReturn(false);
+        mPref = new MultiActionPreference(mContext);
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .isVisible()).isFalse();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2)
+                .isVisible()).isFalse();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3)
+                .isVisible()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onBindViewHolder_toggleButtons_attributesNotEnabled() {
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_one),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_two),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_three),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_one_enabled), anyBoolean()))
+                .thenReturn(false);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_two_enabled), anyBoolean()))
+                .thenReturn(false);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_three_enabled), anyBoolean()))
+                .thenReturn(false);
+        mPref = new MultiActionPreference(mContext);
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .isEnabled()).isFalse();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2)
+                .isEnabled()).isFalse();
+        assertThat(mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3)
+                .isEnabled()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void toggleButtons_onClick_checkedStateChanges() {
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_one),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_two),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInt(eq(R.styleable.MultiActionPreference_action_item_three),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_one_enabled), anyBoolean()))
+                .thenReturn(true);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_two_enabled), anyBoolean()))
+                .thenReturn(true);
+        when(mTypedArray.getBoolean(
+                eq(R.styleable.MultiActionPreference_action_item_three_enabled), anyBoolean()))
+                .thenReturn(true);
+        mPref = new MultiActionPreference(mContext);
+        // OnClickListeners needed for check state to change
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1)).setOnClickListener(c -> {});
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2)).setOnClickListener(c -> {});
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3)).setOnClickListener(c -> {});
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1)).isChecked()).isTrue();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2)).isChecked()).isTrue();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3)).isChecked()).isTrue();
+
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1)).onClick();
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2)).onClick();
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3)).onClick();
+
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1)).isChecked()).isFalse();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2)).isChecked()).isFalse();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3)).isChecked()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void toggleButtons_onClickRestricted_checkedStateDoesNotChange() {
+        when(mTypedArray.getInteger(eq(R.styleable.MultiActionPreference_action_item_one),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInteger(eq(R.styleable.MultiActionPreference_action_item_two),
+                anyInt())).thenReturn(0);
+        when(mTypedArray.getInteger(eq(R.styleable.MultiActionPreference_action_item_three),
+                anyInt())).thenReturn(0);
+        mPref = new MultiActionPreference(mContext);
+        mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM1)
+                .setRestricted(true);
+        mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM2)
+                .setRestricted(true);
+        mPref.getActionItem(MultiActionPreference.ActionItem.ACTION_ITEM3)
+                .setRestricted(true);
+        mPref.onBindViewHolder(mHolder);
+
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1)).isChecked()).isTrue();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2)).isChecked()).isTrue();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3)).isChecked()).isTrue();
+
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1)).onClick();
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2)).onClick();
+        ((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3)).onClick();
+
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM1)).isChecked()).isTrue();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM2)).isChecked()).isTrue();
+        assertThat(((ToggleButtonActionItem) mPref.getActionItem(
+                MultiActionPreference.ActionItem.ACTION_ITEM3)).isChecked()).isTrue();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/PreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/common/PreferenceControllerTest.java
new file mode 100644
index 000000000..f288c597f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/PreferenceControllerTest.java
@@ -0,0 +1,517 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.common.PreferenceXmlParser.PREF_AVAILABILITY_STATUS_HIDDEN;
+import static com.android.car.settings.common.PreferenceXmlParser.PREF_AVAILABILITY_STATUS_READ;
+import static com.android.car.settings.common.PreferenceXmlParser.PREF_AVAILABILITY_STATUS_WRITE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.car.ui.preference.UxRestrictablePreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.util.HashSet;
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class PreferenceControllerTest {
+
+    private static final CarUxRestrictions LIMIT_STRINGS_UX_RESTRICTIONS =
+            new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                    CarUxRestrictions.UX_RESTRICTIONS_LIMIT_STRING_LENGTH, /* timestamp= */
+                    0).build();
+    private static final CarUxRestrictions NO_SETUP_UX_RESTRICTIONS =
+            new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                    CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, /* timestamp= */ 0).build();
+
+    private static final CarUxRestrictions BASELINE_UX_RESTRICTIONS =
+            new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                    CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+    private static final String PREFERENCE_KEY = "key";
+
+    private LifecycleOwner mLifecycleOwner;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private FakePreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUiPreference mPreference;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        MockitoAnnotations.initMocks(this);
+
+        mPreferenceController = new FakePreferenceController(mContext, PREFERENCE_KEY,
+                mFragmentController, BASELINE_UX_RESTRICTIONS);
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_restricted_preferenceRestricted() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Mockito.reset(mPreference);
+        mPreferenceController.onUxRestrictionsChanged(NO_SETUP_UX_RESTRICTIONS);
+
+        verify((UxRestrictablePreference) mPreference).setUxRestricted(true);
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_restricted_viewOnly_preferenceUnrestricted() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(AVAILABLE_FOR_VIEWING);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Mockito.reset(mPreference);
+        mPreferenceController.onUxRestrictionsChanged(NO_SETUP_UX_RESTRICTIONS);
+
+        verify((UxRestrictablePreference) mPreference).setUxRestricted(false);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onUxRestrictionsChanged_restricted_preferenceGroup_preferencesRestricted() {
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen preferenceScreen = preferenceManager.createPreferenceScreen(mContext);
+        CarUiPreference preference1 = mock(CarUiPreference.class);
+        CarUiPreference preference2 = mock(CarUiPreference.class);
+        preferenceScreen.addPreference(preference1);
+        preferenceScreen.addPreference(preference2);
+
+        mPreferenceController.setPreference(preferenceScreen);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Mockito.reset(preference1);
+        Mockito.reset(preference2);
+        mPreferenceController.onUxRestrictionsChanged(NO_SETUP_UX_RESTRICTIONS);
+
+        verify((UxRestrictablePreference) preference1).setUxRestricted(true);
+        verify((UxRestrictablePreference) preference2).setUxRestricted(true);
+    }
+
+    @Test
+    public void shouldApplyUxRestrictions_baseline() {
+        boolean result = mPreferenceController.shouldApplyUxRestrictions(BASELINE_UX_RESTRICTIONS);
+        assertThat(result).isFalse();
+    }
+
+    @Test
+    public void shouldApplyUxRestrictions_isNoSetup() {
+        mPreferenceController.setUxRestrictionsIgnoredConfig(false, new HashSet<String>());
+        boolean result = mPreferenceController.shouldApplyUxRestrictions(NO_SETUP_UX_RESTRICTIONS);
+        assertThat(result).isTrue();
+    }
+
+    @Test
+    public void shouldApplyUxRestrictions_containsKey() {
+        Set prefsThatIgnore = new HashSet<String>();
+        prefsThatIgnore.add(PREFERENCE_KEY);
+
+        mPreferenceController.setUxRestrictionsIgnoredConfig(false, prefsThatIgnore);
+        boolean result = mPreferenceController.shouldApplyUxRestrictions(NO_SETUP_UX_RESTRICTIONS);
+        assertThat(result).isFalse();
+    }
+
+    @Test
+    public void shouldApplyUxRestrictions_not_containsKey() {
+        Set prefsThatIgnore = new HashSet<String>();
+        prefsThatIgnore.add("unknown key");
+
+        mPreferenceController.setUxRestrictionsIgnoredConfig(false, prefsThatIgnore);
+        boolean result = mPreferenceController.shouldApplyUxRestrictions(NO_SETUP_UX_RESTRICTIONS);
+        assertThat(result).isTrue();
+    }
+
+    @Test
+    public void shouldApplyUxRestrictions_allIgnore() {
+        Set prefsThatIgnore = new HashSet<String>();
+        prefsThatIgnore.add("unknown key");
+
+        mPreferenceController.setUxRestrictionsIgnoredConfig(true, prefsThatIgnore);
+        boolean result = mPreferenceController.shouldApplyUxRestrictions(NO_SETUP_UX_RESTRICTIONS);
+        assertThat(result).isFalse();
+    }
+
+    @Test
+    public void onCreate_unrestricted_disabled_preferenceUnrestricted() {
+        mPreference.setEnabled(false);
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify((UxRestrictablePreference) mPreference).setUxRestricted(false);
+    }
+
+    @Test
+    public void refreshUi_notCreated_doesNothing() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.refreshUi();
+
+        verify(mPreference, never()).setVisible(anyBoolean());
+        assertThat(mPreferenceController.getUpdateStateCallCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void refreshUi_created_available_preferenceShownAndEnabled() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Mockito.reset(mPreference);
+
+        mPreferenceController.refreshUi();
+
+        verify(mPreference).setVisible(true);
+        verify(mPreference).setEnabled(true);
+    }
+
+    @Test
+    public void refreshUi_created_availableForViewing_preferenceShownAndDisabled() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(AVAILABLE_FOR_VIEWING);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Mockito.reset(mPreference);
+
+        mPreferenceController.refreshUi();
+
+        verify(mPreference).setVisible(true);
+        verify(mPreference).setEnabled(false);
+    }
+
+    @Test
+    public void refreshUi_created_notAvailable_preferenceHidden() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(CONDITIONALLY_UNAVAILABLE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Mockito.reset(mPreference);
+
+        mPreferenceController.refreshUi();
+
+        verify(mPreference).setVisible(false);
+    }
+
+    @Test
+    public void refreshUi_created_available_updatesState() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.refreshUi();
+
+        // onCreate, refreshUi.
+        assertThat(mPreferenceController.getUpdateStateCallCount()).isEqualTo(2);
+        assertThat(mPreferenceController.getUpdateStateArg()).isEqualTo(mPreference);
+    }
+
+    @Test
+    public void refreshUi_created_notAvailable_doesNotUpdateState() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(CONDITIONALLY_UNAVAILABLE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceController.getUpdateStateCallCount()).isEqualTo(0);
+    }
+
+
+    @Test
+    public void onUxRestrictionsChanged_created_available_updatesState() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.onUxRestrictionsChanged(LIMIT_STRINGS_UX_RESTRICTIONS);
+
+        // onCreate, onUxRestrictionsChanged.
+        assertThat(mPreferenceController.getUpdateStateCallCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_notCreated_available_doesNotUpdateState() {
+        mPreferenceController.onUxRestrictionsChanged(LIMIT_STRINGS_UX_RESTRICTIONS);
+
+        assertThat(mPreferenceController.getUpdateStateCallCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void onCreate_available_updatesState() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getUpdateStateCallCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void onStart_available_updatesState() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        // onCreate, onStart
+        assertThat(mPreferenceController.getUpdateStateCallCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_available_zoneWrite() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_WRITE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        verify(mPreference).setEnabled(true);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_available_zoneRead() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_READ);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        verify(mPreference).setEnabled(false);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_available_zoneHidden() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_HIDDEN);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_availableForViewing_zoneWrite() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(AVAILABLE_FOR_VIEWING);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_WRITE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_availableForViewing_zoneRead() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(AVAILABLE_FOR_VIEWING);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_READ);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        verify(mPreference).setEnabled(false);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_availableForViewing_zoneHidden() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(AVAILABLE_FOR_VIEWING);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_HIDDEN);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_disabledForProfile_zoneWrite() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(DISABLED_FOR_PROFILE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_WRITE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_disabledForProfile_zoneRead() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(DISABLED_FOR_PROFILE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_READ);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_disabledForProfile_zoneHidden() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(DISABLED_FOR_PROFILE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_HIDDEN);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_unsupportedOnDevice_zoneWrite() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(UNSUPPORTED_ON_DEVICE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_WRITE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_unsupportedOnDevice_zoneRead() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(UNSUPPORTED_ON_DEVICE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_READ);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_unsupportedOnDevice_zoneHidden() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(UNSUPPORTED_ON_DEVICE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_HIDDEN);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_conditionallyUnavailable_zoneWrite() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(CONDITIONALLY_UNAVAILABLE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_WRITE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_conditionallyUnavailable_zoneRead() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(CONDITIONALLY_UNAVAILABLE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_READ);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_conditionallyUnavailable_zoneHidden() {
+        mPreferenceController.setPreference(mPreference);
+        mPreferenceController.setAvailabilityStatus(CONDITIONALLY_UNAVAILABLE);
+        mPreferenceController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_HIDDEN);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    private static class FakePreferenceController extends
+            PreferenceController<Preference> {
+
+        private int mAvailabilityStatus;
+        private int mUpdateStateCallCount;
+        private Preference mUpdateStateArg;
+        private boolean mAllIgnoresUxRestrictions = false;
+        private Set<String> mPreferencesIgnoringUxRestrictions = new HashSet<>();
+
+        FakePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+            mAvailabilityStatus = AVAILABLE;
+        }
+
+        @Override
+        protected Class<Preference> getPreferenceType() {
+            return Preference.class;
+        }
+
+        @Override
+        protected int getDefaultAvailabilityStatus() {
+            return mAvailabilityStatus;
+        }
+
+        @Override
+        protected void updateState(Preference preference) {
+            mUpdateStateArg = preference;
+            mUpdateStateCallCount++;
+        }
+
+        public void setAvailabilityStatus(int availabilityStatus) {
+            mAvailabilityStatus = availabilityStatus;
+        }
+
+        public Preference getUpdateStateArg() {
+            return mUpdateStateArg;
+        }
+
+        public int getUpdateStateCallCount() {
+            return mUpdateStateCallCount;
+        }
+
+        public void setUxRestrictionsIgnoredConfig(boolean allIgnore, Set preferencesThatIgnore) {
+            mAllIgnoresUxRestrictions = allIgnore;
+            mPreferencesIgnoringUxRestrictions = preferencesThatIgnore;
+        }
+
+        @Override
+        protected boolean isUxRestrictionsIgnored(boolean allIgnores, Set prefsThatIgnore) {
+            return super.isUxRestrictionsIgnored(mAllIgnoresUxRestrictions,
+                    mPreferencesIgnoringUxRestrictions);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/PreferenceControllerTestUtil.java b/tests/multivalent/src/com/android/car/settings/common/PreferenceControllerTestUtil.java
new file mode 100644
index 000000000..aac4a1d2a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/PreferenceControllerTestUtil.java
@@ -0,0 +1,61 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import androidx.preference.Preference;
+
+public class PreferenceControllerTestUtil {
+
+    /**
+     * Associates a PreferenceController with its Preference.
+     */
+    public static void assignPreference(PreferenceController controller, Preference preference) {
+        controller.setPreference(preference);
+    }
+
+    /**
+     * Asserts that the test availability status matches the expected result
+     *
+     * @param actualValue availability returned by the test
+     * @param expectedValue expected availability
+     */
+    public static void assertAvailability(int actualValue, int expectedValue) {
+        assertWithMessage("controller availability (%s=%s, %s=%s)",
+                actualValue, availabilityToString(actualValue),
+                expectedValue, availabilityToString(expectedValue))
+                .that(actualValue).isEqualTo(expectedValue);
+    }
+
+    private static String availabilityToString(int value) {
+        switch (value) {
+            case PreferenceController.AVAILABLE:
+                return "AVAILABLE";
+            case PreferenceController.AVAILABLE_FOR_VIEWING:
+                return "AVAILABLE_FOR_VIEWING";
+            case PreferenceController.CONDITIONALLY_UNAVAILABLE:
+                return "CONDITIONALLY_UNAVAILABLE";
+            case PreferenceController.DISABLED_FOR_PROFILE:
+                return "DISABLED_FOR_PROFILE";
+            case PreferenceController.UNSUPPORTED_ON_DEVICE:
+                return "UNSUPPORTED_ON_DEVICE";
+            default:
+                return "INVALID-" + value;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/SettingsFragmentTestCase.java b/tests/multivalent/src/com/android/car/settings/common/SettingsFragmentTestCase.java
new file mode 100644
index 000000000..464ffac8d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/SettingsFragmentTestCase.java
@@ -0,0 +1,303 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.withSettings;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentSender;
+import android.widget.Toast;
+
+import androidx.fragment.app.DialogFragment;
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentManager;
+import androidx.preference.Preference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.TestFinishActivity;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.concurrent.atomic.AtomicReference;
+
+@RunWith(AndroidJUnit4.class)
+public abstract class SettingsFragmentTestCase<T extends BaseCarSettingsTestActivity> {
+    protected static final String TEST_TAG = "test_tag";
+
+    protected Context mContext = ApplicationProvider.getApplicationContext();
+    protected BaseCarSettingsTestActivity mActivity;
+    protected FragmentManager mFragmentManager;
+    protected SettingsFragment mFragment;
+
+    abstract ActivityTestRule<T> getActivityTestRule();
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = getActivityTestRule().getActivity();
+        mFragmentManager = mActivity.getSupportFragmentManager();
+        setUpFragment();
+    }
+
+    @Test
+    @UiThreadTest
+    public void use_returnsController() {
+        mFragment.onCreate(null);
+        assertThat(mFragment.use(FakePreferenceController.class,
+                R.string.tpk_fake_controller)).isNotNull();
+    }
+
+    @Test
+    public void onAttach_registersLifecycleObservers() throws Throwable {
+        AtomicReference<FakePreferenceController> controller = new AtomicReference<>();
+        getActivityTestRule().runOnUiThread(() -> {
+            mFragment.onCreate(null);
+            controller.set(mFragment.use(FakePreferenceController.class,
+                    R.string.tpk_fake_controller));
+            assertThat(controller.get().getOnCreateInternalCallCount()).isEqualTo(1);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        getActivityTestRule().finishActivity();
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(controller.get().getOnCreateInternalCallCount()).isEqualTo(1);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onUxRestrictionsChanged_propagatesToControllers() {
+        mFragment.onCreate(null);
+        FakePreferenceController controller = mFragment.use(FakePreferenceController.class,
+                R.string.tpk_fake_controller);
+        CarUxRestrictions uxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_NO_KEYBOARD, /* timestamp= */ 0).build();
+        mFragment.onUxRestrictionsChanged(uxRestrictions);
+        assertThat(controller.getUxRestrictions()).isEqualTo(uxRestrictions);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onUxRestrictedPreferenceTapped_showToast() {
+        MockitoSession session = ExtendedMockito.mockitoSession().mockStatic(Toast.class,
+                withSettings().lenient()).startMocking();
+        Toast mockToast = mock(Toast.class);
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt()))
+                .thenReturn(mockToast);
+
+        mFragment.onCreate(null);
+        FakePreferenceController controller = mFragment.use(FakePreferenceController.class,
+                R.string.tpk_fake_controller);
+        CarUxRestrictions uxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, /* timestamp= */ 0).build();
+        mFragment.onUxRestrictionsChanged(uxRestrictions);
+        controller.getPreference().performClick();
+        verify(mockToast).show();
+
+        session.finishMocking();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onDisplayPreferenceDialog_unknownPreferenceType_throwsIllegalArgumentException() {
+        mFragment.onCreate(null);
+
+        assertThrows(IllegalArgumentException.class,
+                () -> mFragment.onDisplayPreferenceDialog(new Preference(mContext)));
+    }
+
+    @Test
+    @UiThreadTest
+    public void launchFragment_dialogFragment_throwsError() {
+        mFragment.onCreate(null);
+        DialogFragment dialogFragment = new DialogFragment();
+        assertThrows(IllegalArgumentException.class,
+                () -> mFragment.launchFragment(dialogFragment));
+    }
+
+    @Test
+    @UiThreadTest
+    public void showDialog_noTag_launchesDialogFragment() {
+        mFragment.onCreate(null);
+        DialogFragment dialogFragment = mock(DialogFragment.class);
+        mFragment.showDialog(dialogFragment, /* tag= */ null);
+        verify(dialogFragment).show(mFragment.getFragmentManager(), null);
+    }
+
+    @Test
+    @UiThreadTest
+    public void showDialog_withTag_launchesDialogFragment() {
+        mFragment.onCreate(null);
+        DialogFragment dialogFragment = mock(DialogFragment.class);
+        mFragment.showDialog(dialogFragment, TEST_TAG);
+        verify(dialogFragment).show(mFragment.getFragmentManager(), TEST_TAG);
+    }
+
+    @Test
+    public void findDialogByTag_retrieveOriginalDialog_returnsDialog() throws Throwable {
+        DialogFragment dialogFragment = new DialogFragment();
+        getActivityTestRule().runOnUiThread(() -> {
+            mFragment.onCreate(null);
+            mFragment.showDialog(dialogFragment, TEST_TAG);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(mFragment.findDialogByTag(TEST_TAG)).isEqualTo(dialogFragment);
+    }
+
+    @Test
+    @UiThreadTest
+    public void findDialogByTag_notDialogFragment_returnsNull() {
+        mFragment.onCreate(null);
+        TestSettingsFragment
+                fragment = new TestSettingsFragment();
+        mFragment.getFragmentManager().beginTransaction().add(fragment, TEST_TAG).commit();
+        assertThat(mFragment.findDialogByTag(TEST_TAG)).isNull();
+    }
+
+    @Test
+    @UiThreadTest
+    public void findDialogByTag_noSuchFragment_returnsNull() {
+        mFragment.onCreate(null);
+        assertThat(mFragment.findDialogByTag(TEST_TAG)).isNull();
+    }
+
+    @Test
+    @UiThreadTest
+    public void startActivityForResult_largeRequestCode_throwsError() {
+        mFragment.onCreate(null);
+        assertThrows(() -> mFragment.startActivityForResult(new Intent(), 0xffff,
+                mock(ActivityResultCallback.class)));
+    }
+
+    @Test
+    @UiThreadTest
+    public void startActivityForResult_tooManyRequests_throwsError() {
+        mFragment.onCreate(null);
+        assertThrows(() -> {
+            for (int i = 0; i < 0xff; i++) {
+                mFragment.startActivityForResult(new Intent(), i,
+                        mock(ActivityResultCallback.class));
+            }
+        });
+    }
+
+    @Test
+    @UiThreadTest
+    public void startIntentSenderForResult_largeRequestCode_throwsError() {
+        mFragment.onCreate(null);
+        assertThrows(
+                () -> mFragment.startIntentSenderForResult(
+                        mock(IntentSender.class), /* requestCode= */ 0xffff,
+                        /* fillInIntent= */ null, /* flagsMask= */ 0,
+                        /* flagsValues= */ 0, /* options= */ null,
+                        mock(ActivityResultCallback.class)));
+    }
+
+    @Test
+    @UiThreadTest
+    public void startIntentSenderForResult_tooManyRequests_throwsError() {
+        mFragment.onCreate(null);
+        assertThrows(() -> {
+            for (int i = 0; i < 0xff; i++) {
+                mFragment.startIntentSenderForResult(
+                        mock(IntentSender.class), /* requestCode= */ 0xffff,
+                        /* fillInIntent= */ null, /* flagsMask= */ 0,
+                        /* flagsValues= */ 0, /* options= */ null,
+                        mock(ActivityResultCallback.class));
+            }
+        });
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityResult_hasValidRequestCode_triggersOnActivityResult() {
+        mFragment.onCreate(null);
+        ActivityResultCallback callback = mock(ActivityResultCallback.class);
+        Intent intent = new Intent(mContext, TestFinishActivity.class);
+
+        int reqCode = 100;
+        int resCode = -1;
+        mFragment.startActivityForResult(intent, reqCode, callback);
+        int fragmentReqCode = (1 << 8) + reqCode;
+        mFragment.onActivityResult(fragmentReqCode, resCode, intent);
+        verify(callback).processActivityResult(eq(reqCode), eq(resCode), any(Intent.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityResult_wrongRequestCode_doesntTriggerOnActivityResult() {
+        mFragment.onCreate(null);
+        ActivityResultCallback callback = mock(ActivityResultCallback.class);
+        Intent intent = new Intent(mContext, TestFinishActivity.class);
+
+        int reqCode = 100;
+        int resCode = -1;
+        mFragment.startActivityForResult(intent, reqCode, callback);
+        int fragmentReqCode = (2 << 8) + reqCode;
+        mFragment.onActivityResult(fragmentReqCode, resCode, intent);
+        verify(callback, never()).processActivityResult(anyInt(), anyInt(),
+                any(Intent.class));
+    }
+
+    protected void setUpFragment() throws Throwable {
+        setUpFragment(null);
+    }
+
+    protected void setUpFragment(Fragment fragment) throws Throwable {
+        String settingsFragmentTag = "settings_fragment";
+        getActivityTestRule().runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container,
+                            fragment != null ? fragment : new TestSettingsFragment(),
+                            settingsFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (SettingsFragment) mFragmentManager.findFragmentByTag(settingsFragmentTag);
+    }
+
+    /** Concrete {@link SettingsFragment} for testing. */
+    public static class TestSettingsFragment extends SettingsFragment {
+
+        @Override
+        protected int getPreferenceScreenResId() {
+            return R.xml.test_base_settings_fragment;
+        }
+
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/SinglePaneBaseCarSettingsActivityTest.java b/tests/multivalent/src/com/android/car/settings/common/SinglePaneBaseCarSettingsActivityTest.java
new file mode 100644
index 000000000..67f69ebdb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/SinglePaneBaseCarSettingsActivityTest.java
@@ -0,0 +1,82 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+
+import androidx.preference.Preference;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.BaseTestSettingsFragment;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
+
+import org.junit.Rule;
+import org.junit.Test;
+
+public class SinglePaneBaseCarSettingsActivityTest
+        extends BaseCarSettingsActivityTestCase<SinglePaneTestActivity> {
+
+    @Rule
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
+
+    @Override
+    ActivityTestRule<SinglePaneTestActivity> getActivityTestRule() {
+        return mActivityTestRule;
+    }
+
+    @Test
+    public void onPreferenceStartFragment_updateFragmentContainer() throws Throwable {
+        Preference pref = new Preference(mContext);
+        pref.setFragment(BaseTestSettingsFragment.class.getName());
+
+        BaseCarSettingsTestActivity spiedActivity = spy(mActivity);
+
+        mActivityTestRule.runOnUiThread(() ->
+                spiedActivity.onPreferenceStartFragment(/* caller= */ null, pref));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(spiedActivity).updateFragmentContainer(any(BaseTestSettingsFragment.class));
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_fragmentHasUpdatedUxRestrictions()
+            throws Throwable {
+
+        CarUxRestrictions restrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP,
+                /* timestamp= */ 0
+        ).build();
+
+        mActivityTestRule.runOnUiThread(() -> {
+            mActivity.onUxRestrictionsChanged(restrictions);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(((BaseTestSettingsFragment) getCurrentFragment()).getUxRestrictions()
+                .isSameRestrictions(restrictions)).isTrue();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/SinglePaneSettingsFragmentTest.java b/tests/multivalent/src/com/android/car/settings/common/SinglePaneSettingsFragmentTest.java
new file mode 100644
index 000000000..c4b7f1d54
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/SinglePaneSettingsFragmentTest.java
@@ -0,0 +1,69 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import androidx.fragment.app.Fragment;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.RootTestSettingsFragment;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
+import com.android.car.ui.toolbar.NavButtonMode;
+import com.android.car.ui.toolbar.ToolbarController;
+
+import org.junit.Rule;
+import org.junit.Test;
+
+import java.util.concurrent.atomic.AtomicReference;
+
+public class SinglePaneSettingsFragmentTest
+        extends SettingsFragmentTestCase<SinglePaneTestActivity> {
+
+    @Rule
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
+
+    @Override
+    ActivityTestRule<SinglePaneTestActivity> getActivityTestRule() {
+        return mActivityTestRule;
+    }
+
+    @Test
+    public void onActivityCreated_hasAppIconIfRoot() throws Throwable {
+        AtomicReference<Fragment> fragment = new AtomicReference<>();
+        getActivityTestRule().runOnUiThread(() -> {
+            fragment.set(new RootTestSettingsFragment());
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        setUpFragment(fragment.get());
+
+        ToolbarController toolbar = mActivity.getToolbar();
+
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.DISABLED);
+    }
+
+    @Test
+    public void onActivityCreated_hasBackArrowIconIfNotRoot() {
+        ToolbarController toolbar = mActivity.getToolbar();
+
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.BACK);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/TopLevelIconTest.java b/tests/multivalent/src/com/android/car/settings/common/TopLevelIconTest.java
new file mode 100644
index 000000000..1f9e49080
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/TopLevelIconTest.java
@@ -0,0 +1,109 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_BACKGROUND_ARGB;
+import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_BACKGROUND_HINT;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.res.ColorStateList;
+import android.graphics.Color;
+import android.graphics.drawable.ColorDrawable;
+import android.graphics.drawable.GradientDrawable;
+import android.os.Bundle;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class TopLevelIconTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+
+    @Test
+    public void createIcon_shouldSetBackgroundAndInset() {
+        TopLevelIcon icon = new TopLevelIcon(mContext, new ColorDrawable(Color.BLACK));
+
+        assertThat(icon.getNumberOfLayers()).isEqualTo(2);
+        assertThat(icon.getDrawable(0)).isInstanceOf(TopLevelIconShapeDrawable.class);
+    }
+
+    @Test
+    public void setBackgroundColor_shouldUpdateTintList() {
+        TopLevelIcon icon = spy(new TopLevelIcon(mContext, new ColorDrawable(Color.BLACK)));
+        GradientDrawable background = mock(GradientDrawable.class);
+        when(icon.getDrawable(0)).thenReturn(background);
+        icon.setBackgroundColor(Color.BLUE);
+
+        verify(background).setTintList(any(ColorStateList.class));
+    }
+
+    @Test
+    public void injectedPreferenceWithBackgroundColorRawValue_shouldSetColor() {
+        Bundle metaData = new Bundle();
+        metaData.putInt(META_DATA_PREFERENCE_ICON_BACKGROUND_ARGB, 0xff0000);
+        TopLevelIcon icon = new TopLevelIcon(mContext, new ColorDrawable(Color.BLACK));
+        icon.setBackgroundColor(mContext, metaData, mContext.getPackageName());
+
+        assertThat(icon.mBackgroundColorStateList.getDefaultColor()).isEqualTo(0xff0000);
+    }
+
+    @Test
+    public void injectedPreferenceWithoutBackgroundColor_shouldSetDefaultBackgroundColor() {
+        Bundle metaData = new Bundle();
+        TopLevelIcon icon = new TopLevelIcon(mContext, new ColorDrawable(Color.BLACK));
+        icon.setBackgroundColor(mContext, metaData, mContext.getPackageName());
+
+        assertThat(icon.mBackgroundColorStateList.getDefaultColor()).isEqualTo(
+                mContext.getColor(R.color.top_level_injected_default_background));
+    }
+
+    @Test
+    public void injectedPreferenceWithBackgroundColorHintValue_shouldSetColor() {
+        Bundle metaData = new Bundle();
+        metaData.putInt(META_DATA_PREFERENCE_ICON_BACKGROUND_HINT, android.R.color.darker_gray);
+        TopLevelIcon icon = new TopLevelIcon(mContext, new ColorDrawable(Color.BLACK));
+        icon.setBackgroundColor(mContext, metaData, mContext.getPackageName());
+
+        assertThat(icon.mBackgroundColorStateList.getDefaultColor()).isEqualTo(
+                mContext.getColor(android.R.color.darker_gray));
+    }
+
+    @Test
+    public void getConstantState_returnCorrectState() {
+        TopLevelIcon icon = new TopLevelIcon(mContext, new ColorDrawable(Color.BLACK));
+        icon.setBackgroundColor(Color.YELLOW);
+
+        TopLevelIcon.AdaptiveConstantState state =
+                (TopLevelIcon.AdaptiveConstantState) icon.getConstantState();
+
+        assertThat(state.mColor).isEqualTo(Color.YELLOW);
+        assertThat(state.mContext).isEqualTo(mContext);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/TopLevelMenuFragmentTest.java b/tests/multivalent/src/com/android/car/settings/common/TopLevelMenuFragmentTest.java
new file mode 100644
index 000000000..c88819fb3
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/TopLevelMenuFragmentTest.java
@@ -0,0 +1,87 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
+import com.android.car.settings.testutils.TestSettingsFragment1;
+import com.android.car.settings.testutils.TestTopLevelMenuFragment;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class TopLevelMenuFragmentTest {
+
+    private TopLevelMenuFragment mFragment;
+    private FragmentManager mFragmentManager;
+
+    @Rule
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+    }
+
+
+    @Test
+    public void onPreferenceTapped_launchesFragment() throws Throwable {
+        mActivityTestRule.runOnUiThread(() ->
+                mFragment.getPreferenceScreen().getPreference(0).performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(getCurrentFragment().getClass()).isEqualTo(TestSettingsFragment1.class);
+    }
+
+    @Test
+    public void onPreferenceTapped_preferenceHighlightUpdated() throws Throwable {
+        mActivityTestRule.runOnUiThread(() ->
+                mFragment.getPreferenceScreen().getPreference(0).performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(mFragment.getSelectedPreferenceKey()).isEqualTo("pk_test_fragment_1");
+    }
+
+    private void setUpFragment() throws Throwable {
+        String topLevelMenuTag = "top_level_menu";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new TestTopLevelMenuFragment(),
+                            topLevelMenuTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (TopLevelMenuFragment) mFragmentManager.findFragmentByTag(topLevelMenuTag);
+    }
+
+    private Fragment getCurrentFragment() {
+        return mFragmentManager.findFragmentById(R.id.fragment_container);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/common/rotary/DirectManipulationStateTest.java b/tests/multivalent/src/com/android/car/settings/common/rotary/DirectManipulationStateTest.java
new file mode 100644
index 000000000..f9645266a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/rotary/DirectManipulationStateTest.java
@@ -0,0 +1,116 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common.rotary;
+
+import static android.view.ViewGroup.FOCUS_AFTER_DESCENDANTS;
+import static android.view.ViewGroup.FOCUS_BLOCK_DESCENDANTS;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.view.LayoutInflater;
+import android.view.ViewGroup;
+import android.widget.NumberPicker;
+import android.widget.TimePicker;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class DirectManipulationStateTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private DirectManipulationState mDirectManipulationState;
+    private TimePicker mTimePicker;
+    private NumberPicker mNumberPicker;
+
+    @Before
+    public void setUp() {
+        mDirectManipulationState = new DirectManipulationState();
+
+        LayoutInflater inflater = LayoutInflater.from(mContext);
+        ViewGroup view = (ViewGroup) inflater.inflate(R.layout.time_picker, /* root= */ null);
+        mTimePicker = view.findViewById(R.id.time_picker);
+        mTimePicker.setDescendantFocusability(FOCUS_AFTER_DESCENDANTS);
+
+        List<NumberPicker> numberPickers = new ArrayList<>();
+        NumberPickerUtils.getNumberPickerDescendants(numberPickers, mTimePicker);
+        mNumberPicker = numberPickers.get(0);
+        mNumberPicker.setDescendantFocusability(FOCUS_BLOCK_DESCENDANTS);
+    }
+
+    @Test
+    public void enable_timePicker_storesDescendantFocusability() {
+        mDirectManipulationState.enable(mTimePicker);
+
+        assertThat(mDirectManipulationState.getOriginalDescendantFocusability())
+                .isEqualTo(FOCUS_AFTER_DESCENDANTS);
+    }
+
+    @Test
+    public void enable_timePicker_storesViewInDirectManipulation() {
+        mDirectManipulationState.enable(mTimePicker);
+
+        assertThat(mDirectManipulationState.getViewInDirectManipulationMode())
+                .isEqualTo(mTimePicker);
+    }
+
+    @Test
+    public void enable_timePickerChild_descendantFocusabilityUpdates() {
+        mDirectManipulationState.enable(mTimePicker);
+        mDirectManipulationState.enable(mNumberPicker);
+
+        assertThat(mDirectManipulationState.getOriginalDescendantFocusability())
+                .isEqualTo(FOCUS_BLOCK_DESCENDANTS);
+    }
+
+    @Test
+    public void enable_timePickerChild_viewInDirectManipulationUpdates() {
+        mDirectManipulationState.enable(mTimePicker);
+        mDirectManipulationState.enable(mNumberPicker);
+
+        assertThat(mDirectManipulationState.getViewInDirectManipulationMode())
+                .isEqualTo(mNumberPicker);
+    }
+
+    @Test
+    public void disable_viewInDirectManipulationReset() {
+        mDirectManipulationState.enable(mTimePicker);
+        mDirectManipulationState.disable();
+
+        assertThat(mDirectManipulationState.getViewInDirectManipulationMode()).isNull();
+    }
+
+    @Test
+    public void disable_descendantFocusabilityReset() {
+        mDirectManipulationState.enable(mTimePicker);
+        mDirectManipulationState.disable();
+
+        assertThat(mDirectManipulationState.getOriginalDescendantFocusability())
+                .isEqualTo(DirectManipulationState.UNKNOWN_DESCENDANT_FOCUSABILITY);
+    }
+}
+
diff --git a/tests/multivalent/src/com/android/car/settings/common/rotary/NumberPickerUtilsTest.java b/tests/multivalent/src/com/android/car/settings/common/rotary/NumberPickerUtilsTest.java
new file mode 100644
index 000000000..e4c428786
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/common/rotary/NumberPickerUtilsTest.java
@@ -0,0 +1,137 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common.rotary;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.view.LayoutInflater;
+import android.view.View;
+import android.view.ViewGroup;
+import android.widget.DatePicker;
+import android.widget.NumberPicker;
+import android.widget.TimePicker;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class NumberPickerUtilsTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+
+    @Test
+    public void getNumberPickerDescendants_fromTimePicker_has3NumberPickers() {
+        LayoutInflater inflater = LayoutInflater.from(mContext);
+        ViewGroup view = (ViewGroup) inflater.inflate(R.layout.time_picker, /* root= */ null);
+        TimePicker timePicker = view.findViewById(R.id.time_picker);
+
+        List<NumberPicker> numberPickers = new ArrayList<>();
+        NumberPickerUtils.getNumberPickerDescendants(numberPickers, timePicker);
+
+        assertThat(numberPickers).hasSize(3);
+    }
+
+    @Test
+    public void getNumberPickerDescendants_fromDatePicker_has3NumberPickers() {
+        LayoutInflater inflater = LayoutInflater.from(mContext);
+        ViewGroup view = (ViewGroup) inflater.inflate(R.layout.date_picker, /* root= */ null);
+        DatePicker datePicker = view.findViewById(R.id.date_picker);
+
+        List<NumberPicker> numberPickers = new ArrayList<>();
+        NumberPickerUtils.getNumberPickerDescendants(numberPickers, datePicker);
+
+        assertThat(numberPickers).hasSize(3);
+    }
+
+    @Test
+    public void hasCommonNumberPickerParent_bothNull_returnsFalse() {
+        boolean result = NumberPickerUtils.hasCommonNumberPickerParent(null, null);
+
+        assertThat(result).isFalse();
+    }
+
+    @Test
+    public void hasCommonNumberPickerParent_firstNull_returnsFalse() {
+        NumberPicker picker = new NumberPicker(mContext);
+        boolean result = NumberPickerUtils.hasCommonNumberPickerParent(null, picker);
+
+        assertThat(result).isFalse();
+    }
+
+    @Test
+    public void hasCommonNumberPickerParent_secondNull_returnsFalse() {
+        NumberPicker picker = new NumberPicker(mContext);
+        boolean result = NumberPickerUtils.hasCommonNumberPickerParent(picker, null);
+
+        assertThat(result).isFalse();
+    }
+
+    @Test
+    public void hasCommonNumberPickerParent_separateNumberPickers_returnsFalse() {
+        NumberPicker picker1 = new NumberPicker(mContext);
+        NumberPicker picker2 = new NumberPicker(mContext);
+        boolean result = NumberPickerUtils.hasCommonNumberPickerParent(picker1, picker2);
+
+        assertThat(result).isFalse();
+    }
+
+    @Test
+    public void hasCommonNumberPickerParent_fromTimePicker_returnsTrue() {
+        LayoutInflater inflater = LayoutInflater.from(mContext);
+        ViewGroup view = (ViewGroup) inflater.inflate(R.layout.time_picker, /* root= */ null);
+        TimePicker timePicker = view.findViewById(R.id.time_picker);
+        List<NumberPicker> numberPickers = new ArrayList<>();
+        NumberPickerUtils.getNumberPickerDescendants(numberPickers, timePicker);
+        NumberPicker picker1 = numberPickers.get(0);
+        NumberPicker picker2 = numberPickers.get(1);
+
+        boolean result = NumberPickerUtils.hasCommonNumberPickerParent(picker1, picker2);
+
+        assertThat(result).isTrue();
+    }
+
+    @Test
+    public void getNumberPickerParent_noValidParent_returnsNull() {
+        NumberPicker picker = new NumberPicker(mContext);
+        View result = NumberPickerUtils.getNumberPickerParent(picker);
+
+        assertThat(result).isNull();
+    }
+
+    @Test
+    public void getNumberPickerParent_validParent_returnsNull() {
+        LayoutInflater inflater = LayoutInflater.from(mContext);
+        ViewGroup view = (ViewGroup) inflater.inflate(R.layout.time_picker, /* root= */ null);
+        TimePicker timePicker = view.findViewById(R.id.time_picker);
+        List<NumberPicker> numberPickers = new ArrayList<>();
+        NumberPickerUtils.getNumberPickerDescendants(numberPickers, timePicker);
+        NumberPicker picker = numberPickers.get(0);
+
+        View result = NumberPickerUtils.getNumberPickerParent(picker);
+
+        assertThat(result).isEqualTo(timePicker);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/AppDataUsageFragmentTest.java b/tests/multivalent/src/com/android/car/settings/datausage/AppDataUsageFragmentTest.java
new file mode 100644
index 000000000..6942ab351
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/AppDataUsageFragmentTest.java
@@ -0,0 +1,176 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.net.NetworkTemplate;
+import android.os.Bundle;
+import android.text.format.DateUtils;
+
+import androidx.annotation.NonNull;
+import androidx.fragment.app.FragmentManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.settingslib.net.DataUsageController;
+import com.android.settingslib.net.NetworkCycleChartData;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+import java.util.HashMap;
+import java.util.Map;
+
+/** Unit test for {@link AppDataUsageFragment}. */
+@RunWith(AndroidJUnit4.class)
+public class AppDataUsageFragmentTest {
+    private static final String KEY_START = "start";
+    private static final String KEY_END = "end";
+
+    private TestAppDataUsageFragment mFragment;
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    private NetworkTemplate mNetworkTemplate;
+    @Mock
+    private DataUsageController.DataUsageInfo mDataUsageInfo;
+    @Mock
+    private DataUsageCycleManager mDataUsageCycleManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+
+        when(mNetworkTemplate.getWifiNetworkKeys()).thenReturn(Collections.emptySet());
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_noDataCycles_startAndEndDateShouldHaveFourWeeksDifference()
+            throws Throwable {
+        setUpFragment(/* hasDataCycles= */ false);
+
+        Bundle bundle = mFragment.getBundle();
+        long start = bundle.getLong(KEY_START);
+        long end = bundle.getLong(KEY_END);
+        long timeDiff = end - start;
+
+        assertThat(timeDiff).isEqualTo(DateUtils.WEEK_IN_MILLIS * 4);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_dataCyclePicked_showsDataCycle() throws Throwable {
+        long startTime = System.currentTimeMillis();
+        long endTime = System.currentTimeMillis() + DateUtils.WEEK_IN_MILLIS * 4;
+        String cycle = "cycle_key";
+        Map<CharSequence, NetworkCycleChartData> dataCycles = new HashMap<>();
+        NetworkCycleChartData.Builder builder = new NetworkCycleChartData.Builder();
+        builder.setStartTime(startTime)
+                .setEndTime(endTime);
+        dataCycles.put(cycle, builder.build());
+
+        setUpFragment(/* hasDataCycles= */ true);
+        mFragment.onDataCyclePicked(cycle, dataCycles);
+
+        Bundle bundle = mFragment.getBundle();
+        long start = bundle.getLong(KEY_START);
+        long end = bundle.getLong(KEY_END);
+
+        assertThat(start).isEqualTo(startTime);
+        assertThat(end).isEqualTo(endTime);
+    }
+
+    private void setUpFragment(boolean hasDataCycles)
+            throws Throwable {
+        String appDataUsageFragmentTag = "app_data_usage_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container,
+                            TestAppDataUsageFragment.newInstance(hasDataCycles, mNetworkTemplate,
+                                    mDataUsageInfo, mDataUsageCycleManager),
+                            appDataUsageFragmentTag)
+                    .commitNow();
+        });
+
+        mFragment = (TestAppDataUsageFragment) mFragmentManager
+                .findFragmentByTag(appDataUsageFragmentTag);
+    }
+
+    public static class TestAppDataUsageFragment extends AppDataUsageFragment {
+
+        // Ensure onDataCyclePicked() isn't called on test devices with data plans
+        private boolean mHasDataCycles;
+        private NetworkTemplate mNetworkTemplate;
+        private DataUsageController.DataUsageInfo mDataUsageInfo;
+        private DataUsageCycleManager mDataUsageCycleManager;
+
+        /** Creates a TestAppDataUsageFragment with the substituted values */
+        public static TestAppDataUsageFragment newInstance(boolean hasDataCycles,
+                NetworkTemplate networkTemplate, DataUsageController.DataUsageInfo dataUsageInfo,
+                DataUsageCycleManager dataUsageCycleManager) {
+            TestAppDataUsageFragment fragment = new TestAppDataUsageFragment();
+            fragment.mHasDataCycles = hasDataCycles;
+            fragment.mNetworkTemplate = networkTemplate;
+            fragment.mDataUsageInfo = dataUsageInfo;
+            fragment.mDataUsageCycleManager = dataUsageCycleManager;
+            return fragment;
+        }
+
+        @Override
+        public void onDataCyclePicked(String cycle, Map<CharSequence,
+                NetworkCycleChartData> usages) {
+            if (!mHasDataCycles) {
+                return;
+            }
+            super.onDataCyclePicked(cycle, usages);
+        }
+
+        @Override
+        NetworkTemplate getNetworkTemplate(Context context, int subId) {
+            return mNetworkTemplate;
+        }
+
+        @Override
+        DataUsageController.DataUsageInfo getDataUsageInfo(
+                @NonNull NetworkTemplate networkTemplate) {
+            return mDataUsageInfo;
+        }
+
+        @Override
+        DataUsageCycleManager getDataUsageCycleManager(@NonNull NetworkTemplate networkTemplate) {
+            return mDataUsageCycleManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/AppDataUsagePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/AppDataUsagePreferenceControllerTest.java
new file mode 100644
index 000000000..e61dc3792
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/AppDataUsagePreferenceControllerTest.java
@@ -0,0 +1,172 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static android.app.usage.NetworkStats.Bucket.UID_TETHERING;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.app.usage.NetworkStats;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.annotation.NonNull;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.ProgressBarPreference;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.net.UidDetail;
+import com.android.settingslib.net.UidDetailProvider;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Queue;
+import java.util.concurrent.LinkedBlockingQueue;
+
+@RunWith(AndroidJUnit4.class)
+public class AppDataUsagePreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private TestAppDataUsagePreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreferenceGroup;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private UidDetailProvider mMockUidDetailProvider;
+    @Mock
+    private UidDetail mMockUidDetail;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new TestAppDataUsagePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockUidDetailProvider);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    private static class TestAppDataUsagePreferenceController
+            extends AppDataUsagePreferenceController {
+        private final Queue<NetworkStats.Bucket> mMockedBuckets = new LinkedBlockingQueue<>();
+
+        TestAppDataUsagePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions,
+                UidDetailProvider uidDetailProvider) {
+            super(context, preferenceKey, fragmentController, uxRestrictions, uidDetailProvider);
+        }
+
+        public void addBucket(NetworkStats.Bucket bucket) {
+            mMockedBuckets.add(bucket);
+        }
+
+        @Override
+        public boolean hasNextBucket(@NonNull NetworkStats unused) {
+            return !mMockedBuckets.isEmpty();
+        }
+
+        @Override
+        public NetworkStats.Bucket getNextBucket(@NonNull NetworkStats unused) {
+            return mMockedBuckets.remove();
+        }
+    }
+
+    @Test
+    public void defaultInitialize_hasNoPreference() {
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void onDataLoaded_dataNotLoaded_hasNoPreference() {
+        mPreferenceController.onDataLoaded(null, new int[0]);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void onDataLoaded_statsSizeZero_hasNoPreference() {
+        mPreferenceController.onDataLoaded(mock(NetworkStats.class), new int[0]);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    private NetworkStats.Bucket getMockBucket(int uid, long rxBytes, long txBytes) {
+        NetworkStats.Bucket ret = mock(NetworkStats.Bucket.class);
+        when(ret.getUid()).thenReturn(uid);
+        when(ret.getRxBytes()).thenReturn(rxBytes);
+        when(ret.getTxBytes()).thenReturn(txBytes);
+        return ret;
+    }
+
+    @Test
+    public void onDataLoaded_statsLoaded_hasTwoPreference() {
+        mPreferenceController.addBucket(getMockBucket(0, 100, 0));
+        mPreferenceController.addBucket(getMockBucket(UID_TETHERING, 200, 0));
+
+        mPreferenceController.onDataLoaded(mock(NetworkStats.class), new int[0]);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void onDataLoaded_statsLoaded_hasOnePreference() {
+        when(mMockUidDetailProvider.getUidDetail(anyInt(), anyBoolean()))
+                .thenReturn(mMockUidDetail);
+        mPreferenceController.addBucket(getMockBucket(0, 100, 0));
+        mPreferenceController.addBucket(getMockBucket(UID_TETHERING, 200, 0));
+
+        mPreferenceController.onDataLoaded(mock(NetworkStats.class), new int[0]);
+
+        ProgressBarPreference preference1 =
+                (ProgressBarPreference) mPreferenceGroup.getPreference(0);
+        ProgressBarPreference preference2 =
+                (ProgressBarPreference) mPreferenceGroup.getPreference(1);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+        assertThat(preference1.getProgress()).isEqualTo(100);
+        assertThat(preference2.getProgress()).isEqualTo(50);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/AppSpecificDataUsageCyclePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/AppSpecificDataUsageCyclePreferenceControllerTest.java
new file mode 100644
index 000000000..8d28d77be
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/AppSpecificDataUsageCyclePreferenceControllerTest.java
@@ -0,0 +1,116 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.net.DataUsageController;
+import com.android.settingslib.net.NetworkCycleDataForUid;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+import java.util.concurrent.TimeUnit;
+
+@RunWith(AndroidJUnit4.class)
+public class AppSpecificDataUsageCyclePreferenceControllerTest {
+    private static final long FOREGROUND_USAGE_1 = 123456789;
+    private static final long FOREGROUND_USAGE_2 = 1234;
+    private static final long BACKGROUND_USAGE_1 = 100000000;
+    private static final long BACKGROUND_USAGE_2 = 100000;
+    private static final long END_TIME_1 = System.currentTimeMillis();
+    private static final long START_TIME_1 = END_TIME_1 - TimeUnit.DAYS.toMillis(10);
+    private static final long END_TIME_2 = START_TIME_1;
+    private static final long START_TIME_2 = END_TIME_2 - TimeUnit.DAYS.toMillis(30);
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private AppSpecificDataUsageCyclePreferenceController mPreferenceController;
+    private ListPreference mPreference;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DataUsageCycleBasePreferenceController.DataCyclePickedListener mMockListener;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new AppSpecificDataUsageCyclePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new ListPreference(mContext);
+        mPreferenceController.setDataCyclePickedListener(mMockListener);
+        mPreferenceController.setDataUsageInfo(new DataUsageController.DataUsageInfo());
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCreate_testOnDataLoaded() {
+        mPreferenceController.onDataLoaded(createDataList());
+
+        assertThat(mPreference.getSummary().toString()).isEqualTo(
+                mPreferenceController.formatDate(START_TIME_1, END_TIME_1));
+    }
+
+    private List<NetworkCycleDataForUid> createDataList() {
+        List<NetworkCycleDataForUid> dataList = new ArrayList<>();
+        NetworkCycleDataForUid networkCycleDataForUid1 =
+                (NetworkCycleDataForUid) new NetworkCycleDataForUid.Builder()
+                .setForegroundUsage(FOREGROUND_USAGE_1)
+                .setBackgroundUsage(BACKGROUND_USAGE_1)
+                .setTotalUsage(BACKGROUND_USAGE_1 + FOREGROUND_USAGE_1)
+                .setEndTime(END_TIME_1)
+                .setStartTime(START_TIME_1)
+                .build();
+        dataList.add(networkCycleDataForUid1);
+
+        NetworkCycleDataForUid networkCycleDataForUid2 =
+                (NetworkCycleDataForUid) new NetworkCycleDataForUid.Builder()
+                        .setForegroundUsage(FOREGROUND_USAGE_2)
+                        .setBackgroundUsage(BACKGROUND_USAGE_2)
+                        .setTotalUsage(BACKGROUND_USAGE_2 + FOREGROUND_USAGE_2)
+                        .setEndTime(END_TIME_2)
+                        .setStartTime(START_TIME_2)
+                        .build();
+        dataList.add(networkCycleDataForUid2);
+
+        return dataList;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/AppSpecificDataUsageManagerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/AppSpecificDataUsageManagerTest.java
new file mode 100644
index 000000000..06ccf435d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/AppSpecificDataUsageManagerTest.java
@@ -0,0 +1,115 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.android.car.settings.datausage.AppSpecificDataUsageManager.NETWORK_CYCLE_LOADER_ID;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.net.NetworkTemplate;
+
+import androidx.loader.app.LoaderManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.net.NetworkCycleDataForUid;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AppSpecificDataUsageManagerTest {
+
+    private static final int TEST_UID = 1;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private AppSpecificDataUsageManager mAppSpecificDataUsageManager;
+
+    @Captor
+    private ArgumentCaptor<LoaderManager.LoaderCallbacks<List<NetworkCycleDataForUid>>>
+            mCallbacksArgumentCaptor;
+    @Mock
+    private AppSpecificDataUsageManager.AppSpecificDataLoaderCallback mCallback1;
+    @Mock
+    private AppSpecificDataUsageManager.AppSpecificDataLoaderCallback mCallback2;
+    @Mock
+    private LoaderManager mLoaderManager;
+    @Mock
+    private NetworkTemplate mNetworkTemplate;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+
+        mAppSpecificDataUsageManager = new AppSpecificDataUsageManager(mContext, mNetworkTemplate,
+                TEST_UID);
+        mAppSpecificDataUsageManager.startLoading(mLoaderManager);
+
+        verify(mLoaderManager).restartLoader(eq(NETWORK_CYCLE_LOADER_ID), eq(null),
+                mCallbacksArgumentCaptor.capture());
+    }
+
+    @Test
+    public void callback_onLoadFinished_listenerOnDataLoadedCalled() {
+        mAppSpecificDataUsageManager.registerListener(mCallback1);
+        mAppSpecificDataUsageManager.registerListener(mCallback2);
+
+        List<NetworkCycleDataForUid> dataList = new ArrayList<>();
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, dataList);
+
+        verify(mCallback1).onDataLoaded(dataList);
+        verify(mCallback2).onDataLoaded(dataList);
+    }
+
+    @Test
+    public void callback_unregisterListener_onlyOneListenerOnDataLoadedCalled() {
+        mAppSpecificDataUsageManager.registerListener(mCallback1);
+        mAppSpecificDataUsageManager.registerListener(mCallback2);
+        mAppSpecificDataUsageManager.unregisterListener(mCallback2);
+
+        List<NetworkCycleDataForUid> dataList = new ArrayList<>();
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, dataList);
+
+        verify(mCallback1).onDataLoaded(dataList);
+        verify(mCallback2, never()).onDataLoaded(dataList);
+    }
+
+    @Test
+    public void callback_notLoaded_listenerOnDataLoadedNotCalled() {
+        mAppSpecificDataUsageManager.registerListener(mCallback1);
+        mAppSpecificDataUsageManager.registerListener(mCallback2);
+        mAppSpecificDataUsageManager.unregisterListener(mCallback2);
+
+        List<NetworkCycleDataForUid> dataList = new ArrayList<>();
+
+        verify(mCallback1, never()).onDataLoaded(dataList);
+        verify(mCallback2, never()).onDataLoaded(dataList);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/AppsNetworkStatsManagerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/AppsNetworkStatsManagerTest.java
new file mode 100644
index 000000000..02f4849b8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/AppsNetworkStatsManagerTest.java
@@ -0,0 +1,114 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.usage.NetworkStats;
+import android.app.usage.NetworkStatsManager;
+import android.content.Context;
+import android.net.NetworkPolicyManager;
+import android.os.Bundle;
+
+import androidx.loader.app.LoaderManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AppsNetworkStatsManagerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private AppsNetworkStatsManager mAppsNetworkStatsManager;
+
+    @Captor
+    private ArgumentCaptor<LoaderManager.LoaderCallbacks<NetworkStats>> mCallbacksArgumentCaptor;
+    @Mock
+    private AppsNetworkStatsManager.Callback mCallback1;
+    @Mock
+    private AppsNetworkStatsManager.Callback mCallback2;
+    @Mock
+    private LoaderManager mLoaderManager;
+    @Mock
+    private NetworkStatsManager mNetworkStatsManager;
+    @Mock
+    private NetworkPolicyManager mNetworkPolicyManager;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+
+        when(mNetworkPolicyManager.getUidsWithPolicy(anyInt())).thenReturn(new int[0]);
+
+        mAppsNetworkStatsManager = new AppsNetworkStatsManager(
+                mContext, mNetworkPolicyManager, mNetworkStatsManager);
+        mAppsNetworkStatsManager.startLoading(mLoaderManager, Bundle.EMPTY);
+
+        verify(mLoaderManager).restartLoader(eq(1), eq(Bundle.EMPTY),
+                mCallbacksArgumentCaptor.capture());
+    }
+
+    @Test
+    public void callback_onLoadFinished_listenerOnDataLoadedCalled() throws Exception {
+        mAppsNetworkStatsManager.registerListener(mCallback1);
+        mAppsNetworkStatsManager.registerListener(mCallback2);
+
+        NetworkStats networkStats = mock(NetworkStats.class);
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, networkStats);
+
+        verify(mCallback1).onDataLoaded(eq(networkStats), any());
+        verify(mCallback2).onDataLoaded(eq(networkStats), any());
+    }
+
+    @Test
+    public void callback_unregisterListener_onlyOneListenerOnDataLoadedCalled() throws Exception {
+        mAppsNetworkStatsManager.registerListener(mCallback1);
+        mAppsNetworkStatsManager.registerListener(mCallback2);
+        mAppsNetworkStatsManager.unregisterListener(mCallback2);
+
+        NetworkStats networkStats = mock(NetworkStats.class);
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, networkStats);
+
+        verify(mCallback1).onDataLoaded(eq(networkStats), any());
+        verify(mCallback2, never()).onDataLoaded(eq(networkStats), any());
+    }
+
+    @Test
+    public void callback_notLoaded_listenerOnDataLoadedNotCalled() throws Exception {
+        mAppsNetworkStatsManager.registerListener(mCallback1);
+        mAppsNetworkStatsManager.registerListener(mCallback2);
+        mAppsNetworkStatsManager.unregisterListener(mCallback2);
+
+        verify(mCallback1, never()).onDataLoaded(any(), any());
+        verify(mCallback2, never()).onDataLoaded(any(), any());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/CycleResetDayOfMonthPickerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/CycleResetDayOfMonthPickerPreferenceControllerTest.java
new file mode 100644
index 000000000..7ab2cee9a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/CycleResetDayOfMonthPickerPreferenceControllerTest.java
@@ -0,0 +1,116 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.NetworkTemplate;
+import android.text.BidiFormatter;
+import android.text.TextDirectionHeuristics;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.NetworkPolicyEditor;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.TimeZone;
+
+@RunWith(AndroidJUnit4.class)
+public class CycleResetDayOfMonthPickerPreferenceControllerTest {
+    private static int STARTING_VALUE = 15;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private CycleResetDayOfMonthPickerPreferenceController mPreferenceController;
+    private ListPreference mPreference;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private NetworkPolicyEditor mMockPolicyEditor;
+    @Mock
+    private NetworkTemplate mMockNetworkTemplate;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new CycleResetDayOfMonthPickerPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new ListPreference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.setNetworkPolicyEditor(mMockPolicyEditor);
+        mPreferenceController.setNetworkTemplate(mMockNetworkTemplate);
+        when(mMockPolicyEditor.getPolicyCycleDay(mMockNetworkTemplate)).thenReturn(STARTING_VALUE);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCreate_createEntries() {
+        CharSequence[] entries = mPreference.getEntries();
+
+        assertThat(entries[0]).isEqualTo(
+                String.valueOf(CycleResetDayOfMonthPickerPreferenceController.MIN_DAY));
+        assertThat(entries[entries.length - 1]).isEqualTo(
+                String.valueOf(CycleResetDayOfMonthPickerPreferenceController.MAX_DAY));
+    }
+
+    @Test
+    public void onCreate_setsSummary() {
+        String prefix = mContext.getString(R.string.cycle_reset_day_of_month_picker_subtitle);
+        assertThat(mPreference.getSummary()).isEqualTo(BidiFormatter.getInstance().unicodeWrap(
+                prefix + " " + STARTING_VALUE,
+                TextDirectionHeuristics.LOCALE));
+    }
+
+    @Test
+    public void onPreferenceChanged_setsCycleDay() {
+        int newValue = STARTING_VALUE + 1;
+        mPreferenceController.handlePreferenceChanged(mPreference, String.valueOf(newValue));
+
+        ArgumentCaptor<Integer> captor = ArgumentCaptor.forClass(Integer.class);
+        verify(mMockPolicyEditor).setPolicyCycleDay(
+                eq(mMockNetworkTemplate), captor.capture(), eq(TimeZone.getDefault().getID()));
+        assertThat(captor.getValue()).isEqualTo(newValue);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataLimitPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataLimitPreferenceControllerTest.java
new file mode 100644
index 000000000..df2288f0c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataLimitPreferenceControllerTest.java
@@ -0,0 +1,209 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static android.net.NetworkPolicy.LIMIT_DISABLED;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.NetworkTemplate;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.settingslib.NetworkPolicyEditor;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DataLimitPreferenceControllerTest {
+
+    private static final long GIB_IN_BYTES = 1024 * 1024 * 1024;
+    private static final long EPSILON = 100;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private DataLimitPreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreferenceGroup;
+    private Preference mLimitPreference;
+    private TwoStatePreference mEnablePreference;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private NetworkPolicyEditor mMockPolicyEditor;
+    @Mock
+    private NetworkTemplate mMockNetworkTemplate;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DataLimitPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mEnablePreference = new SwitchPreference(mContext);
+        mEnablePreference.setKey(mContext.getString(R.string.pk_data_set_limit));
+        mPreferenceGroup.addPreference(mEnablePreference);
+        mLimitPreference = new CarUiPreference(mContext);
+        mLimitPreference.setKey(mContext.getString(R.string.pk_data_limit));
+        mPreferenceGroup.addPreference(mLimitPreference);
+
+        mPreferenceController.setNetworkPolicyEditor(mMockPolicyEditor);
+        mPreferenceController.setNetworkTemplate(mMockNetworkTemplate);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_limitDisabled_summaryEmpty() {
+        when(mMockPolicyEditor.getPolicyLimitBytes(mMockNetworkTemplate))
+                .thenReturn(LIMIT_DISABLED);
+        mPreferenceController.refreshUi();
+
+        assertThat(mLimitPreference.getSummary()).isNull();
+    }
+
+    @Test
+    public void refreshUi_limitDisabled_preferenceDisabled() {
+        when(mMockPolicyEditor.getPolicyLimitBytes(mMockNetworkTemplate))
+                .thenReturn(LIMIT_DISABLED);
+        mPreferenceController.refreshUi();
+
+        assertThat(mLimitPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_limitDisabled_switchUnchecked() {
+        when(mMockPolicyEditor.getPolicyLimitBytes(mMockNetworkTemplate))
+                .thenReturn(LIMIT_DISABLED);
+        mPreferenceController.refreshUi();
+
+        assertThat(mEnablePreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_limitEnabled_summaryPopulated() {
+        when(mMockPolicyEditor.getPolicyLimitBytes(mMockNetworkTemplate))
+                .thenReturn(5 * GIB_IN_BYTES);
+        mPreferenceController.refreshUi();
+
+        assertThat(mLimitPreference.getSummary().toString()).isNotEmpty();
+    }
+
+    @Test
+    public void refreshUi_limitEnabled_preferenceEnabled() {
+        when(mMockPolicyEditor.getPolicyLimitBytes(mMockNetworkTemplate))
+                .thenReturn(5 * GIB_IN_BYTES);
+        mPreferenceController.refreshUi();
+
+        assertThat(mLimitPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_limitEnabled_switchChecked() {
+        when(mMockPolicyEditor.getPolicyLimitBytes(mMockNetworkTemplate))
+                .thenReturn(5 * GIB_IN_BYTES);
+        mPreferenceController.refreshUi();
+
+        assertThat(mEnablePreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onPreferenceChanged_toggleFalse_limitBytesDisabled() {
+        mEnablePreference.callChangeListener(false);
+        verify(mMockPolicyEditor).setPolicyLimitBytes(mMockNetworkTemplate, LIMIT_DISABLED);
+    }
+
+    @Test
+    public void onPreferenceChanged_toggleTrue_showsDialog() {
+        mEnablePreference.callChangeListener(true);
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    public void onDialogConfirm_noWarningThreshold_setsLimitTo5GB() {
+        mPreferenceController.onConfirm(null);
+
+        verify(mMockPolicyEditor).setPolicyLimitBytes(mMockNetworkTemplate, 5 * GIB_IN_BYTES);
+    }
+
+    @Test
+    public void onDialogConfirm_hasWarningThreshold_setsLimitToWithMultiplier() {
+        when(mMockPolicyEditor.getPolicyWarningBytes(mMockNetworkTemplate))
+                .thenReturn(5 * GIB_IN_BYTES);
+        mPreferenceController.onConfirm(null);
+
+        ArgumentCaptor<Long> setLimit = ArgumentCaptor.forClass(Long.class);
+        verify(mMockPolicyEditor).setPolicyLimitBytes(eq(mMockNetworkTemplate), setLimit.capture());
+
+        long setValue = setLimit.getValue();
+        // Due to precision errors, add and subtract a small epsilon.
+        assertThat(setValue).isGreaterThan(
+                (long) (5 * GIB_IN_BYTES * DataLimitPreferenceController.LIMIT_BYTES_MULTIPLIER)
+                        - EPSILON);
+        assertThat(setValue).isLessThan(
+                (long) (5 * GIB_IN_BYTES * DataLimitPreferenceController.LIMIT_BYTES_MULTIPLIER)
+                        + EPSILON);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClicked_launchesFragment() {
+        mLimitPreference.performClick();
+
+        verify(mMockFragmentController).launchFragment(any(DataLimitSetThresholdFragment.class));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataLimitSetThresholdFragmentTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataLimitSetThresholdFragmentTest.java
new file mode 100644
index 000000000..a28b2b3da
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataLimitSetThresholdFragmentTest.java
@@ -0,0 +1,100 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.android.car.settings.datausage.DataUsageSetThresholdBaseFragment.MIB_IN_BYTES;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.net.NetworkTemplate;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.ToolbarController;
+import com.android.settingslib.NetworkPolicyEditor;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DataLimitSetThresholdFragmentTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private DataLimitSetThresholdFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    private NetworkPolicyEditor mMockNetworkPolicyEditor;
+    @Mock
+    private NetworkTemplate mMockNetworkTemplate;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    @UiThreadTest
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+    }
+
+    @Test
+    public void onActivityCreated_titleIsSet() {
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getTitle().toString()).isEqualTo(
+                mContext.getString(R.string.data_usage_limit_editor_title));
+    }
+
+    @Test
+    public void onActivityCreated_saveButtonClicked_savesLimit() {
+        mFragment.onSave(MIB_IN_BYTES);
+
+        verify(mMockNetworkPolicyEditor).setPolicyLimitBytes(mMockNetworkTemplate, MIB_IN_BYTES);
+    }
+
+    private void setUpFragment() throws Throwable {
+        String dataUsageSetThresholdFragmentTag = "data_usage_set_threshold_fragment";
+        DataLimitSetThresholdFragment fragment = DataLimitSetThresholdFragment.newInstance(
+                mMockNetworkTemplate);
+        fragment.mPolicyEditor = mMockNetworkPolicyEditor;
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, fragment, dataUsageSetThresholdFragmentTag)
+                    .commitNow();
+        });
+        mFragment = spy((DataLimitSetThresholdFragment) mFragmentManager
+                .findFragmentByTag(dataUsageSetThresholdFragmentTag));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCycleBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCycleBasePreferenceControllerTest.java
new file mode 100644
index 000000000..ed11ef6e6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCycleBasePreferenceControllerTest.java
@@ -0,0 +1,175 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.verify;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.net.DataUsageController;
+import com.android.settingslib.net.NetworkCycleData;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+import java.util.concurrent.TimeUnit;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageCycleBasePreferenceControllerTest {
+    private static final long END_TIME_1 = System.currentTimeMillis();
+    private static final long START_TIME_1 = END_TIME_1 - TimeUnit.DAYS.toMillis(10);
+    private static final long END_TIME_2 = START_TIME_1;
+    private static final long START_TIME_2 = END_TIME_2 - TimeUnit.DAYS.toMillis(30);
+    private static final String PERIOD = "data_usage_info_period";
+
+    private Context mContext;
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private DataUsageCycleBasePreferenceController mPreferenceController;
+    private ListPreference mPreference;
+    private DataUsageController.DataUsageInfo mDataUsageInfo;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DataUsageCycleBasePreferenceController.DataCyclePickedListener mMockListener;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mContext = ApplicationProvider.getApplicationContext();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new TestDataUsageCycleBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new ListPreference(mContext);
+        mDataUsageInfo = new DataUsageController.DataUsageInfo();
+        mDataUsageInfo.period = PERIOD;
+    }
+
+    @Test
+    public void onCreate_noListenerSet_throwException() {
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void onCreate_dataNotLoaded_testSummary() {
+        finishSetUp();
+
+        assertThat(mPreference.isEnabled()).isFalse();
+        assertThat(mPreference.getSummary().toString()).isEqualTo(PERIOD);
+    }
+
+    @Test
+    public void onLoaded_loadEmptyData_testEntryInfo() {
+        finishSetUp();
+        mPreferenceController.onLoaded(Collections.emptyList());
+
+        assertThat(mPreference.isEnabled()).isFalse();
+        assertThat(mPreference.getSummary().toString()).isEqualTo(PERIOD);
+    }
+
+    @Test
+    public void onLoaded_testEntryInfo() {
+        finishSetUp();
+        mPreferenceController.onLoaded(createDataList());
+
+        String expectedString1 = mPreferenceController.formatDate(START_TIME_1, END_TIME_1);
+        String expectedString2 = mPreferenceController.formatDate(START_TIME_2, END_TIME_2);
+
+        assertThat(mPreference.isEnabled()).isTrue();
+        verifyArray(mPreference.getEntries(), Arrays.asList(expectedString1, expectedString2));
+        verifyArray(mPreference.getEntryValues(), Arrays.asList("0", "1"));
+        assertThat(mPreference.getSummary().toString()).isEqualTo(expectedString1);
+        assertThat(mPreference.getEntry().toString()).isEqualTo(expectedString1);
+    }
+
+    @Test
+    public void onLoaded_testDataCyclePickedListener() {
+        finishSetUp();
+        mPreferenceController.onLoaded(createDataList());
+
+        verify(mMockListener).onDataCyclePicked(any(), any());
+    }
+
+    private void finishSetUp() {
+        mPreferenceController.setDataCyclePickedListener(mMockListener);
+        mPreferenceController.setDataUsageInfo(mDataUsageInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    private void verifyArray(CharSequence[] array, List<String> list) {
+        assertThat(array.length).isEqualTo(2);
+        assertThat(array[0].toString()).isEqualTo(list.get(0));
+        assertThat(array[1].toString()).isEqualTo(list.get(1));
+    }
+
+    private List<NetworkCycleData> createDataList() {
+        List<NetworkCycleData> dataList = new ArrayList<>();
+        NetworkCycleData networkCycleData1 =
+                new NetworkCycleData.Builder()
+                        .setEndTime(END_TIME_1)
+                        .setStartTime(START_TIME_1)
+                        .build();
+        dataList.add(networkCycleData1);
+
+        NetworkCycleData networkCycleData2 =
+                new NetworkCycleData.Builder()
+                        .setEndTime(END_TIME_2)
+                        .setStartTime(START_TIME_2)
+                        .build();
+        dataList.add(networkCycleData2);
+
+        return dataList;
+    }
+
+    private static class TestDataUsageCycleBasePreferenceController
+            extends DataUsageCycleBasePreferenceController<NetworkCycleData> {
+
+        TestDataUsageCycleBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCycleManagerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCycleManagerTest.java
new file mode 100644
index 000000000..d7aa58d81
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCycleManagerTest.java
@@ -0,0 +1,112 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.android.car.settings.datausage.DataUsageCycleManager.NETWORK_CYCLE_LOADER_ID;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.net.NetworkTemplate;
+
+import androidx.loader.app.LoaderManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.net.NetworkCycleChartData;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageCycleManagerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private DataUsageCycleManager mDataUsageCycleManager;
+
+    @Captor
+    private ArgumentCaptor<LoaderManager.LoaderCallbacks<List<NetworkCycleChartData>>>
+            mCallbacksArgumentCaptor;
+    @Mock
+    private DataUsageCycleManager.DataUsageCycleLoaderCallback mCallback1;
+    @Mock
+    private DataUsageCycleManager.DataUsageCycleLoaderCallback mCallback2;
+    @Mock
+    private LoaderManager mLoaderManager;
+    @Mock
+    private NetworkTemplate mNetworkTemplate;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+
+        mDataUsageCycleManager = new DataUsageCycleManager(mContext, mNetworkTemplate);
+        mDataUsageCycleManager.startLoading(mLoaderManager);
+
+        verify(mLoaderManager).restartLoader(eq(NETWORK_CYCLE_LOADER_ID), eq(null),
+                mCallbacksArgumentCaptor.capture());
+    }
+
+    @Test
+    public void callback_onLoadFinished_listenerOnDataLoadedCalled() {
+        mDataUsageCycleManager.registerListener(mCallback1);
+        mDataUsageCycleManager.registerListener(mCallback2);
+
+        List<NetworkCycleChartData> dataList = new ArrayList<>();
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, dataList);
+
+        verify(mCallback1).onDataLoaded(dataList);
+        verify(mCallback2).onDataLoaded(dataList);
+    }
+
+    @Test
+    public void callback_unregisterListener_onlyOneListenerOnDataLoadedCalled() {
+        mDataUsageCycleManager.registerListener(mCallback1);
+        mDataUsageCycleManager.registerListener(mCallback2);
+        mDataUsageCycleManager.unregisterListener(mCallback2);
+
+        List<NetworkCycleChartData> dataList = new ArrayList<>();
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, dataList);
+
+        verify(mCallback1).onDataLoaded(dataList);
+        verify(mCallback2, never()).onDataLoaded(dataList);
+    }
+
+    @Test
+    public void callback_notLoaded_listenerOnDataLoadedNotCalled() {
+        mDataUsageCycleManager.registerListener(mCallback1);
+        mDataUsageCycleManager.registerListener(mCallback2);
+        mDataUsageCycleManager.unregisterListener(mCallback2);
+
+        List<NetworkCycleChartData> dataList = new ArrayList<>();
+
+        verify(mCallback1, never()).onDataLoaded(dataList);
+        verify(mCallback2, never()).onDataLoaded(dataList);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCyclePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCyclePreferenceControllerTest.java
new file mode 100644
index 000000000..49989c378
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageCyclePreferenceControllerTest.java
@@ -0,0 +1,106 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.net.DataUsageController;
+import com.android.settingslib.net.NetworkCycleChartData;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+import java.util.concurrent.TimeUnit;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageCyclePreferenceControllerTest {
+    private static final long END_TIME_1 = System.currentTimeMillis();
+    private static final long START_TIME_1 = END_TIME_1 - TimeUnit.DAYS.toMillis(10);
+    private static final long END_TIME_2 = START_TIME_1;
+    private static final long START_TIME_2 = END_TIME_2 - TimeUnit.DAYS.toMillis(30);
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private DataUsageCyclePreferenceController mPreferenceController;
+    private ListPreference mPreference;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DataUsageCycleBasePreferenceController.DataCyclePickedListener mMockListener;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DataUsageCyclePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new ListPreference(mContext);
+        mPreferenceController.setDataCyclePickedListener(mMockListener);
+        mPreferenceController.setDataUsageInfo(new DataUsageController.DataUsageInfo());
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCreate_testOnDataLoaded() {
+        mPreferenceController.onDataLoaded(createDataList());
+
+        assertThat(mPreference.getSummary().toString()).isEqualTo(
+                mPreferenceController.formatDate(START_TIME_1, END_TIME_1));
+    }
+
+    private List<NetworkCycleChartData> createDataList() {
+        List<NetworkCycleChartData> dataList = new ArrayList<>();
+        NetworkCycleChartData networkCycleChartData1 =
+                (NetworkCycleChartData) new NetworkCycleChartData.Builder()
+                        .setEndTime(END_TIME_1)
+                        .setStartTime(START_TIME_1)
+                        .build();
+        dataList.add(networkCycleChartData1);
+
+        NetworkCycleChartData networkCycleChartData2 =
+                (NetworkCycleChartData) new NetworkCycleChartData.Builder()
+                        .setEndTime(END_TIME_2)
+                        .setStartTime(START_TIME_2)
+                        .build();
+        dataList.add(networkCycleChartData2);
+
+        return dataList;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEditTextPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEditTextPreferenceControllerTest.java
new file mode 100644
index 000000000..f1b56ed02
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEditTextPreferenceControllerTest.java
@@ -0,0 +1,82 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageEditTextPreferenceControllerTest {
+
+    private static final String DEFAULT_TEXT = "DEFAULT_TEXT";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private DataUsageEditTextPreference mPreference;
+    private DataUsageEditTextPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DataUsageEditTextPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = spy(new DataUsageEditTextPreference(mContext));
+    }
+
+    @Test
+    public void checkInitialized_noDefaultText_throwException() {
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void onCreate_setsDefaultText_textSet() {
+        mPreferenceController.setDefaultText(DEFAULT_TEXT);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mPreference).setText(DEFAULT_TEXT);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEditTextPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEditTextPreferenceTest.java
new file mode 100644
index 000000000..3eb59130a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEditTextPreferenceTest.java
@@ -0,0 +1,65 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.view.View;
+
+import androidx.preference.PreferenceViewHolder;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageEditTextPreferenceTest {
+
+    private static final String TEST_TEXT = "TEST_TEXT";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private PreferenceViewHolder mViewHolder;
+    private DataUsageEditTextPreference mDataUsageEditTextPreference;
+
+    @Before
+    public void setUp() {
+        View rootView = View.inflate(mContext, R.layout.data_usage_edit_text_preference,
+                /* root= */ null);
+        mViewHolder = PreferenceViewHolder.createInstanceForTests(rootView);
+        mDataUsageEditTextPreference = new DataUsageEditTextPreference(mContext);
+    }
+
+    @Test
+    public void onBindViewHolder_noSetText() {
+        mDataUsageEditTextPreference.onBindViewHolder(mViewHolder);
+
+        assertThat(mDataUsageEditTextPreference.getText()).isEmpty();
+    }
+
+    @Test
+    public void onBindViewHolder_setText_displaysText() {
+        mDataUsageEditTextPreference.setText(TEST_TEXT);
+        mDataUsageEditTextPreference.onBindViewHolder(mViewHolder);
+
+        assertThat(mDataUsageEditTextPreference.getText()).isEqualTo(TEST_TEXT);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..b3937cb0c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageEntryPreferenceControllerTest.java
@@ -0,0 +1,268 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static android.telephony.SubscriptionManager.INVALID_SUBSCRIPTION_ID;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.ConnectivityManager;
+import android.net.Network;
+import android.net.NetworkCapabilities;
+import android.telephony.SubscriptionManager;
+import android.telephony.SubscriptionPlan;
+import android.util.Range;
+import android.util.RecurrenceRule;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import com.google.android.collect.Lists;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.time.ZonedDateTime;
+import java.util.Iterator;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageEntryPreferenceControllerTest {
+
+    private static final int SUBSCRIPTION_ID = 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private Preference mPreference;
+    private DataUsageEntryPreferenceController mPreferenceController;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private NetworkCapabilities mMockNetworkCapabilities;
+    @Mock
+    private SubscriptionManager mMockSubscriptionManager;
+    @Mock
+    private SubscriptionPlan mMockSubscriptionPlan;
+    @Mock
+    private RecurrenceRule mMockRecurrenceRule;
+    @Mock
+    private ConnectivityManager mMockConnectivityManager;
+    @Mock
+    private Network mMockNetwork;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DataUsageEntryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+
+        mPreference = new CarUiPreference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                SubscriptionManager.class, withSettings().lenient()).startMocking();
+
+        // Setup to always make preference available.
+        when(mContext.getSystemService(ConnectivityManager.class))
+                .thenReturn(mMockConnectivityManager);
+        Network[] networks = {mMockNetwork};
+        when(mMockConnectivityManager.getAllNetworks()).thenReturn(networks);
+        when(mMockConnectivityManager.getNetworkCapabilities(mMockNetwork))
+                .thenReturn(mMockNetworkCapabilities);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(true);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_noMobileNetwork_isUnsupported() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noMobileNetwork_isUnsupported_zoneWrite() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noMobileNetwork_isUnsupported_zoneRead() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noMobileNetwork_isUnsupported_zoneHidden() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasMobileNetwork_isAvailable() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasMobileNetwork_isAvailable_zoneWrite() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasMobileNetwork_isAvailable_zoneRead() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasMobileNetwork_isAvailable_zoneHidden() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockNetworkCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR))
+                .thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void refreshUi_noDefaultSubscriptionId_noSummarySet() {
+        mockSubscriptionManager(INVALID_SUBSCRIPTION_ID, /* subscriptionPlan= */ null);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isNull();
+    }
+
+    @Test
+    public void refreshUi_noPrimaryPlan_noSummarySet() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, /* subscriptionPlan= */ null);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isNull();
+    }
+
+    @Test
+    public void refreshUi_hasPrimaryPlan_setsSummary() {
+        mockSubscriptionManager(SUBSCRIPTION_ID, mMockSubscriptionPlan);
+        when(mMockSubscriptionPlan.getDataLimitBytes()).thenReturn(100L);
+        when(mMockSubscriptionPlan.getDataUsageBytes()).thenReturn(10L);
+        when(mMockSubscriptionPlan.getCycleRule()).thenReturn(mMockRecurrenceRule);
+
+        // Provide arbitrary cycle start time so summary is displayed
+        Iterator<Range<ZonedDateTime>> cycle = new Iterator<Range<ZonedDateTime>>() {
+            @Override
+            public boolean hasNext() {
+                return true;
+            }
+
+            @Override
+            public Range<ZonedDateTime> next() {
+                return new Range<>(ZonedDateTime.now(), ZonedDateTime.now());
+            }
+        };
+        when(mMockSubscriptionPlan.cycleIterator()).thenReturn(cycle);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary().length()).isGreaterThan(0);
+    }
+
+    private void mockSubscriptionManager(int subscriptionId, SubscriptionPlan subscriptionPlan) {
+        when(mContext.getSystemService(SubscriptionManager.class))
+                .thenReturn(mMockSubscriptionManager);
+        ExtendedMockito.when(SubscriptionManager.getDefaultSubscriptionId())
+                .thenReturn(subscriptionId);
+        if (subscriptionPlan == null) {
+            when(mMockSubscriptionManager.getSubscriptionPlans(subscriptionId))
+                    .thenReturn(Lists.newArrayList());
+        } else {
+            when(mMockSubscriptionManager.getSubscriptionPlans(subscriptionId))
+                    .thenReturn(Lists.newArrayList(mMockSubscriptionPlan));
+        }
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSetThresholdBaseFragmentTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSetThresholdBaseFragmentTest.java
new file mode 100644
index 000000000..26e725622
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSetThresholdBaseFragmentTest.java
@@ -0,0 +1,193 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.android.car.settings.datausage.DataUsageSetThresholdBaseFragment.GIB_IN_BYTES;
+import static com.android.car.settings.datausage.DataUsageSetThresholdBaseFragment.MB_GB_SUFFIX_THRESHOLD;
+import static com.android.car.settings.datausage.DataUsageSetThresholdBaseFragment.MIB_IN_BYTES;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.content.Context;
+import android.net.NetworkPolicyManager;
+import android.net.NetworkTemplate;
+import android.os.Bundle;
+
+import androidx.annotation.StringRes;
+import androidx.fragment.app.FragmentManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.ToolbarController;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.NetworkPolicyEditor;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageSetThresholdBaseFragmentTest {
+
+    private static final int SUB_ID = 11;
+    private static final int TITLE_RES_ID = R.string.settings_label; // placeholder string
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private DataUsageSetThresholdBaseFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MockitoSession mSession;
+
+    @Mock
+    private NetworkPolicyEditor mMockNetworkPolicyEditor;
+    @Mock
+    private NetworkTemplate mMockNetworkTemplate;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        mSession = ExtendedMockito.mockitoSession().mockStatic(DataUsageUtils.class,
+                withSettings().lenient()).startMocking();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_noTemplateSet_getsDefaultTemplate() throws Throwable {
+        when(DataUsageUtils.getDefaultSubscriptionId(any())).thenReturn(SUB_ID);
+        when(DataUsageUtils.getMobileNetworkTemplate(any(), eq(SUB_ID)))
+                .thenReturn(mMockNetworkTemplate);
+        setUpFragment(/* useTemplate= */ false, /* initialBytes= */ MIB_IN_BYTES);
+
+        assertThat(mFragment.mNetworkTemplate).isEqualTo(mMockNetworkTemplate);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_saveButtonSet() throws Throwable {
+        setUpFragment(/* useTemplate= */ true, /* initialBytes= */ MIB_IN_BYTES);
+
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getMenuItems().get(0).getTitle().toString()).isEqualTo(
+                mContext.getString(R.string.data_usage_warning_save_title));
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_titleSet() throws Throwable {
+        setUpFragment(/* useTemplate= */ true, /* initialBytes= */ MIB_IN_BYTES);
+
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getTitle().toString()).isEqualTo(mContext.getString(TITLE_RES_ID));
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_belowGbThreshold_mbSet() throws Throwable {
+        setUpFragment(/* useTemplate= */ true, /* initialBytes= */ MIB_IN_BYTES);
+
+        assertThat(mFragment.mDataWarningUnitsPreferenceController.isGbSelected()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_aboveGbThreshold_gbSet() throws Throwable {
+        setUpFragment(/* useTemplate= */ true,
+                /* initialBytes= */ (long) (MB_GB_SUFFIX_THRESHOLD * GIB_IN_BYTES * 2));
+
+        assertThat(mFragment.mDataWarningUnitsPreferenceController.isGbSelected()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityCreated_saveButtonClicked_goesBack() throws Throwable {
+        setUpFragment(/* useTemplate= */ true, /* initialBytes= */ MIB_IN_BYTES);
+
+        doReturn(MIB_IN_BYTES).when(mFragment).getCurrentThreshold();
+
+        mFragment.onSaveClicked();
+
+        assertThat(mActivity.getOnBackPressedFlag()).isTrue();
+    }
+
+    private void setUpFragment(boolean useTemplate, long initialBytes) throws Throwable {
+        String dataUsageSetThresholdFragmentTag = "data_usage_set_threshold_fragment";
+        TestDataUsageSetThresholdBaseFragment fragment = new
+                TestDataUsageSetThresholdBaseFragment();
+        fragment.mInitialBytes = initialBytes;
+        Bundle args = new Bundle();
+        args.putParcelable(NetworkPolicyManager.EXTRA_NETWORK_TEMPLATE, useTemplate
+                ? mMockNetworkTemplate : null);
+        fragment.setArguments(args);
+        fragment.mPolicyEditor = mMockNetworkPolicyEditor;
+
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, fragment, dataUsageSetThresholdFragmentTag)
+                    .commitNow();
+        });
+        mFragment = spy((TestDataUsageSetThresholdBaseFragment) mFragmentManager
+                .findFragmentByTag(dataUsageSetThresholdFragmentTag));
+    }
+
+    public static class TestDataUsageSetThresholdBaseFragment extends
+            DataUsageSetThresholdBaseFragment {
+        public long mInitialBytes;
+
+        @Override
+        protected void onSave(long threshold) {}
+
+        @Override
+        @StringRes
+        protected int getTitleResId() {
+            return TITLE_RES_ID;
+        }
+
+        @Override
+        protected long getInitialBytes() {
+            return mInitialBytes;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSummaryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSummaryPreferenceControllerTest.java
new file mode 100644
index 000000000..162a10e96
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSummaryPreferenceControllerTest.java
@@ -0,0 +1,323 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+import android.telephony.SubscriptionPlan;
+import android.telephony.TelephonyManager;
+import android.text.TextUtils;
+import android.text.format.Formatter;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.net.DataUsageController;
+
+import com.google.android.collect.Lists;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.time.Period;
+import java.time.ZonedDateTime;
+import java.util.concurrent.TimeUnit;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageSummaryPreferenceControllerTest {
+
+    private static final CharSequence TEST_CARRIER_NAME = "TEST_CARRIER_NAME";
+    private static final int SUB_ID = 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private DataUsageSummaryPreference mDataUsageSummaryPreference;
+    private DataUsageSummaryPreferenceController mPreferenceController;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DataUsageController mMockDataUsageController;
+    @Mock
+    private SubscriptionManager mMockSubscriptionManager;
+    @Mock
+    private TelephonyManager mMockTelephonyManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .spyStatic(TelephonyManager.class)
+                .startMocking();
+
+        ExtendedMockito.when(TelephonyManager.from(mContext)).thenReturn(mMockTelephonyManager);
+        when(mMockTelephonyManager.createForSubscriptionId(SUB_ID))
+                .thenReturn(mMockTelephonyManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DataUsageSummaryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions, mMockSubscriptionManager, mMockDataUsageController);
+        mDataUsageSummaryPreference = new DataUsageSummaryPreference(mContext);
+        mPreferenceController.setFields(SUB_ID);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mDataUsageSummaryPreference);
+
+        SubscriptionInfo info = mock(SubscriptionInfo.class);
+        when(mMockSubscriptionManager.getActiveSubscriptionInfo(SUB_ID)).thenReturn(info);
+
+        when(mMockTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_LOADED);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_isAvailable() {
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_isAvailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_isAvailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_isAvailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_isConditionallyUnavailable() {
+        when(mMockTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_UNKNOWN);
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_isConditionallyUnavailable_zoneWrite() {
+        when(mMockTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_UNKNOWN);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_isConditionallyUnavailable_zoneRead() {
+        when(mMockTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_UNKNOWN);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_isConditionallyUnavailable_zoneHidden() {
+        when(mMockTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_UNKNOWN);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void refreshUi_hasUsage_titleSet() {
+        DataUsageController.DataUsageInfo info = new DataUsageController.DataUsageInfo();
+        info.usageLevel = 10000;
+        when(mMockDataUsageController.getDataUsageInfo(any())).thenReturn(info);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        String usedValueString = Formatter.formatBytes(mContext.getResources(), info.usageLevel,
+                Formatter.FLAG_CALCULATE_ROUNDED | Formatter.FLAG_IEC_UNITS).value;
+        assertThat(mDataUsageSummaryPreference.getTitle().toString()).contains(usedValueString);
+    }
+
+    @Test
+    public void refreshUi_hasCarrierName_hasRecentUpdate_setsCarrierInfoText() {
+        DataUsageController.DataUsageInfo info = new DataUsageController.DataUsageInfo();
+        info.usageLevel = 10000;
+        when(mMockDataUsageController.getDataUsageInfo(any())).thenReturn(info);
+
+        setCarrierName(TEST_CARRIER_NAME);
+        setSubscriptionPlan(/* usageBytes= */ 1000L, System.currentTimeMillis());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mDataUsageSummaryPreference.getCarrierInfoText()).isEqualTo(
+                TextUtils.expandTemplate(mContext.getText(R.string.carrier_and_update_now_text),
+                        TEST_CARRIER_NAME));
+    }
+
+    @Test
+    public void refreshUi_hasCarrierName_hasOldUpdate_setsCarrierInfoText() {
+        DataUsageController.DataUsageInfo info = new DataUsageController.DataUsageInfo();
+        info.usageLevel = 10000;
+        when(mMockDataUsageController.getDataUsageInfo(any())).thenReturn(info);
+
+        int numDays = 15;
+        setCarrierName(TEST_CARRIER_NAME);
+        setSubscriptionPlan(/* usageBytes= */ 1000L,
+                System.currentTimeMillis() - TimeUnit.DAYS.toMillis(numDays));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mDataUsageSummaryPreference.getCarrierInfoText()).isEqualTo(
+                TextUtils.expandTemplate(mContext.getText(R.string.carrier_and_update_text),
+                        TEST_CARRIER_NAME, numDays + " days"));
+    }
+
+    @Test
+    public void refreshUi_noCarrierName_hasRecentUpdate_setsCarrierInfoText() {
+        DataUsageController.DataUsageInfo info = new DataUsageController.DataUsageInfo();
+        info.usageLevel = 10000;
+        when(mMockDataUsageController.getDataUsageInfo(any())).thenReturn(info);
+
+        setSubscriptionPlan(/* usageBytes= */ 1000L, System.currentTimeMillis());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mDataUsageSummaryPreference.getCarrierInfoText().toString()).isEqualTo(
+                mContext.getString(R.string.no_carrier_update_now_text));
+    }
+
+    @Test
+    public void refreshUi_noCarrierName_hasOldUpdate_setsCarrierInfoText() {
+        DataUsageController.DataUsageInfo info = new DataUsageController.DataUsageInfo();
+        info.usageLevel = 10000;
+        when(mMockDataUsageController.getDataUsageInfo(any())).thenReturn(info);
+
+        int numDays = 15;
+        setSubscriptionPlan(/* usageBytes= */ 1000L,
+                System.currentTimeMillis() - TimeUnit.DAYS.toMillis(numDays));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mDataUsageSummaryPreference.getCarrierInfoText()).isEqualTo(
+                TextUtils.expandTemplate(mContext.getText(R.string.no_carrier_update_text),
+                        null, numDays + " days"));
+    }
+
+    @Test
+    public void refreshUi_hasUpdateTimeOlderThanWarning_setsCarrierInfoStyle() {
+        DataUsageController.DataUsageInfo info = new DataUsageController.DataUsageInfo();
+        info.usageLevel = 10000;
+        when(mMockDataUsageController.getDataUsageInfo(any())).thenReturn(info);
+
+
+        // Subtract an extra hour to account fo the difference in calls to
+        // System.currentTimeMillis().
+        setSubscriptionPlan(/* usageBytes= */ 1000L,
+                System.currentTimeMillis() - DataUsageSummaryPreferenceController.WARNING_AGE
+                        - TimeUnit.HOURS.toMillis(1));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mDataUsageSummaryPreference.getCarrierInfoTextStyle()).isEqualTo(
+                R.style.DataUsageSummaryCarrierInfoWarningTextAppearance);
+    }
+
+    @Test
+    public void refreshUi_hasUpdateTimeYoungerThanWarning_setsCarrierInfoStyle() {
+        DataUsageController.DataUsageInfo info = new DataUsageController.DataUsageInfo();
+        info.usageLevel = 10000;
+        when(mMockDataUsageController.getDataUsageInfo(any())).thenReturn(info);
+
+        // Subtract an extra hour to account fo the difference in calls to
+        // System.currentTimeMillis().
+        setSubscriptionPlan(/* usageBytes= */ 1000L,
+                System.currentTimeMillis() - DataUsageSummaryPreferenceController.WARNING_AGE
+                        + TimeUnit.HOURS.toMillis(1));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mDataUsageSummaryPreference.getCarrierInfoTextStyle()).isEqualTo(
+                R.style.DataUsageSummaryCarrierInfoTextAppearance);
+    }
+
+    private void setCarrierName(CharSequence name) {
+        SubscriptionInfo subInfo = new SubscriptionInfo(/* id= */ 0, /* iccId= */ "",
+                /* simSlotIndex= */ 0, /* displayName= */ "", name,
+                /* nameSource= */ 0, /* iconTint= */ 0, /* number= */ "",
+                /* roaming= */ 0, /* icon= */ null, /* mcc= */ "", /* mnc= */ "",
+                /* countryIso= */ "", /* isEmbedded= */ false,
+                /* accessRules= */ null, /* cardString= */ "");
+        when(mMockSubscriptionManager.getActiveSubscriptionInfo(SUB_ID)).thenReturn(subInfo);
+    }
+
+    private void setSubscriptionPlan(long usageBytes, long snapshotMillis) {
+        ZonedDateTime start = ZonedDateTime.now();
+        ZonedDateTime end = ZonedDateTime.now().plusDays(30);
+        SubscriptionPlan plan = new SubscriptionPlan.Builder(start, end, Period.ofMonths(1))
+                .setDataLimit(/* dataLimitBytes= */ 5000000000L,
+                        SubscriptionPlan.LIMIT_BEHAVIOR_DISABLED)
+                .setDataUsage(usageBytes, snapshotMillis)
+                .build();
+        when(mMockSubscriptionManager.getSubscriptionPlans(anyInt()))
+                .thenReturn(Lists.newArrayList(plan));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSummaryPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSummaryPreferenceTest.java
new file mode 100644
index 000000000..58179f2bc
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageSummaryPreferenceTest.java
@@ -0,0 +1,121 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.content.Intent;
+import android.view.View;
+import android.widget.Button;
+import android.widget.TextView;
+
+import androidx.preference.PreferenceViewHolder;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageSummaryPreferenceTest {
+
+    private static final String TEST_LABEL = "TEST_LABEL";
+    private static final Intent TEST_INTENT = new Intent("test_action");
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private PreferenceViewHolder mViewHolder;
+    private DataUsageSummaryPreference mDataUsageSummaryPreference;
+
+    @Before
+    public void setUp() {
+        View rootView = View.inflate(mContext, R.layout.data_usage_summary_preference,
+                /* root= */ null);
+        mViewHolder = PreferenceViewHolder.createInstanceForTests(rootView);
+        mDataUsageSummaryPreference = new DataUsageSummaryPreference(mContext);
+    }
+
+    @Test
+    public void onBindViewHolder_noCarrierInfoText_isGone() {
+        mDataUsageSummaryPreference.onBindViewHolder(mViewHolder);
+
+        assertThat(getCarrierInfoText().getVisibility()).isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_hasCarrierInfoText_isVisible() {
+        mDataUsageSummaryPreference.setCarrierInfoText(TEST_LABEL);
+        mDataUsageSummaryPreference.onBindViewHolder(mViewHolder);
+
+        assertThat(getCarrierInfoText().getVisibility()).isEqualTo(View.VISIBLE);
+    }
+
+    @Test
+    public void onBindViewHolder_hasCarrierInfoText_setsText() {
+        mDataUsageSummaryPreference.setCarrierInfoText(TEST_LABEL);
+        mDataUsageSummaryPreference.onBindViewHolder(mViewHolder);
+
+        assertThat(mDataUsageSummaryPreference.getCarrierInfoText().toString()).isEqualTo(
+                TEST_LABEL);
+    }
+
+    @Test
+    public void onBindViewHolder_noManagePlanIntent_isGone() {
+        mDataUsageSummaryPreference.onBindViewHolder(mViewHolder);
+
+        assertThat(getManageSubscriptionButton().getVisibility()).isEqualTo(View.GONE);
+    }
+
+    @Test
+    public void onBindViewHolder_hasManagePlanIntent_isVisible() {
+        mDataUsageSummaryPreference.setManageSubscriptionIntent(TEST_INTENT);
+        mDataUsageSummaryPreference.onBindViewHolder(mViewHolder);
+
+        assertThat(getManageSubscriptionButton().getVisibility()).isEqualTo(View.VISIBLE);
+    }
+
+    @Test
+    public void onButtonClick_hasManagePlanIntent_startsActivity() {
+        mDataUsageSummaryPreference.setManageSubscriptionIntent(TEST_INTENT);
+        mDataUsageSummaryPreference.onBindViewHolder(mViewHolder);
+        doNothing().when(mContext).startActivity(any());
+        getManageSubscriptionButton().performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(TEST_INTENT.getAction());
+    }
+
+    private TextView getCarrierInfoText() {
+        return (TextView) mViewHolder.findViewById(R.id.carrier_info_text);
+    }
+
+    private Button getManageSubscriptionButton() {
+        return (Button) mViewHolder.findViewById(R.id.manage_subscription_button);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageUnitPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageUnitPreferenceControllerTest.java
new file mode 100644
index 000000000..ff21d72c5
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageUnitPreferenceControllerTest.java
@@ -0,0 +1,111 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageUnitPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private LogicalPreferenceGroup mPreferenceGroup;
+    private DataUsageUnitPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DataUsageUnitPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+    }
+
+    @Test
+    public void checkInitialized_noDefaultSelection_throwException() {
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreferenceGroup));
+    }
+
+    @Test
+    public void onCreate_setsGbDefault_mbSet() {
+        mPreferenceController.setDefaultSelection(/* isGb= */ true);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.isGbSelected()).isTrue();
+    }
+
+    @Test
+    public void onCreate_setsMbDefault_mbSet() {
+        mPreferenceController.setDefaultSelection(/* isGb= */ false);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.isGbSelected()).isFalse();
+    }
+
+    @Test
+    public void onCreate_setsGbDefault_onToggleMbSet() {
+        mPreferenceController.setDefaultSelection(/* isGb= */ true);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Preference mbPreference = mPreferenceGroup
+                .findPreference(mContext.getString(R.string.pk_data_usage_radio_mb));
+        mbPreference.performClick();
+
+        assertThat(mPreferenceController.isGbSelected()).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataUsageUtilsTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageUtilsTest.java
new file mode 100644
index 000000000..f71c892ca
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataUsageUtilsTest.java
@@ -0,0 +1,144 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+import android.telephony.SubscriptionPlan;
+import android.util.RecurrenceRule;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.google.android.collect.Lists;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class DataUsageUtilsTest {
+
+    private static final int SUBSCRIPTION_ID = 1;
+
+    @Test
+    public void getDefaultSubscriptionId_nullSubscriptionManager_returnsInvalidId() {
+        assertThat(DataUsageUtils.getDefaultSubscriptionId(null)).isEqualTo(
+                SubscriptionManager.INVALID_SUBSCRIPTION_ID);
+    }
+
+    @Test
+    public void getDefaultSubscriptionId_noSubscriptions_returnsInvalidId() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        when(subscriptionManager.getDefaultDataSubscriptionInfo()).thenReturn(null);
+        when(subscriptionManager.getAllSubscriptionInfoList()).thenReturn(Collections.emptyList());
+
+        assertThat(DataUsageUtils.getDefaultSubscriptionId(subscriptionManager)).isEqualTo(
+                SubscriptionManager.INVALID_SUBSCRIPTION_ID);
+    }
+
+    @Test
+    public void getDefaultSubscriptionId_noDefaultSubscription_returnsFirstSubscription() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        when(subscriptionManager.getDefaultDataSubscriptionInfo()).thenReturn(null);
+
+        SubscriptionInfo info1 = mock(SubscriptionInfo.class);
+        SubscriptionInfo info2 = mock(SubscriptionInfo.class);
+        when(info1.getSubscriptionId()).thenReturn(1);
+        when(info2.getSubscriptionId()).thenReturn(2);
+        when(subscriptionManager.getAllSubscriptionInfoList()).thenReturn(
+                Lists.newArrayList(info1, info2));
+
+        assertThat(DataUsageUtils.getDefaultSubscriptionId(subscriptionManager)).isEqualTo(1);
+    }
+
+    @Test
+    public void getDefaultSubscriptionId_hasDefaultSubscription_returnsDefaultSubscription() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        SubscriptionInfo info = mock(SubscriptionInfo.class);
+        when(info.getSubscriptionId()).thenReturn(1);
+        when(subscriptionManager.getDefaultDataSubscriptionInfo()).thenReturn(info);
+
+        assertThat(DataUsageUtils.getDefaultSubscriptionId(subscriptionManager)).isEqualTo(1);
+    }
+
+    @Test
+    public void getPrimaryPlan_noSubscriptions_returnsNull() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        when(subscriptionManager.getSubscriptionPlans(SUBSCRIPTION_ID)).thenReturn(
+                Lists.newArrayList());
+
+        assertThat(DataUsageUtils.getPrimaryPlan(subscriptionManager, SUBSCRIPTION_ID)).isNull();
+    }
+
+    @Test
+    public void getPrimaryPlan_dataLimitBytesIsZero_returnsNull() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        SubscriptionPlan subscriptionPlan = mock(SubscriptionPlan.class);
+        when(subscriptionManager.getSubscriptionPlans(SUBSCRIPTION_ID)).thenReturn(
+                Lists.newArrayList(subscriptionPlan));
+        when(subscriptionPlan.getDataLimitBytes()).thenReturn(0L);
+
+        assertThat(DataUsageUtils.getPrimaryPlan(subscriptionManager, SUBSCRIPTION_ID)).isNull();
+
+    }
+
+    @Test
+    public void getPrimaryPlan_dataUsageBytesIsHuge_returnsNull() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        SubscriptionPlan subscriptionPlan = mock(SubscriptionPlan.class);
+        when(subscriptionManager.getSubscriptionPlans(SUBSCRIPTION_ID)).thenReturn(
+                Lists.newArrayList(subscriptionPlan));
+        when(subscriptionPlan.getDataLimitBytes()).thenReturn(100L);
+        when(subscriptionPlan.getDataUsageBytes()).thenReturn(2 * DataUsageUtils.PETA);
+
+        assertThat(DataUsageUtils.getPrimaryPlan(subscriptionManager, SUBSCRIPTION_ID)).isNull();
+    }
+
+    @Test
+    public void getPrimaryPlan_cycleRuleIsNull_returnsNull() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        SubscriptionPlan subscriptionPlan = mock(SubscriptionPlan.class);
+        when(subscriptionManager.getSubscriptionPlans(SUBSCRIPTION_ID)).thenReturn(
+                Lists.newArrayList(subscriptionPlan));
+        when(subscriptionPlan.getDataLimitBytes()).thenReturn(100L);
+        when(subscriptionPlan.getDataUsageBytes()).thenReturn(10L);
+        when(subscriptionPlan.getCycleRule()).thenReturn(null);
+
+        assertThat(DataUsageUtils.getPrimaryPlan(subscriptionManager, SUBSCRIPTION_ID)).isNull();
+    }
+
+    @Test
+    public void getPrimaryPlan_cycleRuleIsValid_returnsSubscriptionPlan() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        SubscriptionPlan subscriptionPlan = mock(SubscriptionPlan.class);
+        RecurrenceRule recurrenceRule = mock(RecurrenceRule.class);
+        when(subscriptionManager.getSubscriptionPlans(SUBSCRIPTION_ID)).thenReturn(
+                Lists.newArrayList(subscriptionPlan));
+        when(subscriptionPlan.getDataLimitBytes()).thenReturn(100L);
+        when(subscriptionPlan.getDataUsageBytes()).thenReturn(10L);
+        when(subscriptionPlan.getCycleRule()).thenReturn(recurrenceRule);
+
+        assertThat(DataUsageUtils.getPrimaryPlan(subscriptionManager, SUBSCRIPTION_ID)).isEqualTo(
+                subscriptionPlan);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataWarningPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataWarningPreferenceControllerTest.java
new file mode 100644
index 000000000..9fa1533a2
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataWarningPreferenceControllerTest.java
@@ -0,0 +1,180 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static android.net.NetworkPolicy.WARNING_DISABLED;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.NetworkTemplate;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.NetworkPolicyEditor;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DataWarningPreferenceControllerTest {
+
+    private static final long BYTES_IN_GIGABYTE = 1024 * 1024 * 1024;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private TwoStatePreference mEnablePreference;
+    private PreferenceGroup mPreferenceGroup;
+    private Preference mWarningPreference;
+    private DataWarningPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private NetworkPolicyEditor mPolicyEditor;
+    @Mock
+    private NetworkTemplate mNetworkTemplate;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new DataWarningPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        mEnablePreference = new SwitchPreference(mContext);
+        mEnablePreference.setKey(mContext.getString(R.string.pk_data_set_warning));
+        mPreferenceGroup.addPreference(mEnablePreference);
+        mWarningPreference = new Preference(mContext);
+        mWarningPreference.setKey(mContext.getString(R.string.pk_data_warning));
+        mPreferenceGroup.addPreference(mWarningPreference);
+
+        mPreferenceController.setNetworkPolicyEditor(mPolicyEditor);
+        mPreferenceController.setNetworkTemplate(mNetworkTemplate);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_warningDisabled_summaryEmpty() {
+        when(mPolicyEditor.getPolicyWarningBytes(mNetworkTemplate)).thenReturn(WARNING_DISABLED);
+        mPreferenceController.refreshUi();
+
+        assertThat(mWarningPreference.getSummary()).isNull();
+    }
+
+    @Test
+    public void refreshUi_warningDisabled_preferenceDisabled() {
+        when(mPolicyEditor.getPolicyWarningBytes(mNetworkTemplate)).thenReturn(WARNING_DISABLED);
+        mPreferenceController.refreshUi();
+
+        assertThat(mWarningPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_warningDisabled_switchUnchecked() {
+        when(mPolicyEditor.getPolicyWarningBytes(mNetworkTemplate)).thenReturn(WARNING_DISABLED);
+        mPreferenceController.refreshUi();
+
+        assertThat(mEnablePreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_warningEnabled_summaryPopulated() {
+        when(mPolicyEditor.getPolicyWarningBytes(mNetworkTemplate)).thenReturn(
+                3 * BYTES_IN_GIGABYTE);
+        mPreferenceController.refreshUi();
+
+        assertThat(mWarningPreference.getSummary().toString()).isNotEmpty();
+    }
+
+    @Test
+    public void refreshUi_warningEnabled_preferenceEnabled() {
+        when(mPolicyEditor.getPolicyWarningBytes(mNetworkTemplate)).thenReturn(
+                3 * BYTES_IN_GIGABYTE);
+        mPreferenceController.refreshUi();
+
+        assertThat(mWarningPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_warningEnabled_switchChecked() {
+        when(mPolicyEditor.getPolicyWarningBytes(mNetworkTemplate)).thenReturn(
+                3 * BYTES_IN_GIGABYTE);
+        mPreferenceController.refreshUi();
+
+        assertThat(mEnablePreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onPreferenceChanged_toggleFalse_warningBytesDisabled() {
+        mEnablePreference.callChangeListener(false);
+        verify(mPolicyEditor).setPolicyWarningBytes(mNetworkTemplate, WARNING_DISABLED);
+    }
+
+    @Test
+    public void onPreferenceChanged_toggleTrue_warningBytesNotDisabled() {
+        mEnablePreference.callChangeListener(true);
+
+        ArgumentCaptor<Long> setWarning = ArgumentCaptor.forClass(Long.class);
+        verify(mPolicyEditor).setPolicyWarningBytes(eq(mNetworkTemplate), setWarning.capture());
+        assertThat(setWarning.getValue()).isNotEqualTo(WARNING_DISABLED);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClicked_launchesFragment() {
+        mWarningPreference.performClick();
+
+        verify(mMockFragmentController).launchFragment(any(DataWarningSetThresholdFragment.class));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/DataWarningSetThresholdFragmentTest.java b/tests/multivalent/src/com/android/car/settings/datausage/DataWarningSetThresholdFragmentTest.java
new file mode 100644
index 000000000..808b83ff6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/DataWarningSetThresholdFragmentTest.java
@@ -0,0 +1,100 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.android.car.settings.datausage.DataWarningSetThresholdFragment.MIB_IN_BYTES;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.net.NetworkTemplate;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.ToolbarController;
+import com.android.settingslib.NetworkPolicyEditor;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DataWarningSetThresholdFragmentTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private DataWarningSetThresholdFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    private NetworkPolicyEditor mMockNetworkPolicyEditor;
+    @Mock
+    private NetworkTemplate mMockNetworkTemplate;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    @UiThreadTest
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+    }
+
+    @Test
+    public void onActivityCreated_titleIsSet() {
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getTitle().toString()).isEqualTo(
+                mContext.getString(R.string.data_usage_warning_editor_title));
+    }
+
+    @Test
+    public void onActivityCreated_saveButtonClicked_savesThreshold() {
+        mFragment.onSave(MIB_IN_BYTES);
+
+        verify(mMockNetworkPolicyEditor).setPolicyWarningBytes(mMockNetworkTemplate, MIB_IN_BYTES);
+    }
+
+    private void setUpFragment() throws Throwable {
+        String dataUsageSetThresholdFragmentTag = "data_usage_set_threshold_fragment";
+        DataWarningSetThresholdFragment fragment = DataWarningSetThresholdFragment.newInstance(
+                mMockNetworkTemplate);
+        fragment.mPolicyEditor = mMockNetworkPolicyEditor;
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, fragment, dataUsageSetThresholdFragmentTag)
+                    .commitNow();
+        });
+        mFragment = spy((DataWarningSetThresholdFragment) mFragmentManager
+                .findFragmentByTag(dataUsageSetThresholdFragmentTag));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datausage/UsageBytesThresholdPickerDialogTest.java b/tests/multivalent/src/com/android/car/settings/datausage/UsageBytesThresholdPickerDialogTest.java
new file mode 100644
index 000000000..999b641c9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datausage/UsageBytesThresholdPickerDialogTest.java
@@ -0,0 +1,138 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datausage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyLong;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.content.DialogInterface;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UsageBytesThresholdPickerDialogTest {
+
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    private UsageBytesThresholdPickerDialog.BytesThresholdPickedListener
+            mBytesThresholdPickedListener;
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+    }
+
+    @Test
+    public void dialogInit_validValue_showsCurrentValue() throws Throwable {
+        long twoGB = 2 * UsageBytesThresholdPickerDialog.GIB_IN_BYTES;
+        UsageBytesThresholdPickerDialog dialog = UsageBytesThresholdPickerDialog.newInstance(
+                R.string.data_usage_limit_editor_title, twoGB);
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mFragmentManager, /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(dialog.getCurrentThreshold()).isEqualTo(twoGB);
+    }
+
+    @Test
+    public void dialogInit_lowInvalidValue_showsLowestPossibleValue() throws Throwable {
+        UsageBytesThresholdPickerDialog dialog = UsageBytesThresholdPickerDialog.newInstance(
+                R.string.data_usage_limit_editor_title, -1);
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mFragmentManager, /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(dialog.getCurrentThreshold()).isEqualTo(0);
+    }
+
+    @Test
+    public void positiveButtonClick_noChangeInValue_dialogListenerNotCalled() throws Throwable {
+        long twoGB = 2 * UsageBytesThresholdPickerDialog.GIB_IN_BYTES;
+        UsageBytesThresholdPickerDialog dialog = UsageBytesThresholdPickerDialog.newInstance(
+                R.string.data_usage_limit_editor_title, twoGB);
+        dialog.setBytesThresholdPickedListener(mBytesThresholdPickedListener);
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mFragmentManager, /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        DialogInterface dialogInterface = mock(DialogInterface.class);
+        dialog.onClick(dialogInterface, DialogInterface.BUTTON_POSITIVE);
+
+        verify(mBytesThresholdPickedListener, never()).onThresholdPicked(anyLong());
+    }
+
+    @Test
+    public void positiveButtonClick_changeInValue_dialogListenerCalled() throws Throwable {
+        long twoGB = 2 * UsageBytesThresholdPickerDialog.GIB_IN_BYTES;
+        UsageBytesThresholdPickerDialog dialog = UsageBytesThresholdPickerDialog.newInstance(
+                R.string.data_usage_limit_editor_title, twoGB);
+        dialog.setBytesThresholdPickedListener(mBytesThresholdPickedListener);
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mFragmentManager, /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        long threeGB = 3 * UsageBytesThresholdPickerDialog.GIB_IN_BYTES;
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.setThresholdEditor(threeGB);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        DialogInterface dialogInterface = mock(DialogInterface.class);
+        dialog.onClick(dialogInterface, DialogInterface.BUTTON_POSITIVE);
+
+        verify(mBytesThresholdPickedListener).onThresholdPicked(threeGB);
+    }
+
+    @Test
+    public void getCurrentThreshold_aboveLimit_returnLimit() throws Throwable {
+        long limitGBTimesTwo = 2 * UsageBytesThresholdPickerDialog.MAX_DATA_LIMIT_BYTES;
+        UsageBytesThresholdPickerDialog dialog = UsageBytesThresholdPickerDialog.newInstance(
+                R.string.data_usage_limit_editor_title, limitGBTimesTwo);
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mFragmentManager, /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(dialog.getCurrentThreshold()).isEqualTo(
+                UsageBytesThresholdPickerDialog.MAX_DATA_LIMIT_BYTES);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/AutoDatetimeTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/AutoDatetimeTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..1bcb39caf
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/AutoDatetimeTogglePreferenceControllerTest.java
@@ -0,0 +1,114 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AutoDatetimeTogglePreferenceControllerTest {
+
+    private Context mContext;
+    private SwitchPreference mPreference;
+    private AutoDatetimeTogglePreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        LifecycleOwner lifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mPreference = new SwitchPreference(mContext);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mController = new AutoDatetimeTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(lifecycleOwner);
+    }
+
+    @Test
+    public void testRefreshUi_autoDateTimeSupported_unchecked() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 0);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testRefreshUi_autoDateTimeSupported_checked() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 1);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneSet_shouldSendIntent() {
+        mPreference.setChecked(true);
+        mPreference.callChangeListener(true);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneUnset_shouldSendIntent() {
+        mPreference.setChecked(false);
+        mPreference.callChangeListener(false);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/AutoLocalTimeTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/AutoLocalTimeTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..42b8a2091
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/AutoLocalTimeTogglePreferenceControllerTest.java
@@ -0,0 +1,326 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.time.Capabilities;
+import android.app.time.TimeCapabilities;
+import android.app.time.TimeCapabilitiesAndConfig;
+import android.app.time.TimeConfiguration;
+import android.app.time.TimeManager;
+import android.app.time.TimeZoneCapabilities;
+import android.app.time.TimeZoneCapabilitiesAndConfig;
+import android.app.time.TimeZoneConfiguration;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.location.LocationManager;
+import android.os.UserManager;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiSwitchPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AutoLocalTimeTogglePreferenceControllerTest {
+    private static final String TEST_RESTRICTION = UserManager.DISALLOW_CONFIG_DATE_TIME;
+
+    private final LifecycleOwner mLifecycleOwner = new TestLifecycleOwner();
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+
+    private CarUiSwitchPreference mPreference;
+    private AutoLocalTimeTogglePreferenceController mController;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Toast mMockToast;
+    @Mock
+    private LocationManager mLocationManager;
+    @Mock
+    private TimeManager mTimeManager;
+    @Mock
+    private TimeCapabilities mTimeCapabilities;
+    @Mock
+    private TimeCapabilitiesAndConfig mTimeCapabilitiesAndConfig;
+    @Mock
+    private TimeConfiguration mTimeConfiguration;
+    @Mock
+    private TimeZoneCapabilities mTimeZoneCapabilities;
+    @Mock
+    private TimeZoneCapabilitiesAndConfig mTimeZoneCapabilitiesAndConfig;
+    @Mock
+    private TimeZoneConfiguration mTimeZoneConfiguration;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        mPreference = new CarUiSwitchPreference(mContext);
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+        when(mContext.getSystemService(TimeManager.class)).thenReturn(mTimeManager);
+        when(mTimeManager.getTimeCapabilitiesAndConfig()).thenReturn(mTimeCapabilitiesAndConfig);
+        when(mTimeManager.getTimeZoneCapabilitiesAndConfig())
+                .thenReturn(mTimeZoneCapabilitiesAndConfig);
+        when(mTimeCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeCapabilities);
+        when(mTimeCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeConfiguration);
+        when(mTimeZoneCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeZoneCapabilities);
+        when(mTimeZoneCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeZoneConfiguration);
+        mController = new AutoLocalTimeTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testRefreshUi_autoLocalTimeSupported_unchecked() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(false);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testRefreshUi_autoLocalTimeSupported_checked() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(true);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneSet_shouldSendIntentIfCapabilitiesPossessed() {
+        mockAutoTimeAndTimeZoneCapabilities(true);
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+
+        mPreference.setChecked(true);
+        mController.handlePreferenceChanged(mPreference, true);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+        verify(mFragmentController, never())
+                .showDialog(any(ConfirmationDialogFragment.class), any());
+        assertThat(mPreference.getSummary().toString()).isEqualTo("");
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneSet_shouldShowDialogIfLocationDisabled() {
+        mockAutoTimeAndTimeZoneCapabilities(true);
+        when(mLocationManager.isLocationEnabled()).thenReturn(false);
+
+        mPreference.setChecked(true);
+        mController.handlePreferenceChanged(mPreference, true);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+        verify(mFragmentController)
+                .showDialog(any(ConfirmationDialogFragment.class),
+                        eq(ConfirmationDialogFragment.TAG));
+        assertThat(mPreference.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.auto_local_time_toggle_summary));
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneUnset_shouldSendIntentIfCapabilitiesPossessed() {
+        mockAutoTimeAndTimeZoneCapabilities(true);
+
+        mPreference.setChecked(false);
+        mController.handlePreferenceChanged(mPreference, false);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+        verify(mFragmentController, never())
+                .showDialog(any(ConfirmationDialogFragment.class), any());
+        assertThat(mPreference.getSummary().toString()).isEqualTo("");
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneSet_shouldNotSendIntentIfNoCapabilities() {
+        mockAutoTimeAndTimeZoneCapabilities(false);
+
+        mPreference.setChecked(true);
+        mController.handlePreferenceChanged(mPreference, true);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, never()).sendBroadcast(captor.capture());
+        verify(mFragmentController, never())
+                .showDialog(any(ConfirmationDialogFragment.class), any());
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneUnset_shouldSendNotIntentIfNoCapabilities() {
+        mockAutoTimeAndTimeZoneCapabilities(false);
+
+        mPreference.setChecked(false);
+        mController.handlePreferenceChanged(mPreference, false);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, never()).sendBroadcast(captor.capture());
+        verify(mFragmentController, never())
+                .showDialog(any(ConfirmationDialogFragment.class), any());
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restricted_availableForViewing() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByUm_toast() {
+        mockUserRestrictionSetByUm(true);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+        mController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByDpm_dialog() {
+        mockUserRestrictionSetByDpm(true);
+        mController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void mockUserRestrictionSetByUm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+                .thenReturn(restricted);
+    }
+
+    private void mockUserRestrictionSetByDpm(boolean restricted) {
+        mockUserRestrictionSetByUm(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+    }
+
+    private void assertShowingBlockedToast() {
+        String toastText = mContext.getResources().getString(R.string.action_unavailable);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private void mockAutoTimeAndTimeZoneCapabilities(boolean isEnabled) {
+        when(mTimeCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+        when(mTimeZoneCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+    }
+
+    private void mockIsAutoTimeAndTimeZoneDetectionEnabled(boolean isEnabled) {
+        mockAutoTimeAndTimeZoneCapabilities(isEnabled);
+        when(mTimeConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeZoneConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/AutoTimeZoneTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/AutoTimeZoneTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..e7b6b7d7c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/AutoTimeZoneTogglePreferenceControllerTest.java
@@ -0,0 +1,290 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+import android.provider.Settings;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiSwitchPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AutoTimeZoneTogglePreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_DATE_TIME;
+
+    private final LifecycleOwner mLifecycleOwner = new TestLifecycleOwner();
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+
+    private CarUiSwitchPreference mPreference;
+    private AutoTimeZoneTogglePreferenceController mController;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        mPreference = new CarUiSwitchPreference(mContext);
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mController = new AutoTimeZoneTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testRefreshUi_autoTimeZoneSupported_unchecked() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME_ZONE, 0);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testRefreshUi_autoTimeZoneSupported_checked() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME_ZONE, 1);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneSet_shouldSendIntent() {
+        mPreference.setChecked(true);
+        mController.handlePreferenceChanged(mPreference, true);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+    }
+
+    @Test
+    public void testOnPreferenceChange_autoTimeZoneUnset_shouldSendIntent() {
+        mPreference.setChecked(false);
+        mController.handlePreferenceChanged(mPreference, false);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restricted_availableForViewing() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restricted_availableForViewing_zoneWrite() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+
+        mController.setAvailabilityStatusForZone("write");
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restricted_availableForViewing_zoneRead() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+
+        mController.setAvailabilityStatusForZone("read");
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restricted_availableForViewing_zoneHidden() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+
+        mController.setAvailabilityStatusForZone("hidden");
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneWrite() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+
+        mController.setAvailabilityStatusForZone("write");
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneRead() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+
+        mController.setAvailabilityStatusForZone("read");
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneHidden() {
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+
+        mController.setAvailabilityStatusForZone("hidden");
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByUm_toast() {
+        mockUserRestrictionSetByUm(true);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+        mController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByDpm_dialog() {
+        mockUserRestrictionSetByDpm(true);
+        mController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void mockUserRestrictionSetByUm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+            .thenReturn(restricted);
+    }
+
+    private void mockUserRestrictionSetByDpm(boolean restricted) {
+        mockUserRestrictionSetByUm(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+    }
+
+    private void assertShowingBlockedToast() {
+        String toastText = mContext.getResources().getString(R.string.action_unavailable);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/DatePickerFragmentTest.java b/tests/multivalent/src/com/android/car/settings/datetime/DatePickerFragmentTest.java
new file mode 100644
index 000000000..39526eb51
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/DatePickerFragmentTest.java
@@ -0,0 +1,102 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.app.Activity;
+import android.app.timedetector.TimeDetectorHelper;
+import android.widget.DatePicker;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+import java.util.Calendar;
+import java.util.GregorianCalendar;
+
+@RunWith(AndroidJUnit4.class)
+public class DatePickerFragmentTest {
+    private DatePickerFragment mFragment;
+    private FragmentManager mFragmentManager;
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+    }
+
+    @Test
+    public void onActivityCreated_setMinDate() {
+        DatePicker datePicker = findDatePicker(mFragment.requireActivity());
+
+        GregorianCalendar calendar = new GregorianCalendar();
+        calendar.clear();
+        calendar.set(Calendar.DAY_OF_MONTH, 1);
+        calendar.set(Calendar.MONTH, Calendar.JANUARY);
+        calendar.set(Calendar.YEAR, TimeDetectorHelper.INSTANCE.getManualDateSelectionYearMin());
+
+        assertThat(datePicker.getMinDate()).isEqualTo(calendar.getTimeInMillis());
+    }
+
+    @Test
+    public void onActivityCreated_setMaxDate() {
+        DatePicker datePicker = findDatePicker(mFragment.requireActivity());
+
+        GregorianCalendar calendar = new GregorianCalendar();
+        calendar.clear();
+        calendar.set(Calendar.DAY_OF_MONTH, 31);
+        calendar.set(Calendar.MONTH, Calendar.DECEMBER);
+        calendar.set(Calendar.YEAR, TimeDetectorHelper.INSTANCE.getManualDateSelectionYearMax());
+
+        assertThat(datePicker.getMaxDate()).isEqualTo(calendar.getTimeInMillis());
+    }
+
+    private void setUpFragment() throws Throwable {
+        String datePickerFragmentTag = "date_picker_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new DatePickerFragment(),
+                            datePickerFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (DatePickerFragment)
+                mFragmentManager.findFragmentByTag(datePickerFragmentTag);
+    }
+
+    private DatePicker findDatePicker(Activity activity) {
+        return activity.findViewById(R.id.date_picker);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/DatePickerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/DatePickerPreferenceControllerTest.java
new file mode 100644
index 000000000..bcbb2bd50
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/DatePickerPreferenceControllerTest.java
@@ -0,0 +1,221 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.time.Capabilities;
+import android.app.time.TimeCapabilities;
+import android.app.time.TimeCapabilitiesAndConfig;
+import android.app.time.TimeConfiguration;
+import android.app.time.TimeManager;
+import android.app.time.TimeZoneCapabilities;
+import android.app.time.TimeZoneCapabilitiesAndConfig;
+import android.app.time.TimeZoneConfiguration;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.platform.test.annotations.RequiresFlagsDisabled;
+import android.platform.test.annotations.RequiresFlagsEnabled;
+import android.platform.test.flag.junit.CheckFlagsRule;
+import android.platform.test.flag.junit.DeviceFlagsValueProvider;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DatePickerPreferenceControllerTest {
+
+    private Context mContext;
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private DatePickerPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private TimeManager mTimeManager;
+    @Mock
+    private TimeCapabilities mTimeCapabilities;
+    @Mock
+    private TimeCapabilitiesAndConfig mTimeCapabilitiesAndConfig;
+    @Mock
+    private TimeConfiguration mTimeConfiguration;
+    @Mock
+    private TimeZoneCapabilities mTimeZoneCapabilities;
+    @Mock
+    private TimeZoneCapabilitiesAndConfig mTimeZoneCapabilitiesAndConfig;
+    @Mock
+    private TimeZoneConfiguration mTimeZoneConfiguration;
+
+    @Rule
+    public final CheckFlagsRule mCheckFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule();
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mPreference = new SwitchPreference(mContext);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        when(mContext.getSystemService(TimeManager.class)).thenReturn(mTimeManager);
+        when(mTimeManager.getTimeCapabilitiesAndConfig()).thenReturn(mTimeCapabilitiesAndConfig);
+        when(mTimeManager.getTimeZoneCapabilitiesAndConfig())
+                .thenReturn(mTimeZoneCapabilitiesAndConfig);
+        when(mTimeCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeCapabilities);
+        when(mTimeCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeConfiguration);
+        when(mTimeZoneCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeZoneCapabilities);
+        when(mTimeZoneCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeZoneConfiguration);
+        mController = new DatePickerPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_disabled_automaticTZProviderFlagDisabled() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 1);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_enabled_automaticTZProviderFlagDisabled() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 0);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_disabled_automaticTZProviderFlagDisabled() {
+        mController.onStart(mLifecycleOwner);
+
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 1);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_enabled_automaticTZProviderFlagDisabled() {
+        mController.onStart(mLifecycleOwner);
+
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 0);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_disabled() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(true);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_enabled() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(false);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_disabled() {
+        mController.onStart(mLifecycleOwner);
+
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(true);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_enabled() {
+        mController.onStart(mLifecycleOwner);
+
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(false);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    private void mockIsAutoTimeAndTimeZoneDetectionEnabled(boolean isEnabled) {
+        when(mTimeCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+        when(mTimeZoneCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+        when(mTimeConfiguration.hasIsAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeZoneConfiguration.hasIsAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeZoneConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/TimeFormatTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/TimeFormatTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..cdca74271
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/TimeFormatTogglePreferenceControllerTest.java
@@ -0,0 +1,121 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class TimeFormatTogglePreferenceControllerTest {
+
+    private Context mContext;
+    private TwoStatePreference mPreference;
+    private TimeFormatTogglePreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        LifecycleOwner lifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mPreference = new SwitchPreference(mContext);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mController = new TimeFormatTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(lifecycleOwner);
+    }
+
+    @Test
+    public void testRefreshUi_24HourSet_shouldCheckPreference() {
+        Settings.System.putString(mContext.getContentResolver(), Settings.System.TIME_12_24,
+                TimeFormatTogglePreferenceController.HOURS_24);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testRefreshUi_12HourSet_shouldUncheckPreference() {
+        Settings.System.putString(mContext.getContentResolver(), Settings.System.TIME_12_24,
+                TimeFormatTogglePreferenceController.HOURS_12);
+        mController.refreshUi();
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testOnPreferenceChange_24HourSet_shouldSendIntent() {
+        mPreference.setChecked(true);
+        mPreference.callChangeListener(true);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+        assertThat(intentFired.getIntExtra(Intent.EXTRA_TIME_PREF_24_HOUR_FORMAT, -1))
+                .isEqualTo(Intent.EXTRA_TIME_PREF_VALUE_USE_24_HOUR);
+    }
+
+    @Test
+    public void testOnPreferenceChange_12HourSet_shouldSendIntent() {
+        mPreference.setChecked(false);
+        mPreference.callChangeListener(false);
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+        assertThat(intentFired.getIntExtra(Intent.EXTRA_TIME_PREF_24_HOUR_FORMAT, -1))
+                .isEqualTo(Intent.EXTRA_TIME_PREF_VALUE_USE_12_HOUR);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/TimePickerFragmentTest.java b/tests/multivalent/src/com/android/car/settings/datetime/TimePickerFragmentTest.java
new file mode 100644
index 000000000..3afa4039e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/TimePickerFragmentTest.java
@@ -0,0 +1,107 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+
+import android.app.Activity;
+import android.text.format.DateFormat;
+import android.widget.TimePicker;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class TimePickerFragmentTest {
+    private TimePickerFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MockitoSession mSession;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+
+        mSession = ExtendedMockito.mockitoSession().spyStatic(DateFormat.class).startMocking();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onActivityCreated_isNot24HourFormat_timePickerShouldShow12HourTimeFormat()
+            throws Throwable {
+        ExtendedMockito.doReturn(false).when(() -> DateFormat.is24HourFormat(any()));
+        setUpFragment();
+        TimePicker timePicker = findTimePicker(mFragment.requireActivity());
+
+        assertThat(timePicker.is24HourView()).isFalse();
+    }
+
+    @Test
+    public void onActivityCreated_is24HourFormat_timePickerShouldShow24HourTimeFormat()
+            throws Throwable {
+        ExtendedMockito.doReturn(true).when(() -> DateFormat.is24HourFormat(any()));
+        setUpFragment();
+        TimePicker timePicker = findTimePicker(mFragment.requireActivity());
+
+        assertThat(timePicker.is24HourView()).isTrue();
+    }
+
+    private void setUpFragment() throws Throwable {
+        String timePickerFragmentTag = "time_picker_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new TimePickerFragment(),
+                            timePickerFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (TimePickerFragment)
+                mFragmentManager.findFragmentByTag(timePickerFragmentTag);
+    }
+
+    private TimePicker findTimePicker(Activity activity) {
+        return activity.findViewById(R.id.time_picker);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/TimePickerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/TimePickerPreferenceControllerTest.java
new file mode 100644
index 000000000..b16a6285b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/TimePickerPreferenceControllerTest.java
@@ -0,0 +1,221 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.time.Capabilities;
+import android.app.time.TimeCapabilities;
+import android.app.time.TimeCapabilitiesAndConfig;
+import android.app.time.TimeConfiguration;
+import android.app.time.TimeManager;
+import android.app.time.TimeZoneCapabilities;
+import android.app.time.TimeZoneCapabilitiesAndConfig;
+import android.app.time.TimeZoneConfiguration;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.platform.test.annotations.RequiresFlagsDisabled;
+import android.platform.test.annotations.RequiresFlagsEnabled;
+import android.platform.test.flag.junit.CheckFlagsRule;
+import android.platform.test.flag.junit.DeviceFlagsValueProvider;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class TimePickerPreferenceControllerTest {
+
+    private Context mContext;
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private TimePickerPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private TimeManager mTimeManager;
+    @Mock
+    private TimeCapabilities mTimeCapabilities;
+    @Mock
+    private TimeCapabilitiesAndConfig mTimeCapabilitiesAndConfig;
+    @Mock
+    private TimeConfiguration mTimeConfiguration;
+    @Mock
+    private TimeZoneCapabilities mTimeZoneCapabilities;
+    @Mock
+    private TimeZoneCapabilitiesAndConfig mTimeZoneCapabilitiesAndConfig;
+    @Mock
+    private TimeZoneConfiguration mTimeZoneConfiguration;
+
+    @Rule
+    public final CheckFlagsRule mCheckFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule();
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mPreference = new SwitchPreference(mContext);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        when(mContext.getSystemService(TimeManager.class)).thenReturn(mTimeManager);
+        when(mTimeManager.getTimeCapabilitiesAndConfig()).thenReturn(mTimeCapabilitiesAndConfig);
+        when(mTimeManager.getTimeZoneCapabilitiesAndConfig())
+                .thenReturn(mTimeZoneCapabilitiesAndConfig);
+        when(mTimeCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeCapabilities);
+        when(mTimeCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeConfiguration);
+        when(mTimeZoneCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeZoneCapabilities);
+        when(mTimeZoneCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeZoneConfiguration);
+        mController = new TimePickerPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_disabled_automaticTZProviderFlagDisabled() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 1);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_enabled_automaticTZProviderFlagDisabled() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 0);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_disabled_automaticTZProviderFlagDisabled() {
+        mController.onStart(mLifecycleOwner);
+
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 1);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_enabled_automaticTZProviderFlagDisabled() {
+        mController.onStart(mLifecycleOwner);
+
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME, 0);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_disabled() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(true);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_enabled() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(false);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_disabled() {
+        mController.onStart(mLifecycleOwner);
+
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(true);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_enabled() {
+        mController.onStart(mLifecycleOwner);
+
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(false);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    private void mockIsAutoTimeAndTimeZoneDetectionEnabled(boolean isEnabled) {
+        when(mTimeCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+        when(mTimeZoneCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+        when(mTimeConfiguration.hasIsAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeZoneConfiguration.hasIsAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeZoneConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/TimeZonePickerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/TimeZonePickerPreferenceControllerTest.java
new file mode 100644
index 000000000..16ccd3f5e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/TimeZonePickerPreferenceControllerTest.java
@@ -0,0 +1,221 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.time.Capabilities;
+import android.app.time.TimeCapabilities;
+import android.app.time.TimeCapabilitiesAndConfig;
+import android.app.time.TimeConfiguration;
+import android.app.time.TimeManager;
+import android.app.time.TimeZoneCapabilities;
+import android.app.time.TimeZoneCapabilitiesAndConfig;
+import android.app.time.TimeZoneConfiguration;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.platform.test.annotations.RequiresFlagsDisabled;
+import android.platform.test.annotations.RequiresFlagsEnabled;
+import android.platform.test.flag.junit.CheckFlagsRule;
+import android.platform.test.flag.junit.DeviceFlagsValueProvider;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class TimeZonePickerPreferenceControllerTest {
+
+    private Context mContext;
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private TimeZonePickerPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private TimeManager mTimeManager;
+    @Mock
+    private TimeCapabilities mTimeCapabilities;
+    @Mock
+    private TimeCapabilitiesAndConfig mTimeCapabilitiesAndConfig;
+    @Mock
+    private TimeConfiguration mTimeConfiguration;
+    @Mock
+    private TimeZoneCapabilities mTimeZoneCapabilities;
+    @Mock
+    private TimeZoneCapabilitiesAndConfig mTimeZoneCapabilitiesAndConfig;
+    @Mock
+    private TimeZoneConfiguration mTimeZoneConfiguration;
+
+    @Rule
+    public final CheckFlagsRule mCheckFlagsRule = DeviceFlagsValueProvider.createCheckFlagsRule();
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mPreference = new SwitchPreference(mContext);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        when(mContext.getSystemService(TimeManager.class)).thenReturn(mTimeManager);
+        when(mTimeManager.getTimeCapabilitiesAndConfig()).thenReturn(mTimeCapabilitiesAndConfig);
+        when(mTimeManager.getTimeZoneCapabilitiesAndConfig())
+                .thenReturn(mTimeZoneCapabilitiesAndConfig);
+        when(mTimeCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeCapabilities);
+        when(mTimeCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeConfiguration);
+        when(mTimeZoneCapabilitiesAndConfig.getCapabilities()).thenReturn(mTimeZoneCapabilities);
+        when(mTimeZoneCapabilitiesAndConfig.getConfiguration()).thenReturn(mTimeZoneConfiguration);
+        mController = new TimeZonePickerPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_disabled_automaticTZProviderFlagDisabled() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME_ZONE, 1);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_enabled_automaticTZProviderFlagDisabled() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME_ZONE, 0);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_disabled_automaticTZProviderFlagDisabled() {
+        mController.onStart(mLifecycleOwner);
+
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME_ZONE, 1);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsDisabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_enabled_automaticTZProviderFlagDisabled() {
+        mController.onStart(mLifecycleOwner);
+
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.AUTO_TIME_ZONE, 0);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_disabled() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(true);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_enabled() {
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(false);
+        mController.refreshUi();
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_disabled() {
+        mController.onStart(mLifecycleOwner);
+
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(true);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @RequiresFlagsEnabled(Flags.FLAG_UPDATE_DATE_AND_TIME_PAGE)
+    @Test
+    public void testRefreshUi_fromBroadcastReceiver_enabled() {
+        mController.onStart(mLifecycleOwner);
+
+        mockIsAutoTimeAndTimeZoneDetectionEnabled(false);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(Intent.ACTION_TIME_CHANGED));
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    private void mockIsAutoTimeAndTimeZoneDetectionEnabled(boolean isEnabled) {
+        when(mTimeCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+        when(mTimeZoneCapabilities.getConfigureAutoDetectionEnabledCapability())
+                .thenReturn(isEnabled ? Capabilities.CAPABILITY_POSSESSED
+                        : Capabilities.CAPABILITY_NOT_SUPPORTED);
+        when(mTimeConfiguration.hasIsAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeZoneConfiguration.hasIsAutoDetectionEnabled()).thenReturn(isEnabled);
+        when(mTimeZoneConfiguration.isAutoDetectionEnabled()).thenReturn(isEnabled);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/datetime/TimeZonePickerScreenPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/datetime/TimeZonePickerScreenPreferenceControllerTest.java
new file mode 100644
index 000000000..29ef4bf28
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/datetime/TimeZonePickerScreenPreferenceControllerTest.java
@@ -0,0 +1,190 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.datetime;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+
+import android.app.timezonedetector.ManualTimeZoneSuggestion;
+import android.app.timezonedetector.TimeZoneDetector;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.datetime.ZoneGetter;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class TimeZonePickerScreenPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private TimeZonePickerScreenPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private TimeZoneDetector mTimeZoneDetector;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new TimeZonePickerScreenPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        // Test setup.
+        mPreferenceController.mTimeZoneDetector = mTimeZoneDetector;
+    }
+
+    @Test
+    public void testOnCreate_hasElements() {
+        List<Map<String, Object>> testTimeZones = new ArrayList<>();
+        testTimeZones.add(
+                createTimeZoneMap("testKey1", "Midway", "GMT-11:00", -1100));
+        testTimeZones.add(
+                createTimeZoneMap("testKey2", "Tijuana", "GMT-07:00", -700));
+        testTimeZones.add(
+                createTimeZoneMap("testKey3", "Coordinated Universal Time", "GMT+00:00", 0));
+        testTimeZones.add(
+                createTimeZoneMap("testKey4", "Kabul", "GMT+04:30", 430));
+        mPreferenceController.setZonesList(testTimeZones);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(4);
+    }
+
+    @Test
+    public void testOnPreferenceClick_setTimeZoneCalled() {
+        List<Map<String, Object>> testTimeZone = new ArrayList<>();
+        testTimeZone.add(createTimeZoneMap("testKey", "London", "GMT+01:00", 100));
+        mPreferenceController.setZonesList(testTimeZone);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Preference preference = mPreferenceGroup.findPreference("testKey");
+        preference.performClick();
+        ManualTimeZoneSuggestion suggestion =
+                TimeZoneDetector.createManualTimeZoneSuggestion("testKey", "Test debug info");
+        verify(mTimeZoneDetector).suggestManualTimeZone(suggestion);
+    }
+
+    @Test
+    public void testOnPreferenceClick_fragmentControllerGoBack() {
+        List<Map<String, Object>> testTimeZone = new ArrayList<>();
+        testTimeZone.add(createTimeZoneMap("testKey", "London", "GMT+01:00", 100));
+        mPreferenceController.setZonesList(testTimeZone);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Preference preference = mPreferenceGroup.findPreference("testKey");
+        preference.performClick();
+        verify(mFragmentController).goBack();
+    }
+
+    @Test
+    public void testOnPreferenceClick_broadcastFired() {
+        List<Map<String, Object>> testTimeZone = new ArrayList<>();
+        testTimeZone.add(createTimeZoneMap("testKey", "London", "GMT+01:00", 100));
+        mPreferenceController.setZonesList(testTimeZone);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Preference preference = mPreferenceGroup.findPreference("testKey");
+        preference.performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, times(1)).sendBroadcast(captor.capture());
+        List<Intent> intentsFired = captor.getAllValues();
+        assertThat(intentsFired.size()).isEqualTo(1);
+        Intent intentFired = intentsFired.get(0);
+        assertThat(intentFired.getAction()).isEqualTo(Intent.ACTION_TIME_CHANGED);
+    }
+
+    @Test
+    public void testTimeZonesComparator() {
+        List<Map<String, Object>> testTimeZones = new ArrayList<>();
+        testTimeZones.add(createTimeZoneMap("testKey1", "Oral",
+                "GMT+05:00", 500));
+        testTimeZones.add(createTimeZoneMap("testKey2", "Kathmandu",
+                "GMT+05:45", 545));
+        testTimeZones.add(createTimeZoneMap("testKey3", "Brazzaville",
+                "GMT+01:00", 100));
+        testTimeZones.add(createTimeZoneMap("testKey4", "Casablanca",
+                "GMT+01:00", 100));
+        testTimeZones.add(createTimeZoneMap("testKey5", "Nuuk",
+                "GMT-02:00", -200));
+        testTimeZones.add(createTimeZoneMap("testKey6", "St. John's",
+                "GMT-02:30", -230));
+        mPreferenceController.setZonesList(testTimeZones);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        List<String> computedOrder = new ArrayList<>();
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            computedOrder.add(mPreferenceGroup.getPreference(i).getTitle().toString());
+        }
+
+        assertThat(computedOrder).containsExactly("St. John's", "Nuuk", "Brazzaville", "Casablanca",
+                "Oral", "Kathmandu");
+    }
+
+    private Map<String, Object> createTimeZoneMap(String key, String timeZone, String offset,
+            int offsetValue) {
+        Map<String, Object> map = new HashMap<>();
+        map.put(ZoneGetter.KEY_ID, key);
+        map.put(ZoneGetter.KEY_DISPLAY_LABEL, timeZone);
+        map.put(ZoneGetter.KEY_OFFSET_LABEL, offset);
+        map.put(ZoneGetter.KEY_OFFSET, offsetValue);
+        return map;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/development/DevelopmentSettingsUtilTest.java b/tests/multivalent/src/com/android/car/settings/development/DevelopmentSettingsUtilTest.java
new file mode 100644
index 000000000..5b7b7c409
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/development/DevelopmentSettingsUtilTest.java
@@ -0,0 +1,143 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.development;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.os.UserManager;
+import android.provider.Settings;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DevelopmentSettingsUtilTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private Context mSpiedContext = spy(mContext);
+
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        // default to no debugging restrictions
+        when(mMockUserManager.hasUserRestriction(
+                UserManager.DISALLOW_DEBUGGING_FEATURES)).thenReturn(false);
+        when(mSpiedContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mSpiedContext.getSystemService(Context.USER_SERVICE)).thenReturn(mMockUserManager);
+        when(mSpiedContext.getContentResolver()).thenReturn(mContext.getContentResolver());
+    }
+
+    @Test
+    public void isEnabled_settingsOff_isAdmin_shouldReturnFalse() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 0);
+
+        assertThat(DevelopmentSettingsUtil.isDevelopmentSettingsEnabled(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void isEnabled_settingsOn_isAdmin_shouldReturnTrue() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+
+        assertThat(DevelopmentSettingsUtil.isDevelopmentSettingsEnabled(mSpiedContext)).isTrue();
+    }
+
+    @Test
+    public void isEnabled_settingsOn_notAdmin_shouldReturnFalse() {
+        when(mMockUserManager.isAdminUser()).thenReturn(false);
+
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+
+        assertThat(DevelopmentSettingsUtil.isDevelopmentSettingsEnabled(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void isEnabled_hasDisallowDebuggingRestriction_shouldReturnFalse() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+
+        when(mMockUserManager.hasUserRestriction(
+                UserManager.DISALLOW_DEBUGGING_FEATURES)).thenReturn(true);
+
+        assertThat(DevelopmentSettingsUtil.isDevelopmentSettingsEnabled(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void isEnabled_doesNotHaveDisallowDebuggingRestriction_shouldReturnTrue() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+
+        assertThat(DevelopmentSettingsUtil.isDevelopmentSettingsEnabled(mSpiedContext)).isTrue();
+    }
+
+    @Test
+    public void setDevelopmentSettingsEnabled_setTrue() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 0);
+
+        DevelopmentSettingsUtil.setDevelopmentSettingsEnabled(mContext, true);
+
+        assertThat(Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 0)).isEqualTo(1);
+    }
+
+    @Test
+    public void setDevelopmentSettingsEnabled_setFalse() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+
+        DevelopmentSettingsUtil.setDevelopmentSettingsEnabled(mContext, false);
+
+        assertThat(Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1)).isEqualTo(0);
+    }
+
+    @Test
+    public void isDeviceProvisioned_true() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.DEVICE_PROVISIONED,
+                1);
+        assertThat(DevelopmentSettingsUtil.isDeviceProvisioned(mContext)).isTrue();
+    }
+
+    @Test
+    public void isDeviceProvisioned_false() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.DEVICE_PROVISIONED,
+                0);
+        assertThat(DevelopmentSettingsUtil.isDeviceProvisioned(mContext)).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/display/AdaptiveBrightnessTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/display/AdaptiveBrightnessTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..149571b53
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/display/AdaptiveBrightnessTogglePreferenceControllerTest.java
@@ -0,0 +1,292 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.display;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.content.res.Resources;
+import android.database.ContentObserver;
+import android.os.UserManager;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiSwitchPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AdaptiveBrightnessTogglePreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_BRIGHTNESS;
+
+    private Context mContext;
+    private Resources mResources;
+    private LifecycleOwner mLifecycleOwner;
+    private AdaptiveBrightnessTogglePreferenceController mPreferenceController;
+    private CarUiSwitchPreference mPreference;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mResources = spy(mContext.getResources());
+        when(mContext.getResources()).thenReturn(mResources);
+        mPreference = new CarUiSwitchPreference(mContext);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new AdaptiveBrightnessTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onStart_registersContentObserver() {
+        ContentResolver resolver = spy(mContext.getContentResolver());
+        when(mContext.getContentResolver()).thenReturn(resolver);
+        mPreferenceController.onStart(mLifecycleOwner);
+        verify(resolver).registerContentObserver(
+                eq(Settings.System.getUriFor(Settings.System.SCREEN_BRIGHTNESS_MODE)), eq(false),
+                any(ContentObserver.class));
+    }
+
+    @Test
+    public void onStop_unregistersContentObserver() {
+        ContentResolver resolver = spy(mContext.getContentResolver());
+        when(mContext.getContentResolver()).thenReturn(resolver);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+        verify(resolver).unregisterContentObserver(any(ContentObserver.class));
+    }
+
+    @Test
+    public void testRefreshUi_manualMode_isNotChecked() {
+        Settings.System.putInt(mContext.getContentResolver(),
+                Settings.System.SCREEN_BRIGHTNESS_MODE,
+                Settings.System.SCREEN_BRIGHTNESS_MODE_MANUAL);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testRefreshUi_automaticMode_isChecked() {
+        Settings.System.putInt(mContext.getContentResolver(),
+                Settings.System.SCREEN_BRIGHTNESS_MODE,
+                Settings.System.SCREEN_BRIGHTNESS_MODE_AUTOMATIC);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_setFalse() {
+        mPreference.callChangeListener(false);
+        int brightnessMode = Settings.System.getInt(mContext.getContentResolver(),
+                Settings.System.SCREEN_BRIGHTNESS_MODE,
+                Settings.System.SCREEN_BRIGHTNESS_MODE_AUTOMATIC);
+        assertThat(brightnessMode).isEqualTo(Settings.System.SCREEN_BRIGHTNESS_MODE_MANUAL);
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_setTrue() {
+        mPreference.callChangeListener(true);
+        int brightnessMode = Settings.System.getInt(mContext.getContentResolver(),
+                Settings.System.SCREEN_BRIGHTNESS_MODE,
+                Settings.System.SCREEN_BRIGHTNESS_MODE_MANUAL);
+        assertThat(brightnessMode).isEqualTo(Settings.System.SCREEN_BRIGHTNESS_MODE_AUTOMATIC);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supportedd_notRestricted_available() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supportedd_notRestricted_available_zoneWrite() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supportedd_notRestricted_available_zoneRead() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supportedd_notRestricted_available_zoneHidden() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSupported_unsupportOnDevice() {
+        mockSupportsAdaptiveBrightness(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSupported_unsupportOnDevice_zoneWrite() {
+        mockSupportsAdaptiveBrightness(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSupported_unsupportOnDevice_zoneRead() {
+        mockSupportsAdaptiveBrightness(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSupported_unsupportOnDevice_zoneHidden() {
+        mockSupportsAdaptiveBrightness(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supported_restricted_availableForViewing() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supported_restricted_availableForViewing_zoneWrite() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supported_restricted_availableForViewing_zoneRead() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_supported_restricted_availableForViewing_zoneHidden() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void disabledClick_restrictedByDpm_showActionDisabledByAdminDialog() {
+        mockSupportsAdaptiveBrightness(true);
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    // TODO: refactor to use EnterpriseTestUtils
+    private void mockUserRestrictionSetByDpm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+                .thenReturn(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+    }
+
+    private void mockSupportsAdaptiveBrightness(boolean supported) {
+        when(mResources.getBoolean(R.bool.config_automatic_brightness_available))
+                .thenReturn(supported);
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/display/BrightnessLevelPreferenceControllerMockTest.java b/tests/multivalent/src/com/android/car/settings/display/BrightnessLevelPreferenceControllerMockTest.java
new file mode 100644
index 000000000..97cb39d81
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/display/BrightnessLevelPreferenceControllerMockTest.java
@@ -0,0 +1,289 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.display;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.SeekBarPreference;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+@RunWith(AndroidJUnit4.class)
+public final class BrightnessLevelPreferenceControllerMockTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_BRIGHTNESS;
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private final LifecycleOwner mLifecycleOwner = new TestLifecycleOwner();
+
+    private BrightnessLevelPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private SeekBarPreference mPreference;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new SeekBarPreference(mContext);
+        mPreferenceController = new BrightnessLevelPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser() {
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser_zoneWrite() {
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser_zoneRead() {
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_disabledForUser_zoneHidden() {
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser() {
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser_zoneWrite() {
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser_zoneRead() {
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_disabledForUser_zoneHidden() {
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneWrite() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneRead() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_notRestricted_available_zoneHidden() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByUm_toast() {
+        mockUserRestrictionSetByUm(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByDpm_dialog() {
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void mockUserRestrictionSetByUm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+                .thenReturn(restricted);
+    }
+
+    private void mockUserRestrictionSetByDpm(boolean restricted) {
+        mockUserRestrictionSetByUm(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+    }
+
+    private void assertShowingBlockedToast() {
+        String toastText = mContext.getResources().getString(R.string.action_unavailable);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/display/BrightnessLevelPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/display/BrightnessLevelPreferenceControllerTest.java
new file mode 100644
index 000000000..44273035f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/display/BrightnessLevelPreferenceControllerTest.java
@@ -0,0 +1,183 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.display;
+
+import static com.android.settingslib.display.BrightnessUtils.GAMMA_SPACE_MAX;
+import static com.android.settingslib.display.BrightnessUtils.convertLinearToGamma;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.database.ContentObserver;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.SeekBarPreference;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.CountDownLatch;
+
+@RunWith(AndroidJUnit4.class)
+public class BrightnessLevelPreferenceControllerTest {
+    private static final int WAIT_TIME_SEC = 10; // Time to ensure brightness value has been written
+
+    private Context mContext;
+    private LifecycleOwner mLifecycleOwner;
+    private TestBrightnessLevelPreferenceController mController;
+    private SeekBarPreference mSeekBarPreference;
+    private CountDownLatch mCountDownLatch;
+    private int mMin;
+    private int mMax;
+    private int mMid;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mCountDownLatch = new CountDownLatch(1);
+
+        mContext = spy(ApplicationProvider.getApplicationContext());
+
+        mSeekBarPreference = new SeekBarPreference(mContext);
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mController = new TestBrightnessLevelPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mSeekBarPreference);
+        mMin = mController.mMinimumBacklight;
+        mMax = mController.mMaximumBacklight;
+        mMid = (mMax + mMin) / 2;
+        mController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onStart_registersContentObserver() {
+        ContentResolver resolver = mock(ContentResolver.class);
+        when(mContext.getContentResolver()).thenReturn(resolver);
+        mController.onStart(mLifecycleOwner);
+        verify(resolver).registerContentObserver(
+                eq(Settings.System.getUriFor(Settings.System.SCREEN_BRIGHTNESS)), eq(false),
+                any(ContentObserver.class));
+    }
+
+    @Test
+    public void onStop_unregistersContentObserver() {
+        ContentResolver resolver = mock(ContentResolver.class);
+        when(mContext.getContentResolver()).thenReturn(resolver);
+        mController.onStart(mLifecycleOwner);
+        mController.onStop(mLifecycleOwner);
+        verify(resolver).unregisterContentObserver(any(ContentObserver.class));
+    }
+
+    @Test
+    public void testRefreshUi_maxSet() {
+        mController.refreshUi();
+        assertThat(mSeekBarPreference.getMax()).isEqualTo(GAMMA_SPACE_MAX);
+    }
+
+    @Test
+    public void testRefreshUi_minValue() {
+        mController.saveScreenBrightnessLinearValue(mMin);
+        mController.refreshUi();
+
+        assertThat(mSeekBarPreference.getValue()).isEqualTo(0);
+    }
+
+    @Test
+    public void testRefreshUi_maxValue() {
+        mController.saveScreenBrightnessLinearValue(mMax);
+        mController.refreshUi();
+
+        assertThat(mSeekBarPreference.getValue()).isEqualTo(GAMMA_SPACE_MAX);
+    }
+
+    @Test
+    public void testRefreshUi_midValue() {
+        mController.saveScreenBrightnessLinearValue(mMid);
+        mController.refreshUi();
+
+        assertThat(mSeekBarPreference.getValue()).isEqualTo(convertLinearToGamma(mMid, mMin, mMax));
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_minValue() {
+        mSeekBarPreference.callChangeListener(0);
+
+        assertThat(mController.getScreenBrightnessLinearValue()).isEqualTo(mMin);
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_maxValue() {
+        mSeekBarPreference.callChangeListener(GAMMA_SPACE_MAX);
+
+        assertThat(mController.getScreenBrightnessLinearValue()).isEqualTo(mMax);
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_midValue() {
+        mSeekBarPreference.callChangeListener(convertLinearToGamma(mMid, mMin, mMax));
+
+        assertThat(mController.getScreenBrightnessLinearValue()).isEqualTo(mMid);
+    }
+
+    private static class TestBrightnessLevelPreferenceController extends
+            BrightnessLevelPreferenceController {
+        // Using Settings.System.putIntForUser() led to flaky tests because other android classes
+        // could write to the value as well.
+        private int mScreenBrightnessLinearValue;
+
+        TestBrightnessLevelPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        int getScreenBrightnessLinearValue() {
+            return mScreenBrightnessLinearValue;
+        }
+
+        @Override
+        void saveScreenBrightnessLinearValue(int linear) {
+            mScreenBrightnessLinearValue = linear;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/display/ThemeTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/display/ThemeTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..fe63bfc62
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/display/ThemeTogglePreferenceControllerTest.java
@@ -0,0 +1,219 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.display;
+
+import static com.android.car.settings.display.ThemeTogglePreferenceController.FORCED_DAY_MODE;
+import static com.android.car.settings.display.ThemeTogglePreferenceController.FORCED_NIGHT_MODE;
+import static com.android.car.settings.display.ThemeTogglePreferenceController.FORCED_SENSOR_MODE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.settings.CarSettings;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.content.res.Resources;
+import android.database.ContentObserver;
+import android.platform.test.flag.junit.SetFlagsRule;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.MultiActionPreference;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.ToggleButtonActionItem;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ThemeTogglePreferenceControllerTest {
+    private Context mContext;
+    private Resources mResources;
+    private LifecycleOwner mLifecycleOwner;
+    private ThemeTogglePreferenceController mPreferenceController;
+    private MultiActionPreference mPreference;
+
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mSetFlagsRule.enableFlags(android.car.feature.Flags.FLAG_CAR_NIGHT_GLOBAL_SETTING);
+        mSetFlagsRule.enableFlags(Flags.FLAG_UI_THEME_TOGGLE);
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mResources = spy(mContext.getResources());
+        when(mContext.getResources()).thenReturn(mResources);
+        mPreference = new TestMultiActionPreference(mContext);
+
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new ThemeTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onStart_registersContentObserver() {
+        ContentResolver resolver = spy(mContext.getContentResolver());
+        when(mContext.getContentResolver()).thenReturn(resolver);
+
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(resolver).registerContentObserver(
+                eq(Settings.Global.getUriFor(CarSettings.Global.FORCED_DAY_NIGHT_MODE)), eq(false),
+                any(ContentObserver.class));
+    }
+
+    @Test
+    public void onStop_unregistersContentObserver() {
+        ContentResolver resolver = spy(mContext.getContentResolver());
+        when(mContext.getContentResolver()).thenReturn(resolver);
+
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(resolver).unregisterContentObserver(any(ContentObserver.class));
+    }
+
+    @Test
+    public void testRefreshUi_sensorMode_sensorButtonChecked() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_SENSOR_MODE);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceController.getAutoButton().isChecked()).isTrue();
+        assertThat(mPreferenceController.getAutoButton().isEnabled()).isFalse();
+        assertThat(mPreferenceController.getDayButton().isChecked()).isFalse();
+        assertThat(mPreferenceController.getDayButton().isEnabled()).isTrue();
+        assertThat(mPreferenceController.getNightButton().isChecked()).isFalse();
+        assertThat(mPreferenceController.getNightButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testRefreshUi_dayMode_dayButtonChecked() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_DAY_MODE);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceController.getAutoButton().isChecked()).isFalse();
+        assertThat(mPreferenceController.getAutoButton().isEnabled()).isTrue();
+        assertThat(mPreferenceController.getDayButton().isChecked()).isTrue();
+        assertThat(mPreferenceController.getDayButton().isEnabled()).isFalse();
+        assertThat(mPreferenceController.getNightButton().isChecked()).isFalse();
+        assertThat(mPreferenceController.getNightButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testRefreshUi_nightMode_nightButtonChecked() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_NIGHT_MODE);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceController.getAutoButton().isChecked()).isFalse();
+        assertThat(mPreferenceController.getAutoButton().isEnabled()).isTrue();
+        assertThat(mPreferenceController.getDayButton().isChecked()).isFalse();
+        assertThat(mPreferenceController.getDayButton().isEnabled()).isTrue();
+        assertThat(mPreferenceController.getNightButton().isChecked()).isTrue();
+        assertThat(mPreferenceController.getNightButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_setSensor() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_DAY_MODE);
+        mPreferenceController.refreshUi();
+
+        mPreferenceController.getAutoButton().onClick();
+
+        int themeMode = Settings.Global.getInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_DAY_MODE);
+        assertThat(themeMode).isEqualTo(FORCED_SENSOR_MODE);
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_setDay() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_SENSOR_MODE);
+        mPreferenceController.refreshUi();
+
+        mPreferenceController.getDayButton().onClick();
+        int themeMode = Settings.Global.getInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_SENSOR_MODE);
+
+        assertThat(themeMode).isEqualTo(FORCED_DAY_MODE);
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_setNight() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_SENSOR_MODE);
+        mPreferenceController.refreshUi();
+
+        mPreferenceController.getNightButton().onClick();
+
+        int themeMode = Settings.Global.getInt(mContext.getContentResolver(),
+                CarSettings.Global.FORCED_DAY_NIGHT_MODE,
+                FORCED_DAY_MODE);
+        assertThat(themeMode).isEqualTo(FORCED_NIGHT_MODE);
+    }
+
+    private static class TestMultiActionPreference extends MultiActionPreference {
+        TestMultiActionPreference(Context context) {
+            super(context);
+            mActionItemArray[0] = new ToggleButtonActionItem(this);
+            mActionItemArray[1] = new ToggleButtonActionItem(this);
+            mActionItemArray[2] = new ToggleButtonActionItem(this);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/ActionDisabledByAdminActivityTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/ActionDisabledByAdminActivityTest.java
new file mode 100644
index 000000000..27910b2f0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/ActionDisabledByAdminActivityTest.java
@@ -0,0 +1,85 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.enterprise.ActionDisabledByAdminActivity.FRAGMENT_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.app.AlertDialog;
+import android.app.admin.DevicePolicyManager;
+import android.content.Intent;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.rule.ActivityTestRule;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.mockito.MockitoAnnotations;
+
+public class ActionDisabledByAdminActivityTest extends BaseEnterpriseTestCase {
+
+    private static final String RESTRICTION_STRING = "RESTRICTION_STRING";
+
+    private FragmentManager mFragmentManager;
+    private ActionDisabledByAdminDialogFragment mFragment;
+
+    @Rule
+    public ActivityTestRule<ActionDisabledByAdminActivity> mActivityTestRule =
+            new ActivityTestRule<>(ActionDisabledByAdminActivity.class, true, false);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mockNullEnforcedAdmin(RESTRICTION_STRING, 0);
+        mockNullEnforcedAdmin(RESTRICTION_STRING, mRealContext.getUserId());
+    }
+
+    @Test
+    public void onCreate_showDialog() {
+        mActivityTestRule.launchActivity(getIntent(false));
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        mFragment = (ActionDisabledByAdminDialogFragment)
+                mFragmentManager.findFragmentByTag(FRAGMENT_TAG);
+
+        assertThat(mFragment).isNotNull();
+        AlertDialog dialog = (AlertDialog) mFragment.getDialog();
+        assertThat(dialog).isNotNull();
+        assertThat(dialog.isShowing()).isTrue();
+    }
+
+    @Test
+    public void onCreate_readsIntentRestriction() {
+        mActivityTestRule.launchActivity(getIntent(true));
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        mFragment = (ActionDisabledByAdminDialogFragment)
+                mFragmentManager.findFragmentByTag(FRAGMENT_TAG);
+
+        assertThat(mFragment).isNotNull();
+        assertThat(mFragment.mRestriction).isEqualTo(RESTRICTION_STRING);
+    }
+
+    private Intent getIntent(boolean hasRestrictionFlag) {
+        Intent intent = new Intent(mSpiedContext, ActionDisabledByAdminActivity.class);
+        if (hasRestrictionFlag) {
+            intent.putExtra(DevicePolicyManager.EXTRA_RESTRICTION, RESTRICTION_STRING);
+        }
+
+        return intent;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedCameraPermissionApplicationListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedCameraPermissionApplicationListPreferenceControllerTest.java
new file mode 100644
index 000000000..574566864
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedCameraPermissionApplicationListPreferenceControllerTest.java
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+
+public final class AdminGrantedCameraPermissionApplicationListPreferenceControllerTest extends
+        BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase
+        <AdminGrantedCameraPermissionApplicationListPreferenceController> {
+
+    public AdminGrantedCameraPermissionApplicationListPreferenceControllerTest() {
+        super(EnterpriseUtils.CAMERA_PERMISSIONS);
+    }
+
+    @Override
+    protected AdminGrantedCameraPermissionApplicationListPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new AdminGrantedCameraPermissionApplicationListPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, provider);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedCameraPermissionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedCameraPermissionPreferenceControllerTest.java
new file mode 100644
index 000000000..4498d7ebd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedCameraPermissionPreferenceControllerTest.java
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+
+public final class AdminGrantedCameraPermissionPreferenceControllerTest extends
+        BaseAdminGrantedPermissionsPreferenceControllerTestCase
+        <AdminGrantedCameraPermissionPreferenceController> {
+
+    public AdminGrantedCameraPermissionPreferenceControllerTest() {
+        super(EnterpriseUtils.CAMERA_PERMISSIONS);
+    }
+
+    @Override
+    protected AdminGrantedCameraPermissionPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new AdminGrantedCameraPermissionPreferenceController(mSpiedContext, mPreferenceKey,
+                mFragmentController, mUxRestrictions, provider);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedLocationPermissionsApplicationListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedLocationPermissionsApplicationListPreferenceControllerTest.java
new file mode 100644
index 000000000..5895a42e9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedLocationPermissionsApplicationListPreferenceControllerTest.java
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+
+public final class AdminGrantedLocationPermissionsApplicationListPreferenceControllerTest extends
+        BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase
+        <AdminGrantedLocationPermissionsApplicationListPreferenceController> {
+
+    public AdminGrantedLocationPermissionsApplicationListPreferenceControllerTest() {
+        super(EnterpriseUtils.LOCATION_PERMISSIONS);
+    }
+
+    @Override
+    protected AdminGrantedLocationPermissionsApplicationListPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new AdminGrantedLocationPermissionsApplicationListPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, provider);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedLocationPermissionsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedLocationPermissionsPreferenceControllerTest.java
new file mode 100644
index 000000000..779448540
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedLocationPermissionsPreferenceControllerTest.java
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+
+public final class AdminGrantedLocationPermissionsPreferenceControllerTest
+        extends BaseAdminGrantedPermissionsPreferenceControllerTestCase
+        <AdminGrantedLocationPermissionsPreferenceController> {
+
+    public AdminGrantedLocationPermissionsPreferenceControllerTest() {
+        super(EnterpriseUtils.LOCATION_PERMISSIONS);
+    }
+
+    @Override
+    protected AdminGrantedLocationPermissionsPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new AdminGrantedLocationPermissionsPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, provider);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedMicrophonePermissionApplicationListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedMicrophonePermissionApplicationListPreferenceControllerTest.java
new file mode 100644
index 000000000..85574ef6d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedMicrophonePermissionApplicationListPreferenceControllerTest.java
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+
+public final class AdminGrantedMicrophonePermissionApplicationListPreferenceControllerTest extends
+        BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase
+        <AdminGrantedMicrophonePermissionApplicationListPreferenceController> {
+
+    public AdminGrantedMicrophonePermissionApplicationListPreferenceControllerTest() {
+        super(EnterpriseUtils.MICROPHONE_PERMISSIONS);
+    }
+
+    @Override
+    protected AdminGrantedMicrophonePermissionApplicationListPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new AdminGrantedMicrophonePermissionApplicationListPreferenceController(
+                mSpiedContext, mPreferenceKey, mFragmentController, mUxRestrictions, provider);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedMicrophonePermissionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedMicrophonePermissionPreferenceControllerTest.java
new file mode 100644
index 000000000..700e5399d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/AdminGrantedMicrophonePermissionPreferenceControllerTest.java
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+
+public final class AdminGrantedMicrophonePermissionPreferenceControllerTest
+        extends BaseAdminGrantedPermissionsPreferenceControllerTestCase
+        <AdminGrantedMicrophonePermissionPreferenceController> {
+
+    public AdminGrantedMicrophonePermissionPreferenceControllerTest() {
+        super(EnterpriseUtils.MICROPHONE_PERMISSIONS);
+    }
+
+    @Override
+    protected AdminGrantedMicrophonePermissionPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new AdminGrantedMicrophonePermissionPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, provider);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/AlwaysOnVpnCurrentUserPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/AlwaysOnVpnCurrentUserPreferenceControllerTest.java
new file mode 100644
index 000000000..c43678c6b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/AlwaysOnVpnCurrentUserPreferenceControllerTest.java
@@ -0,0 +1,171 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.enterprise;
+
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.when;
+
+import android.net.VpnManager;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class AlwaysOnVpnCurrentUserPreferenceControllerTest extends
+        BaseEnterprisePrivacyPreferenceControllerTestCase {
+    private AlwaysOnVpnCurrentUserPreferenceController mAlwaysOnVpnCurrentUserPreferenceController;
+    private Preference mPreference;
+
+    @Mock
+    private VpnManager mVpnManager;
+
+    @Before
+    public void setUp() {
+        when(mSpiedContext.getSystemService(VpnManager.class)).thenReturn(mVpnManager);
+        mockHasDeviceAdminFeature();
+        mPreference = new Preference(mSpiedContext);
+        mAlwaysOnVpnCurrentUserPreferenceController =
+                new AlwaysOnVpnCurrentUserPreferenceController(
+                        mSpiedContext, mPreferenceKey, mFragmentController, mUxRestrictions);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageSet_preferenceEnabled() {
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn("com.test");
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageSet_preferenceEnabled_zoneWrite() {
+        mAlwaysOnVpnCurrentUserPreferenceController.setAvailabilityStatusForZone("write");
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn("com.test");
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageSet_preferenceEnabled_zoneRead() {
+        mAlwaysOnVpnCurrentUserPreferenceController.setAvailabilityStatusForZone("read");
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn("com.test");
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageSet_preferenceEnabled_zoneHidden() {
+        mAlwaysOnVpnCurrentUserPreferenceController.setAvailabilityStatusForZone("hidden");
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn("com.test");
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageNotSet_preferenceDisabled() {
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn(null);
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageNotSet_preferenceDisabled_zoneWrite() {
+        mAlwaysOnVpnCurrentUserPreferenceController.setAvailabilityStatusForZone("write");
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn(null);
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageNotSet_preferenceDisabled_zoneRead() {
+        mAlwaysOnVpnCurrentUserPreferenceController.setAvailabilityStatusForZone("read");
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn(null);
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testAlwaysOnVpnPackageNotSet_preferenceDisabled_zoneHidden() {
+        mAlwaysOnVpnCurrentUserPreferenceController.setAvailabilityStatusForZone("hidden");
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn(null);
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mAlwaysOnVpnCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testNoCompMode_showsRegularTitle() {
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn("com.test");
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.getTitle()).isEqualTo(mRealContext.getResources()
+                .getString(R.string.enterprise_privacy_always_on_vpn_device));
+    }
+
+    @Test
+    public void testCompMode_showsPersonalProfileTitle() {
+        mockCompMode();
+        when(mVpnManager.getAlwaysOnVpnPackageForUser(anyInt())).thenReturn("com.test");
+
+        mAlwaysOnVpnCurrentUserPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.getTitle()).isEqualTo(mRealContext.getResources()
+                .getString(R.string.enterprise_privacy_always_on_vpn_personal));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase.java b/tests/multivalent/src/com/android/car/settings/enterprise/BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase.java
new file mode 100644
index 000000000..2049968ab
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase.java
@@ -0,0 +1,257 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doAnswer;
+import static org.mockito.Mockito.spy;
+
+import android.content.pm.UserInfo;
+import android.graphics.drawable.Drawable;
+import android.util.ArrayMap;
+import android.util.Log;
+
+import androidx.preference.PreferenceGroup;
+import androidx.test.annotation.UiThreadTest;
+
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider.ListOfAppsCallback;
+
+import org.junit.Before;
+import org.junit.Test;
+
+import java.util.Map;
+
+abstract class BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase
+        <C extends BaseAdminGrantedPermissionsApplicationListPreferenceController>
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private static final String TAG =
+            BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase.class
+                    .getSimpleName();
+
+    private static final UserInfo DEFAULT_USER_INFO = new UserInfo(42, "Groot", /* flags= */ 0);
+
+    private static final Map<CharSequence, Drawable> ICONS_BY_LABEL = new ArrayMap<>();
+
+    // Must be a spy to verify refreshUi() is called
+    private C mSpiedController;
+
+    protected final String[] mPermissions;
+
+    private DummyPreferenceGroup mPreferenceGroup;
+
+    BaseAdminGrantedPermissionsApplicationListPreferenceControllerTestCase(String... permissions) {
+        mPermissions = permissions;
+    }
+
+    @Before
+    @UiThreadTest // Needed to instantiate DummyPreferenceGroup
+    public void setExtraFixtures() {
+        mSpiedController = spy(newController(mApplicationFeatureProvider));
+        mPreferenceGroup = new DummyPreferenceGroup(mSpiedContext);
+    }
+
+    protected abstract C newController(ApplicationFeatureProvider provider);
+
+    @Test
+    public void testGetPreferenceType() {
+        assertWithMessage("preference type").that(mSpiedController.getPreferenceType())
+                .isEqualTo(PreferenceGroup.class);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted() {
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted_zoneWrite() {
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted_zoneRead() {
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted_zoneHidden() {
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted_zoneWrite() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted_zoneRead() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted_zoneHidden() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testUpdateState() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListAppsWithAdminGrantedPermissions();
+        mSpiedController.getAvailabilityStatus();
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+        assertUiRefreshed(mSpiedController);
+
+        mSpiedController.updateState(mPreferenceGroup);
+
+        assertPreferenceGroupStateSet(mPreferenceGroup, "foo", "bar");
+    }
+
+    private ListOfAppsCallbackHolder mockListAppsWithAdminGrantedPermissions() {
+        ListOfAppsCallbackHolder callbackHolder = new ListOfAppsCallbackHolder();
+
+        doAnswer((inv) -> {
+            Log.d(TAG, "answering to " + inv);
+            ListOfAppsCallback callback = (ListOfAppsCallback) inv.getArguments()[1];
+            callbackHolder.setCallback(callback);
+            return null;
+        }).when(mApplicationFeatureProvider)
+            .listAppsWithAdminGrantedPermissions(eq(mPermissions), any());
+        return callbackHolder;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/BaseAdminGrantedPermissionsPreferenceControllerTestCase.java b/tests/multivalent/src/com/android/car/settings/enterprise/BaseAdminGrantedPermissionsPreferenceControllerTestCase.java
new file mode 100644
index 000000000..5bf5fb705
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/BaseAdminGrantedPermissionsPreferenceControllerTestCase.java
@@ -0,0 +1,247 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doAnswer;
+import static org.mockito.Mockito.spy;
+
+import android.util.Log;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider.NumberOfAppsCallback;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+abstract class BaseAdminGrantedPermissionsPreferenceControllerTestCase
+        <C extends BaseAdminGrantedPermissionsPreferenceController> extends
+        BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private static final String TAG = BaseAdminGrantedPermissionsPreferenceControllerTestCase.class
+            .getSimpleName();
+
+    // Must be a spy to verify refreshUi() is called
+    private C mSpiedController;
+
+    protected final String[] mPermissions;
+
+    @Mock
+    private Preference mPreference;
+
+    BaseAdminGrantedPermissionsPreferenceControllerTestCase(String... permissions) {
+        mPermissions = permissions;
+    }
+
+    @Before
+    public void setController() {
+        mSpiedController = spy(newController(mApplicationFeatureProvider));
+    }
+
+    protected abstract C newController(ApplicationFeatureProvider provider);
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted() {
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted_zoneWrite() {
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted_zoneRead() {
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noPermissionsGranted_zoneHidden() {
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(42);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted_zoneWrite() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(42);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted_zoneRead() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(42);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_permissionsGranted_zoneHidden() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(42);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testUpdateState() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder =
+                mockCalculateNumberOfAppsWithAdminGrantedPermissions();
+        mSpiedController.getAvailabilityStatus();
+        callbackHolder.release(42);
+        assertUiRefreshed(mSpiedController);
+
+        mSpiedController.updateState(mPreference);
+
+        assertPreferenceStateSet(mPreference, 42);
+    }
+
+    private NumberOfAppsCallbackHolder mockCalculateNumberOfAppsWithAdminGrantedPermissions() {
+        NumberOfAppsCallbackHolder callbackHolder = new NumberOfAppsCallbackHolder();
+
+        doAnswer((inv) -> {
+            Log.d(TAG, "answering to " + inv);
+            NumberOfAppsCallback callback = (NumberOfAppsCallback) inv.getArguments()[2];
+            callbackHolder.setCallback(callback);
+            return null;
+        }).when(mApplicationFeatureProvider)
+                .calculateNumberOfAppsWithAdminGrantedPermissions(eq(mPermissions),
+                        /* sync= */ eq(true), any());
+        return callbackHolder;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterprisePreferenceControllerTestCase.java b/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterprisePreferenceControllerTestCase.java
new file mode 100644
index 000000000..7e50acaea
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterprisePreferenceControllerTestCase.java
@@ -0,0 +1,131 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.google.common.truth.Truth.assertThat;
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.notNull;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import static java.util.stream.Collectors.toList;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+
+import com.android.car.settings.common.FragmentController;
+
+import org.mockito.Mock;
+
+import java.util.ArrayList;
+import java.util.List;
+
+abstract class BaseEnterprisePreferenceControllerTestCase extends BaseEnterpriseTestCase {
+    protected final String mPreferenceKey = "Da Key";
+    protected final CarUxRestrictions mUxRestrictions = new CarUxRestrictions.Builder(
+            /* reqOpt= */ true, CarUxRestrictions.UX_RESTRICTIONS_FULLY_RESTRICTED, /* time= */ 0)
+                    .build();
+    @Mock
+    protected FragmentController mFragmentController;
+
+    protected static final void assertPreferenceSummary(Preference preference, String summary) {
+        assertWithMessage("(preference %s).getSummary()", preference).that(preference.getSummary())
+                .isEqualTo(summary);
+    }
+
+    protected void verifyPreferenceTitles(DummyPreferenceGroup preferenceGroup,
+            CharSequence... titles) {
+        assertThat(preferenceGroup.getPreferences().stream()
+                .map(p -> p.getTitle()).collect(toList())).containsExactly(titles);
+    }
+
+    protected static final void verifyPreferenceVisibleSet(Preference preference, boolean visible) {
+        verify(preference).setVisible(visible);
+    }
+
+    protected static final void verifyPreferenceTitleSet(Preference preference,
+            CharSequence title) {
+        verify(preference).setTitle(title);
+    }
+
+    protected static final void verifyPreferenceTitleNeverSet(Preference preference) {
+        verify(preference, never()).setTitle(any());
+    }
+
+    protected static final void verifyPreferenceSummarySet(Preference preference,
+            CharSequence summary) {
+        verify(preference).setSummary(summary);
+    }
+
+    protected static final void verifyPreferenceSummarySet(Preference preference, int resId) {
+        verify(preference).setSummary(resId);
+    }
+
+    protected static final void verifyPreferenceSummaryNeverSet(Preference preference) {
+        verify(preference, never()).setSummary(any());
+    }
+
+    protected static final void verifyPreferenceIconSet(Preference preference) {
+        verify(preference).setIcon(notNull());
+    }
+
+    protected static final void verifyPreferenceIconNeverSet(Preference preference) {
+        verify(preference, never()).setIcon(notNull());
+    }
+
+    protected static final void verifyPreferenceDisabled(Preference preference) {
+        verify(preference).setEnabled(false);
+    }
+
+    protected static final void verifyPreferenceEnabled(Preference preference) {
+        verify(preference).setEnabled(true);
+    }
+
+    static final class DummyPreferenceGroup extends PreferenceGroup {
+
+        private final List<Preference> mList = new ArrayList<>();
+
+        DummyPreferenceGroup(Context context) {
+            super(context, null);
+        }
+
+        @Override public void removeAll() {
+            mList.clear();
+        }
+
+        @Override public boolean addPreference(Preference preference) {
+            mList.add(preference);
+            return true;
+        }
+
+        @Override public int getPreferenceCount() {
+            return mList.size();
+        }
+
+        @Override public Preference getPreference(int index) {
+            return mList.get(index);
+        }
+
+        public List<Preference> getPreferences() {
+            return mList;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterprisePrivacyPreferenceControllerTestCase.java b/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterprisePrivacyPreferenceControllerTestCase.java
new file mode 100644
index 000000000..c06b2417c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterprisePrivacyPreferenceControllerTestCase.java
@@ -0,0 +1,195 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+
+import android.annotation.Nullable;
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.UserInfo;
+import android.graphics.drawable.Drawable;
+import android.util.ArrayMap;
+import android.util.Log;
+
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.testutils.TextDrawable;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider.ListOfAppsCallback;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider.NumberOfAppsCallback;
+import com.android.car.settingslib.applications.UserAppInfo;
+import com.android.car.settingslib.enterprise.EnterpriseDefaultApps;
+import com.android.car.settingslib.enterprise.EnterprisePrivacyFeatureProvider;
+import com.android.internal.util.Preconditions;
+
+import org.mockito.ArgumentMatcher;
+import org.mockito.Mock;
+
+import java.util.Arrays;
+import java.util.Map;
+import java.util.Objects;
+
+/**
+ * Base test for all controllers in the enterprise privacy / managed device info screen
+ */
+abstract class BaseEnterprisePrivacyPreferenceControllerTestCase
+        extends BaseEnterprisePreferenceControllerTestCase {
+
+    private static final String TAG = BaseEnterprisePrivacyPreferenceControllerTestCase.class
+            .getSimpleName();
+
+    private static final UserInfo DEFAULT_USER_INFO = new UserInfo(42, "Groot", /* flags= */ 0);
+
+    private static final Map<CharSequence, Drawable> ICONS_BY_LABEL = new ArrayMap<>();
+
+    @Mock
+    protected ApplicationFeatureProvider mApplicationFeatureProvider;
+
+    @Mock
+    protected EnterprisePrivacyFeatureProvider mEnterprisePrivacyFeatureProvider;
+
+    protected void verifyFindPersistentPreferredActivitiesCalledOnce() {
+        verify(mApplicationFeatureProvider, times(EnterpriseDefaultApps.values().length))
+                .findPersistentPreferredActivities(anyInt(), any());
+    }
+
+    protected ArgumentMatcher<Intent[]> matchesIntents(Intent[] intents) {
+        return (Intent[] actualIntents) -> {
+            if (actualIntents == null) {
+                return false;
+            }
+            if (actualIntents.length != intents.length) {
+                return false;
+            }
+            for (int i = 0; i < intents.length; i++) {
+                if (!intents[i].filterEquals(actualIntents[i])) {
+                    return false;
+                }
+            }
+            return true;
+        };
+    }
+
+    protected void assertPreferenceStateSet(Preference preference, int count) {
+        String expectedSummary = mRealContext.getResources().getQuantityString(
+                R.plurals.enterprise_privacy_number_packages_lower_bound, count, count);
+        verifyPreferenceTitleNeverSet(preference);
+        verifyPreferenceSummarySet(preference, expectedSummary);
+        verifyPreferenceIconNeverSet(preference);
+    }
+
+    protected void assertPreferenceGroupStateSet(PreferenceGroup preferenceGroup,
+            CharSequence...appLabels) {
+        assertWithMessage("preference count")
+                .that(preferenceGroup.getPreferenceCount()).isEqualTo(appLabels.length);
+
+        for (int i = 0; i < appLabels.length; i++) {
+            Preference pref = preferenceGroup.getPreference(i);
+            CharSequence label = appLabels[i];
+            assertWithMessage("title at index %s", i).that(pref.getTitle()).isEqualTo(label);
+            Drawable icon = getIcon(label);
+            assertWithMessage("icon at index %s", i).that(pref.getIcon()).isEqualTo(icon);
+            assertWithMessage("order at index %s", i).that(pref.getOrder()).isEqualTo(i);
+            assertWithMessage("selectable at index %s", i).that(pref.isSelectable()).isFalse();
+        }
+    }
+
+    protected void expectUiRefreshed(PreferenceController controller) {
+        doNothing().when(controller).refreshUi();
+    }
+
+    protected void assertUiRefreshed(PreferenceController controller) {
+        verify(controller).refreshUi();
+    }
+
+    protected void assertUiNotRefreshed(PreferenceController controller) {
+        verify(controller, never()).refreshUi();
+    }
+
+    protected UserAppInfo newUserAppInfo(CharSequence label) {
+        ApplicationInfo appInfo = new ApplicationInfo() {
+            @Override
+            public CharSequence loadLabel(PackageManager pm) {
+                return label;
+            }
+
+            @Override
+            public Drawable loadIcon(PackageManager pm) {
+                return getIcon(label);
+            };
+
+        };
+        return new UserAppInfo(DEFAULT_USER_INFO, appInfo);
+    }
+
+    protected Drawable getIcon(CharSequence label) {
+        Drawable icon = ICONS_BY_LABEL.get(label);
+        if (icon != null) {
+            Log.d(TAG, "getIcon(" + label + "): returning existing icon " + icon);
+            return icon;
+        }
+        icon = new TextDrawable(label);
+        ICONS_BY_LABEL.put(label, icon);
+        Log.d(TAG, "getIcon(" + label + "): returning new icon " + icon);
+        return icon;
+    }
+
+    static final class ListOfAppsCallbackHolder {
+        @Nullable
+        private ApplicationFeatureProvider.ListOfAppsCallback mCallback;
+
+        void release(UserAppInfo... result) {
+            Preconditions.checkState(mCallback != null, "release() called before setCallback()");
+            Log.d(TAG, "setting result to " + Arrays.toString(result) + " and releasing latch on"
+                    + Thread.currentThread());
+            mCallback.onListOfAppsResult(Arrays.asList(result));
+        }
+
+        void setCallback(ListOfAppsCallback callback) {
+            Log.d(TAG, "setting callback to "  + callback);
+            mCallback = Objects.requireNonNull(callback, "callback cannot be null");
+        }
+    }
+
+    static final class NumberOfAppsCallbackHolder {
+        @Nullable
+        private NumberOfAppsCallback mCallback;
+
+        void release(int result) {
+            Preconditions.checkState(mCallback != null, "release() called before setCallback()");
+            Log.d(TAG, "setting result to " + result + " and releasing latch on"
+                    + Thread.currentThread());
+            mCallback.onNumberOfAppsResult(result);
+        }
+
+        void setCallback(NumberOfAppsCallback callback) {
+            Log.d(TAG, "setting callback to "  + callback);
+            mCallback = Objects.requireNonNull(callback, "callback cannot be null");
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterpriseTestCase.java b/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterpriseTestCase.java
new file mode 100644
index 000000000..f3a83a77b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/BaseEnterpriseTestCase.java
@@ -0,0 +1,283 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.doReturn;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.annotation.UserIdInt;
+import android.app.AppOpsManager;
+import android.app.admin.DeviceAdminInfo;
+import android.app.admin.DevicePolicyManager;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.content.pm.UserInfo;
+import android.os.IBinder;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.RestrictedLockUtilsInternal;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public abstract class BaseEnterpriseTestCase {
+
+    protected static final UserHandle MY_USER_ID = UserHandle.of(UserHandle.myUserId());
+
+    protected final Context mRealContext = ApplicationProvider.getApplicationContext();
+    protected final Context mSpiedContext = spy(mRealContext);
+
+    protected final String mPackageName = mRealContext.getPackageName();
+
+    protected final PackageManager mRealPm = mRealContext.getPackageManager();
+    protected PackageManager mSpiedPm = spy(mRealPm);
+
+    protected final String mAppName = mRealContext.getApplicationInfo().loadLabel(mRealPm)
+            .toString();
+
+    protected final ComponentName mDefaultAdmin =
+            new ComponentName(mSpiedContext, DefaultDeviceAdminReceiver.class);
+    protected final ComponentName mFancyAdmin =
+            new ComponentName(mSpiedContext, FancyDeviceAdminReceiver.class);
+
+    protected ResolveInfo mDefaultResolveInfo;
+    protected ResolveInfo mFancyResolveInfo;
+    protected DeviceAdminInfo mDefaultDeviceAdminInfo;
+    protected DeviceAdminInfo mFancyDeviceAdminInfo;
+
+    @Mock
+    protected AppOpsManager mAppOpsMgr;
+
+    @Mock
+    protected DevicePolicyManager mDpm;
+
+    @Mock
+    protected UserManager mUm;
+
+    private MockitoSession mSession;
+
+    @Before
+    public final void setFixtures() throws Exception {
+        if (mSession != null) {
+            throw new IllegalStateException("Already set session - subclasses should NOT explicitly"
+                    + " call setFixtures()");
+        }
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .spyStatic(UserManager.class)
+                .mockStatic(RestrictedLockUtilsInternal.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        assertWithMessage("mDpm").that(mDpm).isNotNull();
+        assertWithMessage("mUm").that(mUm).isNotNull();
+
+        when(mSpiedContext.getSystemService(AppOpsManager.class)).thenReturn(mAppOpsMgr);
+        when(mSpiedContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mSpiedContext.getSystemService(PackageManager.class)).thenReturn(mSpiedPm);
+        when(mSpiedContext.getPackageManager()).thenReturn(mSpiedPm);
+        when(mSpiedContext.getSystemService(UserManager.class)).thenReturn(mUm);
+        doReturn(mUm).when(() -> UserManager.get(any()));
+
+        ActivityInfo defaultActivityInfo =
+                mRealPm.getReceiverInfo(mDefaultAdmin, PackageManager.GET_META_DATA);
+        mDefaultDeviceAdminInfo = new DeviceAdminInfo(mRealContext, defaultActivityInfo);
+        mDefaultResolveInfo = new ResolveInfo();
+        mDefaultResolveInfo.activityInfo = defaultActivityInfo;
+
+        ActivityInfo fancyActivityInfo =
+                mRealPm.getReceiverInfo(mFancyAdmin, PackageManager.GET_META_DATA);
+        mFancyDeviceAdminInfo = new DeviceAdminInfo(mRealContext, fancyActivityInfo);
+        mFancyResolveInfo = new ResolveInfo();
+        mFancyResolveInfo.activityInfo = fancyActivityInfo;
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+            mSession = null;
+        }
+    }
+
+    protected final void mockProfileOwner() {
+        mockActiveAdmin(mDefaultAdmin);
+        when(mDpm.getProfileOwner()).thenReturn(mDefaultAdmin);
+    }
+
+    protected final void mockProfileOwnerAsUser() {
+        when(mDpm.getProfileOwnerAsUser(MY_USER_ID)).thenReturn(mDefaultAdmin);
+        when(mDpm.getProfileOwnerAsUser(MY_USER_ID.getIdentifier())).thenReturn(mDefaultAdmin);
+    }
+
+    protected final void mockNoProfileOwnerAsUser() {
+        when(mDpm.getProfileOwnerAsUser(MY_USER_ID)).thenReturn(null);
+        when(mDpm.getProfileOwnerAsUser(MY_USER_ID.getIdentifier())).thenReturn(null);
+    }
+
+    protected final void mockDeviceOwner() {
+        when(mDpm.isDeviceManaged()).thenReturn(true);
+        mockActiveAdmin(mDefaultAdmin);
+        when(mDpm.isDeviceManaged()).thenReturn(true);
+        when(mDpm.getDeviceOwnerComponentOnCallingUser()).thenReturn(mDefaultAdmin);
+        when(mDpm.getDeviceOwnerComponentOnAnyUser()).thenReturn(mDefaultAdmin);
+    }
+
+    protected final void mockNoDeviceOwner() {
+        when(mDpm.getDeviceOwnerComponentOnCallingUser()).thenReturn(null);
+        when(mDpm.getDeviceOwnerComponentOnAnyUser()).thenReturn(null);
+    }
+
+    protected final void mockNotManaged() {
+        when(mDpm.isDeviceManaged()).thenReturn(false);
+    }
+
+    protected final void mockOrganizationName(String orgName) {
+        when(mDpm.getDeviceOwnerOrganizationName()).thenReturn(orgName);
+    }
+
+    protected final void mockFinancialDevice() {
+        when(mDpm.isDeviceManaged()).thenReturn(true);
+        when(mDpm.getDeviceOwnerType(mDefaultAdmin))
+                .thenReturn(DevicePolicyManager.DEVICE_OWNER_TYPE_FINANCED);
+    }
+
+    protected final void mockActiveAdmin(ComponentName componentName) {
+        when(mDpm.isAdminActive(componentName)).thenReturn(true);
+    }
+
+    protected final void mockInactiveAdmin(ComponentName componentName) {
+        when(mDpm.isAdminActive(componentName)).thenReturn(false);
+    }
+
+    protected final void mockGetActiveAdmins(ComponentName... componentNames) {
+        when(mDpm.getActiveAdmins()).thenReturn(Arrays.asList(componentNames));
+    }
+
+    protected final void mockQueryBroadcastReceivers(ResolveInfo... resolveInfoArray) {
+        // Need to use doReturn() instead of when() because mSpiedPm is a spy.
+        doReturn(Arrays.asList(resolveInfoArray))
+                .when(mSpiedPm).queryBroadcastReceivers(any(Intent.class), anyInt());
+    }
+
+    protected final void mockGetLongSupportMessageForUser(CharSequence message) {
+        when(mDpm.getLongSupportMessageForUser(eq(mDefaultAdmin), anyInt())).thenReturn(message);
+    }
+
+    protected final void mockRemovingAdmin(ComponentName admin, int userId) {
+        when(mDpm.isRemovingAdmin(admin, userId)).thenReturn(true);
+    }
+
+    protected final void mockGrantedPolicies(ComponentName admin, int ... policies) {
+        for (int policy: policies) {
+            when(mDpm.hasGrantedPolicy(admin, policy)).thenReturn(true);
+        }
+    }
+
+    protected final void mockHasDeviceAdminFeature() {
+        when(mSpiedPm.hasSystemFeature(PackageManager.FEATURE_DEVICE_ADMIN)).thenReturn(true);
+    }
+
+    protected final void mockNoDeviceAdminFeature() {
+        when(mSpiedPm.hasSystemFeature(PackageManager.FEATURE_DEVICE_ADMIN)).thenReturn(false);
+    }
+
+    protected final void mockSystemUser() {
+        when(mUm.isSystemUser()).thenReturn(true);
+    }
+
+    protected final void mockNonSystemUser() {
+        when(mUm.isSystemUser()).thenReturn(false);
+    }
+
+    protected final void mockNullEnforcedAdmin(String restriction, int userId) {
+        when(RestrictedLockUtilsInternal
+                .checkIfRestrictionEnforced(mSpiedContext, restriction, userId)).thenReturn(null);
+    }
+
+    protected final void mockGetLastBugreportTime(long time) {
+        when(mDpm.getLastBugReportRequestTime()).thenReturn(time);
+    }
+
+    protected final void mockCompMode() {
+        mockDeviceOwner();
+        UserInfo userInfo = new UserInfo(10, "UserAbc", null, 0,
+                UserManager.USER_TYPE_PROFILE_MANAGED);
+        when(mUm.getProfiles(anyInt())).thenReturn(Arrays.asList(userInfo));
+    }
+
+    protected final void mockGetLastNetworkLogRetrievalTime(long time) {
+        when(mDpm.getLastNetworkLogRetrievalTime()).thenReturn(time);
+    }
+
+    protected final void mockGetLastSecurityLogRetrievalTime(long time) {
+        when(mDpm.getLastSecurityLogRetrievalTime()).thenReturn(time);
+    }
+
+    protected final void mockIsCurrentInputMethodSetByOwner(boolean value) {
+        when(mDpm.isCurrentInputMethodSetByOwner()).thenReturn(value);
+    }
+
+    protected final void mockGetMaximumFailedPasswordsForWipe(@UserIdInt int userId, int max) {
+        when(mDpm.getMaximumFailedPasswordsForWipe(mDefaultAdmin, userId)).thenReturn(max);
+    }
+
+    protected final void verifyAdminActivated() {
+        verify(mDpm).setActiveAdmin(eq(mDefaultAdmin), anyBoolean());
+    }
+
+    protected final void verifyAdminNeverActivated() {
+        verify(mDpm, never()).setActiveAdmin(any(), anyBoolean());
+    }
+
+    protected final void verifyAdminDeactivated() {
+        verify(mDpm).removeActiveAdmin(mDefaultAdmin);
+    }
+
+    protected final void verifyAdminNeverDeactivated() {
+        verify(mDpm, never()).removeActiveAdmin(any());
+    }
+
+    protected final void verifyAppOpsMgrSetUserRestriction(int code, boolean restricted) {
+        verify(mAppOpsMgr).setUserRestriction(eq(code), eq(restricted), any(IBinder.class));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/BugReportsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/BugReportsPreferenceControllerTest.java
new file mode 100644
index 000000000..3b2d48e91
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/BugReportsPreferenceControllerTest.java
@@ -0,0 +1,66 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import android.text.format.DateUtils;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class BugReportsPreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private BugReportsPreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setUp() throws Exception {
+        mController = new BugReportsPreferenceController(mSpiedContext, mPreferenceKey,
+                mFragmentController, mUxRestrictions);
+    }
+
+    @Test
+    public void testUpdateState_noBugreport() {
+        mockGetLastBugreportTime(-1);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        verifyPreferenceSummarySet(mPreference, R.string.enterprise_privacy_none);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+
+    @Test
+    public void testUpdateState_withBugreport() {
+        long now = System.currentTimeMillis();
+        mockGetLastBugreportTime(now);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        String formattedDate = DateUtils.formatDateTime(mRealContext, now,
+                DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_SHOW_DATE);
+        verifyPreferenceSummarySet(mPreference, formattedDate);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/CaCertsCurrentUserPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/CaCertsCurrentUserPreferenceControllerTest.java
new file mode 100644
index 000000000..bfcd0319e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/CaCertsCurrentUserPreferenceControllerTest.java
@@ -0,0 +1,194 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.enterprise;
+
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.when;
+
+import android.net.ConnectivityManager;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import com.google.common.collect.ImmutableList;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+import java.util.Collections;
+
+public final class CaCertsCurrentUserPreferenceControllerTest extends
+        BaseEnterprisePrivacyPreferenceControllerTestCase {
+    private CaCertsCurrentUserPreferenceController mCaCertsCurrentUserPreferenceController;
+    private Preference mPreference;
+
+    @Mock
+    private ConnectivityManager mConnectivityManager;
+
+    @Before
+    public void setUp() {
+        when(mSpiedContext.getSystemService(ConnectivityManager.class))
+                .thenReturn(mConnectivityManager);
+        mPreference = new Preference(mSpiedContext);
+        mCaCertsCurrentUserPreferenceController = new CaCertsCurrentUserPreferenceController(
+                mSpiedContext, mPreferenceKey, mFragmentController, mUxRestrictions);
+    }
+
+    @Test
+    public void testNoInstalledCaCerts_preferenceDisabled() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(Collections.emptyList());
+
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mRealContext.getResources().getQuantityString(
+                        R.plurals.enterprise_privacy_number_ca_certs, 0, 0));
+    }
+
+    @Test
+    public void testNoInstalledCaCerts_preferenceDisabled_zoneWrite() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(Collections.emptyList());
+
+        mCaCertsCurrentUserPreferenceController.setAvailabilityStatusForZone("write");
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mRealContext.getResources().getQuantityString(
+                        R.plurals.enterprise_privacy_number_ca_certs, 0, 0));
+    }
+
+    @Test
+    public void testNoInstalledCaCerts_preferenceDisabled_zoneRead() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(Collections.emptyList());
+
+        mCaCertsCurrentUserPreferenceController.setAvailabilityStatusForZone("read");
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mRealContext.getResources().getQuantityString(
+                        R.plurals.enterprise_privacy_number_ca_certs, 0, 0));
+    }
+
+    @Test
+    public void testNoInstalledCaCerts_preferenceDisabled_zoneHidden() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(Collections.emptyList());
+
+        mCaCertsCurrentUserPreferenceController.setAvailabilityStatusForZone("hidden");
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mRealContext.getResources().getQuantityString(
+                        R.plurals.enterprise_privacy_number_ca_certs, 0, 0));
+    }
+
+    @Test
+    public void testInstalledCaCerts_preferenceEnabled() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(ImmutableList.of("cert1", "cert2"));
+
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        assertThat(mPreference.getSummary()).isEqualTo(mRealContext.getResources()
+                .getQuantityString(R.plurals.enterprise_privacy_number_ca_certs, 2, 2));
+    }
+
+    @Test
+    public void testInstalledCaCerts_preferenceEnabled_zoneWrite() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(ImmutableList.of("cert1", "cert2"));
+
+        mCaCertsCurrentUserPreferenceController.setAvailabilityStatusForZone("write");
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        assertThat(mPreference.getSummary()).isEqualTo(mRealContext.getResources()
+                .getQuantityString(R.plurals.enterprise_privacy_number_ca_certs, 2, 2));
+    }
+
+    @Test
+    public void testInstalledCaCerts_preferenceEnabled_zoneRead() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(ImmutableList.of("cert1", "cert2"));
+
+        mCaCertsCurrentUserPreferenceController.setAvailabilityStatusForZone("read");
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.getSummary()).isEqualTo(mRealContext.getResources()
+                .getQuantityString(R.plurals.enterprise_privacy_number_ca_certs, 2, 2));
+    }
+
+    @Test
+    public void testInstalledCaCerts_preferenceEnabled_zoneHidden() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(ImmutableList.of("cert1", "cert2"));
+
+        mCaCertsCurrentUserPreferenceController.setAvailabilityStatusForZone("hidden");
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mCaCertsCurrentUserPreferenceController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+        assertThat(mPreference.getSummary()).isEqualTo(mRealContext.getResources()
+                .getQuantityString(R.plurals.enterprise_privacy_number_ca_certs, 2, 2));
+    }
+
+    @Test
+    public void testNoCompMode_showsRegularTitle() {
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(ImmutableList.of("cert1", "cert2"));
+
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.getTitle()).isEqualTo(mRealContext.getResources()
+                .getString(R.string.enterprise_privacy_ca_certs_device));
+    }
+
+    @Test
+    public void testCompMode_showsPersonalProfileTitle() {
+        mockCompMode();
+        when(mDpm.getOwnerInstalledCaCerts(any())).thenReturn(ImmutableList.of("cert1", "cert2"));
+
+        mCaCertsCurrentUserPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.getTitle()).isEqualTo(mRealContext.getResources()
+                .getString(R.string.enterprise_privacy_ca_certs_personal));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DefaultDeviceAdminReceiver.java b/tests/multivalent/src/com/android/car/settings/enterprise/DefaultDeviceAdminReceiver.java
new file mode 100644
index 000000000..3afbb90f8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DefaultDeviceAdminReceiver.java
@@ -0,0 +1,22 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import android.app.admin.DeviceAdminReceiver;
+
+public final class DefaultDeviceAdminReceiver extends DeviceAdminReceiver {
+
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminActivatedAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminActivatedAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..9685edcb8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminActivatedAppsPreferenceControllerTest.java
@@ -0,0 +1,87 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public final class DeviceAdminActivatedAppsPreferenceControllerTest
+        extends BaseEnterprisePreferenceControllerTestCase {
+
+    private DeviceAdminAppsPreferenceController mController;
+    private BaseEnterprisePreferenceControllerTestCase.DummyPreferenceGroup mPreferenceGroup;
+
+    @Before
+    @UiThreadTest
+    public void setUp() throws Exception {
+        mController = new DeviceAdminActivatedAppsPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+        mPreferenceGroup = new DummyPreferenceGroup(mSpiedContext);
+    }
+
+    @Test
+    public void testUpdateState_noBroadcastReceivers() {
+        mockQueryBroadcastReceivers();
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup,
+                mRealContext.getString(R.string.device_admin_apps_list_empty));
+    }
+
+    @Test
+    public void testUpdateState_noActivatedAdminApp() {
+        mockQueryBroadcastReceivers(mDefaultResolveInfo, mFancyResolveInfo);
+        mockInactiveAdmin(mDefaultAdmin);
+        mockInactiveAdmin(mFancyAdmin);
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup,
+                mRealContext.getString(R.string.device_admin_apps_list_empty));
+    }
+
+    @Test
+    public void testUpdateState_singleActivatedAdminApp() {
+        mockQueryBroadcastReceivers(mDefaultResolveInfo, mFancyResolveInfo);
+        mockInactiveAdmin(mDefaultAdmin);
+        mockActiveAdmin(mFancyAdmin);
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup, mFancyDeviceAdminInfo.loadLabel(mRealPm));
+    }
+
+    @Test
+    public void testUpdateState_multipleActivatedAdminApps() {
+        mockQueryBroadcastReceivers(mDefaultResolveInfo, mFancyResolveInfo);
+        mockActiveAdmin(mDefaultAdmin);
+        mockActiveAdmin(mFancyAdmin);
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup,
+                mDefaultDeviceAdminInfo.loadLabel(mRealPm),
+                mFancyDeviceAdminInfo.loadLabel(mRealPm));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddActivityTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddActivityTest.java
new file mode 100644
index 000000000..fcd2bd6eb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddActivityTest.java
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static android.car.test.mocks.AndroidMockitoHelper.syncCallOnMainThread;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import androidx.fragment.app.Fragment;
+
+import org.junit.Test;
+
+public final class DeviceAdminAddActivityTest extends BaseEnterpriseTestCase {
+
+    @Test
+    public void testGetFragment() throws Exception {
+        Fragment fragment = syncCallOnMainThread(() ->
+                // DeviceAdminAddActivity must be created in the main thread
+                new DeviceAdminAddActivity().getInitialFragment());
+        assertWithMessage("initial fragment class").that(fragment)
+                .isInstanceOf(DeviceAdminAddFragment.class);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddExplanationPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddExplanationPreferenceControllerTest.java
new file mode 100644
index 000000000..4a957876f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddExplanationPreferenceControllerTest.java
@@ -0,0 +1,352 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class DeviceAdminAddExplanationPreferenceControllerTest extends
+        BaseEnterprisePreferenceControllerTestCase {
+
+    @Mock
+    private Preference mPreference;
+
+    private DeviceAdminAddExplanationPreferenceController mController;
+
+    @Before
+    public void setController() {
+        mController = new DeviceAdminAddExplanationPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+        mController.setDeviceAdmin(mDefaultDeviceAdminInfo);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin() throws Exception {
+        DeviceAdminAddExplanationPreferenceController controller =
+                new DeviceAdminAddExplanationPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        mController.setExplanation("To conquer the universe");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneWrite() throws Exception {
+        DeviceAdminAddExplanationPreferenceController controller =
+                new DeviceAdminAddExplanationPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneRead() throws Exception {
+        DeviceAdminAddExplanationPreferenceController controller =
+                new DeviceAdminAddExplanationPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneHidden() throws Exception {
+        DeviceAdminAddExplanationPreferenceController controller =
+                new DeviceAdminAddExplanationPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_noReason() throws Exception {
+        mockDeviceOwner();
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_noReason_zoneWrite() throws Exception {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_noReason_zoneRead() throws Exception {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_noReason_zoneHidden() throws Exception {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_withReason() throws Exception {
+        mockDeviceOwner();
+        mController.setExplanation("To conquer the universe");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_withReason_zoneWrite() throws Exception {
+        mockDeviceOwner();
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_withReason_zoneRead() throws Exception {
+        mockDeviceOwner();
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_withReason_zoneHidden() throws Exception {
+        mockDeviceOwner();
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_noReason() throws Exception {
+        mockProfileOwner();
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_noReason_zoneWrite() throws Exception {
+        mockProfileOwner();
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_noReason_zoneRead() throws Exception {
+        mockProfileOwner();
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_noReason_zoneHidden() throws Exception {
+        mockProfileOwner();
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_withReason() throws Exception {
+        mockProfileOwner();
+        mController.setExplanation("To conquer the universe");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_withReason_zoneWrite() throws Exception {
+        mockProfileOwner();
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_withReason_zoneRead() throws Exception {
+        mockProfileOwner();
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_withReason_zoneHidden() throws Exception {
+        mockProfileOwner();
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetRealAvailabilityStatus_nullReason() throws Exception {
+        mController.setExplanation(null);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetRealAvailabilityStatus_nullReason_zoneWrite() throws Exception {
+        mController.setExplanation(null);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetRealAvailabilityStatus_nullReason_zoneRead() throws Exception {
+        mController.setExplanation(null);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetRealAvailabilityStatus_nullReason_zoneHidden() throws Exception {
+        mController.setExplanation(null);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyReason() throws Exception {
+        mController.setExplanation("");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyReason_zoneWrite() throws Exception {
+        mController.setExplanation("");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyReason_zoneRead() throws Exception {
+        mController.setExplanation("");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyReason_zoneHidden() throws Exception {
+        mController.setExplanation("");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validReason() throws Exception {
+        mController.setExplanation("To conquer the universe");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validReason_zoneWrite() throws Exception {
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validReason_zoneRead() throws Exception {
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validReason_zoneHidden() throws Exception {
+        mController.setExplanation("To conquer the universe");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testUpdateState() throws Exception {
+        mController.setExplanation("To conquer the universe");
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleSet(mPreference, "To conquer the universe");
+        verifyPreferenceSummaryNeverSet(mPreference);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddFragmentTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddFragmentTest.java
new file mode 100644
index 000000000..35a8a8861
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddFragmentTest.java
@@ -0,0 +1,541 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static android.app.Activity.RESULT_CANCELED;
+import static android.app.Activity.RESULT_OK;
+import static android.app.admin.DeviceAdminInfo.USES_ENCRYPTED_STORAGE;
+import static android.app.admin.DeviceAdminInfo.USES_POLICY_EXPIRE_PASSWORD;
+import static android.app.admin.DeviceAdminInfo.USES_POLICY_FORCE_LOCK;
+import static android.app.admin.DeviceAdminInfo.USES_POLICY_LIMIT_PASSWORD;
+import static android.app.admin.DeviceAdminInfo.USES_POLICY_RESET_PASSWORD;
+import static android.app.admin.DeviceAdminInfo.USES_POLICY_WATCH_LOGIN;
+import static android.app.admin.DeviceAdminInfo.USES_POLICY_WIPE_DATA;
+import static android.app.admin.DevicePolicyManager.ACTION_ADD_DEVICE_ADMIN;
+import static android.app.admin.DevicePolicyManager.EXTRA_ADD_EXPLANATION;
+import static android.app.admin.DevicePolicyManager.EXTRA_DEVICE_ADMIN;
+import static android.car.test.mocks.AndroidMockitoHelper.syncCallOnMainThread;
+
+import static com.android.car.settings.enterprise.DeviceAdminAddActivity.EXTRA_DEVICE_ADMIN_PACKAGE_NAME;
+import static com.android.car.settings.enterprise.DeviceAdminAddFragment.UNINSTALL_DEVICE_ADMIN_REQUEST_CODE;
+
+import static com.google.common.truth.Truth.assertThat;
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.argThat;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.Activity;
+import android.app.admin.DevicePolicyManager;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.content.res.XmlResourceParser;
+
+import androidx.fragment.app.FragmentActivity;
+import androidx.preference.PreferenceScreen;
+import androidx.test.core.app.ApplicationProvider;
+
+import com.android.car.settings.R;
+import com.android.car.settings.enterprise.DeviceAdminAddHeaderPreferenceController.ActivationListener;
+import com.android.car.ui.toolbar.MenuItem;
+import com.android.car.ui.toolbar.ToolbarController;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+
+import java.util.Arrays;
+
+public final class DeviceAdminAddFragmentTest extends BaseEnterpriseTestCase {
+
+    private static final String EXPLANATION = "To get to the other side";
+
+    private final Context mRealContext = ApplicationProvider.getApplicationContext();
+
+    private DeviceAdminAddFragment mRealFragment;
+    private DeviceAdminAddFragment mSpiedFragment;
+
+    @Mock
+    private ToolbarController mToolbarController;
+
+    @Mock
+    private FragmentActivity mActivity;
+
+    @Mock
+    private PreferenceScreen mPreferenceScreen;
+
+    @Mock
+    private DeviceAdminAddHeaderPreferenceController mHeaderController;
+    @Mock
+    private DeviceAdminAddExplanationPreferenceController mExplanationController;
+    @Mock
+    private DeviceAdminAddSupportPreferenceController mSupportController;
+    @Mock
+    private DeviceAdminAddWarningPreferenceController mWarningController;
+    @Mock
+    private DeviceAdminAddPoliciesPreferenceController mPoliciesController;
+
+    @Captor
+    private ArgumentCaptor<ActivationListener> mActivationListenerCaptor;
+
+    @Before
+    public void createFragments() throws Exception {
+        mRealFragment = syncCallOnMainThread(() -> new DeviceAdminAddFragment());
+        mSpiedFragment = spy(mRealFragment);
+
+        when(mExplanationController.setDeviceAdmin(any())).thenReturn(mExplanationController);
+        when(mHeaderController.setDeviceAdmin(any())).thenReturn(mHeaderController);
+
+        // Note: Must use doReturn (instead of when..doReturn() below because it's a spy
+        doReturn(mActivity).when(mSpiedFragment).requireActivity();
+        doReturn(mHeaderController).when(mSpiedFragment)
+                .use(eq(DeviceAdminAddHeaderPreferenceController.class), anyInt());
+        doReturn(mExplanationController).when(mSpiedFragment)
+                .use(eq(DeviceAdminAddExplanationPreferenceController.class), anyInt());
+        doReturn(mSupportController).when(mSpiedFragment)
+                .use(eq(DeviceAdminAddSupportPreferenceController.class), anyInt());
+        doReturn(mWarningController).when(mSpiedFragment)
+                .use(eq(DeviceAdminAddWarningPreferenceController.class), anyInt());
+        doReturn(mPoliciesController).when(mSpiedFragment)
+                .use(eq(DeviceAdminAddPoliciesPreferenceController.class), anyInt());
+    }
+
+    @Test
+    public void testGetPreferenceScreenResId() {
+        int resId = mRealFragment.getPreferenceScreenResId();
+
+        XmlResourceParser parser = mRealContext.getResources().getXml(resId);
+        assertWithMessage("xml with id %s", resId).that(parser).isNotNull();
+    }
+
+    @Test
+    public void testSetupToolbar_noIntent() {
+        mSpiedFragment.setToolbarTitle(mToolbarController);
+
+        verify(mToolbarController, never()).setTitle(anyInt());
+    }
+
+    @Test
+    public void testSetupToolbar_notFromActionAddDeviceAdmin() {
+        mockActivityIntent(new Intent());
+
+        mSpiedFragment.setToolbarTitle(mToolbarController);
+
+        verify(mToolbarController, never()).setTitle(anyInt());
+    }
+
+    @Test
+    public void testSetupToolbar_fromActionAddDeviceAdmin() {
+        mockActivityIntent(new Intent(DevicePolicyManager.ACTION_ADD_DEVICE_ADMIN));
+
+        mSpiedFragment.setToolbarTitle(mToolbarController);
+
+        verify(mToolbarController).setTitle(R.string.add_device_admin_msg);
+    }
+
+    @Test
+    public void testAttach_noIntent() {
+        mRealFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_noExtra() {
+        mockActivityIntent(new Intent());
+
+        mRealFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_adminExtra_adminNotFound() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN, new ComponentName("Guy", "Incognito")));
+
+        mRealFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_adminExtra_ok_active() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockActiveAdmin(mDefaultAdmin);
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityNeverFinished();
+        verifyControllersUsed(mDefaultAdmin);
+    }
+
+    @Test
+    public void testAttach_addDeviceAdminAction_active() {
+        mockActivityIntent(new Intent(ACTION_ADD_DEVICE_ADMIN)
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockActiveAdmin(mDefaultAdmin);
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verityActivityResultSet(Activity.RESULT_OK);
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_addDeviceAdminAction_active_removing() {
+        mockActivityIntent(new Intent(ACTION_ADD_DEVICE_ADMIN)
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockActiveAdmin(mDefaultAdmin);
+        mockRemovingAdmin(mDefaultAdmin, mSpiedContext.getUserId());
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verityActivityResultNeverSet();
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_addDeviceAdminAction_active_noRefreshing() {
+        mockActivityIntent(new Intent(ACTION_ADD_DEVICE_ADMIN)
+                .putExtra(EXTRA_DEVICE_ADMIN, mFancyAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockActiveAdmin(mFancyAdmin);
+        // Grant all policies that mFancyAdmin has.
+        mockGrantedPolicies(mFancyAdmin, USES_POLICY_LIMIT_PASSWORD, USES_POLICY_WATCH_LOGIN,
+                USES_POLICY_RESET_PASSWORD, USES_POLICY_FORCE_LOCK, USES_POLICY_WIPE_DATA,
+                USES_POLICY_EXPIRE_PASSWORD, USES_ENCRYPTED_STORAGE);
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verityActivityResultSet(Activity.RESULT_OK);
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_addDeviceAdminAction_active_refreshing() {
+        mockActivityIntent(new Intent(ACTION_ADD_DEVICE_ADMIN)
+                .putExtra(EXTRA_DEVICE_ADMIN, mFancyAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockActiveAdmin(mFancyAdmin);
+        // Grant all policies that mFancyAdmin has besides USES_ENCRYPTED_STORAGE.
+        mockGrantedPolicies(mFancyAdmin, USES_POLICY_LIMIT_PASSWORD, USES_POLICY_WATCH_LOGIN,
+                USES_POLICY_RESET_PASSWORD, USES_POLICY_FORCE_LOCK, USES_POLICY_WIPE_DATA,
+                USES_POLICY_EXPIRE_PASSWORD);
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityNeverFinished();
+        verifyControllersUsed(mFancyAdmin);
+    }
+
+    @Test
+    public void testAttach_addDeviceAdminAction_inactive_userActivates() {
+        ActivationListener listener = attachActivityForResultTesting(ACTION_ADD_DEVICE_ADMIN);
+
+        listener.onChanged(true);
+
+        verityActivityResultSet(Activity.RESULT_OK);
+        verifyActivityNeverFinished();
+    }
+
+    @Test
+    public void testAttach_addDeviceAdminAction_inactive_userDeactivates() {
+        ActivationListener listener = attachActivityForResultTesting(ACTION_ADD_DEVICE_ADMIN);
+
+        listener.onChanged(false);
+
+        verityActivityResultSet(Activity.RESULT_CANCELED);
+        verifyActivityNeverFinished();
+    }
+
+    @Test
+    public void testAttach_inactive_notDeviceAdminAction() {
+        ActivationListener listener = attachActivityForResultTesting("ACTION_JACKSON");
+
+        listener.onChanged(true); // value doesn't matter
+
+        verityActivityResultNeverSet();
+        verifyActivityNeverFinished();
+    }
+
+    @Test
+    public void testAttach_adminExtra_ok_inactiveButValid() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockInactiveAdmin(mDefaultAdmin);
+        mockValidAdmin();
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityNeverFinished();
+        verifyControllersUsed(mDefaultAdmin);
+    }
+
+    // TODO(b/202342351): add similar test for when new DeviceAdminInfo(context, ri) throws an
+    // exception (for example, when metadata is invalid).
+    @Test
+    public void testAttach_adminExtra_adminFoundButInvalid() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockInactiveAdmin(mDefaultAdmin);
+        // Don't need to mock pm
+
+        mRealFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_packageExtra_adminNotFound() {
+        mockActivityIntent(new Intent().putExtra(EXTRA_DEVICE_ADMIN_PACKAGE_NAME, "D'OH!"));
+
+        mRealFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityFinished();
+        verifyControllersNeverUsed();
+    }
+
+    @Test
+    public void testAttach_packageExtra_ok() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN_PACKAGE_NAME, mPackageName)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockGetActiveAdmins(mDefaultAdmin);
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verifyActivityNeverFinished();
+        verifyControllersUsed(mDefaultAdmin);
+    }
+
+    @Test
+    public void testAttach_adminExtra_doesNotShowUninstallButton() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockValidAdmin();
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verify(mSpiedFragment).setUninstallButton(any(Context.class), eq(false));
+    }
+
+    @Test
+    public void testAttach_packageExtra_showsUninstallButton() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN_PACKAGE_NAME, mPackageName)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockGetActiveAdmins(mDefaultAdmin);
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verify(mSpiedFragment).setUninstallButton(any(Context.class), eq(true));
+    }
+
+    @Test
+    public void testSetUninstallButton_showButtonFalse() {
+        mRealFragment.setUninstallButton(mRealContext, false);
+
+        MenuItem button = mRealFragment.getToolbarMenuItems().get(0);
+        assertThat(button).isNotNull();
+        assertThat(button.getTitle().toString())
+                .isEqualTo(mRealContext.getString(R.string.deactivate_and_uninstall_device_admin));
+        assertThat(button.isEnabled()).isFalse();
+        assertThat(button.isVisible()).isFalse();
+    }
+
+    @Test
+    public void testSetUninstallButton_showButtonTrue() {
+        mRealFragment.setUninstallButton(mRealContext, true);
+
+        MenuItem button = mRealFragment.getToolbarMenuItems().get(0);
+        assertThat(button).isNotNull();
+        assertThat(button.getTitle().toString())
+                .isEqualTo(mRealContext.getString(R.string.deactivate_and_uninstall_device_admin));
+        assertThat(button.isEnabled()).isTrue();
+        assertThat(button.isVisible()).isTrue();
+    }
+
+    @Test
+    public void testUninstallOnClickListener_activeAdmin() {
+        mSpiedFragment.setDevicePolicyManager(mDpm);
+        mSpiedFragment.setPackageToUninstall(mPackageName, mDefaultAdmin);
+        mSpiedFragment.setUninstallButton(mSpiedContext, true);
+        mockActiveAdmin(mDefaultAdmin);
+        doNothing().when(mSpiedFragment).startActivityForResult(any(Intent.class), anyInt());
+
+        mSpiedFragment.getToolbarMenuItems().get(0).getOnClickListener().onClick(/* item= */ null);
+
+        ArgumentCaptor<Intent> intentArgumentCaptor = ArgumentCaptor.forClass(
+                Intent.class);
+        verify(mSpiedFragment).startActivityForResult(intentArgumentCaptor.capture(),
+                eq(UNINSTALL_DEVICE_ADMIN_REQUEST_CODE));
+
+        Intent intent = intentArgumentCaptor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_UNINSTALL_PACKAGE);
+        assertThat(intent.getData().toString()).isEqualTo("package:" + mPackageName);
+        assertThat(intent.getBooleanExtra(Intent.EXTRA_RETURN_RESULT, false)).isTrue();
+        verify(mDpm).removeActiveAdmin(mDefaultAdmin);
+    }
+
+    @Test
+    public void testUninstallOnClickListener_inactiveAdmin() {
+        mSpiedFragment.setDevicePolicyManager(mDpm);
+        mSpiedFragment.setPackageToUninstall(mPackageName, mDefaultAdmin);
+        mSpiedFragment.setUninstallButton(mSpiedContext, true);
+        mockInactiveAdmin(mDefaultAdmin);
+        doNothing().when(mSpiedFragment).startActivityForResult(any(Intent.class), anyInt());
+
+        mSpiedFragment.getToolbarMenuItems().get(0).getOnClickListener().onClick(/* item= */ null);
+
+        ArgumentCaptor<Intent> intentArgumentCaptor = ArgumentCaptor.forClass(
+                Intent.class);
+        verify(mSpiedFragment).startActivityForResult(intentArgumentCaptor.capture(),
+                eq(UNINSTALL_DEVICE_ADMIN_REQUEST_CODE));
+
+        Intent intent = intentArgumentCaptor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_UNINSTALL_PACKAGE);
+        assertThat(intent.getData().toString()).isEqualTo("package:" + mPackageName);
+        assertThat(intent.getBooleanExtra(Intent.EXTRA_RETURN_RESULT, false)).isTrue();
+        verify(mDpm, never()).removeActiveAdmin(mDefaultAdmin);
+    }
+
+    @Test
+    public void testOnActivityResult_resultOk() {
+        mSpiedFragment.onActivityResult(UNINSTALL_DEVICE_ADMIN_REQUEST_CODE, RESULT_OK, null);
+
+        verify(mActivity).setResult(RESULT_OK);
+        verify(mActivity).finish();
+    }
+
+    @Test
+    public void testOnActivityResult_resultNotOk() {
+        mSpiedFragment.onActivityResult(UNINSTALL_DEVICE_ADMIN_REQUEST_CODE, RESULT_CANCELED,
+                null);
+
+        verify(mActivity, never()).setResult(anyInt());
+        verify(mActivity, never()).finish();
+    }
+
+    @Test
+    public void testSetPreferenceScreenTitle() {
+        mockActivityIntent(new Intent()
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin)
+                .putExtra(EXTRA_ADD_EXPLANATION, EXPLANATION));
+        mockActiveAdmin(mDefaultAdmin);
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        mSpiedFragment.setPreferenceScreenTitle(mPreferenceScreen);
+
+        verify(mPreferenceScreen).setTitle((mDefaultDeviceAdminInfo.loadLabel(mRealPm)));
+    }
+
+    private ActivationListener attachActivityForResultTesting(String action) {
+        mockValidAdmin();
+        mockActivityIntent(new Intent(action)
+                .putExtra(EXTRA_DEVICE_ADMIN, mDefaultAdmin));
+
+        mSpiedFragment.onAttach(mSpiedContext, mActivity);
+
+        verify(mHeaderController).setActivationListener(mActivationListenerCaptor.capture());
+        return mActivationListenerCaptor.getValue();
+    }
+
+    private void mockActivityIntent(Intent intent) {
+        when(mActivity.getIntent()).thenReturn(intent);
+    }
+
+    private void mockValidAdmin() {
+        // TODO(b/202342351): use a custom matcher for
+        // DeviceAdminReceiver.ACTION_DEVICE_ADMIN_ENABLED instead of any()
+        doReturn(Arrays.asList(mDefaultResolveInfo)).when(mSpiedPm).queryBroadcastReceivers(any(),
+                eq(PackageManager.GET_DISABLED_UNTIL_USED_COMPONENTS));
+    }
+
+    private void verifyActivityFinished() {
+        verify(mActivity).finish();
+    }
+
+    private void verifyActivityNeverFinished() {
+        verify(mActivity, never()).finish();
+    }
+
+    private void verityActivityResultSet(int result) {
+        verify(mActivity).setResult(result);
+    }
+
+    private void verityActivityResultNeverSet() {
+        verify(mActivity, never()).setResult(anyInt());
+    }
+
+    private void verifyControllersNeverUsed() {
+        verify(mSpiedFragment, never()).use(any(), anyInt());
+    }
+
+    private void verifyControllersUsed(ComponentName admin) {
+        verify(mSpiedFragment).use(DeviceAdminAddHeaderPreferenceController.class,
+                R.string.pk_device_admin_add_header);
+        verifySetDeviceAdmin(mHeaderController, admin);
+        verify(mHeaderController).setActivationListener(any());
+
+        verify(mSpiedFragment).use(DeviceAdminAddExplanationPreferenceController.class,
+                R.string.pk_device_admin_add_explanation);
+        verifySetDeviceAdmin(mExplanationController, admin);
+        verify(mExplanationController).setExplanation(EXPLANATION);
+
+        verify(mSpiedFragment).use(DeviceAdminAddSupportPreferenceController.class,
+                R.string.pk_device_admin_add_support);
+        verifySetDeviceAdmin(mSupportController, admin);
+
+        verify(mSpiedFragment).use(DeviceAdminAddWarningPreferenceController.class,
+                R.string.pk_device_admin_add_warning);
+        verifySetDeviceAdmin(mWarningController, admin);
+
+        verify(mSpiedFragment).use(DeviceAdminAddPoliciesPreferenceController.class,
+                R.string.pk_device_admin_add_policies);
+        verifySetDeviceAdmin(mPoliciesController, admin);
+    }
+
+    private void verifySetDeviceAdmin(BaseDeviceAdminAddPreferenceController<?> controller,
+            ComponentName admin) {
+        verify(controller).setDeviceAdmin(argThat(info->info.getComponent().equals(admin)));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddHeaderPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddHeaderPreferenceControllerTest.java
new file mode 100644
index 000000000..8bb50d1fa
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddHeaderPreferenceControllerTest.java
@@ -0,0 +1,288 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.app.AppOpsManager;
+
+import androidx.preference.TwoStatePreference;
+
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.DeviceAdminAddHeaderPreferenceController.ActivationListener;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class DeviceAdminAddHeaderPreferenceControllerTest extends
+        BaseEnterprisePreferenceControllerTestCase {
+
+    private DeviceAdminAddHeaderPreferenceController mController;
+
+    @Mock
+    private TwoStatePreference mPreference;
+
+    @Mock
+    private ActivationListener mActivationListener;
+
+    @Before
+    public void setController() {
+        mController = new DeviceAdminAddHeaderPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+        mController.setDeviceAdmin(mDefaultDeviceAdminInfo);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_admin() throws Exception {
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_admin_zoneWrite() throws Exception {
+        mController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_admin_zoneRead() throws Exception {
+        mController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_admin_zoneHidden() throws Exception {
+        mController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin() throws Exception {
+        DeviceAdminAddHeaderPreferenceController controller =
+                new DeviceAdminAddHeaderPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneWrite() throws Exception {
+        DeviceAdminAddHeaderPreferenceController controller =
+                new DeviceAdminAddHeaderPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneRead() throws Exception {
+        DeviceAdminAddHeaderPreferenceController controller =
+                new DeviceAdminAddHeaderPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneHidden() throws Exception {
+        DeviceAdminAddHeaderPreferenceController controller =
+                new DeviceAdminAddHeaderPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testOnResumeInternal_inactiveAdmin() throws Exception {
+        mockInactiveAdmin(mDefaultAdmin);
+
+        mController.onResumeInternal(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, false);
+        verifyPreferenceEnabled(mPreference);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_SYSTEM_ALERT_WINDOW,
+                /* restricted= */ true);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_TOAST_WINDOW, /* restricted= */ true);
+    }
+
+    @Test
+    public void testOnResumeInternal_activeAdmin() throws Exception {
+        mockActiveAdmin(mDefaultAdmin);
+
+        mController.onResumeInternal(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, true);
+        verifyPreferenceEnabled(mPreference);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_SYSTEM_ALERT_WINDOW,
+                /* restricted= */ true);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_TOAST_WINDOW, /* restricted= */ true);
+    }
+
+    @Test
+    public void testOnResumeInternal_deviceOwner() throws Exception {
+        mockDeviceOwner();
+
+        mController.onResumeInternal(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, true);
+        verifyPreferenceDisabled(mPreference);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_SYSTEM_ALERT_WINDOW,
+                /* restricted= */ true);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_TOAST_WINDOW, /* restricted= */ true);
+    }
+
+    @Test
+    public void testOnPauseInternal() throws Exception {
+        mController.onPauseInternal(mPreference);
+
+        verifyPreferenceDisabled(mPreference);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_SYSTEM_ALERT_WINDOW,
+                /* restricted= */ false);
+        verifyAppOpsMgrSetUserRestriction(AppOpsManager.OP_TOAST_WINDOW, /* restricted= */ false);
+    }
+
+    @Test
+    public void testUpdateState_activeAdminWithNoProperties() throws Exception {
+        mockActiveAdmin(mDefaultAdmin);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, true);
+        verifyPreferenceEnabled(mPreference);
+        verifyPreferenceTitleSet(mPreference, mDefaultDeviceAdminInfo.loadLabel(mRealPm));
+        verifyPreferenceSummaryNeverSet(mPreference);
+        verifyPreferenceIconSet(mPreference);
+    }
+
+    @Test
+    public void testUpdateState_activeAdminWithAllProperties() throws Exception {
+        mController.setDeviceAdmin(mFancyDeviceAdminInfo);
+        mockActiveAdmin(mFancyAdmin);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, true);
+        verifyPreferenceEnabled(mPreference);
+        verifyPreferenceTitleSet(mPreference, mFancyDeviceAdminInfo.loadLabel(mRealPm));
+        verifyPreferenceSummarySet(mPreference, mFancyDeviceAdminInfo.loadDescription(mRealPm));
+        verifyPreferenceIconSet(mPreference);
+    }
+
+    @Test
+    public void testUpdateStatus_inactiveAdmin() throws Exception {
+        mockInactiveAdmin(mDefaultAdmin);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, false);
+        verifyPreferenceEnabled(mPreference);
+        verifyPreferenceTitleSet(mPreference, mDefaultDeviceAdminInfo.loadLabel(mRealPm));
+    }
+
+    @Test
+    public void testUpdateStatus_deviceOwner() throws Exception {
+        mockDeviceOwner();
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, true);
+        verifyPreferenceDisabled(mPreference);
+        verifyPreferenceTitleSet(mPreference, mDefaultDeviceAdminInfo.loadLabel(mRealPm));
+    }
+
+    @Test
+    public void testUpdateStatus_profileOwner() throws Exception {
+        mockProfileOwner();
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceSetChecked(mPreference, true);
+        verifyPreferenceDisabled(mPreference);
+        verifyPreferenceTitleSet(mPreference, mDefaultDeviceAdminInfo.loadLabel(mRealPm));
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_activateAdmin_withoutListener() {
+        mockInactiveAdmin(mDefaultAdmin);
+
+        mController.handlePreferenceChanged(mPreference, true);
+
+        verifyAdminNeverDeactivated();
+        verifyAdminActivated();
+        verifyActivationListenerNotCalled();
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_activateAdmin_withListener() {
+        mockInactiveAdmin(mDefaultAdmin);
+        mController.setActivationListener(mActivationListener);
+
+        mController.handlePreferenceChanged(mPreference, true);
+
+        verifyAdminNeverDeactivated();
+        verifyAdminActivated();
+        verifyActivationListenerCalled(true);
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_deactivateAdmin_withoutListener() {
+        mockActiveAdmin(mDefaultAdmin);
+
+        mController.handlePreferenceChanged(mPreference, false);
+
+        verifyAdminNeverActivated();
+        verifyAdminDeactivated();
+        verifyActivationListenerNotCalled();
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_deactivateAdmin_withListener() {
+        mockActiveAdmin(mDefaultAdmin);
+        mController.setActivationListener(mActivationListener);
+
+        mController.handlePreferenceChanged(mPreference, false);
+
+        verifyAdminNeverActivated();
+        verifyAdminDeactivated();
+        verifyActivationListenerCalled(false);
+    }
+
+    private void verifyPreferenceSetChecked(TwoStatePreference preference, boolean isChecked) {
+        verify(preference).setChecked(isChecked);
+    }
+
+    private void verifyActivationListenerNotCalled() {
+        verify(mActivationListener, never()).onChanged(anyBoolean());
+    }
+
+    private void verifyActivationListenerCalled(boolean active) {
+        verify(mActivationListener).onChanged(active);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddPoliciesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddPoliciesPreferenceControllerTest.java
new file mode 100644
index 000000000..843dafeaa
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddPoliciesPreferenceControllerTest.java
@@ -0,0 +1,246 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.Mockito.verify;
+
+import android.app.admin.DeviceAdminInfo.PolicyInfo;
+import android.util.Log;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+
+import java.util.ArrayList;
+
+public final class DeviceAdminAddPoliciesPreferenceControllerTest extends
+        BaseEnterprisePreferenceControllerTestCase {
+
+    private static final String TAG = DeviceAdminAddPoliciesPreferenceControllerTest.class
+            .getSimpleName();
+
+    private DeviceAdminAddPoliciesPreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+    @Captor
+    private ArgumentCaptor<CharSequence> mTitleCaptor;
+
+    @Before
+    public void setController() {
+        mController = new DeviceAdminAddPoliciesPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+        mController.setDeviceAdmin(mDefaultDeviceAdminInfo);
+    }
+
+    @Test
+    public void testGetPreferenceType() throws Exception {
+        assertWithMessage("preference type").that(mController.getPreferenceType())
+                .isEqualTo(Preference.class);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin() throws Exception {
+        DeviceAdminAddPoliciesPreferenceController controller =
+                new DeviceAdminAddPoliciesPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneWrite() throws Exception {
+        DeviceAdminAddPoliciesPreferenceController controller =
+                new DeviceAdminAddPoliciesPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneRead() throws Exception {
+        DeviceAdminAddPoliciesPreferenceController controller =
+                new DeviceAdminAddPoliciesPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneHidden() throws Exception {
+        DeviceAdminAddPoliciesPreferenceController controller =
+                new DeviceAdminAddPoliciesPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner() throws Exception {
+        mockDeviceOwner();
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_zoneWrite() throws Exception {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_zoneRead() throws Exception {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceOwner_zoneHidden() throws Exception {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner() throws Exception {
+        mockProfileOwner();
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_zoneWrite() throws Exception {
+        mockProfileOwner();
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_zoneRead() throws Exception {
+        mockProfileOwner();
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_profileOwner_zoneHidden() throws Exception {
+        mockProfileOwner();
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_regularAdmin() throws Exception {
+        // Admin is neither PO nor DO
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_regularAdmin_zoneWrite() throws Exception {
+        // Admin is neither PO nor DO
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_regularAdmin_zoneRead() throws Exception {
+        // Admin is neither PO nor DO
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_regularAdmin_zoneHidden() throws Exception {
+        // Admin is neither PO nor DO
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testUpdateState_systemUser() throws Exception {
+        updateStateTest(/* isSystemUser= */ true);
+    }
+
+    @Test
+    public void testUpdateState_nonSystemUser() throws Exception {
+        updateStateTest(/* isSystemUser= */ false);
+    }
+
+    private void updateStateTest(boolean isSystemUser) {
+        // Arrange
+        if (isSystemUser) {
+            mockSystemUser();
+        } else {
+            mockNonSystemUser();
+        }
+        ArrayList<PolicyInfo> usedPolicies = mFancyDeviceAdminInfo.getUsedPolicies();
+        Log.d(TAG, "Admin policies: " + usedPolicies);
+        mController.setDeviceAdmin(mFancyDeviceAdminInfo);
+
+        // Act
+        mController.updateState(mPreference);
+
+        // Assert
+        verify(mPreference).setTitle(mTitleCaptor.capture());
+        Log.d(TAG, "Preference title: " + mTitleCaptor.getValue());
+        for (PolicyInfo policy : usedPolicies) {
+            CharSequence itemTitle = mRealContext
+                    .getText(isSystemUser ? policy.label : policy.labelForSecondaryUsers);
+            assertWithMessage("policy item title")
+                    .that(mTitleCaptor.getValue().toString()).contains(itemTitle);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddSupportPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddSupportPreferenceControllerTest.java
new file mode 100644
index 000000000..51d24a842
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddSupportPreferenceControllerTest.java
@@ -0,0 +1,199 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class DeviceAdminAddSupportPreferenceControllerTest extends
+        BaseEnterprisePreferenceControllerTestCase {
+
+    @Mock
+    private Preference mPreference;
+
+    private DeviceAdminAddSupportPreferenceController mController;
+
+    @Before
+    public void setController() {
+        mController = new DeviceAdminAddSupportPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+        mController.setDeviceAdmin(mDefaultDeviceAdminInfo);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin() throws Exception {
+        DeviceAdminAddSupportPreferenceController controller =
+                new DeviceAdminAddSupportPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneWrite() throws Exception {
+        DeviceAdminAddSupportPreferenceController controller =
+                new DeviceAdminAddSupportPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneRead() throws Exception {
+        DeviceAdminAddSupportPreferenceController controller =
+                new DeviceAdminAddSupportPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneHidden() throws Exception {
+        DeviceAdminAddSupportPreferenceController controller =
+                new DeviceAdminAddSupportPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_nullMessage() {
+        mockGetLongSupportMessageForUser(null);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_nullMessage_zoneWrite() {
+        mockGetLongSupportMessageForUser(null);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_nullMessage_zoneRead() {
+        mockGetLongSupportMessageForUser(null);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_nullMessage_zoneHidden() {
+        mockGetLongSupportMessageForUser(null);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyMessage() {
+        mockGetLongSupportMessageForUser("");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyMessage_zoneWrite() {
+        mockGetLongSupportMessageForUser("");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyMessage_zoneRead() {
+        mockGetLongSupportMessageForUser("");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_emptyMessage_zoneHidden() {
+        mockGetLongSupportMessageForUser("");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validMessage() {
+        mockGetLongSupportMessageForUser("WHAZZZZUP");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validMessage_zoneWrite() {
+        mockGetLongSupportMessageForUser("WHAZZZZUP");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validMessage_zoneRead() {
+        mockGetLongSupportMessageForUser("WHAZZZZUP");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_validMessage_zoneHidden() {
+        mockGetLongSupportMessageForUser("WHAZZZZUP");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testUpdateState() {
+        mockGetLongSupportMessageForUser("WHAZZZZUP");
+        mController.setSupportMessage();
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleSet(mPreference, "WHAZZZZUP");
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddWarningPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddWarningPreferenceControllerTest.java
new file mode 100644
index 000000000..6cc61fa7c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminAddWarningPreferenceControllerTest.java
@@ -0,0 +1,91 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class DeviceAdminAddWarningPreferenceControllerTest extends
+        BaseEnterprisePreferenceControllerTestCase {
+
+    @Mock
+    private Preference mPreference;
+
+    private DeviceAdminAddWarningPreferenceController mController;
+
+    @Before
+    public void setController() {
+        mController = new DeviceAdminAddWarningPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+        mController.setDeviceAdmin(mDefaultDeviceAdminInfo);
+    }
+
+    @Test
+    public void testUpdateState_adminInactive() {
+        mockInactiveAdmin(mDefaultAdmin);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleSet(mPreference,
+                mRealContext.getString(R.string.device_admin_warning, mAppName));
+    }
+
+    @Test
+    public void testUpdateState_adminActive() {
+        mockActiveAdmin(mDefaultAdmin);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleSet(mPreference,
+                mRealContext.getString(R.string.device_admin_status, mAppName));
+    }
+
+    @Test
+    public void testUpdateState_profileOwner() {
+        mockProfileOwner();
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleSet(mPreference,
+                mRealContext.getString(R.string.admin_profile_owner_user_message));
+    }
+
+    @Test
+    public void testUpdateState_deviceOwner() {
+        mockDeviceOwner();
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleSet(mPreference,
+                mRealContext.getString(R.string.admin_device_owner_message));
+    }
+
+    @Test
+    public void testUpdateState_deviceOwner_financialDevice() {
+        mockDeviceOwner();
+        mockFinancialDevice();
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleSet(mPreference,
+                mRealContext.getString(R.string.admin_financed_message));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminDeactivatedAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminDeactivatedAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..20751a290
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminDeactivatedAppsPreferenceControllerTest.java
@@ -0,0 +1,87 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public final class DeviceAdminDeactivatedAppsPreferenceControllerTest
+        extends BaseEnterprisePreferenceControllerTestCase {
+
+    private DeviceAdminAppsPreferenceController mController;
+    private BaseEnterprisePreferenceControllerTestCase.DummyPreferenceGroup mPreferenceGroup;
+
+    @Before
+    @UiThreadTest
+    public void setUp() throws Exception {
+        mController = new DeviceAdminDeactivatedAppsPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+        mPreferenceGroup = new DummyPreferenceGroup(mSpiedContext);
+    }
+
+    @Test
+    public void testUpdateState_noBroadcastReceivers() {
+        mockQueryBroadcastReceivers();
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup,
+                mRealContext.getString(R.string.device_admin_apps_list_empty));
+    }
+
+    @Test
+    public void testUpdateState_noDeactivatedAdminApp() {
+        mockQueryBroadcastReceivers(mDefaultResolveInfo, mFancyResolveInfo);
+        mockActiveAdmin(mDefaultAdmin);
+        mockActiveAdmin(mFancyAdmin);
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup,
+                mRealContext.getString(R.string.device_admin_apps_list_empty));
+    }
+
+    @Test
+    public void testUpdateState_singleDeactivatedAdminApp() {
+        mockQueryBroadcastReceivers(mDefaultResolveInfo, mFancyResolveInfo);
+        mockActiveAdmin(mDefaultAdmin);
+        mockInactiveAdmin(mFancyAdmin);
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup, mFancyDeviceAdminInfo.loadLabel(mRealPm));
+    }
+
+    @Test
+    public void testUpdateState_multipleDeactivatedAdminApps() {
+        mockQueryBroadcastReceivers(mDefaultResolveInfo, mFancyResolveInfo);
+        mockInactiveAdmin(mDefaultAdmin);
+        mockInactiveAdmin(mFancyAdmin);
+
+        mController.updateState(mPreferenceGroup);
+
+        verifyPreferenceTitles(mPreferenceGroup,
+                mDefaultDeviceAdminInfo.loadLabel(mRealPm),
+                mFancyDeviceAdminInfo.loadLabel(mRealPm));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminStringProviderImplTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminStringProviderImplTest.java
new file mode 100644
index 000000000..c18fde2c8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/DeviceAdminStringProviderImplTest.java
@@ -0,0 +1,114 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.enterprise;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.testng.Assert.expectThrows;
+
+import android.content.Context;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class DeviceAdminStringProviderImplTest {
+
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private final DeviceAdminStringProviderImpl mDeviceAdminStringProvider =
+            new DeviceAdminStringProviderImpl(mContext);
+
+    @Test
+    public void testDefaultDisabledByPolicyTitle() {
+        assertThat(mDeviceAdminStringProvider.getDefaultDisabledByPolicyTitle())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title));
+    }
+
+    @Test
+    public void testDisallowAdjustVolumeTitle() {
+        assertThat(mDeviceAdminStringProvider.getDisallowAdjustVolumeTitle())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title_adjust_volume));
+    }
+
+    @Test
+    public void testDisallowOutgoingCallsTitle() {
+        assertThat(mDeviceAdminStringProvider.getDisallowOutgoingCallsTitle())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title_outgoing_calls));
+    }
+
+    @Test
+    public void testDisallowSmsTitle() {
+        assertThat(mDeviceAdminStringProvider.getDisallowSmsTitle())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title_sms));
+    }
+
+    @Test
+    public void testDisableCameraTitle() {
+        assertThat(mDeviceAdminStringProvider.getDisableCameraTitle())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title_camera));
+    }
+
+    @Test
+    public void testDisableScreenCaptureTitle() {
+        assertThat(mDeviceAdminStringProvider.getDisableScreenCaptureTitle())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title_screen_capture));
+    }
+
+    @Test
+    public void testSuspendPackagesTitle() {
+        assertThat(mDeviceAdminStringProvider.getSuspendPackagesTitle())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title_suspend_packages));
+    }
+
+    @Test
+    public void testDefaultDisabledByPolicyContent() {
+        assertThat(mDeviceAdminStringProvider.getDefaultDisabledByPolicyContent())
+                .isEqualTo(mContext.getString(R.string.default_admin_support_msg));
+    }
+
+    @Test
+    public void testLearnMoreHelpPageUrl() {
+        assertThat(mDeviceAdminStringProvider.getLearnMoreHelpPageUrl())
+                .isEqualTo(mContext.getString(R.string.help_url_action_disabled_by_it_admin));
+    }
+
+    @Test
+    public void testDisabledByPolicyTitleForFinancedDevice() {
+        assertThat(mDeviceAdminStringProvider.getDisabledByPolicyTitleForFinancedDevice())
+                .isEqualTo(mContext.getString(R.string.disabled_by_policy_title_financed_device));
+    }
+
+    @Test
+    public void testDisabledBiometricsParentConsentTitle() {
+        UnsupportedOperationException e = expectThrows(UnsupportedOperationException.class,
+                () -> mDeviceAdminStringProvider.getDisabledBiometricsParentConsentTitle());
+        assertThat(e.getMessage()).contains("disabled_by_policy_title_biometric_parental_consent");
+    }
+
+    @Test
+    public void testDisabledBiometricsParentConsentContent() {
+        UnsupportedOperationException e = expectThrows(UnsupportedOperationException.class,
+                () -> mDeviceAdminStringProvider.getDisabledBiometricsParentConsentContent());
+        assertThat(e.getMessage())
+                .contains("disabled_by_policy_content_biometric_parental_consent");
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseDisclosurePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseDisclosurePreferenceControllerTest.java
new file mode 100644
index 000000000..d57725482
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseDisclosurePreferenceControllerTest.java
@@ -0,0 +1,121 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+
+import com.android.car.admin.ui.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.ui.preference.CarUiFooterPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+
+public final class EnterpriseDisclosurePreferenceControllerTest extends
+        BaseEnterprisePrivacyPreferenceControllerTestCase {
+    private static final String ORG_NAME = "My Org";
+
+    private EnterpriseDisclosurePreferenceController mEnterpriseDisclosurePreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private CarUiFooterPreference mPreference;
+
+    @Before
+    public void setUp() {
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new CarUiFooterPreference(mSpiedContext);
+
+        mockHasDeviceAdminFeature();
+        mEnterpriseDisclosurePreferenceController = new EnterpriseDisclosurePreferenceController(
+                mSpiedContext, mPreferenceKey, mFragmentController, mCarUxRestrictions);
+    }
+
+    @Test
+    public void testNoDeviceOwnerComponent_noDisclosure() {
+        mockNoDeviceOwner();
+
+        mEnterpriseDisclosurePreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mEnterpriseDisclosurePreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testNoDeviceOwnerComponent_noDisclosure_zoneWrite() {
+        mockNoDeviceOwner();
+
+        mEnterpriseDisclosurePreferenceController.setAvailabilityStatusForZone("write");
+        mEnterpriseDisclosurePreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mEnterpriseDisclosurePreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testNoDeviceOwnerComponent_noDisclosure_zoneRead() {
+        mockNoDeviceOwner();
+
+        mEnterpriseDisclosurePreferenceController.setAvailabilityStatusForZone("read");
+        mEnterpriseDisclosurePreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mEnterpriseDisclosurePreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testNoDeviceOwnerComponent_noDisclosure_zoneHidden() {
+        mockNoDeviceOwner();
+
+        mEnterpriseDisclosurePreferenceController.setAvailabilityStatusForZone("hidden");
+        mEnterpriseDisclosurePreferenceController.updateState(mPreference);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mEnterpriseDisclosurePreferenceController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testOrganizationNameAbsent_genericDisclosure() {
+        mockDeviceOwner();
+        mockOrganizationName(null);
+
+        mEnterpriseDisclosurePreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getSummary().toString()).isEqualTo(mRealContext.getString(
+                R.string.car_admin_ui_managed_device_message_generic));
+    }
+
+    @Test
+    public void testOrganizationNamePresent_specificDisclosure() {
+        mockDeviceOwner();
+        mockOrganizationName(ORG_NAME);
+
+        mEnterpriseDisclosurePreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getSummary().toString()).isEqualTo(mRealContext.getString(
+                R.string.car_admin_ui_managed_device_message_by_org, ORG_NAME));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseInstalledPackagesListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseInstalledPackagesListPreferenceControllerTest.java
new file mode 100644
index 000000000..06eab4138
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseInstalledPackagesListPreferenceControllerTest.java
@@ -0,0 +1,241 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doAnswer;
+import static org.mockito.Mockito.spy;
+
+import android.util.Log;
+
+import androidx.preference.PreferenceGroup;
+import androidx.test.annotation.UiThreadTest;
+
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider.ListOfAppsCallback;
+
+import org.junit.Before;
+import org.junit.Test;
+
+public class EnterpriseInstalledPackagesListPreferenceControllerTest extends
+        BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private static final String TAG = EnterpriseInstalledPackagesListPreferenceControllerTest.class
+            .getSimpleName();
+
+    // Must be a spy to verify refreshUi() is called
+    private EnterpriseInstalledPackagesListPreferenceController mSpiedController;
+
+    private DummyPreferenceGroup mPreferenceGroup;
+
+    @Before
+    @UiThreadTest // Needed to instantiate DummyPreferenceGroup
+    public void setExtraFixtures() {
+        mSpiedController = spy(newController(mApplicationFeatureProvider));
+        mPreferenceGroup = new DummyPreferenceGroup(mSpiedContext);
+    }
+
+    @Test
+    public void testGetPreferenceType() {
+        assertWithMessage("preference type").that(mSpiedController.getPreferenceType())
+                .isEqualTo(PreferenceGroup.class);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps() {
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps_zoneWrite() {
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps_zoneRead() {
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps_zoneHidden() {
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release();
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps_zoneWrite() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps_zoneRead() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps_zoneHidden() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testUpdateState() {
+        expectUiRefreshed(mSpiedController);
+        ListOfAppsCallbackHolder callbackHolder = mockListPolicyInstalledApps();
+        mSpiedController.getAvailabilityStatus();
+        callbackHolder.release(newUserAppInfo("foo"), newUserAppInfo("bar"));
+        assertUiRefreshed(mSpiedController);
+
+        mSpiedController.updateState(mPreferenceGroup);
+
+        assertPreferenceGroupStateSet(mPreferenceGroup, "foo", "bar");
+    }
+
+    private EnterpriseInstalledPackagesListPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new EnterpriseInstalledPackagesListPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, provider);
+    }
+
+    private ListOfAppsCallbackHolder mockListPolicyInstalledApps() {
+        ListOfAppsCallbackHolder callbackHolder = new ListOfAppsCallbackHolder();
+
+        doAnswer((inv) -> {
+            Log.d(TAG, "answering to " + inv);
+            ListOfAppsCallback callback = (ListOfAppsCallback) inv.getArguments()[0];
+            callbackHolder.setCallback(callback);
+            return null;
+        }).when(mApplicationFeatureProvider).listPolicyInstalledApps(any());
+        return callbackHolder;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseInstalledPackagesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseInstalledPackagesPreferenceControllerTest.java
new file mode 100644
index 000000000..be8237a52
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseInstalledPackagesPreferenceControllerTest.java
@@ -0,0 +1,235 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doAnswer;
+import static org.mockito.Mockito.spy;
+
+import android.util.Log;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider;
+import com.android.car.settingslib.applications.ApplicationFeatureProvider.NumberOfAppsCallback;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public class EnterpriseInstalledPackagesPreferenceControllerTest extends
+        BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private static final String TAG = EnterpriseInstalledPackagesPreferenceControllerTest.class
+            .getSimpleName();
+
+    // Must be a spy to verify refreshUi() is called
+    private EnterpriseInstalledPackagesPreferenceController mSpiedController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setController() {
+        mSpiedController = spy(newController(mApplicationFeatureProvider));
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps() {
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps_zoneWrite() {
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps_zoneRead() {
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noInstalledApps_zoneHidden() {
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(0);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+        assertUiNotRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(3);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps_zoneWrite() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("write");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(3);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps_zoneRead() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("read");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(3);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withInstalledApps_zoneHidden() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+        mSpiedController.setAvailabilityStatusForZone("hidden");
+
+        // Assert initial state
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        // Unblock async call
+        callbackHolder.release(3);
+
+        // Assert post-callback result
+        PreferenceControllerTestUtil.assertAvailability(mSpiedController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+        assertUiRefreshed(mSpiedController);
+    }
+
+    @Test
+    public void testUpdateState() {
+        expectUiRefreshed(mSpiedController);
+        NumberOfAppsCallbackHolder callbackHolder = mockCalculateNumberOfPolicyInstalledApps();
+        mSpiedController.getAvailabilityStatus();
+        callbackHolder.release(3);
+        assertUiRefreshed(mSpiedController);
+
+        mSpiedController.updateState(mPreference);
+
+        assertPreferenceStateSet(mPreference, 3);
+    }
+
+    private EnterpriseInstalledPackagesPreferenceController newController(
+            ApplicationFeatureProvider provider) {
+        return new EnterpriseInstalledPackagesPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, provider);
+    }
+
+    private NumberOfAppsCallbackHolder mockCalculateNumberOfPolicyInstalledApps() {
+        NumberOfAppsCallbackHolder callbackHolder = new NumberOfAppsCallbackHolder();
+
+        doAnswer((inv) -> {
+            Log.d(TAG, "answering to " + inv);
+            NumberOfAppsCallback callback = (NumberOfAppsCallback) inv.getArguments()[1];
+            callbackHolder.setCallback(callback);
+            return null;
+        }).when(mApplicationFeatureProvider)
+                .calculateNumberOfPolicyInstalledApps(/* async= */ eq(true), any());
+
+        return callbackHolder;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsActivityTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsActivityTest.java
new file mode 100644
index 000000000..b86f6c39f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsActivityTest.java
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static android.car.test.mocks.AndroidMockitoHelper.syncCallOnMainThread;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import androidx.fragment.app.Fragment;
+
+import org.junit.Test;
+
+public final class EnterprisePrivacySettingsActivityTest extends BaseEnterpriseTestCase {
+
+    @Test
+    public void testGetFragment() throws Exception {
+        Fragment fragment = syncCallOnMainThread(() ->
+                // EnterprisePrivacySettingsActivity must be created in the main thread
+                new EnterprisePrivacySettingsActivity().getInitialFragment());
+        assertWithMessage("initial fragment class").that(fragment)
+                .isInstanceOf(EnterprisePrivacySettingsFragment.class);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsFragmentTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsFragmentTest.java
new file mode 100644
index 000000000..a05cbde88
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsFragmentTest.java
@@ -0,0 +1,70 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static android.car.test.mocks.AndroidMockitoHelper.syncCallOnMainThread;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.content.res.XmlResourceParser;
+
+import androidx.fragment.app.FragmentActivity;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class EnterprisePrivacySettingsFragmentTest extends BaseEnterpriseTestCase {
+
+    private EnterprisePrivacySettingsFragment mFragment;
+
+    @Mock
+    private FragmentActivity mFragmentActivity;
+
+    @Before
+    public void setFragment() throws Exception {
+        mFragment = syncCallOnMainThread(() -> new EnterprisePrivacySettingsFragment());
+    }
+
+    @Test
+    public void testGetPreferenceScreenResId() {
+        int resId = mFragment.getPreferenceScreenResId();
+
+        XmlResourceParser parser = mRealContext.getResources().getXml(resId);
+        assertWithMessage("xml with id %s", resId).that(parser).isNotNull();
+    }
+
+    @Test
+    public void testFinishActivityWhenDeviceOwnerIsNotSet() {
+        mockNotManaged();
+
+        mFragment.onAttach(mSpiedContext, mFragmentActivity);
+
+        verify(mFragmentActivity).finish();
+    }
+
+    @Test
+    public void testDoesNotFinishActivityWhenDeviceOwnerIsNotSet() {
+        mockDeviceOwner();
+
+        mFragment.onAttach(mSpiedContext, mFragmentActivity);
+
+        verify(mFragmentActivity, never()).finish();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsPreferenceControllerTest.java
new file mode 100644
index 000000000..1c41916f6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterprisePrivacySettingsPreferenceControllerTest.java
@@ -0,0 +1,181 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class EnterprisePrivacySettingsPreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private EnterprisePrivacySettingsPreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setController() {
+        mController = new EnterprisePrivacySettingsPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature() {
+        mockNoDeviceAdminFeature();
+
+        // Must use new controller as availability is set on constructor
+        EnterprisePrivacySettingsPreferenceController controller =
+                new EnterprisePrivacySettingsPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature_zoneWrite() {
+        mockNoDeviceAdminFeature();
+
+        // Must use new controller as availability is set on constructor
+        EnterprisePrivacySettingsPreferenceController controller =
+                new EnterprisePrivacySettingsPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature_zoneRead() {
+        mockNoDeviceAdminFeature();
+
+        // Must use new controller as availability is set on constructor
+        EnterprisePrivacySettingsPreferenceController controller =
+                new EnterprisePrivacySettingsPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature_zoneHidden() {
+        mockNoDeviceAdminFeature();
+
+        // Must use new controller as availability is set on constructor
+        EnterprisePrivacySettingsPreferenceController controller =
+                new EnterprisePrivacySettingsPreferenceController(mSpiedContext, mPreferenceKey,
+                        mFragmentController, mUxRestrictions);
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+
+    @Test
+    public void testGetAvailabilityStatus_noDeviceOwner() {
+        mockNoDeviceOwner();
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noDeviceOwner_zoneWrite() {
+        mockNoDeviceOwner();
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noDeviceOwner_zoneRead() {
+        mockNoDeviceOwner();
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noDeviceOwner_zoneHidden() {
+        mockNoDeviceOwner();
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withDeviceOwner() {
+        mockDeviceOwner();
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withDeviceOwner_zoneWrite() {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withDeviceOwner_zoneRead() {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_withDeviceOwner_zoneHidden() {
+        mockDeviceOwner();
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testuUdateState() {
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        verifyPreferenceSummarySet(mPreference,
+                R.string.enterprise_privacy_settings_summary_generic);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsListFragmentTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsListFragmentTest.java
new file mode 100644
index 000000000..b54438a34
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsListFragmentTest.java
@@ -0,0 +1,49 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static android.car.test.mocks.AndroidMockitoHelper.syncCallOnMainThread;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import android.content.res.XmlResourceParser;
+
+import androidx.fragment.app.FragmentActivity;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class EnterpriseSetDefaultAppsListFragmentTest extends BaseEnterpriseTestCase {
+
+    private EnterpriseSetDefaultAppsListFragment mFragment;
+
+    @Mock
+    private FragmentActivity mFragmentActivity;
+
+    @Before
+    public void setFragment() throws Exception {
+        mFragment = syncCallOnMainThread(() -> new EnterpriseSetDefaultAppsListFragment());
+    }
+
+    @Test
+    public void testGetPreferenceScreenResId() {
+        int resId = mFragment.getPreferenceScreenResId();
+
+        XmlResourceParser parser = mRealContext.getResources().getXml(resId);
+        assertWithMessage("xml with id %s", resId).that(parser).isNotNull();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsListPreferenceControllerTest.java
new file mode 100644
index 000000000..cf1810f30
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsListPreferenceControllerTest.java
@@ -0,0 +1,333 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.argThat;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.when;
+
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.UserInfo;
+import android.util.Log;
+
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.test.annotation.UiThreadTest;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.BaseEnterprisePreferenceControllerTestCase.DummyPreferenceGroup;
+import com.android.car.settingslib.applications.UserAppInfo;
+import com.android.car.settingslib.enterprise.EnterpriseDefaultApps;
+
+import org.junit.Before;
+import org.junit.Test;
+
+import java.util.ArrayList;
+import java.util.List;
+
+public final class EnterpriseSetDefaultAppsListPreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private static final String TAG = EnterpriseSetDefaultAppsListPreferenceControllerTest.class
+            .getSimpleName();
+
+    private UserInfo mMyUser;
+    private EnterpriseSetDefaultAppsListPreferenceController mController;
+
+    private DummyPreferenceGroup mPreferenceGroup;
+
+    @Before
+    @UiThreadTest // Needed to instantiate DummyPreferenceGroup
+    public void setUp() throws Exception {
+        mController = new EnterpriseSetDefaultAppsListPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, mApplicationFeatureProvider);
+        int userId = mSpiedContext.getUserId();
+        mMyUser = new UserInfo(mSpiedContext.getUserId(), "Mambo Number " + userId, /* flags= */ 0);
+        Log.d(TAG, "myUser: " + mMyUser.toFullString());
+        mPreferenceGroup = new DummyPreferenceGroup(mSpiedContext);
+    }
+
+    @Test
+    public void testGetPreferenceType() {
+        assertWithMessage("preference type").that(mController.getPreferenceType())
+                .isEqualTo(PreferenceGroup.class);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        // Don't need to mock anything
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none_zoneWrite() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        // Don't need to mock anything
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none_zoneRead() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        // Don't need to mock anything
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none_zoneHidden() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        // Don't need to mock anything
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one_zoneWrite() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one_zoneRead() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one_zoneHidden() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached_zoneWrite() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached_zoneRead() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached_zoneHidden() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app");
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testUpdateState_allSingleApps() {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "app_4");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CALENDAR, "app_8");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CAMERA, "app_15");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CONTACTS, "app_16");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.EMAIL, "app_23");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.MAP, "app_42");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.PHONE, "app_108");
+        // Must call getAvailabilityStatus() to fetch the list
+        mController.getAvailabilityStatus();
+
+        mController.updateState(mPreferenceGroup);
+
+        List<Preference> prefs = mPreferenceGroup.getPreferences();
+        assertWithMessage("children preferences").that(prefs).hasSize(7);
+
+        // NOTE: must be called in the same order as the EnterpriseDefaultApp enums
+        assertPreference(prefs, 0, getSingleAppsTitle(R.string.default_browser_title), "app_4");
+        assertPreference(prefs, 1, getSingleAppsTitle(R.string.default_calendar_app_title),
+                "app_8");
+        assertPreference(prefs, 2, getMultipleAppsTitle(R.plurals.default_camera_app_title, 1),
+                "app_15");
+        assertPreference(prefs, 3, getSingleAppsTitle(R.string.default_contacts_app_title),
+                "app_16");
+        assertPreference(prefs, 4, getMultipleAppsTitle(R.plurals.default_email_app_title, 1),
+                "app_23");
+        assertPreference(prefs, 5, getSingleAppsTitle(R.string.default_map_app_title), "app_42");
+        assertPreference(prefs, 6, getMultipleAppsTitle(R.plurals.default_phone_app_title, 1),
+                "app_108");
+    }
+
+    @Test
+    public void testUpdateState_allMultipleApps() {
+        // NOTE: uses "s.." on apps that are single, and "m..." on apps that are multiple
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, "s1", "s2");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CALENDAR, "s1", "s2", "s3");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CAMERA, "m1", "m2");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CONTACTS, "s1", "s2", "s3", "s4");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.EMAIL, "m1", "m2", "m3");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.MAP, "s1", "s2", "s3", "s4");
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.PHONE, "m1", "m2", "m3", "m4");
+        // Must call getAvailabilityStatus() to fetch the list
+        mController.getAvailabilityStatus();
+
+        mController.updateState(mPreferenceGroup);
+
+        List<Preference> prefs = mPreferenceGroup.getPreferences();
+        assertWithMessage("children preferences").that(prefs).hasSize(7);
+
+        // NOTE: must be called in the same order as the EnterpriseDefaultApp enums
+        assertPreference(prefs, 0, getSingleAppsTitle(R.string.default_browser_title), "s1", "s2");
+        assertPreference(prefs, 1, getSingleAppsTitle(R.string.default_calendar_app_title), "s1",
+                "s2", "s3");
+        assertPreference(prefs, 2, getMultipleAppsTitle(R.plurals.default_camera_app_title, 2),
+                "m1", "m2");
+        assertPreference(prefs, 3, getSingleAppsTitle(R.string.default_contacts_app_title), "s1",
+                "s2", "s3", "s4");
+        assertPreference(prefs, 4, getMultipleAppsTitle(R.plurals.default_email_app_title, 3),
+                "m1", "m2", "m3");
+        assertPreference(prefs, 5, getSingleAppsTitle(R.string.default_map_app_title), "s1", "s2",
+                "s3", "s4");
+        assertPreference(prefs, 6, getMultipleAppsTitle(R.plurals.default_phone_app_title, 4),
+                "m1", "m2", "m3"); // caps at 3, so m4 is ignored
+    }
+
+    private void assertPreference(List<Preference> prefs, int index, CharSequence expectedTitle,
+            CharSequence... expectedApps) {
+        CharSequence expectedSummary = getSummary(expectedApps);
+        Preference pref = prefs.get(index);
+        Log.d(TAG, "assertPreference() at index #" + index + ": pref=" + pref
+                + " expectedTitle: " + expectedTitle
+                + " expectedSummary: " + expectedSummary);
+
+        assertWithMessage("title of preference #%s", index).that(pref.getTitle())
+                .isEqualTo(expectedTitle);
+        assertWithMessage("summary of preference #%s", index).that(pref.getSummary())
+                .isEqualTo(expectedSummary);
+    }
+
+    /**
+     * Gets the title for a default app type that can only have one app.
+     */
+    private CharSequence getSingleAppsTitle(int resId) {
+        return mRealContext.getString(resId);
+    }
+
+    /**
+     * Gets the title for a default app type that can have multiple apps.
+     */
+    private CharSequence getMultipleAppsTitle(int resId, int numberApps) {
+        return mRealContext.getResources().getQuantityString(resId, numberApps);
+    }
+
+    private CharSequence getSummary(CharSequence[] appNames) {
+        switch (appNames.length) {
+            case 1:
+                return appNames[0];
+            case 2:
+                return mRealContext.getString(R.string.app_names_concatenation_template_2,
+                        appNames[0], appNames[1]);
+            default:
+                return mRealContext.getString(R.string.app_names_concatenation_template_3,
+                        appNames[0], appNames[1], appNames[2]);
+        }
+    }
+
+    private void setEnterpriseSetDefaultApps(EnterpriseDefaultApps typeOfDefault,
+            String... appNames) {
+        Intent[] intents = typeOfDefault.getIntents();
+        int size = appNames.length;
+        List<UserAppInfo> apps = new ArrayList<>(size);
+        for (int i = 0; i < size; i++) {
+            String appName = appNames[i];
+            ApplicationInfo appInfo = new ApplicationInfo();
+            appInfo.packageName = appName;
+            apps.add(new UserAppInfo(mMyUser, appInfo));
+        }
+        Log.d(TAG, "mocking " + size + " apps for " + typeOfDefault + ": " + apps);
+        when(mApplicationFeatureProvider.findPersistentPreferredActivities(eq(mMyUser.id),
+                argThat(matchesIntents(intents)))).thenReturn(apps);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..f7721371e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseSetDefaultAppsPreferenceControllerTest.java
@@ -0,0 +1,230 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static org.mockito.ArgumentMatchers.argThat;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.when;
+
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.UserInfo;
+import android.util.Log;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settingslib.applications.UserAppInfo;
+import com.android.car.settingslib.enterprise.EnterpriseDefaultApps;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+import java.util.ArrayList;
+import java.util.List;
+
+public final class EnterpriseSetDefaultAppsPreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private static final String TAG = EnterpriseSetDefaultAppsPreferenceControllerTest.class
+            .getSimpleName();
+
+    private UserInfo mMyUser;
+    private EnterpriseSetDefaultAppsPreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setUp() throws Exception {
+        mController = new EnterpriseSetDefaultAppsPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions, mApplicationFeatureProvider);
+        int userId = mSpiedContext.getUserId();
+        mMyUser = new UserInfo(mSpiedContext.getUserId(), "Mambo Number " + userId, /* flags= */ 0);
+        Log.d(TAG, "myUser: " + mMyUser.toFullString());
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none_zoneWrite() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none_zoneRead() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_none_zoneHidden() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one_zoneWrite() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one_zoneRead() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_one_zoneHidden() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached_zoneWrite() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached_zoneRead() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_cached_zoneHidden() throws Exception {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 1);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 0);
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+
+        verifyFindPersistentPreferredActivitiesCalledOnce();
+    }
+
+    @Test
+    public void testUpdateState() {
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.BROWSER, 4);
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CALENDAR, 8);
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CAMERA, 15);
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.CONTACTS, 16);
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.EMAIL, 23);
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.MAP, 42);
+        setEnterpriseSetDefaultApps(EnterpriseDefaultApps.PHONE, 108);
+        // Must call getAvailabilityStatus() to set the count
+        mController.getAvailabilityStatus();
+
+        mController.updateState(mPreference);
+
+        int count = EnterpriseDefaultApps.values().length;
+        String summary = mRealContext.getResources()
+                .getQuantityString(R.plurals.enterprise_privacy_number_packages, count, count);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        verifyPreferenceSummarySet(mPreference, summary);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+
+    private void setEnterpriseSetDefaultApps(EnterpriseDefaultApps typeOfDefault, int number) {
+        Intent[] intents = typeOfDefault.getIntents();
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.packageName = "app";
+        for (int i = 0; i < number; i++) {
+            List<UserAppInfo> apps = new ArrayList<>(number);
+            apps.add(new UserAppInfo(mMyUser, appInfo));
+            when(mApplicationFeatureProvider.findPersistentPreferredActivities(eq(mMyUser.id),
+                    argThat(matchesIntents(intents)))).thenReturn(apps);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseUtilsTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseUtilsTest.java
new file mode 100644
index 000000000..30371d5b7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/EnterpriseUtilsTest.java
@@ -0,0 +1,211 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.enterprise.EnterpriseUtils.getAdminWithinPackage;
+import static com.android.car.settings.enterprise.EnterpriseUtils.getAvailabilityStatusRestricted;
+import static com.android.car.settings.enterprise.EnterpriseUtils.getDeviceAdminInfo;
+import static com.android.car.settings.enterprise.EnterpriseUtils.hasDeviceOwner;
+import static com.android.car.settings.enterprise.EnterpriseUtils.hasUserRestrictionByDpm;
+import static com.android.car.settings.enterprise.EnterpriseUtils.hasUserRestrictionByUm;
+import static com.android.car.settings.enterprise.EnterpriseUtils.isAdminUser;
+import static com.android.car.settings.enterprise.EnterpriseUtils.isDemoUser;
+import static com.android.car.settings.testutils.EnterpriseTestUtils.mockUserRestrictionSetByDpm;
+import static com.android.car.settings.testutils.EnterpriseTestUtils.mockUserRestrictionSetByUm;
+
+import static com.google.common.truth.Truth.assertThat;
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.eq;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DeviceAdminInfo;
+import android.content.ComponentName;
+import android.os.UserManager;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.Test;
+
+public final class EnterpriseUtilsTest extends BaseEnterpriseTestCase {
+
+    private static final String TEST_RESTRICTION = "test_restriction";
+
+    @Test
+    public void testGetAdminWithinPackage_notFound() {
+        ComponentName admin = getAdminWithinPackage(mSpiedContext, mPackageName);
+
+        assertWithMessage("Admin for %s", mPackageName).that(admin).isNull();
+    }
+
+    @Test
+    public void testGetAdminWithinPackage_found() {
+        mockGetActiveAdmins(mDefaultAdmin);
+
+        ComponentName admin = getAdminWithinPackage(mSpiedContext, mPackageName);
+
+        assertWithMessage("Admin for %s", mPackageName).that(admin).isEqualTo(mDefaultAdmin);
+    }
+
+    @Test
+    public void testGetDeviceAdminInfo_notFound() {
+        ComponentName admin = new ComponentName("Bond", "James Bond");
+
+        DeviceAdminInfo info = getDeviceAdminInfo(mSpiedContext, admin);
+
+        assertWithMessage("Device admin for %s", admin).that(info).isNull();
+    }
+
+    @Test
+    public void testGetDeviceAdminInfo_found() {
+        DeviceAdminInfo info = getDeviceAdminInfo(mSpiedContext, mDefaultAdmin);
+
+        assertWithMessage("Device admin for %s", mDefaultAdmin).that(info).isNotNull();
+        assertWithMessage("Component for %s", info).that(info.getComponent())
+                .isEqualTo(mDefaultAdmin);
+    }
+
+    @Test
+    public void testIsDemoUser_notDemoMode_notDemoUser() {
+        ExtendedMockito.doReturn(false)
+                .when(() -> UserManager.isDeviceInDemoMode(mSpiedContext));
+        when(mUm.isDemoUser()).thenReturn(false);
+
+        assertThat(isDemoUser(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void testIsDemoUser_notDemoMode_demoUser() {
+        ExtendedMockito.doReturn(false)
+                .when(() -> UserManager.isDeviceInDemoMode(mSpiedContext));
+        when(mUm.isDemoUser()).thenReturn(true);
+
+        assertThat(isDemoUser(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void testIsDemoUser_demoMode_notDemoUser() {
+        ExtendedMockito.doReturn(false)
+                .when(() -> UserManager.isDeviceInDemoMode(mSpiedContext));
+        when(mUm.isDemoUser()).thenReturn(false);
+
+        assertThat(isDemoUser(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void testIsDemoUser_demoMode_demoUser() {
+        ExtendedMockito.doReturn(true)
+                .when(() -> UserManager.isDeviceInDemoMode(mSpiedContext));
+        when(mUm.isDemoUser()).thenReturn(true);
+
+        assertThat(isDemoUser(mSpiedContext)).isTrue();
+    }
+
+    @Test
+    public void testIsAdminUser_true() {
+        when(mUm.isAdminUser()).thenReturn(true);
+
+        assertThat(isAdminUser(mSpiedContext)).isTrue();
+    }
+
+    @Test
+    public void testUserRestriction_notBaseRestricted_notUmRestricted() {
+        when(mUm.hasBaseUserRestriction(eq(TEST_RESTRICTION), any())).thenReturn(false);
+        when(mUm.hasUserRestriction(TEST_RESTRICTION)).thenReturn(false);
+
+        assertThat(hasUserRestrictionByUm(mSpiedContext, TEST_RESTRICTION)).isFalse();
+        assertThat(hasUserRestrictionByDpm(mSpiedContext, TEST_RESTRICTION)).isFalse();
+    }
+
+    @Test
+    public void testUserRestriction_baseRestricted_umRestricted() {
+        when(mUm.hasBaseUserRestriction(eq(TEST_RESTRICTION), any())).thenReturn(true);
+
+        assertThat(hasUserRestrictionByUm(mSpiedContext, TEST_RESTRICTION)).isTrue();
+        assertThat(hasUserRestrictionByDpm(mSpiedContext, TEST_RESTRICTION)).isFalse();
+    }
+
+    @Test
+    public void testUserRestriction_notBaseRestricted_umRestricted() {
+        when(mUm.hasBaseUserRestriction(eq(TEST_RESTRICTION), any())).thenReturn(false);
+        when(mUm.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+
+        assertThat(hasUserRestrictionByUm(mSpiedContext, TEST_RESTRICTION)).isFalse();
+        assertThat(hasUserRestrictionByDpm(mSpiedContext, TEST_RESTRICTION)).isTrue();
+    }
+
+    @Test
+    public void testHasDeviceOwner_unmanagedDevice() {
+        when(mDpm.isDeviceManaged()).thenReturn(false);
+
+        assertThat(hasDeviceOwner(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void testHasDeviceOwner_managedDevice_noDeviceOwnerComponent() {
+        when(mDpm.isDeviceManaged()).thenReturn(true);
+        when(mDpm.getDeviceOwnerComponentOnAnyUser()).thenReturn(null);
+
+        assertThat(hasDeviceOwner(mSpiedContext)).isFalse();
+    }
+
+    @Test
+    public void testHasDeviceOwner() {
+        when(mDpm.isDeviceManaged()).thenReturn(true);
+        when(mDpm.getDeviceOwnerComponentOnAnyUser())
+                .thenReturn(new ComponentName("testPackage", "testClass"));
+
+        assertThat(hasDeviceOwner(mSpiedContext)).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatusRestricted_unrestricted_available() {
+        mockUserRestrictionSetByDpm(mUm, TEST_RESTRICTION, false);
+        mockUserRestrictionSetByUm(mUm, TEST_RESTRICTION, false);
+
+        assertThat(getAvailabilityStatusRestricted(mSpiedContext, TEST_RESTRICTION))
+                .isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatusRestricted_restrictedByUm_disabled() {
+        mockUserRestrictionSetByUm(mUm, TEST_RESTRICTION, true);
+
+        assertThat(getAvailabilityStatusRestricted(mSpiedContext, TEST_RESTRICTION))
+                .isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatusRestricted_restrictedByDpm_viewing() {
+        mockUserRestrictionSetByDpm(mUm, TEST_RESTRICTION, true);
+
+        assertThat(getAvailabilityStatusRestricted(mSpiedContext, TEST_RESTRICTION))
+                .isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatusRestricted_restrictedByBothUmAndDpm_disabled() {
+        mockUserRestrictionSetByDpm(mUm, TEST_RESTRICTION, true);
+        mockUserRestrictionSetByUm(mUm, TEST_RESTRICTION, true);
+
+        assertThat(getAvailabilityStatusRestricted(mSpiedContext, TEST_RESTRICTION))
+                .isEqualTo(DISABLED_FOR_PROFILE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/FailedPasswordWipeCurrentUserPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/FailedPasswordWipeCurrentUserPreferenceControllerTest.java
new file mode 100644
index 000000000..aec80ac8f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/FailedPasswordWipeCurrentUserPreferenceControllerTest.java
@@ -0,0 +1,132 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static org.mockito.Mockito.when;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class FailedPasswordWipeCurrentUserPreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private FailedPasswordWipeCurrentUserPreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setUp() throws Exception {
+        mController = new FailedPasswordWipeCurrentUserPreferenceController(mSpiedContext,
+                mPreferenceKey, mFragmentController, mUxRestrictions,
+                mEnterprisePrivacyFeatureProvider);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxNotSet() throws Exception {
+        mockGetMaximumFailedPasswordsForWipe(0);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxNotSet_zoneWrite() throws Exception {
+        mController.setAvailabilityStatusForZone("write");
+        mockGetMaximumFailedPasswordsForWipe(0);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxNotSet_zoneRead() throws Exception {
+        mController.setAvailabilityStatusForZone("read");
+        mockGetMaximumFailedPasswordsForWipe(0);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxNotSet_zoneHidden() throws Exception {
+        mController.setAvailabilityStatusForZone("hidden");
+        mockGetMaximumFailedPasswordsForWipe(0);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxSet() throws Exception {
+        mockGetMaximumFailedPasswordsForWipe(42);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxSet_zoneWrite() throws Exception {
+        mController.setAvailabilityStatusForZone("write");
+        mockGetMaximumFailedPasswordsForWipe(42);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxSet_zoneRead() throws Exception {
+        mController.setAvailabilityStatusForZone("read");
+        mockGetMaximumFailedPasswordsForWipe(42);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_maxSet_zoneHidden() throws Exception {
+        mController.setAvailabilityStatusForZone("hidden");
+        mockGetMaximumFailedPasswordsForWipe(42);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testUpdateState_set() {
+        mockGetMaximumFailedPasswordsForWipe(42);
+
+        mController.updateState(mPreference);
+
+        String expectedSummary = mRealContext.getResources().getQuantityString(
+                R.plurals.enterprise_privacy_number_failed_password_wipe, 42, 42);
+        verifyPreferenceTitleNeverSet(mPreference);
+        verifyPreferenceSummarySet(mPreference, expectedSummary);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+
+    private void mockGetMaximumFailedPasswordsForWipe(int max) {
+        when(mEnterprisePrivacyFeatureProvider.getMaximumFailedPasswordsBeforeWipeInCurrentUser())
+                .thenReturn(max);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/FancyDeviceAdminReceiver.java b/tests/multivalent/src/com/android/car/settings/enterprise/FancyDeviceAdminReceiver.java
new file mode 100644
index 000000000..563398aff
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/FancyDeviceAdminReceiver.java
@@ -0,0 +1,22 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import android.app.admin.DeviceAdminReceiver;
+
+public final class FancyDeviceAdminReceiver extends DeviceAdminReceiver {
+
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/GlobalHttpProxyPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/GlobalHttpProxyPreferenceControllerTest.java
new file mode 100644
index 000000000..08a356afb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/GlobalHttpProxyPreferenceControllerTest.java
@@ -0,0 +1,126 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.enterprise;
+
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static org.mockito.Mockito.when;
+
+import android.net.ConnectivityManager;
+import android.net.ProxyInfo;
+
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class GlobalHttpProxyPreferenceControllerTest extends
+        BaseEnterprisePrivacyPreferenceControllerTestCase {
+    private GlobalHttpProxyPreferenceController mGlobalHttpProxyPreferenceController;
+
+    @Mock
+    private ConnectivityManager mConnectivityManager;
+
+    @Before
+    public void setUp() {
+        when(mSpiedContext.getSystemService(ConnectivityManager.class))
+                .thenReturn(mConnectivityManager);
+        mGlobalHttpProxyPreferenceController = new GlobalHttpProxyPreferenceController(
+                mSpiedContext, mPreferenceKey, mFragmentController, mUxRestrictions);
+    }
+
+    @Test
+    public void testGlobalProxyNotSet_disablesPreference() {
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(
+                ProxyInfo.buildDirectProxy("test.com", 43));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testGlobalProxyNotSet_disablesPreference_zoneWrite() {
+        mGlobalHttpProxyPreferenceController.setAvailabilityStatusForZone("write");
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(
+                ProxyInfo.buildDirectProxy("test.com", 43));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testGlobalProxyNotSet_disablesPreference_zoneRead() {
+        mGlobalHttpProxyPreferenceController.setAvailabilityStatusForZone("read");
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(
+                ProxyInfo.buildDirectProxy("test.com", 43));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGlobalProxyNotSet_disablesPreference_zoneHidden() {
+        mGlobalHttpProxyPreferenceController.setAvailabilityStatusForZone("hidden");
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(
+                ProxyInfo.buildDirectProxy("test.com", 43));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGlobalProxySet_enablesPreference() {
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(null);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGlobalProxySet_enablesPreference_zoneWrite() {
+        mGlobalHttpProxyPreferenceController.setAvailabilityStatusForZone("write");
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(null);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGlobalProxySet_enablesPreference_zoneRead() {
+        mGlobalHttpProxyPreferenceController.setAvailabilityStatusForZone("read");
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(null);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGlobalProxySet_enablesPreference_zoneHidden() {
+        mGlobalHttpProxyPreferenceController.setAvailabilityStatusForZone("hidden");
+        when(mConnectivityManager.getGlobalProxy()).thenReturn(null);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mGlobalHttpProxyPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/ImePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/ImePreferenceControllerTest.java
new file mode 100644
index 000000000..68208c8f6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/ImePreferenceControllerTest.java
@@ -0,0 +1,142 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static org.mockito.Mockito.when;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class ImePreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private ImePreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setUp() throws Exception {
+        mController = new ImePreferenceController(mSpiedContext, mPreferenceKey,
+                mFragmentController, mUxRestrictions, mEnterprisePrivacyFeatureProvider);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_notSet() {
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet(null);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_notSet_zoneWrite() {
+        mController.setAvailabilityStatusForZone("write");
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet(null);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_notSet_zoneRead() {
+        mController.setAvailabilityStatusForZone("read");
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet(null);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_notSet_zoneHidden() {
+        mController.setAvailabilityStatusForZone("hidden");
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet(null);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_set() {
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet("Da Lablue");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_set_zoneWrite() {
+        mController.setAvailabilityStatusForZone("write");
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet("Da Lablue");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_set_zoneRead() {
+        mController.setAvailabilityStatusForZone("read");
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet("Da Lablue");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetgetAvailabilityStatus_set_zoneHidden() {
+        mController.setAvailabilityStatusForZone("hidden");
+        mockHasDeviceAdminFeature();
+        mockGetImeLabelIfOwnerSet("Da Lablue");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testUpdateState_set() {
+        mockGetImeLabelIfOwnerSet("Da Lablue");
+
+        mController.updateState(mPreference);
+
+        String summary = mRealContext.getResources()
+                .getString(R.string.enterprise_privacy_input_method_name, "Da Lablue");
+        verifyPreferenceTitleNeverSet(mPreference);
+        verifyPreferenceSummarySet(mPreference, summary);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+
+    private void mockGetImeLabelIfOwnerSet(String label) {
+        when(mEnterprisePrivacyFeatureProvider.getImeLabelIfOwnerSet()).thenReturn(label);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/ManageDeviceAdminPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/ManageDeviceAdminPreferenceControllerTest.java
new file mode 100644
index 000000000..40138d716
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/ManageDeviceAdminPreferenceControllerTest.java
@@ -0,0 +1,161 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import android.content.ComponentName;
+
+import androidx.preference.Preference;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.settingslib.utils.StringUtil;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public final class ManageDeviceAdminPreferenceControllerTest
+        extends BaseEnterprisePreferenceControllerTestCase {
+
+    private Preference mPreference;
+
+    @Test
+    public void testUpdateState_noActiveAdminApps() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureEnabled();
+        mockGetActiveAdmins();
+
+        controller.updateState(mPreference);
+
+        assertPreferenceSummary(mPreference,
+                mRealContext.getString(R.string.number_of_device_admins_none));
+    }
+
+    @Test
+    public void testUpdateState_singleActiveAdminApp() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureEnabled();
+        mockGetActiveAdmins(ComponentName.createRelative("packageName", "className"));
+
+        controller.updateState(mPreference);
+
+        assertPreferenceSummary(mPreference,
+                StringUtil.getIcuPluralsString(mRealContext, 1, R.string.number_of_device_admins));
+    }
+
+    @Test
+    public void testUpdateState_multipleActiveAdminApps() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureEnabled();
+        mockGetActiveAdmins(ComponentName.createRelative("packageName1", "className1"),
+                ComponentName.createRelative("packageName2", "className2"));
+
+        controller.updateState(mPreference);
+
+        assertPreferenceSummary(mPreference,
+                StringUtil.getIcuPluralsString(mRealContext, 2, R.string.number_of_device_admins));
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminDisabled() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureDisabled();
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminDisabled_zoneWrite() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureDisabled();
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminDisabled_zoneRead() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureDisabled();
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminDisabled_zoneHidden() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureDisabled();
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminEnabled() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureEnabled();
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminEnabled_zoneWrite() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureEnabled();
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminEnabled_zoneRead() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureEnabled();
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_deviceAdminEnabled_zoneHidden() {
+        ManageDeviceAdminPreferenceController controller = newControllerWithFeatureEnabled();
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    private ManageDeviceAdminPreferenceController newControllerWithFeatureDisabled() {
+        mockNoDeviceAdminFeature();
+        return newController();
+    }
+
+    private ManageDeviceAdminPreferenceController newControllerWithFeatureEnabled() {
+        mockHasDeviceAdminFeature();
+        ManageDeviceAdminPreferenceController controller = newController();
+        return controller;
+    }
+
+    private ManageDeviceAdminPreferenceController newController() {
+        mPreference = new Preference(mSpiedContext);
+        return new ManageDeviceAdminPreferenceController(
+                mSpiedContext, mPreferenceKey, mFragmentController, mUxRestrictions);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/NetworkLogsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/NetworkLogsPreferenceControllerTest.java
new file mode 100644
index 000000000..7ee7a3242
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/NetworkLogsPreferenceControllerTest.java
@@ -0,0 +1,66 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import android.text.format.DateUtils;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class NetworkLogsPreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private NetworkLogsPreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setUp() throws Exception {
+        mController = new NetworkLogsPreferenceController(mSpiedContext, mPreferenceKey,
+                mFragmentController, mUxRestrictions);
+    }
+
+    @Test
+    public void testUpdateState_noLogs() {
+        mockGetLastNetworkLogRetrievalTime(-1);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        verifyPreferenceSummarySet(mPreference, R.string.enterprise_privacy_none);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+
+    @Test
+    public void testUpdateState_withLogs() {
+        long now = System.currentTimeMillis();
+        mockGetLastNetworkLogRetrievalTime(now);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        String formattedDate = DateUtils.formatDateTime(mRealContext, now,
+                DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_SHOW_DATE);
+        verifyPreferenceSummarySet(mPreference, formattedDate);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/SecurityLogsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/SecurityLogsPreferenceControllerTest.java
new file mode 100644
index 000000000..93e3b348f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/SecurityLogsPreferenceControllerTest.java
@@ -0,0 +1,66 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import android.text.format.DateUtils;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+public final class SecurityLogsPreferenceControllerTest
+        extends BaseEnterprisePrivacyPreferenceControllerTestCase {
+
+    private SecurityLogsPreferenceController mController;
+
+    @Mock
+    private Preference mPreference;
+
+    @Before
+    public void setUp() throws Exception {
+        mController = new SecurityLogsPreferenceController(mSpiedContext, mPreferenceKey,
+                mFragmentController, mUxRestrictions);
+    }
+
+    @Test
+    public void testUpdateState_noLogs() {
+        mockGetLastSecurityLogRetrievalTime(-1);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        verifyPreferenceSummarySet(mPreference, R.string.enterprise_privacy_none);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+
+    @Test
+    public void testUpdateState_withLogs() {
+        long now = System.currentTimeMillis();
+        mockGetLastSecurityLogRetrievalTime(now);
+
+        mController.updateState(mPreference);
+
+        verifyPreferenceTitleNeverSet(mPreference);
+        String formattedDate = DateUtils.formatDateTime(mRealContext, now,
+                DateUtils.FORMAT_SHOW_TIME | DateUtils.FORMAT_SHOW_DATE);
+        verifyPreferenceSummarySet(mPreference, formattedDate);
+        verifyPreferenceIconNeverSet(mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/enterprise/WorkPolicyInfoPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/enterprise/WorkPolicyInfoPreferenceControllerTest.java
new file mode 100644
index 000000000..87ce6b276
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/enterprise/WorkPolicyInfoPreferenceControllerTest.java
@@ -0,0 +1,334 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.enterprise;
+
+import static android.car.test.mocks.CarArgumentMatchers.intentFor;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.doThrow;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.content.Intent;
+import android.content.pm.PackageManager.NameNotFoundException;
+import android.content.pm.ResolveInfo;
+import android.provider.Settings;
+
+import androidx.preference.Preference;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Test;
+import org.mockito.Mock;
+
+import java.util.Arrays;
+
+public final class WorkPolicyInfoPreferenceControllerTest
+        extends BaseEnterprisePreferenceControllerTestCase {
+
+    @Mock
+    private ResolveInfo mResolveInfo;
+
+    @Mock
+    private Preference mPreference;
+
+    @Test
+    public void testGetPreferenceType() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+
+        assertWithMessage("preferenceType").that(controller.getPreferenceType())
+                .isEqualTo(Preference.class);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureDisabled();
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature_zoneWrite() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureDisabled();
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature_zoneRead() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureDisabled();
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noFeature_zoneHidden() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureDisabled();
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        // Don't need to mock anything else
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneWrite() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        // Don't need to mock anything else
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneRead() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        // Don't need to mock anything else
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_noAdmin_zoneHidden() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        // Don't need to mock anything else
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithoutReceiver() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        // Don't need to mock anything else
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithoutReceiver_zoneWrite() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        // Don't need to mock anything else
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithoutReceiver_zoneRead() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        // Don't need to mock anything else
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithoutReceiver_zoneHidden() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        // Don't need to mock anything else
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithReceiver()  {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        mockHasIntent();
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithReceiver_zoneWrite()  {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        mockHasIntent();
+        controller.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithReceiver_zoneRead()  {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        mockHasIntent();
+        controller.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_adminWithReceiver_zoneHidden()  {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        mockHasIntent();
+        controller.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(controller.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testUpdateStatus_noFeature() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureDisabled();
+        // Don't need to mock anything else
+
+        controller.updateState(mPreference);
+
+        verifyPreferenceIntentNotSet();
+        verifyPreferenceTitleNotSet();
+    }
+
+    @Test
+    public void testUpdateStatus_noAdmin() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        // Don't need to mock anything else
+
+        controller.updateState(mPreference);
+
+        verifyPreferenceIntentNotSet();
+    }
+
+    @Test
+    public void testUpdateStatus_adminWithoutReceiver() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        // Don't need to mock anything else
+
+        controller.updateState(mPreference);
+
+        verifyPreferenceIntentNotSet();
+        verifyPreferenceTitleNotSet();
+    }
+
+    @Test
+    public void testUpdateStatus_adminWithReceiver() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        mockHasIntent();
+
+        controller.updateState(mPreference);
+
+        verifyPreferenceIntentSet();
+        verifyPreferenceTitleSet();
+    }
+
+    @Test
+    public void testUpdateStatus_adminWithReceiverButNoPackageInfo() throws Exception {
+        WorkPolicyInfoPreferenceController controller = newControllerWithFeatureEnabled();
+        mockProfileOwner();
+        mockHasIntent();
+        mockAppInfoMissing();
+
+        controller.updateState(mPreference);
+
+        verifyPreferenceIntentNotSet();
+        verifyPreferenceTitleNotSet();
+    }
+
+    // Must create new instances on demand as the feature check is done on constructor
+    private WorkPolicyInfoPreferenceController newControllerWithFeatureDisabled() {
+        mockNoDeviceAdminFeature();
+        return newController();
+    }
+
+    // Must create new instances on demand as the feature check is done on constructor
+    private WorkPolicyInfoPreferenceController newControllerWithFeatureEnabled() {
+        mockHasDeviceAdminFeature();
+        return newController();
+    }
+
+    private WorkPolicyInfoPreferenceController newController() {
+        return new WorkPolicyInfoPreferenceController(mSpiedContext, mPreferenceKey,
+                mFragmentController, mUxRestrictions);
+    }
+
+    private void mockHasIntent() {
+        // Must use doReturn() instead of when() because it's a spy
+        doReturn(Arrays.asList(mResolveInfo)).when(mSpiedPm)
+                .queryIntentActivities(showWorkPolicyInfoIntent(), eq(/* flags= */ 0));
+    }
+
+    private void mockAppInfoMissing() throws NameNotFoundException {
+        // Must use doThrow() instead of when() because it's a spy
+        doThrow(new NameNotFoundException("D'OH!")).when(mSpiedPm).getApplicationInfo(mPackageName,
+                /* flags= */ 0);
+    }
+
+    private Intent showWorkPolicyInfoIntent() {
+        return intentFor(Settings.ACTION_SHOW_WORK_POLICY_INFO, mDefaultAdmin.getPackageName());
+    }
+
+    private void verifyPreferenceIntentNotSet() {
+        verify(mPreference, never()).setIntent(any());
+    }
+
+    private void verifyPreferenceIntentSet() {
+        verify(mPreference).setIntent(showWorkPolicyInfoIntent());
+    }
+
+    private void verifyPreferenceTitleNotSet() {
+        verify(mPreference, never()).setTitle(any());
+    }
+
+    private void verifyPreferenceTitleSet() {
+        verify(mPreference).setTitle(mRealContext.getString(R.string.work_policy_privacy_settings,
+                mAppName));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/inputmethod/EnabledKeyboardPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/inputmethod/EnabledKeyboardPreferenceControllerTest.java
new file mode 100644
index 000000000..4a8a0b52c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/inputmethod/EnabledKeyboardPreferenceControllerTest.java
@@ -0,0 +1,312 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.inputmethod;
+
+import static android.content.Intent.FLAG_ACTIVITY_NEW_TASK;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.content.pm.ServiceInfo;
+import android.view.inputmethod.InputMethodInfo;
+import android.view.inputmethod.InputMethodManager;
+import android.view.inputmethod.InputMethodSubtype;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class EnabledKeyboardPreferenceControllerTest {
+    private static final String PLACEHOLDER_LABEL = "placeholder label";
+    private static final String PLACEHOLDER_ID = "placeholder id";
+    private static final String PLACEHOLDER_SETTINGS_ACTIVITY = "placeholder settings activity";
+    private static final String PLACEHOLDER_PACKAGE_NAME = "placeholder package name";
+    private static final String ALLOWED_PACKAGE_NAME = "allowed package name";
+    private static final String DISALLOWED_PACKAGE_NAME = "disallowed package name";
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private EnabledKeyboardPreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private List<String> mPermittedList;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DevicePolicyManager mDevicePolicyManager;
+    @Mock
+    private InputMethodManager mInputMethodManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPermittedList = new ArrayList<>();
+        mPermittedList.add(PLACEHOLDER_PACKAGE_NAME);
+        mPermittedList.add(ALLOWED_PACKAGE_NAME);
+
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDevicePolicyManager);
+        when(mContext.getSystemService(InputMethodManager.class)).thenReturn(mInputMethodManager);
+
+        mPreferenceController = new TestEnabledKeyboardPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_permitAllInputMethods() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(PLACEHOLDER_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void refreshUi_hasAllowedImeByOrganization() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser())
+                .thenReturn(mPermittedList);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void refreshUi_disallowedByOrganization() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser())
+                .thenReturn(mPermittedList);
+        List<InputMethodInfo> infos = createInputMethodInfoList(DISALLOWED_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void refreshUi_skipVoiceTyping() {
+        // TODO: b/236143731 Add Sufficient Testing to Prevent "Google Voice Typing" Regression
+        for (String gvtPackageName : InputMethodUtil.GVT_PACKAGE_NAMES) {
+            List<InputMethodInfo> infos =
+                    createInputMethodInfoList(gvtPackageName);
+            when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+            mPreferenceController.refreshUi();
+
+            assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+        }
+    }
+
+    @Test
+    public void refreshUi_verifyPreferenceIcon() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreference.getPreference(0);
+        assertThat(preference.getIcon()).isEqualTo(
+                InputMethodUtil.getPackageIcon(mContext.getPackageManager(), infos.get(0)));
+    }
+
+    @Test
+    public void refreshUi_verifyPreferenceTitle() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreference.getPreference(0);
+        assertThat(preference.getTitle()).isEqualTo(
+                InputMethodUtil.getPackageLabel(mContext.getPackageManager(), infos.get(0)));
+    }
+
+    @Test
+    public void refreshUi_verifyPreferenceSummary() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreference.getPreference(0);
+        assertThat(preference.getSummary()).isEqualTo(
+                InputMethodUtil.getSummaryString(mContext, mInputMethodManager, infos.get(0)));
+    }
+
+    @Test
+    public void performClick_launchSettingsActivity() {
+        doNothing().when(mContext).startActivity(any());
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(DISALLOWED_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreference.getPreference(0);
+        preference.performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+        Intent intent = captor.getValue();
+        assertThat(intent).isNotNull();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MAIN);
+        assertThat(intent.getComponent().getClassName()).isEqualTo(PLACEHOLDER_SETTINGS_ACTIVITY);
+        assertThat(intent.getComponent().getPackageName()).isEqualTo(DISALLOWED_PACKAGE_NAME);
+    }
+
+    @Test
+    public void performClick_missingSettingsActivity_noCrash() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(DISALLOWED_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreference.getPreference(0);
+        preference.performClick(); // if no exception occurs here, test passes
+    }
+
+    @Test
+    public void performClick_noSettingsActivity_noCrash() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                DISALLOWED_PACKAGE_NAME, /* settingsActivity= */ null);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreference.getPreference(0);
+        preference.performClick(); // if no exception occurs here, test passes
+    }
+
+    private List<InputMethodInfo> createInputMethodInfoList(String packageName) {
+        return createInputMethodInfoList(packageName, PLACEHOLDER_SETTINGS_ACTIVITY);
+    }
+
+    private List<InputMethodInfo> createInputMethodInfoList(String packageName,
+            String settingsName) {
+        List<InputMethodInfo> infos = new ArrayList<>();
+        PackageManager packageManager = mContext.getPackageManager();
+        infos.add(createMockInputMethodInfoWithSubtypes(
+                packageManager, packageName, settingsName));
+        return infos;
+    }
+
+    private InputMethodInfo createMockInputMethodInfoWithSubtypes(
+            PackageManager packageManager, String packageName, String settingsName) {
+        InputMethodInfo mockInfo = createMockInputMethodInfo(packageManager, packageName,
+                settingsName);
+        List<InputMethodSubtype> subtypes = createSubtypes();
+        when(mInputMethodManager.getEnabledInputMethodSubtypeList(any(), anyBoolean()))
+                .thenReturn(subtypes);
+
+        return mockInfo;
+    }
+
+    private static InputMethodInfo createMockInputMethodInfo(
+            PackageManager packageManager, String packageName, String settingsName) {
+        InputMethodInfo mockInfo = mock(InputMethodInfo.class);
+        when(mockInfo.getPackageName()).thenReturn(packageName);
+        when(mockInfo.getId()).thenReturn(PLACEHOLDER_ID);
+        when(mockInfo.loadLabel(packageManager)).thenReturn(PLACEHOLDER_LABEL);
+        when(mockInfo.getServiceInfo()).thenReturn(new ServiceInfo());
+        when(mockInfo.getSettingsActivity()).thenReturn(settingsName);
+        return mockInfo;
+    }
+
+    private static List<InputMethodSubtype> createSubtypes() {
+        List<InputMethodSubtype> subtypes = new ArrayList<>();
+        subtypes.add(createSubtype(1, "en_US"));
+        subtypes.add(createSubtype(2, "de_BE"));
+        subtypes.add(createSubtype(3, "oc-FR"));
+        return subtypes;
+    }
+
+    private static InputMethodSubtype createSubtype(int id, String locale) {
+        return new InputMethodSubtype.InputMethodSubtypeBuilder().setSubtypeId(id)
+                .setSubtypeLocale(locale).setIsAuxiliary(false).setIsAsciiCapable(true).build();
+    }
+
+    private static class TestEnabledKeyboardPreferenceController extends
+            EnabledKeyboardPreferenceController {
+
+        TestEnabledKeyboardPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        Intent createInputMethodSettingsIntent(String packageName, String settingsActivity) {
+            Intent intent = super.createInputMethodSettingsIntent(packageName, settingsActivity);
+            // FLAG_ACTIVITY_NEW_TASK is required to launch an activity outside of an activity
+            // context.
+            intent.addFlags(FLAG_ACTIVITY_NEW_TASK);
+            return intent;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/inputmethod/InputMethodUtilTest.java b/tests/multivalent/src/com/android/car/settings/inputmethod/InputMethodUtilTest.java
new file mode 100644
index 000000000..e2c43c2ed
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/inputmethod/InputMethodUtilTest.java
@@ -0,0 +1,386 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.inputmethod;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.content.pm.ServiceInfo;
+import android.graphics.drawable.Drawable;
+import android.provider.Settings;
+import android.view.inputmethod.InputMethodInfo;
+import android.view.inputmethod.InputMethodManager;
+import android.view.inputmethod.InputMethodSubtype;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.HashSet;
+import java.util.List;
+import java.util.Set;
+import java.util.stream.Collectors;
+
+@RunWith(AndroidJUnit4.class)
+public class InputMethodUtilTest {
+    private static final String PLACEHOLDER_PACKAGE_NAME = "placeholder package name";
+    private static final String PLACEHOLDER_LABEL = "placeholder label";
+    private static final String PLACEHOLDER_SETTINGS_ACTIVITY = "placeholder settings activity";
+    private static final String SUBTYPES_STRING =
+            "English (United States), German (Belgium), and Occitan (France)";
+    private static final String PLACEHOLDER_ENABLED_INPUT_METHODS =
+            "com.google.android.googlequicksearchbox/com.google.android.voicesearch.ime"
+                    + ".VoiceInputMethodService:com.google.android.apps.automotive.inputmethod/"
+                    + ".InputMethodService";
+    private static final String PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT =
+            "com.google.android.apps.automotive.inputmethod/.InputMethodService";
+    private static final String PLACEHOLDER_ENABLED_INPUT_METHOD_ID =
+            "com.google.android.googlequicksearchbox/com.google.android.voicesearch.ime"
+                    + ".VoiceInputMethodService";
+    private static final String PLACEHOLDER_DISABLED_INPUT_METHOD_ID = "disabled input method id";
+    private Context mContext;
+    private List<InputMethodInfo> mPlaceholderEnabledInputMethodsListAllDefaultable;
+    private List<InputMethodInfo> mPlaceholderEnabledInputMethodsListOneDefaultable;
+
+    @Mock
+    private PackageManager mPackageManager;
+    @Mock
+    private InputMethodManager mInputMethodManager;
+    @Mock
+    private DevicePolicyManager mDevicePolicyManager;
+    @Mock
+    private Drawable mIcon;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mContext = ApplicationProvider.getApplicationContext();
+
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS, PLACEHOLDER_ENABLED_INPUT_METHODS);
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.DEFAULT_INPUT_METHOD, PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+
+        mPlaceholderEnabledInputMethodsListOneDefaultable = Arrays
+                .stream(PLACEHOLDER_ENABLED_INPUT_METHODS.split(
+                        String.valueOf(InputMethodUtil.INPUT_METHOD_DELIMITER)))
+                .collect(Collectors.toList())
+                .stream().map(
+                        result -> {
+                            InputMethodInfo info = createMockInputMethodInfo(
+                                    mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+                            when(info.getId()).thenReturn(result);
+                            when(info.isDefault(mContext)).thenReturn(result.equals(
+                                    PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT));
+                            return info;
+                        })
+                .collect(Collectors.toList());
+        mPlaceholderEnabledInputMethodsListAllDefaultable = Arrays
+                .stream(PLACEHOLDER_ENABLED_INPUT_METHODS.split(String.valueOf(InputMethodUtil
+                        .INPUT_METHOD_DELIMITER)))
+                .collect(Collectors.toList())
+                .stream().map(
+                        result -> {
+                            InputMethodInfo info = createMockInputMethodInfo(
+                                    mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+                            when(info.getId()).thenReturn(result);
+                            when(info.isDefault(mContext)).thenReturn(true);
+                            return info;
+                        })
+                .collect(Collectors.toList());
+    }
+
+    @Test
+    public void getPermittedAndEnabledInputMethodList_noEnabledInputMethods_returnsNull() {
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(null);
+
+        List<InputMethodInfo> results = InputMethodUtil.getPermittedAndEnabledInputMethodList(
+                mInputMethodManager, mDevicePolicyManager);
+
+        assertThat(results).isNull();
+    }
+
+    @Test
+    public void getPermittedAndEnabledInputMethodList_noPermittedMethods_returnsEmptyList() {
+        String secondPlaceholderPackageName = "Different package";
+        InputMethodInfo info = createMockInputMethodInfoWithSubtypes(
+                mPackageManager, mInputMethodManager, PLACEHOLDER_PACKAGE_NAME);
+        when(mInputMethodManager.getEnabledInputMethodList())
+                .thenReturn(Collections.singletonList(info));
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser())
+                .thenReturn(Collections.singletonList(secondPlaceholderPackageName));
+
+        List<InputMethodInfo> results = InputMethodUtil.getPermittedAndEnabledInputMethodList(
+                mInputMethodManager, mDevicePolicyManager);
+
+        assertThat(results).isNotNull();
+        assertThat(results).isEmpty();
+    }
+
+    @Test
+    public void getPermittedAndEnabledInputMethodList_withGoogleTypingIME_doesNotIncludeIME() {
+        List<InputMethodInfo> googleVoiceTypingIMEList = new ArrayList<>();
+
+        InputMethodInfo placeholderIME = createMockInputMethodInfoWithSubtypes(
+                mPackageManager, mInputMethodManager, PLACEHOLDER_PACKAGE_NAME);
+
+        for (String gvtPackageName : InputMethodUtil.GVT_PACKAGE_NAMES) {
+            InputMethodInfo googleVoiceTypingIME = createMockInputMethodInfoWithSubtypes(
+                    mPackageManager, mInputMethodManager, gvtPackageName);
+            googleVoiceTypingIMEList.add(googleVoiceTypingIME);
+        }
+        ArrayList<InputMethodInfo> getEnabledInputMethodListReturnValue =
+                new ArrayList<InputMethodInfo>(googleVoiceTypingIMEList);
+        getEnabledInputMethodListReturnValue.add(placeholderIME);
+        when(mInputMethodManager.getEnabledInputMethodList())
+                .thenReturn(getEnabledInputMethodListReturnValue);
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+
+        List<InputMethodInfo> results = InputMethodUtil.getPermittedAndEnabledInputMethodList(
+                mInputMethodManager, mDevicePolicyManager);
+
+        assertThat(results).contains(placeholderIME);
+
+        // Check that the result does not contain any of the statically defined Voice Typing IMEs
+        for (InputMethodInfo googleVoiceTypingIME : googleVoiceTypingIMEList) {
+            assertThat(results).doesNotContain(googleVoiceTypingIME);
+        }
+    }
+
+    @Test
+    public void getPackageIcon_hasApplicationIcon() throws PackageManager.NameNotFoundException {
+        InputMethodInfo info = createMockInputMethodInfoWithSubtypes(mPackageManager,
+                mInputMethodManager, PLACEHOLDER_PACKAGE_NAME);
+        when(mPackageManager.getApplicationIcon(eq(info.getPackageName()))).thenReturn(mIcon);
+        assertThat(InputMethodUtil.getPackageIcon(mPackageManager, info)).isEqualTo(mIcon);
+    }
+
+    @Test
+    public void getPackageIcon_noApplicationIcon() throws PackageManager.NameNotFoundException {
+        InputMethodInfo info = createMockInputMethodInfoWithSubtypes(mPackageManager,
+                mInputMethodManager, PLACEHOLDER_PACKAGE_NAME);
+        when(mPackageManager.getApplicationIcon(PLACEHOLDER_PACKAGE_NAME)).thenThrow(
+                new PackageManager.NameNotFoundException());
+        assertThat(InputMethodUtil.getPackageIcon(mPackageManager, info)).isEqualTo(
+                InputMethodUtil.NO_ICON);
+    }
+
+    @Test
+    public void getPackageLabel() {
+        InputMethodInfo info = createMockInputMethodInfoWithSubtypes(mPackageManager,
+                mInputMethodManager, PLACEHOLDER_PACKAGE_NAME);
+        assertThat(InputMethodUtil.getPackageLabel(mPackageManager, info)).isEqualTo(
+                PLACEHOLDER_LABEL);
+    }
+
+    @Test
+    public void getSummaryString() {
+        InputMethodInfo info = createMockInputMethodInfoWithSubtypes(mPackageManager,
+                mInputMethodManager, PLACEHOLDER_PACKAGE_NAME);
+        assertThat(InputMethodUtil.getSummaryString(mContext, mInputMethodManager, info)).isEqualTo(
+                SUBTYPES_STRING);
+    }
+
+    @Test
+    public void isInputMethodEnabled_isDisabled_returnsFalse() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_DISABLED_INPUT_METHOD_ID);
+
+        assertThat(InputMethodUtil.isInputMethodEnabled(mContext.getContentResolver(), info))
+                .isFalse();
+    }
+
+    @Test
+    public void isInputMethodEnabled_isEnabled_returnsTrue() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+
+        assertThat(InputMethodUtil.isInputMethodEnabled(mContext.getContentResolver(), info))
+                .isTrue();
+    }
+
+    @Test
+    public void enableInputMethod_alreadyEnabled_remainsUnchanged() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+
+        InputMethodUtil.enableInputMethod(mContext.getContentResolver(), info);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHODS);
+    }
+
+    @Test
+    public void enableInputMethod_noEnabledInputMethods_addsIME() {
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS, "");
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+
+        InputMethodUtil.enableInputMethod(mContext.getContentResolver(), info);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+    }
+
+    @Test
+    public void enableInputMethod_someEnabledInputMethods_addsIME() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_DISABLED_INPUT_METHOD_ID);
+
+        InputMethodUtil.enableInputMethod(mContext.getContentResolver(), info);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHODS + ":"
+                        + PLACEHOLDER_DISABLED_INPUT_METHOD_ID);
+    }
+
+    @Test
+    public void disableInputMethod_notEnabled_remainsUnchanged() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_DISABLED_INPUT_METHOD_ID);
+        when(mInputMethodManager.getEnabledInputMethodList())
+                .thenReturn(mPlaceholderEnabledInputMethodsListAllDefaultable);
+
+        InputMethodUtil.disableInputMethod(mContext, mInputMethodManager, info);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHODS);
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.DEFAULT_INPUT_METHOD)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+    }
+
+    @Test
+    public void disableInputMethod_notDefault_removesIMEWhileDefaultRemainsSame() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_ENABLED_INPUT_METHOD_ID);
+        when(mInputMethodManager.getEnabledInputMethodList())
+                .thenReturn(mPlaceholderEnabledInputMethodsListAllDefaultable);
+
+        InputMethodUtil.disableInputMethod(mContext, mInputMethodManager, info);
+
+        assertThat(splitConcatenatedIdsIntoSet(Settings.Secure.getString(mContext
+                .getContentResolver(), Settings.Secure.ENABLED_INPUT_METHODS))).isEqualTo(
+                splitConcatenatedIdsIntoSet(PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT));
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.DEFAULT_INPUT_METHOD)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+    }
+
+    @Test
+    public void disableInputMethod_twoDefaultableIMEsEnabled_removesIMEAndChangesDefault() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+        when(mInputMethodManager.getEnabledInputMethodList())
+                .thenReturn(mPlaceholderEnabledInputMethodsListAllDefaultable);
+
+        InputMethodUtil.disableInputMethod(mContext, mInputMethodManager, info);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHOD_ID);
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.DEFAULT_INPUT_METHOD)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHOD_ID);
+    }
+
+    @Test
+    public void disableInputMethod_isDefaultWithNoOtherDefaultableEnabled_remainsUnchanged() {
+        InputMethodInfo info = createMockInputMethodInfo(mPackageManager, PLACEHOLDER_PACKAGE_NAME);
+        when(info.getId()).thenReturn(PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+        when(mInputMethodManager.getEnabledInputMethodList())
+                .thenReturn(mPlaceholderEnabledInputMethodsListOneDefaultable);
+
+        InputMethodUtil.disableInputMethod(mContext, mInputMethodManager, info);
+
+        assertThat(splitConcatenatedIdsIntoSet(Settings.Secure.getString(mContext
+                .getContentResolver(), Settings.Secure.ENABLED_INPUT_METHODS))).isEqualTo(
+                splitConcatenatedIdsIntoSet(PLACEHOLDER_ENABLED_INPUT_METHODS));
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.DEFAULT_INPUT_METHOD)).isEqualTo(
+                PLACEHOLDER_ENABLED_INPUT_METHOD_ID_DEFAULT);
+    }
+
+    private static InputMethodInfo createMockInputMethodInfoWithSubtypes(
+            PackageManager packageManager, InputMethodManager inputMethodManager,
+            String packageName) {
+        InputMethodInfo mockInfo = createMockInputMethodInfo(packageManager, packageName);
+        List<InputMethodSubtype> subtypes = createSubtypes();
+        when(inputMethodManager.getEnabledInputMethodSubtypeList(
+                eq(mockInfo), anyBoolean())).thenReturn(subtypes);
+        return mockInfo;
+    }
+
+    private static InputMethodInfo createMockInputMethodInfo(
+            PackageManager packageManager, String packageName) {
+        InputMethodInfo mockInfo = mock(InputMethodInfo.class);
+        when(mockInfo.getPackageName()).thenReturn(packageName);
+        when(mockInfo.loadLabel(packageManager)).thenReturn(PLACEHOLDER_LABEL);
+        when(mockInfo.getServiceInfo()).thenReturn(new ServiceInfo());
+        when(mockInfo.getSettingsActivity()).thenReturn(PLACEHOLDER_SETTINGS_ACTIVITY);
+        return mockInfo;
+    }
+
+    private static List<InputMethodSubtype> createSubtypes() {
+        List<InputMethodSubtype> subtypes = new ArrayList<>();
+        subtypes.add(createSubtype(1, "en_US"));
+        subtypes.add(createSubtype(2, "de_BE"));
+        subtypes.add(createSubtype(3, "oc-FR"));
+        return subtypes;
+    }
+
+    private static InputMethodSubtype createSubtype(int id, String locale) {
+        return new InputMethodSubtype.InputMethodSubtypeBuilder().setSubtypeId(id).setSubtypeLocale(
+                locale).setIsAuxiliary(false).setIsAsciiCapable(true).build();
+    }
+
+    private Set<String> splitConcatenatedIdsIntoSet(String ids) {
+        Set<String> result = new HashSet<>();
+
+        if (ids == null || ids.isEmpty()) {
+            return result;
+        }
+
+        InputMethodUtil.sInputMethodSplitter.setString(ids);
+        while (InputMethodUtil.sInputMethodSplitter.hasNext()) {
+            result.add(InputMethodUtil.sInputMethodSplitter.next());
+        }
+
+        return result;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/inputmethod/KeyboardManagementPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/inputmethod/KeyboardManagementPreferenceControllerTest.java
new file mode 100644
index 000000000..1e7a7ff51
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/inputmethod/KeyboardManagementPreferenceControllerTest.java
@@ -0,0 +1,1262 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.inputmethod;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.pm.PackageManager;
+import android.content.pm.ServiceInfo;
+import android.provider.Settings;
+import android.view.inputmethod.InputMethodInfo;
+import android.view.inputmethod.InputMethodManager;
+import android.view.inputmethod.InputMethodSubtype;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.preference.SwitchPreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.stubbing.Answer;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+import java.util.stream.Collectors;
+
+@RunWith(AndroidJUnit4.class)
+public class KeyboardManagementPreferenceControllerTest {
+    private static final String PLACEHOLDER_LABEL = "placeholder label";
+    private static final String PLACEHOLDER_SETTINGS_ACTIVITY = "placeholder settings activity";
+    private static final String PLACEHOLDER_PACKAGE_NAME = "placeholder package name";
+    private static final String PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE =
+            "placeholder id defaultable direct boot aware";
+    private static final String PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE =
+            "placeholder id defaultable not direct boot aware";
+    private static final String PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE =
+            "placeholder id not defaultable direct boot aware";
+    private static final String PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE =
+            "placeholder id not defaultable not direct boot aware";
+    private static final String DISALLOWED_PACKAGE_NAME = "disallowed package name";
+    private static final String ALLOWED_PACKAGE_NAME = "allowed package name";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private KeyboardManagementPreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreferenceGroup;
+    private CarUxRestrictions mCarUxRestrictions;
+    private List<String> mPermittedList;
+    private Map<String, InputMethodInfo> mInputMethodMap;
+    private String mInitialInputMethods;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DevicePolicyManager mDevicePolicyManager;
+    @Mock
+    private InputMethodManager mInputMethodManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mInputMethodMap = new HashMap<>();
+        mPermittedList = new ArrayList<>();
+        mPermittedList.add(PLACEHOLDER_PACKAGE_NAME);
+        mPermittedList.add(ALLOWED_PACKAGE_NAME);
+        mInitialInputMethods = Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS);
+
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDevicePolicyManager);
+        when(mContext.getSystemService(InputMethodManager.class)).thenReturn(mInputMethodManager);
+        when(mInputMethodManager.getInputMethodList()).thenReturn(new ArrayList<>());
+
+        mPreferenceController = new KeyboardManagementPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    public void tearDown() {
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS, mInitialInputMethods);
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_permitAllInputMethods_preferenceCountIs4() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(4);
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_multiplteAllowedImeByOrganization_allPreferencesVisible() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(
+                mPermittedList);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            assertThat(mPreferenceGroup.getPreference(i).isVisible()).isTrue();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_multipleEnabledInputMethods_allPreferencesEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(
+                mPermittedList);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            assertThat(mPreferenceGroup.getPreference(i).isEnabled()).isTrue();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_multipleEnabledInputMethods_allPreferencesChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(
+                mPermittedList);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            assertThat(((SwitchPreference) mPreferenceGroup.getPreference(i)).isChecked())
+                    .isTrue();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_disallowedByOrganization_preferenceShownDisabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(
+                mPermittedList);
+        List<InputMethodInfo> infos = createInputMethodInfoList(DISALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(infos.size());
+
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            SwitchPreference pref = (SwitchPreference) mPreferenceGroup.getPreference(i);
+            assertThat(pref.isVisible()).isTrue();
+            assertThat(pref.isEnabled()).isTrue();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_skipVoiceTyping() {
+        // TODO: b/236143731 Add Sufficient Testing to Prevent "Google Voice Typing" Regression
+        for (String gvtPackageName : InputMethodUtil.GVT_PACKAGE_NAMES) {
+            List<InputMethodInfo> infos =
+                    createInputMethodInfoList(gvtPackageName);
+            setInputMethodList(infos);
+
+            mPreferenceController.refreshUi();
+
+            assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_verifyPreferenceIcon() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreferenceGroup.getPreference(0);
+        assertThat(preference.getIcon()).isEqualTo(
+                InputMethodUtil.getPackageIcon(mContext.getPackageManager(), infos.get(0)));
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_verifyPreferenceTitle() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreferenceGroup.getPreference(0);
+        assertThat(preference.getTitle()).isEqualTo(
+                InputMethodUtil.getPackageLabel(mContext.getPackageManager(), infos.get(0)));
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_verifyPreferenceSummary() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(ALLOWED_PACKAGE_NAME,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        Preference preference = mPreferenceGroup.getPreference(0);
+        assertThat(preference.getSummary()).isEqualTo(
+                InputMethodUtil.getSummaryString(mContext, mInputMethodManager, infos.get(0)));
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_oneInputMethod_noneEnabled_oneInputMethodPreferenceInView() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_oneInputMethod_noneEnabled_preferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreference(0).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_oneInputMethod_noneEnabled_preferenceNotChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        assertThat(((SwitchPreference) mPreferenceGroup.getPreference(0)).isChecked())
+                .isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_oneInputMethod_defaultable_notChecked_preferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreference(0).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_securityDialogShown() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        verify(mMockFragmentController).showDialog(
+                any(ConfirmationDialogFragment.class),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showSecurityDialog_positive_noOtherPreferenceAdded() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreferenceGroup.getPreference(0).getKey()).isEqualTo(
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showSecurityDialog_positive_preferenceChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(((SwitchPreference) mPreferenceGroup.getPreference(0)).isChecked())
+                .isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showSecurityDialog_positive_preferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(mPreferenceGroup.getPreference(0).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showSecurityDialog_positive_inputMethodEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(getEnabledInputMethodList().get(0).getId())
+                .isEqualTo(PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showSecurityDialog_negative_noOtherPreferenceAdded() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_NEGATIVE);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreferenceGroup.getPreference(0).getKey()).isEqualTo(
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showSecurityDialog_negative_preferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_NEGATIVE);
+
+        assertThat(mPreferenceGroup.getPreference(0).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showSecurityDialog_negative_inputMethodDisabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_NEGATIVE);
+
+        assertThat(((SwitchPreference) mPreferenceGroup.getPreference(0)).isChecked())
+                .isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_directBootWarningShown() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+
+        verify(mMockFragmentController).showDialog(
+                any(ConfirmationDialogFragment.class),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_positive_noOtherPreferenceAdded() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreferenceGroup.getPreference(0).getKey()).isEqualTo(
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_positive_preferenceChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(((SwitchPreference) mPreferenceGroup.getPreference(0)).isChecked())
+                .isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_positive_preferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(mPreferenceGroup.getPreference(0).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_positive_inputMethodEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        assertThat(getEnabledInputMethodList().get(0).getId())
+                .isEqualTo(PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_negative_noOtherPreferenceAdded() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_NEGATIVE);
+
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreferenceGroup.getPreference(0).getKey()).isEqualTo(
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_negative_preferenceNotChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_NEGATIVE);
+
+
+        assertThat(((SwitchPreference) mPreferenceGroup.getPreference(0)).isChecked())
+                .isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_negative_preferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_NEGATIVE);
+
+        assertThat(mPreferenceGroup.getPreference(0).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_showDirectBootDialog_negative_inputMethodDisabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(new ArrayList<>());
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> securityDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(
+                securityDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = securityDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        ArgumentCaptor<ConfirmationDialogFragment> bootDialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(bootDialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.DIRECT_BOOT_WARN_DIALOG_TAG));
+        dialogFragment = bootDialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_NEGATIVE);
+
+        assertThat(mInputMethodManager.getEnabledInputMethodList().size())
+                .isEqualTo(0);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_noOtherPreferenceAdded() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreferenceGroup.getPreference(0).getKey()).isEqualTo(
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_preferenceNotChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        assertThat(((SwitchPreference) mPreferenceGroup.getPreference(0)).isChecked())
+                .isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_preferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        assertThat((mPreferenceGroup.getPreference(0)).isEnabled())
+                .isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_inputMethodDisabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        mPreferenceGroup.getPreference(0).performClick();
+
+        assertThat(mInputMethodManager.getEnabledInputMethodList().size())
+                .isEqualTo(0);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_twoDefaultable_notClickDefaultablePreferenceDisabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup, PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE)
+                .performClick();
+
+        assertThat(getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE).isEnabled()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_twoDefaultable_clickedDefaultablePreferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).performClick();
+
+        assertThat(getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_twoDefaultable_nonDefaultablePreferenceEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).performClick();
+
+        assertThat(getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_twoDefaultable_clickedDefaultablePreferenceNotChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).performClick();
+
+        assertThat(((SwitchPreference) getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE)).isChecked()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_twoDefaultable_notClickedDefaultablePreferenceChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).performClick();
+
+        assertThat(((SwitchPreference) getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE)).isChecked()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleFalse_twoDefaultable_nonDefaultablePreferenceChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        setEnabledInputMethodList(infos);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).performClick();
+
+        assertThat(((SwitchPreference) getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE)).isChecked()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_twoDefaultable_allPreferencesEnabled() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        List<InputMethodInfo> infos2 = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setEnabledInputMethodList(infos2);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            assertThat(mPreferenceGroup.getPreference(i).isEnabled()).isTrue();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_toggleTrue_twoDefaultable_allPreferencesChecked() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        List<InputMethodInfo> infos = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setInputMethodList(infos);
+        List<InputMethodInfo> infos2 = createInputMethodInfoList(
+                ALLOWED_PACKAGE_NAME, PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE,
+                PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE);
+        setEnabledInputMethodList(infos2);
+
+        mPreferenceController.refreshUi();
+
+        getPreferenceFromGroupByKey(mPreferenceGroup,
+                PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE).performClick();
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(KeyboardManagementPreferenceController.SECURITY_WARN_DIALOG_TAG));
+        ConfirmationDialogFragment dialogFragment = dialogCaptor.getValue();
+
+        dialogFragment.onClick(null, DialogInterface.BUTTON_POSITIVE);
+
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            assertThat(((SwitchPreference) mPreferenceGroup.getPreference(i)).isChecked())
+                    .isTrue();
+        }
+    }
+
+    private InputMethodInfo createMockInputMethodInfo(
+            Context context, PackageManager packageManager,
+            String packageName, String id, boolean isDefaultable, boolean directBootAware) {
+        ServiceInfo mockServiceInfo = mock(ServiceInfo.class);
+        mockServiceInfo.directBootAware = directBootAware;
+
+        InputMethodInfo mockInfo = mock(InputMethodInfo.class);
+        when(mockInfo.getPackageName()).thenReturn(packageName);
+        when(mockInfo.loadLabel(packageManager)).thenReturn(PLACEHOLDER_LABEL);
+        when(mockInfo.getServiceInfo()).thenReturn(mockServiceInfo);
+        when(mockInfo.getSettingsActivity()).thenReturn(PLACEHOLDER_SETTINGS_ACTIVITY);
+        when(mockInfo.getId()).thenReturn(id);
+        when(mockInfo.isDefault(context)).thenReturn(isDefaultable);
+        List<InputMethodSubtype> subtypes = createSubtypes();
+        when(mInputMethodManager.getEnabledInputMethodSubtypeList(any(), anyBoolean()))
+                .thenReturn(subtypes);
+        return mockInfo;
+    }
+
+    private static Preference getPreferenceFromGroupByKey(PreferenceGroup prefGroup, String key) {
+        for (int i = 0; i < prefGroup.getPreferenceCount(); i++) {
+            Preference pref = prefGroup.getPreference(i);
+            if (pref.getKey().equals(key)) {
+                return pref;
+            }
+        }
+        return null;
+    }
+
+    private static List<InputMethodSubtype> createSubtypes() {
+        List<InputMethodSubtype> subtypes = new ArrayList<>();
+        subtypes.add(createSubtype(1, "en_US"));
+        subtypes.add(createSubtype(2, "de_BE"));
+        subtypes.add(createSubtype(3, "oc-FR"));
+        return subtypes;
+    }
+
+    private static InputMethodSubtype createSubtype(int id, String locale) {
+        return new InputMethodSubtype.InputMethodSubtypeBuilder().setSubtypeId(id)
+                .setSubtypeLocale(locale).setIsAuxiliary(false).setIsAsciiCapable(true).build();
+    }
+
+    private List<InputMethodInfo> createInputMethodInfoList(String packageName, String... ids) {
+        List<InputMethodInfo> infos = new ArrayList<>();
+        PackageManager packageManager = mContext.getPackageManager();
+        List<String> idsList = Arrays.asList(ids);
+        idsList.forEach(id -> {
+            boolean defaultable;
+            boolean directBootAware;
+            switch (id) {
+                case PLACEHOLDER_ID_DEFAULTABLE_DIRECT_BOOT_AWARE:
+                    defaultable = true;
+                    directBootAware = true;
+                    break;
+                case PLACEHOLDER_ID_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE:
+                    defaultable = true;
+                    directBootAware = false;
+                    break;
+                case PLACEHOLDER_ID_NOT_DEFAULTABLE_DIRECT_BOOT_AWARE:
+                    defaultable = false;
+                    directBootAware = true;
+                    break;
+                default: //case PLACEHOLDER_ID_NOT_DEFAULTABLE_NOT_DIRECT_BOOT_AWARE:
+                    defaultable = false;
+                    directBootAware = false;
+                    break;
+            }
+            infos.add(createMockInputMethodInfo(mContext, packageManager, packageName, id,
+                    defaultable, directBootAware));
+        });
+        return infos;
+    }
+
+    private void setInputMethodList(List<InputMethodInfo> list) {
+        when(mInputMethodManager.getInputMethodList()).thenReturn(list);
+        if (list != null && list.size() > 0) {
+            addInputMethodInfosToMap(list);
+        }
+    }
+
+    private void setEnabledInputMethodList(List<InputMethodInfo> list) {
+        if (list == null || list.size() == 0) {
+            Settings.Secure.putString(mContext.getContentResolver(),
+                    Settings.Secure.ENABLED_INPUT_METHODS, "");
+            return;
+        }
+
+        String concatenatedInputMethodIds = createInputMethodIdString(list.stream().map(
+                imi -> imi.getId()).collect(Collectors.toList()).toArray(new String[list.size()]));
+        Settings.Secure.putString(mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS, concatenatedInputMethodIds);
+        addInputMethodInfosToMap(list);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenAnswer(
+                (Answer<List<InputMethodInfo>>) invocation -> getEnabledInputMethodList());
+    }
+
+    private List<InputMethodInfo> getEnabledInputMethodList() {
+        List<InputMethodInfo> enabledInputMethodList = new ArrayList<>();
+
+        String inputMethodIdString = Settings.Secure.getString(
+                mContext.getContentResolver(),
+                Settings.Secure.ENABLED_INPUT_METHODS);
+        if (inputMethodIdString == null || inputMethodIdString.isEmpty()) {
+            return enabledInputMethodList;
+        }
+
+        InputMethodUtil.sInputMethodSplitter.setString(inputMethodIdString);
+        while (InputMethodUtil.sInputMethodSplitter.hasNext()) {
+            enabledInputMethodList.add(mInputMethodMap.get(InputMethodUtil.sInputMethodSplitter
+                    .next()));
+        }
+        return enabledInputMethodList;
+    }
+
+    private String createInputMethodIdString(String... ids) {
+        int size = ids == null ? 0 : ids.length;
+
+        if (size == 1) {
+            return ids[0];
+        }
+
+        StringBuilder builder = new StringBuilder();
+        for (int i = 0; i < size; i++) {
+            builder.append(ids[i]);
+            if (i != size - 1) {
+                builder.append(InputMethodUtil.INPUT_METHOD_DELIMITER);
+            }
+        }
+        return builder.toString();
+    }
+
+    private void addInputMethodInfosToMap(List<InputMethodInfo> inputMethodInfos) {
+        if (mInputMethodMap == null || mInputMethodMap.size() == 0) {
+            mInputMethodMap = inputMethodInfos.stream().collect(Collectors.toMap(
+                    InputMethodInfo::getId, imi -> imi));
+            return;
+        }
+
+        inputMethodInfos.forEach(imi -> {
+            mInputMethodMap.put(imi.getId(), imi);
+        });
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/inputmethod/KeyboardPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/inputmethod/KeyboardPreferenceControllerTest.java
new file mode 100644
index 000000000..6e190f8dd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/inputmethod/KeyboardPreferenceControllerTest.java
@@ -0,0 +1,216 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.inputmethod;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.content.pm.ServiceInfo;
+import android.view.inputmethod.InputMethodInfo;
+import android.view.inputmethod.InputMethodManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class KeyboardPreferenceControllerTest {
+    private static final String EMPTY = "";
+    private static final String PLACEHOLDER_LABEL = "placeholder label";
+    private static final String PLACEHOLDER_LABEL_1 = "placeholder label 1";
+    private static final String PLACEHOLDER_LABEL_2 = "placeholder label 2";
+    private static final String PLACEHOLDER_SETTINGS_ACTIVITY = "placeholder settings activity";
+    private static final String PLACEHOLDER_PACKAGE_NAME = "placeholder package name";
+    private static final String ALLOWED_PACKAGE_NAME = "allowed package name";
+    private static final String DISALLOWED_PACKAGE_NAME = "disallowed package name";
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private KeyboardPreferenceController mPreferenceController;
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private List<String> mPermittedList;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DevicePolicyManager mDevicePolicyManager;
+    @Mock
+    private InputMethodManager mInputMethodManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPermittedList = new ArrayList<>();
+        mPermittedList.add(PLACEHOLDER_PACKAGE_NAME);
+        mPermittedList.add(ALLOWED_PACKAGE_NAME);
+
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDevicePolicyManager);
+        when(mContext.getSystemService(InputMethodManager.class)).thenReturn(mInputMethodManager);
+
+        mPreferenceController = new KeyboardPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController,
+                mCarUxRestrictions);
+        mPreference = new Preference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_noInputMethodInfo() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(Collections.emptyList());
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isEqualTo(EMPTY);
+    }
+
+    @Test
+    public void refreshUi_permitAllInputMethods_hasOneInputMethodInfo() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+
+        List<InputMethodInfo> infos = new ArrayList<>();
+        PackageManager packageManager = mContext.getPackageManager();
+        infos.add(
+                createInputMethodInfo(packageManager, PLACEHOLDER_PACKAGE_NAME, PLACEHOLDER_LABEL));
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isNotNull();
+        assertThat(mPreference.getSummary().toString().contains(PLACEHOLDER_LABEL)).isTrue();
+    }
+
+    @Test
+    public void refreshUi_permitAllInputMethods_hasTwoInputMethodInfo() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+
+        List<InputMethodInfo> infos = new ArrayList<>();
+        PackageManager packageManager = mContext.getPackageManager();
+        infos.add(createInputMethodInfo(packageManager, PLACEHOLDER_PACKAGE_NAME,
+                PLACEHOLDER_LABEL));
+        infos.add(createInputMethodInfo(packageManager, PLACEHOLDER_PACKAGE_NAME,
+                PLACEHOLDER_LABEL_1));
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isNotNull();
+        assertThat(mPreference.getSummary().toString().contains(PLACEHOLDER_LABEL)).isTrue();
+        assertThat(mPreference.getSummary().toString().contains(PLACEHOLDER_LABEL_1)).isTrue();
+    }
+
+    @Test
+    public void refreshUi_permitAllInputMethods_hasThreeInputMethodInfo() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(null);
+
+        List<InputMethodInfo> infos = new ArrayList<>();
+        PackageManager packageManager = mContext.getPackageManager();
+        infos.add(createInputMethodInfo(packageManager, PLACEHOLDER_PACKAGE_NAME,
+                PLACEHOLDER_LABEL));
+        infos.add(createInputMethodInfo(packageManager, PLACEHOLDER_PACKAGE_NAME,
+                PLACEHOLDER_LABEL_1));
+        infos.add(createInputMethodInfo(packageManager, PLACEHOLDER_PACKAGE_NAME,
+                PLACEHOLDER_LABEL_2));
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isNotNull();
+        assertThat(mPreference.getSummary().toString().contains(PLACEHOLDER_LABEL)).isTrue();
+        assertThat(mPreference.getSummary().toString().contains(PLACEHOLDER_LABEL_1)).isTrue();
+        assertThat(mPreference.getSummary().toString().contains(PLACEHOLDER_LABEL_2)).isTrue();
+    }
+
+    @Test
+    public void refreshUi_hasAllowedImeByOrganization() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(
+                mPermittedList);
+
+        List<InputMethodInfo> infos = new ArrayList<>();
+        PackageManager packageManager = mContext.getPackageManager();
+        infos.add(createInputMethodInfo(packageManager, ALLOWED_PACKAGE_NAME, PLACEHOLDER_LABEL));
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isEqualTo(PLACEHOLDER_LABEL);
+    }
+
+    @Test
+    public void refreshUi_disallowedByOrganization() {
+        when(mDevicePolicyManager.getPermittedInputMethodsForCurrentUser()).thenReturn(
+                mPermittedList);
+
+        List<InputMethodInfo> infos = new ArrayList<>();
+        PackageManager packageManager = mContext.getPackageManager();
+        infos.add(
+                createInputMethodInfo(packageManager, DISALLOWED_PACKAGE_NAME, PLACEHOLDER_LABEL));
+        when(mInputMethodManager.getEnabledInputMethodList()).thenReturn(infos);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isEqualTo(EMPTY);
+    }
+
+    private static InputMethodInfo createInputMethodInfo(
+            PackageManager packageManager, String packageName, String label) {
+        ResolveInfo resolveInfo = mock(ResolveInfo.class);
+        ServiceInfo serviceInfo = new ServiceInfo();
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+        applicationInfo.packageName = packageName;
+        applicationInfo.enabled = true;
+        applicationInfo.flags |= ApplicationInfo.FLAG_SYSTEM;
+        serviceInfo.applicationInfo = applicationInfo;
+        serviceInfo.enabled = true;
+        serviceInfo.packageName = packageName;
+        serviceInfo.name = label;
+        serviceInfo.exported = true;
+        serviceInfo.nonLocalizedLabel = label;
+        resolveInfo.serviceInfo = serviceInfo;
+        resolveInfo.nonLocalizedLabel = label;
+        when(resolveInfo.loadLabel(packageManager)).thenReturn(label);
+        return new InputMethodInfo(resolveInfo,
+                /* isAuxIme= */ false,
+                PLACEHOLDER_SETTINGS_ACTIVITY,
+                /* subtypes= */ null,
+                /* isDefaultResId= */ 1,
+                /* forceDefault= */ false);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/language/LanguageBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/language/LanguageBasePreferenceControllerTest.java
new file mode 100644
index 000000000..d6ebe8200
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/language/LanguageBasePreferenceControllerTest.java
@@ -0,0 +1,264 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.language;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.internal.app.LocalePicker;
+import com.android.internal.app.LocaleStore;
+import com.android.internal.app.SuggestedLocaleAdapter;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.runner.RunWith;
+import org.junit.Test;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Arrays;
+import java.util.HashSet;
+import java.util.Locale;
+
+@RunWith(AndroidJUnit4.class)
+public class LanguageBasePreferenceControllerTest {
+
+    private static final LocaleStore.LocaleInfo TEST_LOCALE_INFO = LocaleStore.getLocaleInfo(
+            Locale.FRENCH);
+
+    private LanguageBasePreferenceController mController;
+    private Context mContext;
+    private PreferenceGroup mPreferenceGroup;
+    private MockitoSession mSession;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private SuggestedLocaleAdapter mSuggestedLocaleAdapter;
+    @Mock
+    private LocaleStore.LocaleInfo mLocaleInfo;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        LifecycleOwner lifecycleOwner = new TestLifecycleOwner();
+
+        mContext = ApplicationProvider.getApplicationContext();
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        initMocks();
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        LocalePreferenceProvider localePreferenceProvider =
+                new LocalePreferenceProvider(mContext, mSuggestedLocaleAdapter);
+        mController = new LanguageBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, carUxRestrictions) {
+            @Override
+            protected LocalePreferenceProvider defineLocaleProvider() {
+                return localePreferenceProvider;
+            }
+        };
+        PreferenceControllerTestUtil.assignPreference(mController, mPreferenceGroup);
+
+        mController.onCreate(lifecycleOwner);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testRefreshUi_groupConstructed() {
+        when(mSuggestedLocaleAdapter.getCount()).thenReturn(1);
+        when(mSuggestedLocaleAdapter.getItemViewType(0)).thenReturn(
+                LocalePreferenceProvider.TYPE_LOCALE);
+        when(mSuggestedLocaleAdapter.getItem(0)).thenReturn(TEST_LOCALE_INFO);
+        mController.refreshUi();
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void testOnPreferenceClick_noLocale_returnsFalse() {
+        assertThat(mController.onPreferenceClick(new Preference(mContext))).isFalse();
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasMultipleChildLocales_returnsTrue() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        ExtendedMockito.when(LocaleStore.getLevelLocales(mContext,
+                mController.getExclusionSet(), mLocaleInfo, true))
+                .thenReturn(new HashSet<>(Arrays.asList(
+                        mock(LocaleStore.LocaleInfo.class),
+                        mock(LocaleStore.LocaleInfo.class))));
+        Preference preference = new Preference(mContext);
+
+        assertThat(mController.onPreferenceClick(preference)).isTrue();
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasMultipleChildLocales_localeNotUpdated() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        ExtendedMockito.when(LocaleStore.getLevelLocales(mContext,
+                mController.getExclusionSet(), mLocaleInfo, true))
+                .thenReturn(new HashSet<>(Arrays.asList(
+                        mock(LocaleStore.LocaleInfo.class),
+                        mock(LocaleStore.LocaleInfo.class))));
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+
+        ExtendedMockito.verify(() -> LocalePicker.updateLocale(any()), never());
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasMultipleChildLocales_neverCallsGoBack() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        ExtendedMockito.when(LocaleStore.getLevelLocales(mContext,
+                mController.getExclusionSet(), mLocaleInfo, true))
+                .thenReturn(new HashSet<>(Arrays.asList(
+                        mock(LocaleStore.LocaleInfo.class),
+                        mock(LocaleStore.LocaleInfo.class))));
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+
+        verify(mFragmentController, never()).goBack();
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasSingleChildLocale_returnsTrue() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        ExtendedMockito.when(LocaleStore.getLevelLocales(mContext,
+                mController.getExclusionSet(), mLocaleInfo, true))
+                .thenReturn(new HashSet<>(Arrays.asList(
+                        mock(LocaleStore.LocaleInfo.class))));
+        Preference preference = new Preference(mContext);
+        assertThat(mController.onPreferenceClick(preference)).isTrue();
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasSingleChildLocale_localeUpdated() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        ExtendedMockito.when(LocaleStore.getLevelLocales(mContext,
+                mController.getExclusionSet(), mLocaleInfo, true))
+                .thenReturn(new HashSet<>(Arrays.asList(
+                        mock(LocaleStore.LocaleInfo.class))));
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+
+        ExtendedMockito.verify(() -> LocalePicker.updateLocale(any()), times(1));
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasSingleChildLocale_callsGoBack() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        ExtendedMockito.when(LocaleStore.getLevelLocales(mContext,
+                mController.getExclusionSet(), mLocaleInfo, true))
+                .thenReturn(new HashSet<>(Arrays.asList(
+                        mock(LocaleStore.LocaleInfo.class))));
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+
+        verify(mFragmentController).goBack();
+    }
+
+    @Test
+    public void testOnPreferenceClick_noChildLocale_returnsFalse() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        Preference preference = new Preference(mContext);
+        assertThat(mController.onPreferenceClick(preference)).isFalse();
+    }
+
+    @Test
+    public void testOnPreferenceClick_noChildLocale_localeNotUpdated() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+        ExtendedMockito.verify(() -> LocalePicker.updateLocale(any()), never());
+    }
+
+    @Test
+    public void testOnPreferenceClick_noChildLocale_neverCallsGoBack() {
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+        verify(mFragmentController, never()).goBack();
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasParentLocale_returnsTrue() {
+        when(mLocaleInfo.getParent()).thenReturn(Locale.ENGLISH);
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        Preference preference = new Preference(mContext);
+        assertThat(mController.onPreferenceClick(preference)).isTrue();
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasParentLocale_localeUpdated() {
+        when(mLocaleInfo.getParent()).thenReturn(Locale.ENGLISH);
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+        ExtendedMockito.verify(() -> LocalePicker.updateLocale(any()), times(1));
+    }
+
+    @Test
+    public void testOnPreferenceClick_hasParentLocale_callsGoBack() {
+        when(mLocaleInfo.getParent()).thenReturn(Locale.ENGLISH);
+        when(LocaleUtil.getLocaleArgument(any())).thenReturn(mLocaleInfo);
+        Preference preference = new Preference(mContext);
+        mController.onPreferenceClick(preference);
+        verify(mFragmentController).goBack();
+    }
+
+    private void initMocks() {
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(LocalePicker.class, withSettings().lenient())
+                .mockStatic(LocaleStore.class, withSettings().lenient())
+                .mockStatic(LocaleUtil.class, withSettings().lenient())
+                .startMocking();
+        }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/language/LanguageSettingsEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/language/LanguageSettingsEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..9ef41cdd7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/language/LanguageSettingsEntryPreferenceControllerTest.java
@@ -0,0 +1,171 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.language;
+
+import static android.os.UserManager.DISALLOW_CONFIG_LOCALE;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.common.PreferenceXmlParser.PREF_AVAILABILITY_STATUS_HIDDEN;
+import static com.android.car.settings.common.PreferenceXmlParser.PREF_AVAILABILITY_STATUS_READ;
+import static com.android.car.settings.common.PreferenceXmlParser.PREF_AVAILABILITY_STATUS_WRITE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.internal.app.LocaleHelper;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+import java.util.Locale;
+
+@RunWith(AndroidJUnit4.class)
+public class LanguageSettingsEntryPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private LanguageSettingsEntryPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mController = new LanguageSettingsEntryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+    }
+
+    @Test
+    public void onCreate_setsSummary() {
+        mController.onCreate(mLifecycleOwner);
+
+        Locale locale = mController.getConfiguredLocale();
+        String summary = LocaleHelper.getDisplayName(locale, locale, /* sentenceCase= */ true);
+        assertThat(mPreference.getSummary()).isEqualTo(summary);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noRestriction_zoneWrite_available() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_CONFIG_LOCALE, false);
+        mController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_WRITE);
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasRestriction_zoneWrite_disabledForProfile() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_CONFIG_LOCALE, true);
+        mController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_WRITE);
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getDefaultAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noRestriction_zoneRead_availableForViewing() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_CONFIG_LOCALE, false);
+        mController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_READ);
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasRestriction_zoneRead_disabledForProfile() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_CONFIG_LOCALE, true);
+        mController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_READ);
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noRestriction_zoneHidden_conditionallyUnavailable() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_CONFIG_LOCALE, false);
+        mController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_HIDDEN);
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasRestriction_zoneHidden_disabledForProfile() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_CONFIG_LOCALE, true);
+        mController.setAvailabilityStatusForZone(PREF_AVAILABILITY_STATUS_HIDDEN);
+
+        mController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                DISABLED_FOR_PROFILE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/AdasLocationSwitchPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/AdasLocationSwitchPreferenceControllerTest.java
new file mode 100644
index 000000000..8cc0b93e6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/AdasLocationSwitchPreferenceControllerTest.java
@@ -0,0 +1,527 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assert.assertTrue;
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.any;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.app.AlertDialog;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.Intent;
+import android.content.IntentFilter;
+import android.location.LocationManager;
+import android.platform.test.annotations.DisableFlags;
+import android.platform.test.annotations.EnableFlags;
+import android.platform.test.flag.junit.SetFlagsRule;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.R;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiSwitchPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AdasLocationSwitchPreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private CarUiSwitchPreference mSwitchPreference;
+    private AdasLocationSwitchPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Mock
+    private LocationManager mLocationManager;
+
+    @Mock
+    private Toast mToast;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(Toast.class,
+                withSettings().lenient()).startMocking();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSwitchPreference = new CarUiSwitchPreference(mContext);
+    }
+
+    @After
+    public void tearDown() {
+        mSession.finishMocking();
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void unclickable_switchDisabled() throws Throwable {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsClickable(false);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void notVisible_switchHidden() throws Throwable {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsVisible(false);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void isVisible_switchShown() throws Throwable {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsVisible(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void unclickable_onPreferenceClicked_noChange_showToggleDisabledDialog() {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsClickable(false);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+        verify(mLocationManager, never()).setAdasGnssLocationEnabled(anyBoolean());
+        verify(mFragmentController)
+                .showDialog(any(ConfirmationDialogFragment.class),
+                        eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void unclickable_powerPolicyOff_onPreferenceClicked_showToggleDisabledDialog() {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsClickable(false);
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        mSwitchPreference.performClick();
+
+        verify(mLocationManager, never()).setAdasGnssLocationEnabled(anyBoolean());
+        verify(mFragmentController)
+                .showDialog(any(ConfirmationDialogFragment.class),
+                        eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void powerPolicyOff_onPreferenceClicked_showCorrectToast() throws Throwable {
+        int correctToastId = R.string.power_component_disabled;
+        mActivityTestRule.runOnUiThread(() -> {
+            ExtendedMockito.when(Toast.makeText(any(), eq(correctToastId), anyInt()))
+                    .thenReturn(mToast);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsClickable(true);
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        mSwitchPreference.performClick();
+
+        verify(mToast).show();
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void powerPolicyOff_onPreferenceClicked_showCorrectToast_flagReq() throws Throwable {
+        int correctToastId = R.string.power_component_disabled;
+        mActivityTestRule.runOnUiThread(() -> {
+            ExtendedMockito.when(Toast.makeText(any(), eq(correctToastId), anyInt()))
+                    .thenReturn(mToast);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsVisible(true);
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        mSwitchPreference.performClick();
+
+        verify(mToast).show();
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onAdasIntentReceived_updateUi() {
+        initializePreference(/* isAdasLocationEnabled= */false, /* isMainLocationEnabled= */false);
+        setIsClickable(true);
+
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        ArgumentCaptor<IntentFilter> intentFilterCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+        verify(mContext, times(1))
+                .registerReceiver(broadcastReceiverArgumentCaptor.capture(),
+                        intentFilterCaptor.capture(), eq(Context.RECEIVER_NOT_EXPORTED));
+        List<IntentFilter> actions = intentFilterCaptor.getAllValues();
+        assertTrue(actions.get(0).hasAction(LocationManager.ACTION_ADAS_GNSS_ENABLED_CHANGED));
+
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(true);
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(LocationManager.ACTION_ADAS_GNSS_ENABLED_CHANGED));
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onAdasIntentReceived_updateUi_flagReq() {
+        initializePreference(/* isAdasLocationEnabled= */false, /* isMainLocationEnabled= */false);
+        setIsVisible(true);
+
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        ArgumentCaptor<IntentFilter> intentFilterCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+        verify(mContext, times(1))
+                .registerReceiver(broadcastReceiverArgumentCaptor.capture(),
+                        intentFilterCaptor.capture(), eq(Context.RECEIVER_NOT_EXPORTED));
+        List<IntentFilter> actions = intentFilterCaptor.getAllValues();
+        assertTrue(actions.get(0).hasAction(LocationManager.ACTION_ADAS_GNSS_ENABLED_CHANGED));
+
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(true);
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(LocationManager.ACTION_ADAS_GNSS_ENABLED_CHANGED));
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onLocationIntentReceived_updateUi() {
+        initializePreference(/* isAdasLocationEnabled= */false, /* isMainLocationEnabled= */false);
+        setIsClickable(true);
+
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        ArgumentCaptor<IntentFilter> intentFilterCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+
+        verify(mContext, times(1))
+                .registerReceiver(broadcastReceiverArgumentCaptor.capture(),
+                        intentFilterCaptor.capture(), eq(Context.RECEIVER_NOT_EXPORTED));
+        List<IntentFilter> actions = intentFilterCaptor.getAllValues();
+        assertTrue(actions.get(0).hasAction(LocationManager.MODE_CHANGED_ACTION));
+
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(true);
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(LocationManager.MODE_CHANGED_ACTION));
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onLocationIntentReceived_updateUi_flagReq() {
+        initializePreference(/* isAdasLocationEnabled= */false, /* isMainLocationEnabled= */false);
+        setIsVisible(true);
+
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        ArgumentCaptor<IntentFilter> intentFilterCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+
+        verify(mContext, times(1))
+                .registerReceiver(broadcastReceiverArgumentCaptor.capture(),
+                        intentFilterCaptor.capture(), eq(Context.RECEIVER_NOT_EXPORTED));
+        List<IntentFilter> actions = intentFilterCaptor.getAllValues();
+        assertTrue(actions.get(0).hasAction(LocationManager.MODE_CHANGED_ACTION));
+
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(true);
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(LocationManager.MODE_CHANGED_ACTION));
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPreferenceClicked_adasDisabled_shouldEnable_notShowDialog() {
+        initializePreference(/* isAdasLocationEnabled= */false, /* isMainLocationEnabled= */false);
+        setIsClickable(true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+        verify(mLocationManager).setAdasGnssLocationEnabled(true);
+        verify(mFragmentController, never())
+                .showDialog(any(ConfirmationDialogFragment.class), any());
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPreferenceClicked_adasDisabled_shouldEnable() {
+        initializePreference(/* isAdasLocationEnabled= */false, /* isMainLocationEnabled= */false);
+        setIsVisible(true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+        verify(mLocationManager).setAdasGnssLocationEnabled(true);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPreferenceClicked_adasEnabled_shouldStayEnable_showDialog() {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsClickable(true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+        verify(mLocationManager, never()).setLocationEnabledForUser(anyBoolean(), any());
+        verify(mFragmentController)
+                .showDialog(any(ConfirmationDialogFragment.class),
+                        eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPreferenceClicked_adasEnabled_shouldDisable_flagReq() {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsVisible(true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+        verify(mLocationManager).setAdasGnssLocationEnabled(false);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void confirmDialog_turnOffDriverAssistance() throws Throwable {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsClickable(true);
+
+        mSwitchPreference.performClick();
+
+        // Capture the dialog that is shown on toggle.
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mFragmentController).showDialog(dialogCaptor.capture(),
+                eq(ConfirmationDialogFragment.TAG));
+
+        // Show the captured dialog on press the confirmation button.
+        ConfirmationDialogFragment dialog = dialogCaptor.getValue();
+        assertThat(dialogCaptor).isNotNull();
+        AlertDialog alertDialog = showDialog(dialog);
+
+        // Confirm action is the listener of negative button.
+        mActivityTestRule.runOnUiThread(() -> {
+            alertDialog.getButton(DialogInterface.BUTTON_NEGATIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mLocationManager).setAdasGnssLocationEnabled(false);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPowerPolicyChange_isEnabledChanges() {
+        initializePreference(/* isAdasLocationEnabled= */ true, /* isMainLocationEnabled= */ false);
+        setIsClickable(true);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPowerPolicyChange_isEnabledChanges_flagReq() {
+        initializePreference(/* isAdasLocationEnabled= */ true, /* isMainLocationEnabled= */ false);
+        setIsVisible(true);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPowerPolicyChange_enabled_locationEnabled_switchStaysDisabled() {
+        initializePreference(/* isAdasLocationEnabled= */ true, /* isMainLocationEnabled= */ true);
+        setIsClickable(true);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void onPowerPolicyChange_enabled_locationEnabled_switchStaysDisabled_flagReq() {
+        initializePreference(/* isAdasLocationEnabled= */ true, /* isMainLocationEnabled= */ true);
+        setIsVisible(true);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void cancelDialog_DriverAssistanceStaysOn() throws Throwable {
+        initializePreference(/* isAdasLocationEnabled= */true, /* isMainLocationEnabled= */false);
+        setIsClickable(true);
+
+        mSwitchPreference.performClick();
+
+        // Capture the dialog that is shown on toggle.
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mFragmentController).showDialog(dialogCaptor.capture(),
+                eq(ConfirmationDialogFragment.TAG));
+
+        // Show the captured dialog on press the confirmation button.
+        ConfirmationDialogFragment dialog = dialogCaptor.getValue();
+        assertThat(dialogCaptor).isNotNull();
+        AlertDialog alertDialog = showDialog(dialog);
+
+        // Cancel action is the listener of positive button.
+        mActivityTestRule.runOnUiThread(() -> {
+            alertDialog.getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mLocationManager, never()).setAdasGnssLocationEnabled(false);
+    }
+
+    private void initializePreference(
+            boolean isAdasLocationEnabled, boolean isMainLocationEnabled) {
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(isAdasLocationEnabled);
+        when(mLocationManager.isLocationEnabled()).thenReturn(isMainLocationEnabled);
+        mPreferenceController = new AdasLocationSwitchPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+    }
+
+    private void setIsClickable(boolean isClickable) {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mIsClickable = isClickable;
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+
+    private void setIsVisible(boolean isVisible) {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mIsVisible = isVisible;
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+
+    private AlertDialog showDialog(ConfirmationDialogFragment dialog) throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mActivityTestRule.getActivity().getSupportFragmentManager(),
+                    /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        return (AlertDialog) dialog.getDialog();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/AdasPrivacyPolicyDisclosurePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/AdasPrivacyPolicyDisclosurePreferenceControllerTest.java
new file mode 100644
index 000000000..55c28433e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/AdasPrivacyPolicyDisclosurePreferenceControllerTest.java
@@ -0,0 +1,195 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.PackageManager.NameNotFoundException;
+import android.location.LocationManager;
+import android.os.Bundle;
+import android.os.PackageTagsList;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionTextPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AdasPrivacyPolicyDisclosurePreferenceControllerTest {
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private AdasPrivacyPolicyDisclosurePreferenceController mPreferenceController;
+
+    @Mock private FragmentController mFragmentController;
+    @Mock private PackageManager mPackageManager;
+    @Mock private LocationManager mLocationManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+
+        CarUxRestrictions carUxRestrictions =
+                new CarUxRestrictions.Builder(
+                                /* reqOpt= */ true,
+                                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                                /* timestamp= */ 0)
+                        .build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController =
+                new AdasPrivacyPolicyDisclosurePreferenceController(
+                        mContext,
+                        "key",
+                        mFragmentController,
+                        carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+
+        initializePreference();
+    }
+
+    @Test
+    public void refreshUi_oneAdasApp_showApp() {
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void refreshUi_adasAppWithLocationPermission_launchLocationSettings() throws Exception {
+        mPreferenceController.refreshUi();
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+        assertThat(intent.getStringExtra(Intent.EXTRA_PERMISSION_GROUP_NAME))
+                .isEqualTo(Manifest.permission_group.LOCATION);
+    }
+
+    @Test
+    public void refreshUi_adasAppWithLocationPermission_launchPrivacyPolicy() throws Exception {
+        mPreferenceController.refreshUi();
+        CarUiTwoActionTextPreference perf =
+                (CarUiTwoActionTextPreference) mPreference.getPreference(0);
+
+        perf.performSecondaryActionClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_VIEW);
+    }
+
+    @Test
+    public void refreshUi_privacyPolicyMissing_throwsNoException() throws Exception {
+        ApplicationInfo appInfo = new ApplicationInfo();
+        Bundle bundle = new Bundle();
+        appInfo.metaData = bundle;
+        when(mPackageManager.getApplicationInfoAsUser(any(), anyInt(), anyInt()))
+                .thenReturn(appInfo);
+
+        mPreferenceController.refreshUi();
+        CarUiTwoActionTextPreference perf =
+                (CarUiTwoActionTextPreference) mPreference.getPreference(0);
+
+        perf.performSecondaryActionClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, never()).startActivity(captor.capture());
+    }
+
+    @Test
+    public void refreshUi_metaDataMissing_throwsNoException() throws Exception {
+        ApplicationInfo appInfo = new ApplicationInfo();
+        when(mPackageManager.getApplicationInfoAsUser(any(), anyInt(), anyInt()))
+                .thenReturn(appInfo);
+
+        mPreferenceController.refreshUi();
+        CarUiTwoActionTextPreference perf =
+                (CarUiTwoActionTextPreference) mPreference.getPreference(0);
+
+        perf.performSecondaryActionClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext, never()).startActivity(captor.capture());
+    }
+
+    @Test
+    public void refreshUi_throwsNoException() throws Exception {
+        when(mPackageManager.getApplicationInfoAsUser(any(), anyInt(), anyInt()))
+                .thenThrow(new NameNotFoundException());
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+    }
+
+    private void initializePreference() throws Exception {
+        ApplicationInfo appInfo = new ApplicationInfo();
+        Bundle bundle = new Bundle();
+        appInfo.metaData = bundle;
+        bundle.putCharSequence("privacy_policy", "test App Url");
+        when(mPackageManager.getApplicationInfoAsUser(any(), anyInt(), anyInt()))
+                .thenReturn(appInfo);
+
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationAccessDisclaimerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationAccessDisclaimerPreferenceControllerTest.java
new file mode 100644
index 000000000..dc03aa481
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationAccessDisclaimerPreferenceControllerTest.java
@@ -0,0 +1,125 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.app.ActivityManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.location.LocationManager;
+import android.os.PackageTagsList;
+import android.os.UserHandle;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationAccessDisclaimerPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LocationAccessDisclaimerPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private LocationManager mLocationManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        mSession = mockitoSession()
+                .strictness(Strictness.LENIENT)
+                .spyStatic(ActivityManager.class)
+                .startMocking();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new LocationAccessDisclaimerPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @After
+    public void tearDown() {
+        mSession.finishMocking();
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_driverWithAdas_conditionallyUnavailable() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_driverNoAdas_available() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_passengerAdas_available() {
+        int nonCurrentUser = UserHandle.myUserId() + 1;
+        when(ActivityManager.getCurrentUser()).thenReturn(nonCurrentUser);
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_passengerNoAdas_available() {
+        int nonCurrentUser = UserHandle.myUserId() + 1;
+        when(ActivityManager.getCurrentUser()).thenReturn(nonCurrentUser);
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationAccessPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationAccessPreferenceControllerTest.java
new file mode 100644
index 000000000..0faaeaee7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationAccessPreferenceControllerTest.java
@@ -0,0 +1,124 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.location.LocationManager;
+import android.os.PackageTagsList;
+import android.platform.test.annotations.DisableFlags;
+import android.platform.test.annotations.EnableFlags;
+import android.platform.test.flag.junit.SetFlagsRule;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationAccessPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private CarUxRestrictions mCarUxRestrictions;
+    private LocationAccessPreferenceController mController;
+
+    @Mock
+    private LocationManager mLocationManager;
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mController = new LocationAccessPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void getAvailabilityStatus_adasAllowlistNotEmpty_available() {
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void getAvailabilityStatus_adasAllowlistNotEmpty_conditionallyUnavailable_zoneHidden() {
+        mController.setAvailabilityStatusForZone("hidden");
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void getAvailabilityStatus_adasAllowlistEmpty_conditionallyUnavailable() {
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @DisableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void getAvailabilityStatus_adasAllowlistEmpty_conditionallyUnavailable_zoneHidden() {
+        mController.setAvailabilityStatusForZone("hidden");
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_REQUIRED_INFOTAINMENT_APPS_SETTINGS_PAGE)
+    public void getAvailabilityStatus_available() {
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationInfotainmentAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationInfotainmentAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..ceeb31e99
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationInfotainmentAppsPreferenceControllerTest.java
@@ -0,0 +1,208 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.PackageManager.NameNotFoundException;
+import android.content.pm.PermissionInfo;
+import android.location.LocationManager;
+import android.os.Build;
+import android.os.PackageTagsList;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationInfotainmentAppsPreferenceControllerTest {
+    private static final String PACKAGE_NAME = "testApp";
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private LocationInfotainmentAppsPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mPackageManager;
+    @Mock
+    private LocationManager mLocationManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+
+        CarUxRestrictions carUxRestrictions =
+                new CarUxRestrictions.Builder(
+                                /* reqOpt= */ true,
+                                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                                /* timestamp= */ 0)
+                        .build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController =
+                new LocationInfotainmentAppsPreferenceController(
+                        mContext,
+                        "key",
+                        mFragmentController,
+                        carUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+
+        initializePreference();
+    }
+
+    @Test
+    public void refreshUi_oneInfotainmentApp_showApp() {
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void refreshUi_infotainmentAppWithLocationPermission_launchLocationSettings() {
+        mPreferenceController.refreshUi();
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+        assertThat(intent.getStringExtra(Intent.EXTRA_PERMISSION_GROUP_NAME))
+                .isEqualTo(Manifest.permission_group.LOCATION);
+    }
+
+    @Test
+    public void refreshUi_throwsNoException() throws Exception {
+        when(mPackageManager.getApplicationInfoAsUser(any(), anyInt(), anyInt()))
+                .thenThrow(new NameNotFoundException());
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void refreshUi_isRequiredApp() {
+        PackageTagsList list = new PackageTagsList.Builder().add(PACKAGE_NAME).build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void refreshUi_permissionNotGranted_hideApp() {
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.targetSdkVersion = Build.VERSION_CODES.CUR_DEVELOPMENT;
+        appInfo.enabled = true;
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.packageName = PACKAGE_NAME;
+        packageInfo.applicationInfo = appInfo;
+        packageInfo.requestedPermissions =
+                new String[] {Manifest.permission.ACCESS_COARSE_LOCATION};
+        packageInfo.requestedPermissionsFlags = new int[] {0};
+
+        when(mPackageManager.getPackagesHoldingPermissions(any(), anyInt()))
+                .thenReturn(List.of(packageInfo));
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void refreshUi_appDisabled_hideApp() throws Exception {
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.targetSdkVersion = Build.VERSION_CODES.CUR_DEVELOPMENT;
+        appInfo.enabled = false;
+
+        when(mPackageManager.getApplicationInfoAsUser(any(), anyInt(), anyInt()))
+                .thenReturn(appInfo);
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+    }
+
+
+    private void initializePreference() throws Exception {
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.targetSdkVersion = Build.VERSION_CODES.CUR_DEVELOPMENT;
+        appInfo.enabled = true;
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.packageName = PACKAGE_NAME;
+        packageInfo.applicationInfo = appInfo;
+        packageInfo.requestedPermissions =
+                new String[] {Manifest.permission.ACCESS_COARSE_LOCATION};
+        packageInfo.requestedPermissionsFlags =
+                new int[] {PackageInfo.REQUESTED_PERMISSION_GRANTED};
+
+        when(mPackageManager.getApplicationInfoAsUser(any(), anyInt(), anyInt()))
+                .thenReturn(appInfo);
+        when(mPackageManager.getPackagesHoldingPermissions(any(), anyInt()))
+                .thenReturn(List.of(packageInfo));
+        when(mPackageManager.getPermissionFlags(any(), any(), any()))
+                .thenReturn(PackageManager.FLAG_PERMISSION_USER_SENSITIVE_WHEN_GRANTED);
+        when(mPackageManager.getPermissionInfo(any(), anyInt())).thenReturn(new PermissionInfo());
+
+        when(mLocationManager.getAdasAllowlist()).thenReturn(new PackageTagsList.Builder().build());
+        when(mLocationManager.isLocationEnabled()).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationRecentAccessViewAllPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationRecentAccessViewAllPreferenceControllerTest.java
new file mode 100644
index 000000000..ee519b8de
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationRecentAccessViewAllPreferenceControllerTest.java
@@ -0,0 +1,189 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.graphics.drawable.Drawable;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.RecentAppOpsAccess;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.time.Clock;
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationRecentAccessViewAllPreferenceControllerTest {
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private LocationRecentAccessViewAllPreferenceController mPreferenceController;
+
+    @Mock private FragmentController mFragmentController;
+    @Mock private RecentAppOpsAccess mRecentLocationAccesses;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        CarUxRestrictions carUxRestrictions =
+                new CarUxRestrictions.Builder(
+                                /* reqOpt= */ true,
+                                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                                /* timestamp= */ 0)
+                        .build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController =
+                new LocationRecentAccessViewAllPreferenceController(
+                        mContext,
+                        "key",
+                        mFragmentController,
+                        carUxRestrictions,
+                        mRecentLocationAccesses);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+    }
+
+    @Test
+    public void updateState_noSystemAppsByDefault() {
+        initializePreference();
+        verify(mRecentLocationAccesses, never()).getAppListSorted(/* showSystem= */ true);
+    }
+
+    @Test
+    public void setShowSystem_showsSystemApps() {
+        initializePreference();
+        mPreferenceController.setShowSystem(true);
+        verify(mRecentLocationAccesses).getAppListSorted(/* showSystem= */ true);
+    }
+
+    @Test
+    public void refreshUi_noRecentAccesses_showsEmptyState() {
+        initializePreference();
+
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle())
+                .isEqualTo(mContext.getString(R.string.location_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_someRecentAccesses_displaysAppInformation() {
+        initializePreference();
+
+        String fakeLabel = "Test app 1";
+        RecentAppOpsAccess.Access fakeAccess =
+                new RecentAppOpsAccess.Access(
+                        "com.test",
+                        UserHandle.CURRENT,
+                        mock(Drawable.class),
+                        fakeLabel,
+                        "fake contentDescription",
+                        Clock.systemDefaultZone().millis());
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(fakeAccess);
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(fakeLabel);
+        assertThat(mPreference.getPreference(0).getSummary().toString()).contains("min. ago");
+    }
+
+    @Test
+    public void refreshUi_recentAccesses_launchLocationSettings() {
+        initializePreference();
+
+        List<RecentAppOpsAccess.Access> list =
+                Collections.singletonList(mock(RecentAppOpsAccess.Access.class));
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+        assertThat(intent.getStringExtra(Intent.EXTRA_PERMISSION_GROUP_NAME))
+                .isEqualTo(Manifest.permission_group.LOCATION);
+    }
+
+    @Test
+    public void refreshUi_newRecentAccesses_listIsUpdated() {
+        initializePreference();
+
+        List<RecentAppOpsAccess.Access> list1 =
+                Collections.singletonList(mock(RecentAppOpsAccess.Access.class));
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list1);
+
+        List<RecentAppOpsAccess.Access> list2 = new ArrayList<>(list1);
+        list2.add(mock(RecentAppOpsAccess.Access.class));
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list1.size());
+
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list2);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list2.size());
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationRecentAccessesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationRecentAccessesPreferenceControllerTest.java
new file mode 100644
index 000000000..f75a35bca
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationRecentAccessesPreferenceControllerTest.java
@@ -0,0 +1,411 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.ActivityManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+import android.graphics.drawable.Drawable;
+import android.location.LocationManager;
+import android.os.PackageTagsList;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.RecentAppOpsAccess;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.time.Clock;
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationRecentAccessesPreferenceControllerTest {
+    private static final int RECENT_APPS_MAX_COUNT = 2;
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private final LocationManager mLocationManager =
+            Mockito.spy(mContext.getSystemService(LocationManager.class));
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceCategory mPreference;
+    private LocationRecentAccessesPreferenceController mPreferenceController;
+    private MockitoSession mSession;
+
+    @Mock private FragmentController mFragmentController;
+    @Mock private RecentAppOpsAccess mRecentLocationAccesses;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mSession = mockitoSession()
+                .strictness(Strictness.LENIENT)
+                .spyStatic(ActivityManager.class)
+                .startMocking();
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        CarUxRestrictions carUxRestrictions =
+                new CarUxRestrictions.Builder(
+                                /* reqOpt= */ true,
+                                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                                /* timestamp= */ 0)
+                        .build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new PreferenceCategory(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController =
+                new LocationRecentAccessesPreferenceController(
+                        mContext,
+                        "key",
+                        mFragmentController,
+                        carUxRestrictions,
+                        mRecentLocationAccesses,
+                        RECENT_APPS_MAX_COUNT);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        mSession.finishMocking();
+    }
+
+    @Test
+    public void driverWithAdas_locationAndAdasOff_preferenceIsHidden() {
+        setUserToDriverWithAdas();
+        setIsLocationEnabled(false);
+        setIsAdasGnssLocationEnabled(false);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void driverWithAdas_locationAndAdasOn_preferenceIsShown() {
+        setUserToDriverWithAdas();
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void driverWithAdas_adasOnOnly_preferenceIsShown() {
+        setUserToDriverWithAdas();
+        setIsLocationEnabled(false);
+        setIsAdasGnssLocationEnabled(true);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void driverWithNoAdas_locationAndAdasOff_preferenceIsHidden() {
+        setUserToDriverWithNoAdas();
+        setIsLocationEnabled(false);
+        setIsAdasGnssLocationEnabled(false);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void driverWithNoAdas_locationAndAdasOn_preferenceIsShown() {
+        setUserToDriverWithNoAdas();
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void driverWithNoAdas_adasOnOnly_preferenceIsHidden() {
+        setUserToDriverWithNoAdas();
+        setIsLocationEnabled(false);
+        setIsAdasGnssLocationEnabled(true);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void passenger_locationAndAdasOff_preferenceIsHidden() {
+        setUserToPassenger();
+        setIsLocationEnabled(false);
+        setIsAdasGnssLocationEnabled(false);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void passenger_locationAndAdasOn_preferenceIsShown() {
+        setUserToPassenger();
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void passenger_adasOnOnly_preferenceIsHidden() {
+        setUserToPassenger();
+        setIsLocationEnabled(false);
+        setIsAdasGnssLocationEnabled(true);
+
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_messageDisplayed() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle())
+                .isEqualTo(mContext.getString(R.string.location_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_exceptForSomeRecentSystemAppRequests_showsViewAll() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.singletonList(mock(RecentAppOpsAccess.Access.class)));
+        mPreferenceController.refreshUi();
+
+        // includes preference for "View all"
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreference.getPreference(1).getTitle())
+                .isEqualTo(
+                        mContext.getString(
+                                R.string.location_settings_recently_accessed_view_all_title));
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_clickViewAll_launchesFragment() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.singletonList(mock(RecentAppOpsAccess.Access.class)));
+        mPreferenceController.refreshUi();
+
+        // click on the "View all" preference
+        mPreference.getPreference(1).performClick();
+        verify(mFragmentController).launchFragment(any(LocationRecentAccessViewAllFragment.class));
+    }
+
+    @Test
+    public void refreshUi_noRecentAccesses_includingNoSystemAppAccesses_doesNotShowViewAll() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        // no preference for "View all"
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreference.getPreference(0).getTitle())
+                .isEqualTo(mContext.getString(R.string.location_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_someRecentAccesses_displaysAppInformation() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        String fakeLabel = "Test app 1";
+        RecentAppOpsAccess.Access fakeAccess =
+                new RecentAppOpsAccess.Access(
+                        "com.test",
+                        UserHandle.CURRENT,
+                        mock(Drawable.class),
+                        fakeLabel,
+                        "fake contentDescription",
+                        Clock.systemDefaultZone().millis());
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(fakeAccess);
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(fakeLabel);
+        assertThat(mPreference.getPreference(0).getSummary().toString()).contains("min. ago");
+    }
+
+    @Test
+    public void refreshUi_someRecentAcesses_preferencesAddedToScreen_capsAtMax() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        List<RecentAppOpsAccess.Access> list =
+                Arrays.asList(
+                        mock(RecentAppOpsAccess.Access.class),
+                        mock(RecentAppOpsAccess.Access.class),
+                        mock(RecentAppOpsAccess.Access.class));
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(RECENT_APPS_MAX_COUNT);
+    }
+
+    @Test
+    public void refreshUi_recentRequests_launchLocationSettings() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        List<RecentAppOpsAccess.Access> list =
+                Collections.singletonList(mock(RecentAppOpsAccess.Access.class));
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+    }
+
+    @Test
+    public void refreshUi_newRecentRequests_listIsUpdated() {
+        setIsLocationEnabled(true);
+        setIsAdasGnssLocationEnabled(true);
+
+        List<RecentAppOpsAccess.Access> list1 =
+                Collections.singletonList(mock(RecentAppOpsAccess.Access.class));
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list1);
+
+        List<RecentAppOpsAccess.Access> list2 = new ArrayList<>(list1);
+        list2.add(mock(RecentAppOpsAccess.Access.class));
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list1.size());
+
+        when(mRecentLocationAccesses.getAppListSorted(/* showSystem= */ false)).thenReturn(list2);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list2.size());
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor =
+                ArgumentCaptor.forClass(BroadcastReceiver.class);
+        ArgumentCaptor<IntentFilter> intentFilterCaptor =
+                ArgumentCaptor.forClass(IntentFilter.class);
+
+        verify(mContext, times(1))
+                .registerReceiver(broadcastReceiverArgumentCaptor.capture(),
+                        intentFilterCaptor.capture(), eq(Context.RECEIVER_NOT_EXPORTED));
+    }
+
+    private void setUserToDriverWithAdas() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+    }
+
+    private void setUserToDriverWithNoAdas() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+    }
+
+    private void setUserToPassenger() {
+        int nonCurrentUser = UserHandle.myUserId() + 1;
+        when(ActivityManager.getCurrentUser()).thenReturn(nonCurrentUser);
+    }
+
+    private void setIsLocationEnabled(boolean isEnabled) {
+        when(mLocationManager.isLocationEnabled()).thenReturn(isEnabled);
+    }
+
+    private void setIsAdasGnssLocationEnabled(boolean isEnabled) {
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(isEnabled);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationRequiredAppsHeaderPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationRequiredAppsHeaderPreferenceControllerTest.java
new file mode 100644
index 000000000..5f6d03c56
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationRequiredAppsHeaderPreferenceControllerTest.java
@@ -0,0 +1,88 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static org.mockito.Mockito.spy;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationRequiredAppsHeaderPreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LocationRequiredAppsHeaderPreferenceController mPreferenceController;
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new LocationRequiredAppsHeaderPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreference = new Preference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_toggleVisible_conditionallyUnavailable() {
+        initializePreference(/* isToggleVisible= */ true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_toggleNotVisible_available() {
+        initializePreference(/* isToggleVisible= */ false);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+
+    private void initializePreference(boolean isToggleVisible) {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mIsToggleVisible = isToggleVisible;
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationRequiredAppsSectionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationRequiredAppsSectionPreferenceControllerTest.java
new file mode 100644
index 000000000..35d661d57
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationRequiredAppsSectionPreferenceControllerTest.java
@@ -0,0 +1,125 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.app.ActivityManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.location.LocationManager;
+import android.os.PackageTagsList;
+import android.os.UserHandle;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationRequiredAppsSectionPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LocationRequiredAppsSectionPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private LocationManager mLocationManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        mSession = mockitoSession()
+                .strictness(Strictness.LENIENT)
+                .spyStatic(ActivityManager.class)
+                .startMocking();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new LocationRequiredAppsSectionPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @After
+    public void tearDown() {
+        mSession.finishMocking();
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_driverWithAdas_available() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_driverNoAdas_conditionallyUnavailable() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_passengerAdas_conditionallyUnavailable() {
+        int nonCurrentUser = UserHandle.myUserId() + 1;
+        when(ActivityManager.getCurrentUser()).thenReturn(nonCurrentUser);
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_passengerNoAdas_conditionallyUnavailable() {
+        int nonCurrentUser = UserHandle.myUserId() + 1;
+        when(ActivityManager.getCurrentUser()).thenReturn(nonCurrentUser);
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationServicesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationServicesPreferenceControllerTest.java
new file mode 100644
index 000000000..a1da8f0fa
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationServicesPreferenceControllerTest.java
@@ -0,0 +1,171 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserHandle;
+import android.util.ArrayMap;
+import android.util.ArraySet;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+import java.util.List;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationServicesPreferenceControllerTest {
+    private static final int PROFILE_ID = UserHandle.USER_CURRENT;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceCategory mPreference;
+    private LocationServicesPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarLocationSettingsInjector mSettingsInjector;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new PreferenceCategory(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new LocationServicesPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setSettingsInjector(mSettingsInjector);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onStart_registersBroadcastReceiver() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        ArgumentCaptor<BroadcastReceiver> captor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(captor.capture(), any(),
+                eq(Context.RECEIVER_EXPORTED));
+
+        captor.getValue().onReceive(mContext, new Intent());
+        verify(mSettingsInjector).reloadStatusMessages();
+    }
+
+    @Test
+    public void onStop_unregistersBroadcastReceiver() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        ArgumentCaptor<BroadcastReceiver> captor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(captor.capture(), any(),
+                eq(Context.RECEIVER_EXPORTED));
+
+        mPreferenceController.onStop(mLifecycleOwner);
+        verify(mContext).unregisterReceiver(captor.getValue());
+    }
+
+    @Test
+    public void updateState_addsInjectedSettingsToPreferenceCategory() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        Map<Integer, List<Preference>> samplePrefs = getSamplePreferences();
+        doReturn(samplePrefs).when(mSettingsInjector)
+                .getInjectedSettings(any(Context.class), any(ArraySet.class));
+
+        mPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(samplePrefs.get(PROFILE_ID).size());
+    }
+
+    @Test
+    public void updateState_updatesPreferenceSummary() {
+        Map<Integer, List<Preference>> samplePrefs = getSamplePreferences();
+        doReturn(samplePrefs).when(mSettingsInjector)
+                .getInjectedSettings(any(Context.class), any(ArraySet.class));
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        String summary = "Summary";
+        samplePrefs.get(PROFILE_ID).get(0).setSummary(summary);
+
+        mPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.getPreference(0).getSummary()).isEqualTo(summary);
+    }
+
+    @Test
+    public void preferenceCategory_isVisibleIfThereAreInjectedSettings() {
+        doReturn(getSamplePreferences()).when(mSettingsInjector)
+                .getInjectedSettings(any(Context.class), any(ArraySet.class));
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void preferenceCategory_isHiddenIfThereAreNoInjectedSettings() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    private Map<Integer, List<Preference>> getSamplePreferences() {
+        Map<Integer, List<Preference>> preferences = new ArrayMap<>();
+        preferences.put(PROFILE_ID,
+                Arrays.asList(new Preference(mContext), new Preference(mContext),
+                        new Preference(mContext)));
+        return preferences;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationStateListenerBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationStateListenerBasePreferenceControllerTest.java
new file mode 100644
index 000000000..07b1a2d3f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationStateListenerBasePreferenceControllerTest.java
@@ -0,0 +1,198 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+import android.location.LocationManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationStateListenerBasePreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private Preference mPreference;
+    private LocationStateListenerBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Mock
+    private LocationManager mLocationManager;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new Preference(mContext);
+    }
+
+    @Test
+    public void onAdasIntentReceived_refreshUi() {
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(false);
+        mPreferenceController = new LocationStateListenerBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions) {
+            @Override
+            protected Class<Preference> getPreferenceType() {
+                return Preference.class;
+            }
+            @Override
+            protected int getDefaultAvailabilityStatus() {
+                return getLocationManager().isAdasGnssLocationEnabled()
+                        ? AVAILABLE
+                        : CONDITIONALLY_UNAVAILABLE;
+            }
+        };
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.addDefaultBypassLocationStateListener();
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        ArgumentCaptor<IntentFilter> intentFilterCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+        verify(mContext, times(1))
+                .registerReceiver(broadcastReceiverArgumentCaptor.capture(),
+                        intentFilterCaptor.capture(), eq(Context.RECEIVER_NOT_EXPORTED));
+
+        List<IntentFilter> actions = intentFilterCaptor.getAllValues();
+        assertThat(actions.get(0).hasAction(LocationManager.ACTION_ADAS_GNSS_ENABLED_CHANGED))
+                .isTrue();
+
+        when(mLocationManager.isAdasGnssLocationEnabled()).thenReturn(true);
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(LocationManager.ACTION_ADAS_GNSS_ENABLED_CHANGED));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void onLocationIntentReceived_refreshUi() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(false);
+        mPreferenceController = new LocationStateListenerBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions) {
+            @Override
+            protected Class<Preference> getPreferenceType() {
+                return Preference.class;
+            }
+            @Override
+            protected int getDefaultAvailabilityStatus() {
+                return getLocationManager().isLocationEnabled()
+                        ? AVAILABLE
+                        : CONDITIONALLY_UNAVAILABLE;
+            }
+        };
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.addDefaultMainLocationStateListener();
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        ArgumentCaptor<IntentFilter> intentFilterCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+
+        verify(mContext, times(1))
+                .registerReceiver(broadcastReceiverArgumentCaptor.capture(),
+                        intentFilterCaptor.capture(), eq(Context.RECEIVER_NOT_EXPORTED));
+
+        List<IntentFilter> actions = intentFilterCaptor.getAllValues();
+        assertThat(actions.get(0).hasAction(LocationManager.MODE_CHANGED_ACTION)).isTrue();
+
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(LocationManager.MODE_CHANGED_ACTION));
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void onPowerPolicyChange_refreshUi() {
+        mPreferenceController = new LocationStateListenerBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions) {
+            @Override
+            protected Class<Preference> getPreferenceType() {
+                return Preference.class;
+            }
+            @Override
+            protected int getDefaultAvailabilityStatus() {
+                return getIsPowerPolicyOn()
+                        ? AVAILABLE
+                        : CONDITIONALLY_UNAVAILABLE;
+            }
+        };
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.addDefaultPowerPolicyListener();
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationStateSwitchOuterPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationStateSwitchOuterPreferenceControllerTest.java
new file mode 100644
index 000000000..cb5889eec
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationStateSwitchOuterPreferenceControllerTest.java
@@ -0,0 +1,125 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.mockitoSession;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.app.ActivityManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.location.LocationManager;
+import android.os.PackageTagsList;
+import android.os.UserHandle;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationStateSwitchOuterPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LocationStateSwitchOuterPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private LocationManager mLocationManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        mSession = mockitoSession()
+                .strictness(Strictness.LENIENT)
+                .spyStatic(ActivityManager.class)
+                .startMocking();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new LocationStateSwitchOuterPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @After
+    public void tearDown() {
+        mSession.finishMocking();
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_driverWithAdas_conditionallyUnavailable() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_driverNoAdas_available() {
+        int currentUser = UserHandle.myUserId();
+        when(ActivityManager.getCurrentUser()).thenReturn(currentUser);
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_passengerAdas_available() {
+        int nonCurrentUser = UserHandle.myUserId() + 1;
+        when(ActivityManager.getCurrentUser()).thenReturn(nonCurrentUser);
+        PackageTagsList list = new PackageTagsList.Builder().add("testApp1").build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_passengerNoAdas_available() {
+        int nonCurrentUser = UserHandle.myUserId() + 1;
+        when(ActivityManager.getCurrentUser()).thenReturn(nonCurrentUser);
+        PackageTagsList list = new PackageTagsList.Builder().build();
+        when(mLocationManager.getAdasAllowlist()).thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/location/LocationStateSwitchPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/location/LocationStateSwitchPreferenceControllerTest.java
new file mode 100644
index 000000000..6b50e389a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/location/LocationStateSwitchPreferenceControllerTest.java
@@ -0,0 +1,238 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.location;
+
+import static android.os.UserManager.DISALLOW_CONFIG_LOCATION;
+import static android.os.UserManager.DISALLOW_SHARE_LOCATION;
+
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.location.LocationManager;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class LocationStateSwitchPreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SwitchPreference mSwitchPreference;
+    private LocationStateSwitchPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private UserHandle mUserHandle;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private LocationManager mLocationManager;
+    @Mock
+    private UserManager mUserManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mUserHandle = UserHandle.of(UserHandle.myUserId());
+
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new LocationStateSwitchPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+    }
+
+    @Test
+    public void onIntentReceived_updateUi() {
+        initializePreference(/* checked= */ false, /* enabled= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        ArgumentCaptor<BroadcastReceiver> broadcastReceiverArgumentCaptor = ArgumentCaptor.forClass(
+                BroadcastReceiver.class);
+        verify(mContext).registerReceiver(broadcastReceiverArgumentCaptor.capture(), any(),
+                eq(Context.RECEIVER_NOT_EXPORTED));
+
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        broadcastReceiverArgumentCaptor.getValue().onReceive(mContext,
+                new Intent(LocationManager.MODE_CHANGED_ACTION));
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onPreferenceClicked_locationDisabled_shouldEnable() {
+        initializePreference(/* checked= */ false, /* enabled= */ true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+        verify(mLocationManager).setLocationEnabledForUser(/* enabled= */ true, mUserHandle);
+    }
+
+    @Test
+    public void onPreferenceClicked_locationEnabled_shouldDisable() {
+        initializePreference(/* checked= */ true, /* enabled= */ true);
+
+        mSwitchPreference.performClick();
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+        verify(mLocationManager).setLocationEnabledForUser(/* enabled= */ false, mUserHandle);
+    }
+
+    @Test
+    public void onPolicyChanged_enabled_setsSwitchEnabled() {
+        initializePreference(/* checked= */ false, /* enabled= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onPolicyChanged_disabled_setsSwitchDisabled() {
+        initializePreference(/* checked= */ false, /* enabled= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void locationOn_disallowConfigLocation_interactionDisabled() {
+        verifyLocationStateWithRestriction(/* locationOnByDefault= */true,
+                DISALLOW_CONFIG_LOCATION, /* expectedLocationToBeOn= */ true);
+    }
+
+    @Test
+    public void locationOff_disallowConfigLocation_interactionDisabled() {
+        verifyLocationStateWithRestriction(/* locationOnByDefault= */false,
+                DISALLOW_CONFIG_LOCATION, /* expectedLocationToBeOn= */ false);
+    }
+
+    @Test
+    public void locationOn_disallowShareLocation_interactionDisabled_locationTurnedOff() {
+        verifyLocationStateWithRestriction(/* locationOnByDefault= */true,
+                DISALLOW_SHARE_LOCATION, /* expectedLocationToBeOn= */ false);
+    }
+
+    @Test
+    public void locationOff_disallowShareLocation_interactionDisabled_locationRemainsOff() {
+        verifyLocationStateWithRestriction(/* locationOnByDefault= */false,
+                DISALLOW_SHARE_LOCATION, /* expectedLocationToBeOn= */ false);
+    }
+
+    public void verifyLocationStateWithRestriction(boolean locationOnByDefault, String restriction,
+            boolean expectedLocationToBeOn) {
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager,  restriction,
+                /* restricted= */true);
+        initializePreference(/* checked= */ locationOnByDefault, /* enabled= */ true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+        if (expectedLocationToBeOn) {
+            assertThat(mSwitchPreference.isChecked()).isTrue();
+        } else {
+            assertThat(mSwitchPreference.isChecked()).isFalse();
+        }
+    }
+
+    @Test
+    public void disallowConfigLocation_onInteraction_showsDialog() {
+        initializePreference(/* checked= */ true, /* enabled= */ true);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager,  DISALLOW_CONFIG_LOCATION,
+                /* restricted= */true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        mSwitchPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    @Test
+    public void disallowShareLocation_onInteraction_showsDialog() {
+        initializePreference(/* checked= */ true, /* enabled= */ true);
+        EnterpriseTestUtils.mockUserRestrictionSetByDpm(mUserManager,  DISALLOW_SHARE_LOCATION,
+                /* restricted= */true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        mSwitchPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private void initializePreference(boolean checked, boolean enabled) {
+        when(mLocationManager.isLocationEnabled()).thenReturn(checked);
+        mSwitchPreference.setChecked(checked);
+        mSwitchPreference.setEnabled(enabled);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/AddMobileNetworkPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/network/AddMobileNetworkPreferenceControllerTest.java
new file mode 100644
index 000000000..aa3706af0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/AddMobileNetworkPreferenceControllerTest.java
@@ -0,0 +1,191 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.network.AddMobileNetworkPreferenceController.ADD_NETWORK_INTENT;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.telephony.euicc.EuiccManager;
+
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class AddMobileNetworkPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private Preference mPreference;
+    private AddMobileNetworkPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private EuiccManager mMockEuiccManager;
+    @Mock
+    private PackageManager mMockPackageManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(EuiccManager.class)).thenReturn(mMockEuiccManager);
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new AddMobileNetworkPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccDisabled_isUnsupported() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccDisabled_isUnsupported_zoneWrite() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccDisabled_isUnsupported_zoneRead() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccDisabled_isUnsupported_zoneHidden() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentResolves_isAvailable() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        when(mMockPackageManager.queryIntentActivities(ADD_NETWORK_INTENT, /* flags= */ 0))
+                .thenReturn(Collections.singletonList(new ResolveInfo()));
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentResolves_isAvailable_zoneWrite() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        when(mMockPackageManager.queryIntentActivities(ADD_NETWORK_INTENT, /* flags= */ 0))
+                .thenReturn(Collections.singletonList(new ResolveInfo()));
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentResolves_isAvailable_zoneRead() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        when(mMockPackageManager.queryIntentActivities(ADD_NETWORK_INTENT, /* flags= */ 0))
+                .thenReturn(Collections.singletonList(new ResolveInfo()));
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentResolves_isAvailable_zoneHidden() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        when(mMockPackageManager.queryIntentActivities(ADD_NETWORK_INTENT, /* flags= */ 0))
+                .thenReturn(Collections.singletonList(new ResolveInfo()));
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentFailsToResolve_isUnsupported() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentFailsToResolve_isUnsupported_zoneWrite() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentFailsToResolve_isUnsupported_zoneRead() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccEnabled_intentFailsToResolve_isUnsupported_zoneHidden() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/MobileDataTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/network/MobileDataTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..9243f6149
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/MobileDataTogglePreferenceControllerTest.java
@@ -0,0 +1,401 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.app.AlertDialog;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.net.Uri;
+import android.provider.Settings;
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+import android.telephony.TelephonyManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileDataTogglePreferenceControllerTest {
+
+    private static final int SUB_ID = 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private TwoStatePreference mPreference;
+    private MobileDataTogglePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private TelephonyManager mMockTelephonyManager;
+    @Mock
+    private ContentResolver mMockContentResolver;
+    @Mock
+    private SubscriptionManager mMockSubscriptionManager;
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(SubscriptionManager.class, withSettings().lenient())
+                .startMocking();
+
+        when(mContext.getSystemService(eq(Context.TELEPHONY_SERVICE)))
+                .thenReturn(mMockTelephonyManager);
+        when(mContext.getSystemService(TelephonyManager.class)).thenReturn(mMockTelephonyManager);
+        when(mMockTelephonyManager.createForSubscriptionId(SUB_ID))
+                .thenReturn(mMockTelephonyManager);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(1);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(false);
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+        ExtendedMockito.when(SubscriptionManager.getDefaultDataSubscriptionId())
+                .thenReturn(SUB_ID);
+        when(mMockSubscriptionManager.isActiveSubscriptionId(SUB_ID)).thenReturn(true);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new SwitchPreference(mContext);
+        mPreferenceController = new MobileDataTogglePreferenceController(mContext,
+                "key", mMockFragmentController, mCarUxRestrictions,
+                mMockSubscriptionManager);
+        mPreferenceController.setFields(SUB_ID);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onStart_singleSim_registersObserver() {
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        Uri uri = Settings.Global.getUriFor(Settings.Global.MOBILE_DATA);
+        verify(mMockContentResolver).registerContentObserver(eq(uri), eq(false), any());
+    }
+
+    @Test
+    public void onStart_multiSim_registersObserver() {
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        Uri uri = Settings.Global.getUriFor(Settings.Global.MOBILE_DATA + SUB_ID);
+        verify(mMockContentResolver).registerContentObserver(eq(uri), eq(false), any());
+    }
+
+    @Test
+    public void onStop_singleSim_unregistersObserver() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockContentResolver).unregisterContentObserver(any());
+    }
+
+    @Test
+    public void refreshUi_isOpportunistic_isDisabled() {
+        when(mMockSubscriptionManager.getActiveSubscriptionInfo(SUB_ID))
+                .thenReturn(createSubscriptionInfo(SUB_ID, /* isOpportunistic= */ true));
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_isNotOpportunistic_isEnabled() {
+        when(mMockSubscriptionManager.getActiveSubscriptionInfo(SUB_ID))
+                .thenReturn(createSubscriptionInfo(SUB_ID, /* isOpportunistic= */ false));
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_dataEnabled_setChecked() {
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_dataDisabled_setUnchecked() {
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void handlePreferenceChanged_setFalse_isSingleSim_opensDialog() {
+        mPreference.callChangeListener(false);
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(MobileDataTogglePreferenceController.DISABLE_DIALOG_TAG));
+    }
+
+    @Test
+    public void handlePreferenceChanged_setFalse_isMultiSim_disablesData() {
+        mPreference.setChecked(true);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        mPreference.callChangeListener(false);
+
+        verify(mMockTelephonyManager).setDataEnabled(false);
+    }
+
+    @Test
+    public void handlePreferenceChanged_setFalse_isMultiSim_setsUnchecked() {
+        mPreference.setChecked(true);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        mPreference.callChangeListener(false);
+
+        verify(mMockTelephonyManager).setDataEnabled(false);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(false);
+        mPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void handlePreferenceChanged_setTrue_isSingleSim_enablesData() {
+        mPreference.setChecked(false);
+        mPreference.callChangeListener(true);
+
+        verify(mMockTelephonyManager).setDataEnabled(true);
+    }
+
+    @Test
+    public void handlePreferenceChanged_setTrue_isSingleSim_setsChecked() {
+        mPreference.setChecked(false);
+        mPreference.callChangeListener(true);
+
+        verify(mMockTelephonyManager).setDataEnabled(true);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        mPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void handlePreferenceChanged_setTrue_isMultiSim_noOtherSimActive_enablesData() {
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        mPreference.callChangeListener(true);
+
+        verify(mMockTelephonyManager).setDataEnabled(true);
+    }
+
+    @Test
+    public void handlePreferenceChanged_setTrue_isMultiSim_noOtherSimActive_setsChecked() {
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        mPreference.callChangeListener(true);
+
+        verify(mMockTelephonyManager).setDataEnabled(true);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        mPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void handlePreferenceChanged_setTrue_isMultiSim_otherSimActive_opensDialog() {
+        int otherSubId = SUB_ID + 1;
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        ExtendedMockito.when(SubscriptionManager.getDefaultDataSubscriptionId())
+                .thenReturn(otherSubId);
+        when(mMockSubscriptionManager.isActiveSubscriptionId(otherSubId)).thenReturn(true);
+        mPreference.callChangeListener(true);
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(MobileDataTogglePreferenceController.ENABLE_MULTISIM_DIALOG_TAG));
+    }
+
+    @Test
+    public void disableSingleSimDialog_onConfirm_disablesData() throws Throwable {
+        mPreference.setChecked(true);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        mPreference.callChangeListener(false);
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(MobileDataTogglePreferenceController.DISABLE_DIALOG_TAG));
+
+        ConfirmationDialogFragment dialog = dialogCaptor.getValue();
+        assertThat(dialogCaptor).isNotNull();
+        AlertDialog alertDialog = showDialog(dialog);
+        mActivityTestRule.runOnUiThread(() -> {
+            alertDialog.getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockTelephonyManager).setDataEnabled(false);
+    }
+
+    @Test
+    public void disableSingleSimDialog_onConfirm_setsUnchecked() throws Throwable {
+        mPreference.setChecked(true);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        mPreference.callChangeListener(false);
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(MobileDataTogglePreferenceController.DISABLE_DIALOG_TAG));
+
+        ConfirmationDialogFragment dialog = dialogCaptor.getValue();
+        assertThat(dialogCaptor).isNotNull();
+        AlertDialog alertDialog = showDialog(dialog);
+        mActivityTestRule.runOnUiThread(() -> {
+            alertDialog.getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockTelephonyManager).setDataEnabled(false);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(false);
+        mPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void enableMultiSimDialog_onConfirm_enablesData() throws Throwable {
+        int otherSubId = SUB_ID + 1;
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        when(mMockTelephonyManager.createForSubscriptionId(otherSubId))
+                .thenReturn(mMockTelephonyManager);
+        ExtendedMockito.when(SubscriptionManager.getDefaultDataSubscriptionId())
+                .thenReturn(otherSubId);
+        when(mMockSubscriptionManager.isActiveSubscriptionId(otherSubId)).thenReturn(true);
+        mPreference.callChangeListener(true);
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(MobileDataTogglePreferenceController.ENABLE_MULTISIM_DIALOG_TAG));
+
+        ConfirmationDialogFragment dialog = dialogCaptor.getValue();
+        assertThat(dialogCaptor).isNotNull();
+        AlertDialog alertDialog = showDialog(dialog);
+        mActivityTestRule.runOnUiThread(() -> {
+            alertDialog.getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockTelephonyManager).setDataEnabled(true);
+    }
+
+    @Test
+    public void enableMultiSimDialog_onConfirm_setsChecked() throws Throwable {
+        int otherSubId = SUB_ID + 1;
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        when(mMockTelephonyManager.createForSubscriptionId(otherSubId))
+                .thenReturn(mMockTelephonyManager);
+        ExtendedMockito.when(SubscriptionManager.getDefaultDataSubscriptionId())
+                .thenReturn(otherSubId);
+        when(mMockSubscriptionManager.isActiveSubscriptionId(otherSubId)).thenReturn(true);
+        mPreference.callChangeListener(true);
+
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(MobileDataTogglePreferenceController.ENABLE_MULTISIM_DIALOG_TAG));
+
+        ConfirmationDialogFragment dialog = dialogCaptor.getValue();
+        assertThat(dialogCaptor).isNotNull();
+        AlertDialog alertDialog = showDialog(dialog);
+        mActivityTestRule.runOnUiThread(() -> {
+            alertDialog.getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockTelephonyManager).setDataEnabled(true);
+        when(mMockTelephonyManager.isDataEnabled()).thenReturn(true);
+        mPreferenceController.updateState(mPreference);
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    private SubscriptionInfo createSubscriptionInfo(int subId, boolean isOpportunistic) {
+        SubscriptionInfo subInfo = new SubscriptionInfo(subId, /* iccId= */ "",
+                /* simSlotIndex= */ 0, /* displayName= */ "", /* carrierName= */ "",
+                /* nameSource= */ 0, /* iconTint= */ 0, /* number= */ "",
+                /* roaming= */ 0, /* icon= */ null, /* mcc= */ "", /* mnc= */ "",
+                /* countryIso= */ "", /* isEmbedded= */ false,
+                /* accessRules= */ null, /* cardString= */ "", isOpportunistic,
+                /* groupUUID= */ null, /* carrierId= */ 0, /* profileClass= */ 0);
+        return subInfo;
+    }
+
+    private AlertDialog showDialog(ConfirmationDialogFragment dialog) throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mActivityTestRule.getActivity().getSupportFragmentManager(),
+                    /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        return (AlertDialog) dialog.getDialog();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/MobileNetworkEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..c3c715569
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkEntryPreferenceControllerTest.java
@@ -0,0 +1,522 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.net.ConnectivityManager;
+import android.net.Network;
+import android.net.NetworkCapabilities;
+import android.net.Uri;
+import android.os.UserManager;
+import android.provider.Settings;
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+import android.telephony.TelephonyManager;
+
+import androidx.fragment.app.Fragment;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.car.datasubscription.DataSubscription;
+import com.android.car.settings.R;
+import com.android.car.settings.common.ColoredTwoActionSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.utils.StringUtil;
+
+import com.google.android.collect.Lists;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileNetworkEntryPreferenceControllerTest {
+
+    private static final String TEST_NETWORK_NAME = "test network name";
+    private static final int SUB_ID = 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private MobileNetworkEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private SubscriptionManager mSubscriptionManager;
+    @Mock
+    private ConnectivityManager mConnectivityManager;
+    @Mock
+    private TelephonyManager mTelephonyManager;
+    @Mock
+    private NetworkCapabilities mCapabilities;
+    @Mock
+    private ContentResolver mMockContentResolver;
+    @Mock
+    private DataSubscription mDataSubscription;
+    @Mock
+    private ColoredTwoActionSwitchPreference mMockPreference;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(SubscriptionManager.class, withSettings().lenient())
+                .startMocking();
+
+        // Setup to always make preference available.
+        when(mContext.getSystemService(Context.USER_SERVICE)).thenReturn(mUserManager);
+        when(mContext.getSystemService(SubscriptionManager.class)).thenReturn(mSubscriptionManager);
+        // Because of the static mock of SubscriptionManager, Mockito thinks .from() is supposed to
+        // return SubscriptionManager instead of TelephonyManager
+        doReturn(mTelephonyManager).when(mContext).getSystemService(TelephonyManager.class);
+        doReturn(mConnectivityManager).when(mContext).getSystemService(ConnectivityManager.class);
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+        ExtendedMockito.when(SubscriptionManager.getDefaultDataSubscriptionId())
+                .thenReturn(SUB_ID);
+
+        when(mTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_PRESENT);
+        when(mTelephonyManager.getSimCount()).thenReturn(1);
+        when(mTelephonyManager.isDataEnabled()).thenReturn(true);
+
+        Network network = mock(Network.class);
+        when(mCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(true);
+        when(mConnectivityManager.getNetworkCapabilities(network)).thenReturn(mCapabilities);
+        when(mConnectivityManager.getAllNetworks()).thenReturn(new Network[]{network});
+
+        when(mUserManager.isAdminUser()).thenReturn(true);
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS))
+                .thenReturn(false);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new MobileNetworkEntryPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+
+        mPreferenceController.setSubscription(mDataSubscription);
+
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mMockPreference);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_noMobileNetwork_unsupported() {
+        when(mTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_ABSENT);
+        when(mCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(false);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_noMobileNetwork_unsupported_zoneWrite() {
+        when(mTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_ABSENT);
+        when(mCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_noMobileNetwork_unsupported_zoneRead() {
+        when(mTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_ABSENT);
+        when(mCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_noMobileNetwork_unsupported_zoneHidden() {
+        when(mTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_ABSENT);
+        when(mCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notAdmin_disabledForUser() {
+        when(mUserManager.isAdminUser()).thenReturn(false);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notAdmin_disabledForUser_zoneWrite() {
+        when(mUserManager.isAdminUser()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notAdmin_disabledForUser_zoneRead() {
+        when(mUserManager.isAdminUser()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notAdmin_disabledForUser_zoneHidden() {
+        when(mUserManager.isAdminUser()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasRestriction_disabledForUser() {
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS))
+                .thenReturn(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasRestriction_disabledForUser_zoneWrite() {
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS))
+                .thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasRestriction_disabledForUser_zoneRead() {
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS))
+                .thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasRestriction_disabledForUser_zoneHidden() {
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS))
+                .thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_hasMobileNetwork_isAdmin_noRestriction_available() {
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noSim_hasMobileNetwork_isAdmin_noRestriction_available() {
+        when(mTelephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_ABSENT);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_noMobileNetwork_isAdmin_noRestriction_available() {
+        when(mCapabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(false);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_hasMobileNetwork_noRestriction_available_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_hasMobileNetwork_noRestriction_available_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_hasSim_hasMobileNetwork_noRestriction_available_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onStart_singleSim_registersObserver() {
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        Uri uri = Settings.Global.getUriFor(Settings.Global.MOBILE_DATA);
+        verify(mMockContentResolver).registerContentObserver(eq(uri), eq(false), any());
+    }
+
+    @Test
+    public void onStart_multiSim_registersObserver() {
+        when(mTelephonyManager.getSimCount()).thenReturn(2);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        Uri uri = Settings.Global.getUriFor(Settings.Global.MOBILE_DATA + SUB_ID);
+        verify(mMockContentResolver).registerContentObserver(eq(uri), eq(false), any());
+    }
+
+    @Test
+    public void onStop_singleSim_unregistersObserver() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockContentResolver).unregisterContentObserver(any());
+    }
+
+    @Test
+    public void onCreate_noSubscriptionInfo_InactiveData_validSummary() {
+        when(mDataSubscription.isDataSubscriptionInactive()).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockPreference).setSummary(mContext.getResources().getString(
+                R.string.connectivity_inactive_prompt));
+    }
+
+    @Test
+    public void onCreate_oneSim_enabled() {
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockPreference, times(2)).setEnabled(true);
+    }
+
+    @Test
+    public void onCreate_dataEnabled_oneSim_summaryIsDisplayName() {
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        verify(mMockPreference).setSummary(TEST_NETWORK_NAME);
+    }
+
+    @Test
+    public void onCreate_dataDisabled_summaryIsOff() {
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+        when(mTelephonyManager.isDataEnabled()).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockPreference).setSummary(mContext.getString(R.string.mobile_network_state_off));
+    }
+
+    @Test
+    public void onCreate_multiSim_enabled() {
+        SubscriptionInfo info1 = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        SubscriptionInfo info2 = createSubscriptionInfo(/* subId= */ 2,
+                /* simSlotIndex= */ 2, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info1, info2);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockPreference, times(2)).setEnabled(true);
+    }
+
+    @Test
+    public void onCreate_multiSim_summaryShowsCount() {
+        SubscriptionInfo info1 = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        SubscriptionInfo info2 = createSubscriptionInfo(/* subId= */ 2,
+                /* simSlotIndex= */ 2, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info1, info2);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+        when(mDataSubscription.isDataSubscriptionInactive()).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockPreference).setSummary(StringUtil.getIcuPluralsString(mContext, 2,
+                R.string.mobile_network_summary_count));
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_noSim_noFragmentStarted() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.handlePreferenceClicked(mMockPreference);
+
+        verify(mFragmentController, never()).launchFragment(
+                any(Fragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_noSubscriptionInfo_noFragmentStarted() {
+        when(mDataSubscription.isDataSubscriptionInactive()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.handlePreferenceClicked(mMockPreference);
+
+        verify(mContext).startActivity(any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_oneSim_startsMobileNetworkFragment() {
+        int subId = 1;
+        SubscriptionInfo info = createSubscriptionInfo(subId, /* simSlotIndex= */ 1,
+                TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.handlePreferenceClicked(mMockPreference);
+
+        ArgumentCaptor<MobileNetworkFragment> captor = ArgumentCaptor.forClass(
+                MobileNetworkFragment.class);
+        verify(mFragmentController).launchFragment(captor.capture());
+
+        assertThat(captor.getValue().getArguments().getInt(MobileNetworkFragment.ARG_NETWORK_SUB_ID,
+                -1)).isEqualTo(subId);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_multiSim_startsMobileNetworkListFragment() {
+        SubscriptionInfo info1 = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        SubscriptionInfo info2 = createSubscriptionInfo(/* subId= */ 2,
+                /* simSlotIndex= */ 2, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info1, info2);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.handlePreferenceClicked(mMockPreference);
+
+        verify(mFragmentController).launchFragment(
+                any(MobileNetworkListFragment.class));
+    }
+
+    @Test
+    public void performToggle_disabled_setsDataEnabled() {
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        when(mTelephonyManager.isDataEnabled()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockPreference).setOnSecondaryActionClickListener(any());
+        verify(mMockPreference).setSecondaryActionChecked(false);
+        mPreferenceController.onSecondaryActionClick(true);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mTelephonyManager).setDataEnabled(true);
+    }
+
+    @Test
+    public void performToggle_enabled_setsDataDisabled() {
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, TEST_NETWORK_NAME);
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        when(mTelephonyManager.isDataEnabled()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mMockPreference).setOnSecondaryActionClickListener(any());
+        verify(mMockPreference).setSecondaryActionChecked(true);
+        mPreferenceController.onSecondaryActionClick(false);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mTelephonyManager).setDataEnabled(false);
+    }
+
+    private SubscriptionInfo createSubscriptionInfo(int subId, int simSlotIndex,
+            String displayName) {
+        SubscriptionInfo subInfo = new SubscriptionInfo(subId, /* iccId= */ "",
+                simSlotIndex, displayName, /* carrierName= */ "",
+                /* nameSource= */ 0, /* iconTint= */ 0, /* number= */ "",
+                /* roaming= */ 0, /* icon= */ null, /* mcc= */ "", "mncString",
+                /* countryIso= */ "", /* isEmbedded= */ false,
+                /* accessRules= */ null, /* cardString= */ "");
+        return subInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/MobileNetworkFragmentTest.java b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkFragmentTest.java
new file mode 100644
index 000000000..00299b1ae
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkFragmentTest.java
@@ -0,0 +1,155 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.os.Bundle;
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.ToolbarController;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileNetworkFragmentTest {
+    private static final int SUB_ID = 1;
+    private static final String TEST_NAME = "Test Name";
+    private static SubscriptionManager sMockSubscriptionManager = mock(SubscriptionManager.class);
+
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    private static MobileNetworkUpdateManager.PhoneChangeReceiver sMockPhoneChangeReceiver;
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        when(sMockSubscriptionManager.getActiveSubscriptionInfoList()).thenReturn(
+                Arrays.asList(
+                        createSubscriptionInfo(SUB_ID + 1, TEST_NAME + "_1"),
+                        createSubscriptionInfo(SUB_ID + 2, TEST_NAME + "_2")));
+    }
+
+    @After
+    public void tearDown() {
+        Mockito.reset(sMockSubscriptionManager);
+    }
+
+    @Test
+    public void onMobileNetworkUpdated_startWithArgument_updateTitle() throws Throwable {
+        setUpFragmentWithSubId(SUB_ID, TEST_NAME);
+
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getTitle()).isEqualTo(TEST_NAME);
+    }
+
+    @Test
+    public void onMobileNetworkUpdated_noArgumentProvided_updateTitle() throws Throwable {
+        setUpFragment();
+        when(sMockSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(
+                Collections.singletonList(createSubscriptionInfo(SUB_ID, TEST_NAME)));
+
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getTitle()).isEqualTo(TEST_NAME + "_1");
+    }
+
+    private void setUpFragment() throws Throwable {
+        String mobileNetworkFragmentTag = "mobile_network_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new TestMobileNetworkFragment(),
+                            mobileNetworkFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+    }
+
+    private void setUpFragmentWithSubId(int subId, String name) throws Throwable {
+        SubscriptionInfo info = createSubscriptionInfo(subId, name);
+        when(sMockSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(
+                Collections.singletonList(info));
+
+        String mobileNetworkFragmentTag = "mobile_network_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, TestMobileNetworkFragment.newInstance(subId),
+                            mobileNetworkFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+    }
+
+    private SubscriptionInfo createSubscriptionInfo(int subId, String name) {
+        SubscriptionInfo subInfo = new SubscriptionInfo(subId, /* iccId= */ "",
+                /* simSlotIndex= */ 0, /* displayName= */ name, /* carrierName= */ "",
+                /* nameSource= */ 0, /* iconTint= */ 0, /* number= */ "",
+                /* roaming= */ 0, /* icon= */ null, /* mcc= */ "", /* mnc= */ "",
+                /* countryIso= */ "", /* isEmbedded= */ false,
+                /* accessRules= */ null, /* cardString= */ "");
+        return subInfo;
+    }
+
+    public static class TestMobileNetworkFragment extends MobileNetworkFragment {
+        public static MobileNetworkFragment newInstance(int subId) {
+            MobileNetworkFragment fragment = new TestMobileNetworkFragment();
+            Bundle args = new Bundle();
+            args.putInt(ARG_NETWORK_SUB_ID, subId);
+            fragment.setArguments(args);
+            return fragment;
+        }
+
+        @Override
+        SubscriptionManager getSubscriptionManager(Context context) {
+            return sMockSubscriptionManager;
+        }
+
+        @Override
+        MobileNetworkUpdateManager getMobileNetworkUpdateManager(Context context, int subId) {
+            return new MobileNetworkUpdateManager(subId, sMockSubscriptionManager,
+                    sMockPhoneChangeReceiver);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/MobileNetworkListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkListPreferenceControllerTest.java
new file mode 100644
index 000000000..921bea2bc
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkListPreferenceControllerTest.java
@@ -0,0 +1,132 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import com.google.android.collect.Lists;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileNetworkListPreferenceControllerTest {
+
+    private static final int SUB_ID = 1;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private MobileNetworkListPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private SubscriptionManager mSubscriptionManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(SubscriptionManager.class)).thenReturn(mSubscriptionManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new MobileNetworkListPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+    }
+
+    @Test
+    public void onCreate_containsElements() {
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, /* cardString= */"", "mncString");
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClicked_launchesFragment() {
+        SubscriptionInfo info = createSubscriptionInfo(SUB_ID, /* simSlotIndex= */ 1,
+                /* cardString= */"", "mncString");
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(mSubscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Preference preference = mPreferenceGroup.getPreference(0);
+        preference.performClick();
+
+        ArgumentCaptor<MobileNetworkFragment> captor = ArgumentCaptor.forClass(
+                MobileNetworkFragment.class);
+        verify(mFragmentController).launchFragment(captor.capture());
+
+        assertThat(captor.getValue().getArguments().getInt(MobileNetworkFragment.ARG_NETWORK_SUB_ID,
+                -1)).isEqualTo(SUB_ID);
+    }
+
+    private SubscriptionInfo createSubscriptionInfo(int subId, int simSlotIndex,
+            String cardString, String mncString) {
+        SubscriptionInfo subInfo = new SubscriptionInfo(subId, /* iccId= */ "",
+                simSlotIndex, /* displayName= */ "", /* carrierName= */ "",
+                /* nameSource= */ 0, /* iconTint= */ 0, /* number= */ "",
+                /* roaming= */ 0, /* icon= */ null, /* mcc= */ "", mncString,
+                /* countryIso= */ "", /* isEmbedded= */ false,
+                /* accessRules= */ null, cardString);
+        return subInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/MobileNetworkUpdateManagerTest.java b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkUpdateManagerTest.java
new file mode 100644
index 000000000..8d40a32d0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/MobileNetworkUpdateManagerTest.java
@@ -0,0 +1,155 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileNetworkUpdateManagerTest {
+
+    private static final int SUB_ID = 1;
+
+    private BaseCarSettingsTestActivity mActivity;
+    private MobileNetworkUpdateManager mMobileNetworkUpdateManager;
+
+    @Mock
+    private MobileNetworkUpdateManager.MobileNetworkUpdateListener mMockMobileNetworkUpdateListener;
+    @Mock
+    private SubscriptionManager mMockSubscriptionManager;
+    @Mock
+    private MobileNetworkUpdateManager.PhoneChangeReceiver mMockPhoneChangeReceiver;
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onStart_receiverRegistered() {
+        setupMobileNetworkUpdateManager(SUB_ID);
+
+        verify(mMockPhoneChangeReceiver).register();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onStop_receiverUnregistered() {
+        setupMobileNetworkUpdateManager(SUB_ID);
+        mMobileNetworkUpdateManager.onStop(mActivity);
+
+        verify(mMockPhoneChangeReceiver).unregister();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onStart_subscriptionListenerRegistered() {
+        setupMobileNetworkUpdateManager(SUB_ID);
+
+        verify(mMockSubscriptionManager).addOnSubscriptionsChangedListener(any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void onStop_subscriptionListenerUnregistered() {
+        setupMobileNetworkUpdateManager(SUB_ID);
+        mMobileNetworkUpdateManager.onStop(mActivity);
+
+        verify(mMockSubscriptionManager).removeOnSubscriptionsChangedListener(any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void onMobileNetworkUpdated_withInitialSubId_pickSubId() {
+        setupMobileNetworkUpdateManager(SUB_ID);
+        List<SubscriptionInfo> newSubscriptionInfoList = List.of(createSubscriptionInfo(SUB_ID + 1),
+                createSubscriptionInfo(SUB_ID + 2));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList(true)).thenReturn(
+                newSubscriptionInfoList);
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList()).thenReturn(
+                newSubscriptionInfoList);
+        mMobileNetworkUpdateManager.mOnSubscriptionsChangeListener.onSubscriptionsChanged();
+
+        // Ensure SubId doesn't change. There are three statements because using any() causes a
+        // runtime exception.
+        verify(mMockMobileNetworkUpdateListener, never()).onMobileNetworkUpdated(SUB_ID);
+        verify(mMockMobileNetworkUpdateListener, never()).onMobileNetworkUpdated(SUB_ID + 1);
+        verify(mMockMobileNetworkUpdateListener, never()).onMobileNetworkUpdated(SUB_ID + 2);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onMobileNetworkUpdated_withoutInitialSubId_pickDefaultSubId() {
+        setupMobileNetworkUpdateManager(MobileNetworkUpdateManager.SUB_ID_NULL);
+        List<SubscriptionInfo> newSubscriptionInfoList = List.of(createSubscriptionInfo(SUB_ID + 1),
+                createSubscriptionInfo(SUB_ID + 2));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList(true)).thenReturn(
+                newSubscriptionInfoList);
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList()).thenReturn(
+                newSubscriptionInfoList);
+        mMobileNetworkUpdateManager.mOnSubscriptionsChangeListener.onSubscriptionsChanged();
+
+        verify(mMockMobileNetworkUpdateListener).onMobileNetworkUpdated(SUB_ID + 1);
+    }
+
+    private void setupMobileNetworkUpdateManager(int subId) {
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(Collections.singletonList(createSubscriptionInfo(subId)));
+        when(mMockSubscriptionManager.getSelectableSubscriptionInfoList())
+                .thenReturn(Collections.singletonList(createSubscriptionInfo(subId)));
+        mMobileNetworkUpdateManager = new MobileNetworkUpdateManager(subId,
+                mMockSubscriptionManager, mMockPhoneChangeReceiver);
+        mActivity.getLifecycle().addObserver(mMobileNetworkUpdateManager);
+        mMobileNetworkUpdateManager.registerListener(mMockMobileNetworkUpdateListener);
+    }
+
+    private SubscriptionInfo createSubscriptionInfo(int subId) {
+        SubscriptionInfo subInfo = new SubscriptionInfo(/* id= */ subId, /* iccId= */ "",
+                /* simSlotIndex= */ 0, /* displayName= */ "", /* carrierName= */ "",
+                /* nameSource= */ 0, /* iconTint= */ 0, /* number= */ "",
+                /* roaming= */ 0, /* icon= */ null, /* mcc= */ "", /* mnc= */ "",
+                /* countryIso= */ "", /* isEmbedded= */ false,
+                /* accessRules= */ null, /* cardString= */ "");
+        return subInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/NetworkBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/network/NetworkBasePreferenceControllerTest.java
new file mode 100644
index 000000000..08fe8d386
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/NetworkBasePreferenceControllerTest.java
@@ -0,0 +1,113 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.NetworkTemplate;
+import android.telephony.TelephonyManager;
+
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.datausage.DataUsageUtils;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class NetworkBasePreferenceControllerTest {
+
+    private static final int SUB_ID = 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private TestNetworkBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private TelephonyManager mMockTelephonyManager;
+    @Mock
+    private NetworkTemplate mMockNetworkTemplate;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(TelephonyManager.class, withSettings().lenient())
+                .mockStatic(DataUsageUtils.class, withSettings().lenient())
+                .startMocking();
+
+        ExtendedMockito.when(TelephonyManager.from(mContext)).thenReturn(mMockTelephonyManager);
+        when(mMockTelephonyManager.createForSubscriptionId(SUB_ID))
+                .thenReturn(mMockTelephonyManager);
+        ExtendedMockito.when(DataUsageUtils.getMobileNetworkTemplate(mMockTelephonyManager, SUB_ID))
+                .thenReturn(mMockNetworkTemplate);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new TestNetworkBasePreferenceController(mContext,
+                "key", mMockFragmentController, mCarUxRestrictions);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onSubIdSet_setsFields() {
+        mPreferenceController.setFields(SUB_ID);
+        assertThat(mPreferenceController.getSubId()).isEqualTo(SUB_ID);
+        assertThat(mPreferenceController.getTelephonyManager()).isEqualTo(mMockTelephonyManager);
+        assertThat(mPreferenceController.getNetworkTemplate()).isEqualTo(mMockNetworkTemplate);
+    }
+
+    /** Concrete impl of {@link NetworkBasePreferenceController} for testing. */
+    private static class TestNetworkBasePreferenceController extends
+            NetworkBasePreferenceController<Preference> {
+
+        TestNetworkBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected Class<Preference> getPreferenceType() {
+            return Preference.class;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/NetworkUtilsTest.java b/tests/multivalent/src/com/android/car/settings/network/NetworkUtilsTest.java
new file mode 100644
index 000000000..31ac436c8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/NetworkUtilsTest.java
@@ -0,0 +1,86 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.net.ConnectivityManager;
+import android.net.Network;
+import android.net.NetworkCapabilities;
+import android.telephony.TelephonyManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class NetworkUtilsTest {
+
+    @Test
+    public void hasMobileNetwork_hasCellularCapabilities_returnsTrue() {
+        ConnectivityManager connectivityManager = mock(ConnectivityManager.class);
+        Network network = mock(Network.class);
+        NetworkCapabilities capabilities = mock(NetworkCapabilities.class);
+
+        when(connectivityManager.getAllNetworks()).thenReturn(new Network[]{network});
+        when(connectivityManager.getNetworkCapabilities(network)).thenReturn(capabilities);
+        when(capabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(true);
+
+        assertThat(NetworkUtils.hasMobileNetwork(connectivityManager)).isTrue();
+    }
+
+    @Test
+    public void hasMobileNetwork_hasNoCellularCapabilities_returnsFalse() {
+        ConnectivityManager connectivityManager = mock(ConnectivityManager.class);
+        Network network = mock(Network.class);
+        NetworkCapabilities capabilities = mock(NetworkCapabilities.class);
+
+        when(connectivityManager.getAllNetworks()).thenReturn(new Network[]{network});
+        when(connectivityManager.getNetworkCapabilities(network)).thenReturn(capabilities);
+        when(capabilities.hasTransport(NetworkCapabilities.TRANSPORT_CELLULAR)).thenReturn(false);
+
+        assertThat(NetworkUtils.hasMobileNetwork(connectivityManager)).isFalse();
+    }
+
+    @Test
+    public void hasSim_simAbsent_returnsFalse() {
+        TelephonyManager telephonyManager = mock(TelephonyManager.class);
+        when(telephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_ABSENT);
+
+        assertThat(NetworkUtils.hasSim(telephonyManager)).isFalse();
+    }
+
+    @Test
+    public void hasSim_simUnknown_returnsFalse() {
+        TelephonyManager telephonyManager = mock(TelephonyManager.class);
+        when(telephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_UNKNOWN);
+
+        assertThat(NetworkUtils.hasSim(telephonyManager)).isFalse();
+    }
+
+    @Test
+    public void hasSim_otherStatus_returnsTrue() {
+        TelephonyManager telephonyManager = mock(TelephonyManager.class);
+        when(telephonyManager.getSimState()).thenReturn(TelephonyManager.SIM_STATE_LOADED);
+
+        assertThat(NetworkUtils.hasSim(telephonyManager)).isTrue();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/RoamingPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/network/RoamingPreferenceControllerTest.java
new file mode 100644
index 000000000..90d0c57cf
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/RoamingPreferenceControllerTest.java
@@ -0,0 +1,260 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.app.AlertDialog;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.os.PersistableBundle;
+import android.provider.Settings;
+import android.telephony.CarrierConfigManager;
+import android.telephony.SubscriptionManager;
+import android.telephony.TelephonyManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.preference.TwoStatePreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class RoamingPreferenceControllerTest {
+
+    private static final int SUB_ID = 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private TwoStatePreference mPreference;
+    private RoamingPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private CarrierConfigManager mMockCarrierConfigManager;
+    @Mock
+    private TelephonyManager mMockTelephonyManager;
+    @Mock
+    private ContentResolver mMockContentResolver;
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(TelephonyManager.class, withSettings().lenient())
+                .mockStatic(SubscriptionManager.class, withSettings().lenient())
+                .startMocking();
+
+        ExtendedMockito.when(TelephonyManager.from(mContext)).thenReturn(mMockTelephonyManager);
+        when(mMockTelephonyManager.createForSubscriptionId(SUB_ID))
+                .thenReturn(mMockTelephonyManager);
+        when(mMockTelephonyManager.getSimCount()).thenReturn(1);
+        when(mMockTelephonyManager.isDataRoamingEnabled()).thenReturn(true);
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+        when(mContext.getSystemService(CarrierConfigManager.class))
+                .thenReturn(mMockCarrierConfigManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new SwitchPreference(mContext);
+        mPreferenceController = new RoamingPreferenceController(mContext,
+                "key", mMockFragmentController, mCarUxRestrictions);
+        mPreferenceController.setFields(SUB_ID);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onStart_registerObserver() {
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mMockContentResolver).registerContentObserver(
+                eq(Settings.Global.getUriFor(Settings.Global.DATA_ROAMING)), eq(false),
+                any());
+    }
+
+    @Test
+    public void onStart_registerObserver_additionalSubId() {
+        when(mMockTelephonyManager.getSimCount()).thenReturn(2);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mMockContentResolver).registerContentObserver(
+                eq(Settings.Global.getUriFor(Settings.Global.DATA_ROAMING + SUB_ID)),
+                eq(false), any());
+    }
+
+    @Test
+    public void onStop_unregisterObserver() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockContentResolver).unregisterContentObserver(any());
+    }
+
+    @Test
+    public void refreshUi_invalidSubId_isDisabled() {
+        when(mMockTelephonyManager.createForSubscriptionId(
+                SubscriptionManager.INVALID_SUBSCRIPTION_ID)).thenReturn(mMockTelephonyManager);
+        mPreferenceController.setFields(SubscriptionManager.INVALID_SUBSCRIPTION_ID);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_validSubId_isEnabled() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_roamingEnabled_setChecked() {
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_roamingDisabled_setUnchecked() {
+        when(mMockTelephonyManager.isDataRoamingEnabled()).thenReturn(false);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void callChangeListener_toggleFalse_turnOffRoaming() {
+        mPreference.setChecked(true);
+
+        mPreference.callChangeListener(false);
+
+        verify(mMockTelephonyManager).setDataRoamingEnabled(false);
+    }
+
+    @Test
+    public void callChangeListener_toggleTrue_needsDialog_showDialog() {
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.isDataRoamingEnabled()).thenReturn(false);
+        PersistableBundle bundle = new PersistableBundle();
+        bundle.putBoolean(CarrierConfigManager.KEY_DISABLE_CHARGE_INDICATION_BOOL, false);
+        when(mMockCarrierConfigManager.getConfigForSubId(SUB_ID)).thenReturn(bundle);
+
+        mPreference.callChangeListener(true);
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    public void confirmDialog_turnOnRoaming() throws Throwable {
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.isDataRoamingEnabled()).thenReturn(false);
+        PersistableBundle bundle = new PersistableBundle();
+        bundle.putBoolean(CarrierConfigManager.KEY_DISABLE_CHARGE_INDICATION_BOOL, false);
+        when(mMockCarrierConfigManager.getConfigForSubId(SUB_ID)).thenReturn(bundle);
+
+        mPreference.callChangeListener(true);
+
+        // Capture the dialog that is shown on toggle.
+        ArgumentCaptor<ConfirmationDialogFragment> dialogCaptor = ArgumentCaptor.forClass(
+                ConfirmationDialogFragment.class);
+        verify(mMockFragmentController).showDialog(dialogCaptor.capture(),
+                eq(ConfirmationDialogFragment.TAG));
+
+        // Show the captured dialog on press the confirmation button.
+        ConfirmationDialogFragment dialog = dialogCaptor.getValue();
+        assertThat(dialogCaptor).isNotNull();
+        AlertDialog alertDialog = showDialog(dialog);
+        mActivityTestRule.runOnUiThread(() -> {
+            alertDialog.getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mMockTelephonyManager).setDataRoamingEnabled(true);
+    }
+
+    @Test
+    public void callChangeListener_toggleTrue_doesntNeedDialog_turnOnRoaming() {
+        mPreference.setChecked(false);
+        when(mMockTelephonyManager.isDataRoamingEnabled()).thenReturn(false);
+        PersistableBundle bundle = new PersistableBundle();
+        bundle.putBoolean(CarrierConfigManager.KEY_DISABLE_CHARGE_INDICATION_BOOL, true);
+        when(mMockCarrierConfigManager.getConfigForSubId(SUB_ID)).thenReturn(bundle);
+
+        mPreference.callChangeListener(true);
+
+        verify(mMockTelephonyManager).setDataRoamingEnabled(true);
+    }
+
+    private AlertDialog showDialog(ConfirmationDialogFragment dialog) throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> {
+            dialog.show(mActivityTestRule.getActivity().getSupportFragmentManager(),
+                    /* tag= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        return (AlertDialog) dialog.getDialog();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/SubscriptionUtilsTest.java b/tests/multivalent/src/com/android/car/settings/network/SubscriptionUtilsTest.java
new file mode 100644
index 000000000..a788b2b4a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/SubscriptionUtilsTest.java
@@ -0,0 +1,118 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+import android.telephony.TelephonyManager;
+import android.telephony.UiccPortInfo;
+import android.telephony.UiccSlotInfo;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.google.android.collect.Lists;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class SubscriptionUtilsTest {
+
+    @Test
+    public void getAvailableSubscriptions_hasSubscriptionsFromSubscriptionManager_valueReturned() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        TelephonyManager telephonyManager = mock(TelephonyManager.class);
+
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, /* cardString= */"", "mncString");
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(subscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+        when(telephonyManager.getUiccSlotsInfo()).thenReturn(new UiccSlotInfo[0]);
+
+        List<SubscriptionInfo> infos = SubscriptionUtils.getAvailableSubscriptions(
+                subscriptionManager, telephonyManager);
+
+        assertThat(infos).contains(info);
+    }
+
+    @Test
+    public void getAvailableSubscriptions_hasSimSlotNotInSubscriptionManager_valueReturned() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        TelephonyManager telephonyManager = mock(TelephonyManager.class);
+
+        int simSlotIdx = 1;
+        String cardString = "testString";
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1, simSlotIdx, cardString,
+                "mncString");
+        UiccSlotInfo slotInfo = createUuicSlotInfo(/* isActive= */ false, /* isEsim= */ false,
+                simSlotIdx, cardString, UiccSlotInfo.CARD_STATE_INFO_PRESENT);
+        List<SubscriptionInfo> allSims = Lists.newArrayList(info);
+        when(subscriptionManager.getAllSubscriptionInfoList()).thenReturn(allSims);
+        when(telephonyManager.getUiccSlotsInfo()).thenReturn(new UiccSlotInfo[]{slotInfo});
+
+        List<SubscriptionInfo> infos = SubscriptionUtils.getAvailableSubscriptions(
+                subscriptionManager, telephonyManager);
+
+        assertThat(infos).contains(info);
+    }
+
+    @Test
+    public void getAvailableSubscriptions_hasInactiveInsertedPSim_valueRemoved() {
+        SubscriptionManager subscriptionManager = mock(SubscriptionManager.class);
+        TelephonyManager telephonyManager = mock(TelephonyManager.class);
+
+        SubscriptionInfo info = createSubscriptionInfo(/* subId= */ 1,
+                /* simSlotIndex= */ 1, /* cardString= */"", "");
+        List<SubscriptionInfo> selectable = Lists.newArrayList(info);
+        when(subscriptionManager.getSelectableSubscriptionInfoList()).thenReturn(selectable);
+        when(telephonyManager.getUiccSlotsInfo()).thenReturn(new UiccSlotInfo[0]);
+
+        List<SubscriptionInfo> infos = SubscriptionUtils.getAvailableSubscriptions(
+                subscriptionManager, telephonyManager);
+
+        assertThat(infos).doesNotContain(info);
+    }
+
+    private SubscriptionInfo createSubscriptionInfo(int subId, int simSlotIndex,
+            String cardString, String mncString) {
+        SubscriptionInfo subInfo = new SubscriptionInfo(subId, /* iccId= */ "",
+                simSlotIndex, /* displayName= */ "", /* carrierName= */ "",
+                /* nameSource= */ 0, /* iconTint= */ 0, /* number= */ "",
+                /* roaming= */ 0, /* icon= */ null, /* mcc= */ "", mncString,
+                /* countryIso= */ "", /* isEmbedded= */ false,
+                /* accessRules= */ null, cardString);
+        return subInfo;
+    }
+
+    private UiccSlotInfo createUuicSlotInfo(boolean isActive, boolean isEsim, int simSlotIndex,
+            String cardId, int cardStateInfo) {
+        return new UiccSlotInfo(
+                isEsim, cardId, cardStateInfo,
+                /* isExtendedApduSupported= */ false, /* isRemovable= */ true,
+                Collections.singletonList(
+                        new UiccPortInfo("" /* iccId */, 0 /* portIdx */,
+                                simSlotIndex /* logicalSlotIdx */, isActive /* isActive */)));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/network/SubscriptionsChangeListenerTest.java b/tests/multivalent/src/com/android/car/settings/network/SubscriptionsChangeListenerTest.java
new file mode 100644
index 000000000..c687444dd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/network/SubscriptionsChangeListenerTest.java
@@ -0,0 +1,113 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.network;
+
+import static com.android.car.settings.network.SubscriptionsChangeListener.RADIO_TECH_CHANGED_FILTER;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.Intent;
+import android.telephony.SubscriptionManager;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class SubscriptionsChangeListenerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SubscriptionsChangeListener mSubscriptionsChangeListener;
+
+    @Mock
+    private SubscriptionsChangeListener.SubscriptionsChangeAction mSubscriptionsChangeAction;
+    @Mock
+    private SubscriptionManager mMockSubscriptionManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(SubscriptionManager.class))
+                .thenReturn(mMockSubscriptionManager);
+        mSubscriptionsChangeListener = new SubscriptionsChangeListener(mContext,
+                mSubscriptionsChangeAction);
+    }
+
+    @Test
+    public void start_registersListener() {
+        verify(mMockSubscriptionManager, never()).addOnSubscriptionsChangedListener(
+                mSubscriptionsChangeListener.mSubscriptionsChangedListener);
+        mSubscriptionsChangeListener.start();
+
+        verify(mMockSubscriptionManager).addOnSubscriptionsChangedListener(
+                mSubscriptionsChangeListener.mSubscriptionsChangedListener);
+    }
+
+    @Test
+    public void onSubscriptionChange_triggersAction() {
+        mSubscriptionsChangeListener.start();
+        mSubscriptionsChangeListener.mSubscriptionsChangedListener.onSubscriptionsChanged();
+
+        verify(mSubscriptionsChangeAction).onSubscriptionsChanged();
+    }
+
+    @Test
+    public void stop_unregistersListener() {
+        mSubscriptionsChangeListener.start();
+        mSubscriptionsChangeListener.stop();
+
+        verify(mMockSubscriptionManager).removeOnSubscriptionsChangedListener(
+                mSubscriptionsChangeListener.mSubscriptionsChangedListener);
+    }
+
+    @Test
+    public void start_registersReceiver() {
+        mSubscriptionsChangeListener.start();
+
+        verify(mContext).registerReceiver(any(), eq(RADIO_TECH_CHANGED_FILTER));
+    }
+
+    @Test
+    public void onReceive_triggersAction() {
+        mSubscriptionsChangeListener.start();
+        mSubscriptionsChangeListener.mRadioTechChangeReceiver.onReceive(mContext, new Intent());
+
+        verify(mSubscriptionsChangeAction).onSubscriptionsChanged();
+    }
+
+    @Test
+    public void stop_unregistersReceiver() {
+        mSubscriptionsChangeListener.start();
+        mSubscriptionsChangeListener.stop();
+
+        verify(mContext).unregisterReceiver(any());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/notifications/NotificationAccessConfirmationActivityTest.java b/tests/multivalent/src/com/android/car/settings/notifications/NotificationAccessConfirmationActivityTest.java
new file mode 100644
index 000000000..8b6234b7a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/notifications/NotificationAccessConfirmationActivityTest.java
@@ -0,0 +1,217 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.notifications;
+
+import static com.android.internal.notification.NotificationAccessConfirmationActivityContract.EXTRA_COMPONENT_NAME;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.Manifest;
+import android.app.AlertDialog;
+import android.app.NotificationManager;
+import android.car.test.mocks.AndroidMockitoHelper;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.DialogInterface;
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ServiceInfo;
+
+import androidx.annotation.Nullable;
+import androidx.lifecycle.Lifecycle;
+import androidx.test.core.app.ActivityScenario;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Locale;
+
+/**
+ * Unit tests for {@link NotificationAccessConfirmationActivity}
+ */
+@RunWith(AndroidJUnit4.class)
+public final class NotificationAccessConfirmationActivityTest {
+    private static final ComponentName TEMP_COMPONENT_NAME = ComponentName.unflattenFromString(
+            "com.temp/com.temp.k");
+
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private ActivityScenario<TestActivity> mActivityScenario;
+    private TestActivity mActivity;
+    private PackageManager mPackageManager;
+
+    @Mock
+    private NotificationManager mNotificationManager;
+
+    private static ServiceInfo createServiceInfoForTempComponent(String permission) {
+        ServiceInfo info = new ServiceInfo();
+        info.name = TEMP_COMPONENT_NAME.getClassName();
+        info.packageName = TEMP_COMPONENT_NAME.getPackageName();
+        info.permission = permission;
+        return info;
+    }
+
+    private static ApplicationInfo createApplicationInfo() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.name = TEMP_COMPONENT_NAME.getClassName();
+        info.packageName = TEMP_COMPONENT_NAME.getPackageName();
+        return info;
+    }
+
+    @Before
+    public void setup() {
+        MockitoAnnotations.initMocks(this);
+    }
+
+    @Test
+    public void componentNameEmpty_finishes() {
+        Intent intent = new Intent(mContext, TestActivity.class);
+        mActivityScenario = ActivityScenario.launch(intent);
+        assertThat(mActivityScenario.getState()).isEqualTo(Lifecycle.State.DESTROYED);
+    }
+
+    @Test
+    public void componentNameNonEmpty_showsConfirmationDialog() {
+        launchActivityWithValidIntent();
+        assertThat(mActivityScenario.getState()).isAtLeast(Lifecycle.State.CREATED);
+    }
+
+    @Test
+    public void onAllow_permissionMissing_finishes() throws Exception {
+        launchActivityWithValidIntent();
+        assertThat(mActivityScenario.getState()).isAtLeast(Lifecycle.State.CREATED);
+        ServiceInfo info = createServiceInfoForTempComponent(/* permission = */ "");
+        doReturn(info).when(mPackageManager).getServiceInfo(info.getComponentName(), 0);
+
+        AndroidMockitoHelper.syncRunOnUiThread(mActivity, () -> {
+            getConfirmationDialog().getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Not asserting DESTROYED state as mActivityScenario.getState() returns STARTED state for
+        // some unknown reason.
+        assertThat(mActivity.mFinishTriggered).isTrue();
+    }
+
+    @Test
+    public void onAllow_permissionAvailable_callsNotificationManager() throws Exception {
+        launchActivityWithValidIntent();
+        assertThat(mActivityScenario.getState()).isAtLeast(Lifecycle.State.CREATED);
+        ServiceInfo info = createServiceInfoForTempComponent(
+                Manifest.permission.BIND_NOTIFICATION_LISTENER_SERVICE);
+        doReturn(info).when(mPackageManager).getServiceInfo(info.getComponentName(), 0);
+
+        AndroidMockitoHelper.syncRunOnUiThread(mActivity, () -> {
+            getConfirmationDialog().getButton(DialogInterface.BUTTON_POSITIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(mNotificationManager)
+                .setNotificationListenerAccessGranted(eq(info.getComponentName()), eq(true));
+    }
+
+    @Test
+    public void onDeny_finishes() throws Exception {
+        launchActivityWithValidIntent();
+        assertThat(mActivityScenario.getState()).isAtLeast(Lifecycle.State.CREATED);
+
+        AndroidMockitoHelper.syncRunOnUiThread(mActivity, () -> {
+            getConfirmationDialog().getButton(DialogInterface.BUTTON_NEGATIVE).performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Not asserting DESTROYED state as mActivityScenario.getState() returns STARTED state for
+        // some unknown reason.
+        assertThat(mActivity.mFinishTriggered).isTrue();
+    }
+
+    private AlertDialog getConfirmationDialog() {
+        return (AlertDialog) ((ConfirmationDialogFragment) mActivity.getSupportFragmentManager()
+                .findFragmentByTag(ConfirmationDialogFragment.TAG))
+                .getDialog();
+    }
+
+    private void launchActivityWithValidIntent() {
+        Intent intent = new Intent(mContext, TestActivity.class)
+                .putExtra(EXTRA_COMPONENT_NAME, TEMP_COMPONENT_NAME);
+
+        mActivityScenario = ActivityScenario.launch(intent);
+        mActivityScenario.onActivity(
+                activity -> {
+                    mActivity = activity;
+                    mPackageManager = mActivity.getPackageManager();
+                    mActivity.setPackageManagerSpy(mPackageManager);
+                    mActivity.setNotificationManagerSpy(mNotificationManager);
+                });
+    }
+
+    public static final class TestActivity extends NotificationAccessConfirmationActivity {
+        @Nullable private PackageManager mPackageManagerSpy;
+        @Nullable private NotificationManager mNotificationManagerSpy;
+        boolean mFinishTriggered;
+
+        void setPackageManagerSpy(PackageManager packageManagerSpy) {
+            mPackageManagerSpy = packageManagerSpy;
+        }
+
+        void setNotificationManagerSpy(NotificationManager notificationManagerSpy) {
+            mNotificationManagerSpy = notificationManagerSpy;
+        }
+
+        @Override
+        public PackageManager getPackageManager() {
+            if (mPackageManagerSpy == null) {
+                mPackageManagerSpy = spy(super.getPackageManager());
+                try {
+                    ApplicationInfo info = createApplicationInfo();
+                    doReturn(info).when(mPackageManagerSpy).getApplicationInfo(any(), any());
+                } catch (PackageManager.NameNotFoundException e) {
+                    // do nothing... tests will fail when activity finishes during onCreate()
+                }
+            }
+            return mPackageManagerSpy;
+        }
+
+        @Override
+        public Object getSystemService(String name) {
+            return mNotificationManagerSpy != null
+                    && name.toLowerCase(Locale.ROOT).contains("notification")
+                    ? mNotificationManagerSpy
+                    : super.getSystemService(name);
+        }
+
+        @Override
+        public void finish() {
+            mFinishTriggered = true;
+            super.finish();
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/notifications/NotificationsAppListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/notifications/NotificationsAppListPreferenceControllerTest.java
new file mode 100644
index 000000000..2178c7ca0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/notifications/NotificationsAppListPreferenceControllerTest.java
@@ -0,0 +1,389 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.notifications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.app.INotificationManager;
+import android.app.NotificationChannel;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
+import android.graphics.drawable.Drawable;
+import android.os.Build;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.applications.ApplicationDetailsFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionSwitchPreference;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+
+@RunWith(AndroidJUnit4.class)
+public class NotificationsAppListPreferenceControllerTest {
+    private static final String PKG_NAME = "package.name";
+    private static final int UID = 1001010;
+    private static final int ID = 1;
+    private static final String LABEL = "label";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceCategory;
+    private NotificationsAppListPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArrayList<ApplicationsState.AppEntry> mAppEntryList;
+    private ApplicationInfo mApplicationInfo;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private INotificationManager mMockNotificationManager;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private NotificationChannel mMockChannel;
+    @Mock
+    private CarUiTwoActionSwitchPreference mMockPreference;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceCategory = new PreferenceCategory(mContext);
+        screen.addPreference(mPreferenceCategory);
+
+        mPreferenceController = new TestNotificationsAppListPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceCategory);
+
+        mPreferenceController.mNotificationManager = mMockNotificationManager;
+
+        mApplicationInfo = new ApplicationInfo();
+        mApplicationInfo.packageName = PKG_NAME;
+        mApplicationInfo.uid = UID;
+        mApplicationInfo.sourceDir = "";
+        mApplicationInfo.targetSdkVersion = Build.VERSION_CODES.TIRAMISU;
+        ApplicationsState.AppEntry appEntry =
+                new ApplicationsState.AppEntry(mContext, mApplicationInfo, ID);
+        appEntry.label = LABEL;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+
+        mAppEntryList = new ArrayList<>();
+        mAppEntryList.add(appEntry);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+    }
+
+    @Test
+    public void onCreate_createsPreference() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(true);
+        setupNotificationsEnabledPermissions();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        assertThat(mPreferenceCategory.getPreferenceCount()).isEqualTo(1);
+
+        verify(mMockPreference).setTitle(LABEL);
+        verify(mMockPreference).setIcon(any(Drawable.class));
+    }
+
+    @Test
+    public void onCreate_notificationEnabled_isChecked() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(true);
+        setupNotificationsEnabledPermissions();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionChecked(true);
+    }
+
+    @Test
+    public void onCreate_notificationDisabled_isNotChecked() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(false);
+        setupNotificationsEnabledPermissions();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionChecked(false);
+    }
+
+    @Test
+    public void onCreate_importanceLocked_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(false);
+    }
+
+    @Test
+    public void onCreate_noNotificationPermission_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(false);
+    }
+
+    @Test
+    public void onCreate_systemFixedFlag_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_SYSTEM_FIXED);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(false);
+    }
+
+    @Test
+    public void onCreate_policyFixedFlag_isNotEnabled() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_POLICY_FIXED);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(false);
+    }
+
+    @Test
+    public void onCreate_hasPermissions_isEnabled() throws Exception {
+        setupNotificationsEnabledPermissions();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(true);
+    }
+
+    @Test
+    public void onCreate_targetSdkBelow33_systemFixedFlag_isNotEnabled() throws Exception {
+        mApplicationInfo.targetSdkVersion = Build.VERSION_CODES.S;
+
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_SYSTEM_FIXED);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(false);
+    }
+
+    @Test
+    public void onCreate_targetSdkBelow33_policyFixedFlag_isNotEnabled() throws Exception {
+        mApplicationInfo.targetSdkVersion = Build.VERSION_CODES.S;
+
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(PackageManager.FLAG_PERMISSION_POLICY_FIXED);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(false);
+    }
+
+    @Test
+    public void onCreate_targetSdkBelow33_doesNotHavePermission_isEnabled() throws Exception {
+        mApplicationInfo.targetSdkVersion = Build.VERSION_CODES.S;
+
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(0);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setSecondaryActionEnabled(true);
+    }
+
+    @Test
+    public void toggle_setEnable_enablingNotification() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(false);
+        when(mMockNotificationManager.onlyHasDefaultChannel(PKG_NAME, UID)).thenReturn(false);
+        setupNotificationsEnabledPermissions();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setOnSecondaryActionClickListener(any());
+
+        mPreferenceController.onSecondaryActionClick(PKG_NAME, UID, /* newValue= */ true);
+
+        verify(mMockNotificationManager).setNotificationsEnabledForPackage(PKG_NAME, UID, true);
+    }
+
+    @Test
+    public void toggle_setDisable_disablingNotification() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(true);
+        when(mMockNotificationManager.onlyHasDefaultChannel(PKG_NAME, UID)).thenReturn(false);
+        setupNotificationsEnabledPermissions();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setOnSecondaryActionClickListener(any());
+
+        mPreferenceController.onSecondaryActionClick(PKG_NAME, UID, /* newValue= */ false);
+
+        verify(mMockNotificationManager).setNotificationsEnabledForPackage(PKG_NAME, UID, false);
+    }
+
+    @Test
+    public void toggle_onlyHasDefaultChannel_updateChannel() throws Exception {
+        when(mMockNotificationManager.areNotificationsEnabledForPackage(PKG_NAME, UID))
+                .thenReturn(false);
+        when(mMockNotificationManager.onlyHasDefaultChannel(PKG_NAME, UID)).thenReturn(true);
+        when(mMockNotificationManager
+                .getNotificationChannelForPackage(
+                        PKG_NAME, UID, NotificationChannel.DEFAULT_CHANNEL_ID, null, true))
+                .thenReturn(mMockChannel);
+        setupNotificationsEnabledPermissions();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setOnSecondaryActionClickListener(any());
+
+        mPreferenceController.onSecondaryActionClick(PKG_NAME, UID, /* newValue= */ true);
+
+        verify(mMockNotificationManager)
+                .updateNotificationChannelForPackage(PKG_NAME, UID, mMockChannel);
+    }
+
+    @Test
+    @UiThreadTest
+    public void clickPreference_shouldOpenApplicationDetailsFragment() throws Exception {
+        setupNotificationsEnabledPermissions();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onDataLoaded(mAppEntryList);
+
+        verify(mMockPreference).setOnPreferenceClickListener(any());
+
+        mPreferenceController.onPrimaryActionClick(PKG_NAME);
+
+        verify(mFragmentController).launchFragment(any(ApplicationDetailsFragment.class));
+    }
+
+    private void setupNotificationsEnabledPermissions() throws Exception {
+        when(mMockNotificationManager.isImportanceLocked(PKG_NAME, UID)).thenReturn(false);
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.requestedPermissions = new String[] {Manifest.permission.POST_NOTIFICATIONS};
+        when(mMockPackageManager.getPackageInfoAsUser(eq(PKG_NAME),
+                eq(PackageManager.GET_PERMISSIONS), anyInt())).thenReturn(packageInfo);
+
+        when(mMockPackageManager.getPermissionFlags(eq(Manifest.permission.POST_NOTIFICATIONS),
+                eq(PKG_NAME), any())).thenReturn(0);
+    }
+
+    private class TestNotificationsAppListPreferenceController extends
+            NotificationsAppListPreferenceController {
+
+        TestNotificationsAppListPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUiTwoActionSwitchPreference createPreference() {
+            return mMockPreference;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/notifications/RecentNotificationsAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/notifications/RecentNotificationsAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..8e9ad919b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/notifications/RecentNotificationsAppsPreferenceControllerTest.java
@@ -0,0 +1,226 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.notifications;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyLong;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.after;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.INotificationManager;
+import android.app.usage.IUsageStatsManager;
+import android.app.usage.UsageEvents;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.os.Parcel;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class RecentNotificationsAppsPreferenceControllerTest {
+    private static final int TIMEOUT = 5000;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceCategory;
+    private RecentNotificationsAppsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private int mMaxEntryCount;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private INotificationManager mMockManager;
+    @Mock
+    private ApplicationsState mMockApplicationsState;
+    @Mock
+    private IUsageStatsManager mMockUsageStatsManager;
+    @Mock
+    private ApplicationInfo mApplicationInfo;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceCategory = new PreferenceCategory(mContext);
+        screen.addPreference(mPreferenceCategory);
+
+        mPreferenceController = new RecentNotificationsAppsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceCategory);
+
+        mPreferenceController.mNotificationManager = mMockManager;
+        mPreferenceController.mUsageStatsManager = mMockUsageStatsManager;
+        mPreferenceController.setApplicationsState(mMockApplicationsState);
+
+        mMaxEntryCount = mContext.getResources().getInteger(
+                R.integer.recent_notifications_apps_list_count);
+    }
+
+    @Test
+    public void noEvents_noPreferences() throws Exception {
+        when(mMockUsageStatsManager.queryEventsForUser(anyLong(),
+                anyLong(), anyInt(), anyString())).thenReturn(null);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceCategory.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void areEvents_showValidRecents() throws Exception {
+        long timestamp = System.currentTimeMillis();
+        List<UsageEvents.Event> events = new ArrayList<>();
+        UsageEvents.Event app1 = createUsageEvent("a", timestamp);
+        UsageEvents.Event app2 = createUsageEvent("com.android.settings", timestamp);
+        UsageEvents.Event app3 = createUsageEvent("pkg.class2", timestamp - 1000);
+
+        events.add(app1);
+        events.add(app2);
+        events.add(app3);
+
+        ApplicationsState.AppEntry app1Entry = createAppEntry("app 1");
+        ApplicationsState.AppEntry app2Entry = createAppEntry("app 2");
+
+        // app1, app2 are valid apps. app3 is invalid.
+        int userId = UserHandle.myUserId();
+        when(mMockApplicationsState.getEntry(app1.getPackageName(), userId)).thenReturn(app1Entry);
+        when(mMockApplicationsState.getEntry(app2.getPackageName(), userId)).thenReturn(app2Entry);
+        when(mMockApplicationsState.getEntry(app3.getPackageName(), userId)).thenReturn(null);
+
+        UsageEvents usageEvents = getUsageEvents(
+                new String[] {app1.getPackageName(), app2.getPackageName(), app3.getPackageName()},
+                events);
+        when(mMockUsageStatsManager.queryEventsForUser(anyLong(), anyLong(), anyInt(), anyString()))
+                .thenReturn(usageEvents);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Only add app1 & app2. app3 skipped because it's invalid app.
+        verify(mMockApplicationsState, after(TIMEOUT).times(2))
+                .getEntry(eq(app1.getPackageName()), anyInt());
+        assertThat(mPreferenceCategory.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreferenceCategory.getPreference(0).getTitle()).isEqualTo(app1Entry.label);
+        assertThat(mPreferenceCategory.getPreference(1).getTitle()).isEqualTo(app2Entry.label);
+    }
+
+    @Test
+    public void areEvents_showMaximumRecents() throws Exception {
+        long timestamp = System.currentTimeMillis();
+        List<UsageEvents.Event> events = new ArrayList<>();
+        UsageEvents.Event app1 = createUsageEvent("a", timestamp);
+        UsageEvents.Event app2 = createUsageEvent("com.android.settings", timestamp);
+        UsageEvents.Event app3 = createUsageEvent("pkg.class2", timestamp - 1000);
+        UsageEvents.Event app4 = createUsageEvent("pkg.class3", timestamp - 1000);
+
+        events.add(app1);
+        events.add(app2);
+        events.add(app3);
+        events.add(app4);
+
+        ApplicationsState.AppEntry app1Entry = createAppEntry("app 1");
+        ApplicationsState.AppEntry app2Entry = createAppEntry("app 2");
+        ApplicationsState.AppEntry app3Entry = createAppEntry("app 3");
+        ApplicationsState.AppEntry app4Entry = createAppEntry("app 4");
+
+        // Four valid apps found
+        int userId = UserHandle.myUserId();
+        when(mMockApplicationsState.getEntry(app1.getPackageName(), userId)).thenReturn(app1Entry);
+        when(mMockApplicationsState.getEntry(app2.getPackageName(), userId)).thenReturn(app2Entry);
+        when(mMockApplicationsState.getEntry(app3.getPackageName(), userId)).thenReturn(app3Entry);
+        when(mMockApplicationsState.getEntry(app4.getPackageName(), userId)).thenReturn(app4Entry);
+
+        UsageEvents usageEvents = getUsageEvents(
+                new String[] {app1.getPackageName(), app2.getPackageName(), app3.getPackageName(),
+                app4.getPackageName()}, events);
+        when(mMockUsageStatsManager.queryEventsForUser(anyLong(), anyLong(), anyInt(), anyString()))
+                .thenReturn(usageEvents);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Only max allowed apps displayed
+        verify(mMockApplicationsState, after(TIMEOUT).times(2))
+                .getEntry(eq(app1.getPackageName()), anyInt());
+        assertThat(mPreferenceCategory.getPreferenceCount()).isEqualTo(mMaxEntryCount);
+        assertThat(mPreferenceCategory.getPreference(0).getTitle()).isEqualTo(app1Entry.label);
+        assertThat(mPreferenceCategory.getPreference(1).getTitle()).isEqualTo(app2Entry.label);
+        assertThat(mPreferenceCategory.getPreference(2).getTitle()).isEqualTo(app3Entry.label);
+    }
+
+    private UsageEvents getUsageEvents(String[] pkgs, List<UsageEvents.Event> events) {
+        UsageEvents usageEvents = new UsageEvents(events, pkgs);
+        Parcel parcel = Parcel.obtain();
+        parcel.setDataPosition(0);
+        usageEvents.writeToParcel(parcel, 0);
+        parcel.setDataPosition(0);
+        return UsageEvents.CREATOR.createFromParcel(parcel);
+    }
+
+    private UsageEvents.Event createUsageEvent(String packageName, long timestamp) {
+        UsageEvents.Event app = new UsageEvents.Event();
+        app.mEventType = UsageEvents.Event.NOTIFICATION_INTERRUPTION;
+        app.mPackage = packageName;
+        app.mTimeStamp = timestamp;
+        return app;
+    }
+
+    private ApplicationsState.AppEntry createAppEntry(String label) {
+        ApplicationsState.AppEntry appEntry = mock(ApplicationsState.AppEntry.class);
+        appEntry.info = mApplicationInfo;
+        appEntry.label = label;
+        return appEntry;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/CameraRecentAccessViewAllPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/CameraRecentAccessViewAllPreferenceControllerTest.java
new file mode 100644
index 000000000..de82e7df6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/CameraRecentAccessViewAllPreferenceControllerTest.java
@@ -0,0 +1,180 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.graphics.drawable.Drawable;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.RecentAppOpsAccess;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.time.Clock;
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class CameraRecentAccessViewAllPreferenceControllerTest {
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private CameraRecentAccessViewAllPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private RecentAppOpsAccess mRecentCameraAccesses;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new CameraRecentAccessViewAllPreferenceController(mContext,
+                "key", mFragmentController, carUxRestrictions,
+                mRecentCameraAccesses);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+    }
+
+    @Test
+    public void updateState_noSystemAppsByDefault() {
+        initializePreference();
+        verify(mRecentCameraAccesses, never()).getAppListSorted(/* showSystem= */ true);
+    }
+
+    @Test
+    public void setShowSystem_showsSystemApps() {
+        initializePreference();
+        mPreferenceController.setShowSystem(true);
+        verify(mRecentCameraAccesses).getAppListSorted(/* showSystem= */ true);
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_showsEmptyState() {
+        initializePreference();
+
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(
+                mContext.getString(R.string.camera_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_someRecentRequests_displaysAppInformation() {
+        initializePreference();
+
+        String fakeLabel = "Test app 1";
+        RecentAppOpsAccess.Access fakeAccess = new RecentAppOpsAccess.Access("com.test",
+                UserHandle.CURRENT, mock(Drawable.class), fakeLabel,
+                "fake contentDescription", Clock.systemDefaultZone().millis());
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(fakeAccess);
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(fakeLabel);
+        assertThat(mPreference.getPreference(0).getSummary().toString()).contains("min. ago");
+    }
+
+    @Test
+    public void refreshUi_recentRequests_launchCameraSettings() {
+        initializePreference();
+
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+    }
+
+    @Test
+    public void refreshUi_newRecentRequests_listIsUpdated() {
+        initializePreference();
+
+        List<RecentAppOpsAccess.Access> list1 = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list1);
+
+        List<RecentAppOpsAccess.Access> list2 = new ArrayList<>(list1);
+        list2.add(mock(RecentAppOpsAccess.Access.class));
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list1.size());
+
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list2);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list2.size());
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+}
+
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/CameraRecentAccessesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/CameraRecentAccessesPreferenceControllerTest.java
new file mode 100644
index 000000000..343b9fba0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/CameraRecentAccessesPreferenceControllerTest.java
@@ -0,0 +1,267 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.graphics.drawable.Drawable;
+import android.hardware.SensorPrivacyManager;
+import android.hardware.SensorPrivacyManager.OnSensorPrivacyChangedListener;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.RecentAppOpsAccess;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.time.Clock;
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class CameraRecentAccessesPreferenceControllerTest {
+    private static final int RECENT_APPS_MAX_COUNT = 2;
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceCategory mPreference;
+    private CameraRecentAccessesPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private RecentAppOpsAccess mRecentCameraAccesses;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+    @Mock
+    private OnSensorPrivacyChangedListener.SensorPrivacyChangedParams mSensorPrivacyChangedParams;
+    @Captor
+    private ArgumentCaptor<OnSensorPrivacyChangedListener> mListener;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new PreferenceCategory(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new CameraRecentAccessesPreferenceController(mContext,
+                "key", mFragmentController, carUxRestrictions,
+                mRecentCameraAccesses, RECENT_APPS_MAX_COUNT, mMockSensorPrivacyManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void cameraMuted_preferenceIsHidden() {
+        setIsSensorPrivacyEnabled(true);
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void cameraNotMuted_preferenceIsShown() {
+        setIsSensorPrivacyEnabled(false);
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_cameraEnabled_shouldShow() {
+        initializePreference();
+
+        setIsSensorPrivacyEnabled(false);
+        mListener.getValue().onSensorPrivacyChanged(mSensorPrivacyChangedParams);
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_cameraDisabled_shouldHide() {
+        initializePreference();
+
+        setIsSensorPrivacyEnabled(true);
+        mListener.getValue().onSensorPrivacyChanged(mSensorPrivacyChangedParams);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_messageDisplayed() {
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(
+                mContext.getString(R.string.camera_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_exceptForSomeRecentSystemAppRequests_showsViewAll() {
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.singletonList(mock(RecentAppOpsAccess.Access.class)));
+        mPreferenceController.refreshUi();
+
+        // includes preference for "View all"
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreference.getPreference(1).getTitle()).isEqualTo(
+                mContext.getString(R.string.camera_settings_recent_requests_view_all_title));
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_clickViewAll_launchesFragment() {
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.singletonList(mock(RecentAppOpsAccess.Access.class)));
+        mPreferenceController.refreshUi();
+
+        // click on the "View all" preference
+        mPreference.getPreference(1).performClick();
+        verify(mFragmentController)
+                .launchFragment(any(CameraRecentAccessViewAllFragment.class));
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_includingNoSystemAppRequests_doesNotShowViewAll() {
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        // no preference for "View all"
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(
+                mContext.getString(R.string.camera_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_someRecentRequests_displaysAppInformation() {
+        String fakeLabel = "Test app 1";
+        RecentAppOpsAccess.Access fakeAccess = new RecentAppOpsAccess.Access("com.test",
+                UserHandle.CURRENT, mock(Drawable.class), fakeLabel,
+                "fake contentDescription", Clock.systemDefaultZone().millis());
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(fakeAccess);
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(fakeLabel);
+        assertThat(mPreference.getPreference(0).getSummary().toString()).contains("min. ago");
+    }
+
+    @Test
+    public void refreshUi_someRecentRequests_preferencesAddedToScreen_capsAtMax() {
+        List<RecentAppOpsAccess.Access> list = Arrays.asList(
+                mock(RecentAppOpsAccess.Access.class),
+                mock(RecentAppOpsAccess.Access.class),
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(RECENT_APPS_MAX_COUNT);
+    }
+
+    @Test
+    public void refreshUi_recentRequests_launchCameraSettings() {
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+    }
+
+    @Test
+    public void refreshUi_newRecentRequests_listIsUpdated() {
+        List<RecentAppOpsAccess.Access> list1 = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list1);
+
+        List<RecentAppOpsAccess.Access> list2 = new ArrayList<>(list1);
+        list2.add(mock(RecentAppOpsAccess.Access.class));
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list1.size());
+
+        when(mRecentCameraAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list2);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list2.size());
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        verify(mMockSensorPrivacyManager).addSensorPrivacyListener(
+                eq(SensorPrivacyManager.Sensors.CAMERA), mListener.capture());
+    }
+
+    private void setIsSensorPrivacyEnabled(boolean isMuted) {
+        when(mMockSensorPrivacyManager.isSensorPrivacyEnabled(
+                eq(SensorPrivacyManager.Sensors.CAMERA))).thenReturn(isMuted);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/CameraTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/CameraTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..e4676f3aa
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/CameraTogglePreferenceControllerTest.java
@@ -0,0 +1,236 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.hardware.SensorPrivacyManager;
+import android.hardware.SensorPrivacyManager.OnSensorPrivacyChangedListener;
+import android.os.UserHandle;
+import android.os.UserManager;
+import android.platform.test.flag.junit.SetFlagsRule;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.internal.camera.flags.Flags;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class CameraTogglePreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private ColoredSwitchPreference mSwitchPreference;
+    private CameraTogglePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private UserHandle mUserHandle;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+    @Mock
+    private OnSensorPrivacyChangedListener.SensorPrivacyChangedParams mSensorPrivacyChangedParams;
+    @Mock
+    private UserManager mMockUserManager;
+    @Captor
+    private ArgumentCaptor<OnSensorPrivacyChangedListener> mListener;
+
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSetFlagsRule.disableFlags(Flags.FLAG_CAMERA_PRIVACY_ALLOWLIST);
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        mUserHandle = mContext.getUser();
+        setCameraMuteFeatureAvailable(true);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new CameraTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mMockSensorPrivacyManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+    }
+
+    @Test
+    public void cameraMuteUnavailable_preferenceIsHidden() {
+        setCameraMuteFeatureAvailable(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void cameraMuteAvailable_preferenceIsShown() {
+        setCameraMuteFeatureAvailable(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void baseUserRestricted_preferenceIsShown_zoneWrite() {
+        when(mMockSensorPrivacyManager
+                .supportsSensorToggle(eq(SensorPrivacyManager.Sensors.MICROPHONE)))
+                .thenReturn(true);
+        when(mMockUserManager.hasBaseUserRestriction(eq(UserManager.DISALLOW_CAMERA_TOGGLE),
+                eq(mUserHandle))).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void userRestricted_preferenceIsShown_zoneWrite() {
+        when(mMockSensorPrivacyManager
+                .supportsSensorToggle(eq(SensorPrivacyManager.Sensors.MICROPHONE)))
+                .thenReturn(true);
+        when(mMockUserManager.hasBaseUserRestriction(eq(UserManager.DISALLOW_CAMERA_TOGGLE),
+                eq(mUserHandle))).thenReturn(false);
+        when(mMockUserManager.hasUserRestriction(eq(UserManager.DISALLOW_CAMERA_TOGGLE)))
+                .thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onPreferenceClicked_clickCameraEnabled_shouldSetPrivacySensor() {
+        initializePreference(/* isCameraEnabled= */ true);
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+
+        mSwitchPreference.performClick();
+
+        verify(mMockSensorPrivacyManager).setSensorPrivacyForProfileGroup(
+                eq(SensorPrivacyManager.Sources.SETTINGS),
+                eq(SensorPrivacyManager.Sensors.CAMERA),
+                eq(true));
+        setIsSensorPrivacyEnabled(true);
+
+        mListener.getValue().onSensorPrivacyChanged(mSensorPrivacyChangedParams);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onPreferenceClicked_clickCameraDisabled_shouldClearPrivacySensor() {
+        initializePreference(/* isCameraEnabled= */ false);
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+
+        mSwitchPreference.performClick();
+
+        verify(mMockSensorPrivacyManager).setSensorPrivacyForProfileGroup(
+                eq(SensorPrivacyManager.Sources.SETTINGS),
+                eq(SensorPrivacyManager.Sensors.CAMERA),
+                eq(false));
+        setIsSensorPrivacyEnabled(false);
+        mPreferenceController.refreshUi();
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_cameraDisabled_shouldUpdateChecked() {
+        initializePreference(/* isCameraEnabled= */ false);
+
+        setIsSensorPrivacyEnabled(false);
+        mPreferenceController.refreshUi();
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_cameraEnabled_shouldUpdateChecked() {
+        initializePreference(/* isCameraEnabled= */ true);
+
+        setIsSensorPrivacyEnabled(true);
+        mListener.getValue().onSensorPrivacyChanged(mSensorPrivacyChangedParams);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onStop_removesSensorPrivacyListener() {
+        initializePreference(/* isCameraEnabled= */ true);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockSensorPrivacyManager).removeSensorPrivacyListener(
+                SensorPrivacyManager.Sensors.CAMERA, mListener.getValue());
+    }
+
+    private void initializePreference(boolean isCameraEnabled) {
+        setIsSensorPrivacyEnabled(!isCameraEnabled);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        if (isCameraEnabled) {
+            verify(mMockSensorPrivacyManager).addSensorPrivacyListener(
+                    eq(SensorPrivacyManager.Sensors.CAMERA), mListener.capture());
+        }
+    }
+
+    private void setIsSensorPrivacyEnabled(boolean isMuted) {
+        when(mMockSensorPrivacyManager.isSensorPrivacyEnabled(
+                eq(SensorPrivacyManager.Sensors.CAMERA))).thenReturn(isMuted);
+    }
+
+    private void setCameraMuteFeatureAvailable(boolean isAvailable) {
+        when(mMockSensorPrivacyManager
+                .supportsSensorToggle(eq(SensorPrivacyManager.Sensors.CAMERA)))
+                .thenReturn(isAvailable);
+        when(mMockUserManager.hasBaseUserRestriction(eq(UserManager.DISALLOW_CAMERA_TOGGLE),
+                eq(mUserHandle))).thenReturn(!isAvailable);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/DeleteUserPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/DeleteUserPreferenceControllerTest.java
new file mode 100644
index 000000000..6bbec72cd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/DeleteUserPreferenceControllerTest.java
@@ -0,0 +1,127 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.profiles.RemoveProfileHandler;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class DeleteUserPreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private Preference mPreference;
+    private DeleteUserPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private RemoveProfileHandler mRemoveProfileHandler;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new DeleteUserPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mRemoveProfileHandler);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_canRemoveProfile_preferenceEnabled() {
+        when(mRemoveProfileHandler.canRemoveProfile(any())).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_cannotRemoveProfile_preferenceDisabled() {
+        when(mRemoveProfileHandler.canRemoveProfile(any())).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onClick_preferenceDisabled_showsToast() {
+        Toast mockToast = mock(Toast.class);
+        MockitoSession session = ExtendedMockito.mockitoSession()
+                .mockStatic(Toast.class, withSettings().lenient())
+                .startMocking();
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mockToast);
+        when(mRemoveProfileHandler.canRemoveProfile(any())).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(),
+                        eq(mContext.getString(R.string.action_unavailable)),
+                        anyInt()));
+        verify(mockToast).show();
+        session.finishMocking();
+    }
+
+    @Test
+    public void onClick_preferenceEnabled_showsDialog() {
+        when(mRemoveProfileHandler.canRemoveProfile(any())).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        verify(mRemoveProfileHandler).showConfirmRemoveProfileDialog();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/ManageCameraPermissionsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/ManageCameraPermissionsPreferenceControllerTest.java
new file mode 100644
index 000000000..6f38c34c7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/ManageCameraPermissionsPreferenceControllerTest.java
@@ -0,0 +1,242 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.hardware.SensorPrivacyManager;
+import android.os.UserHandle;
+import android.os.UserManager;
+import android.permission.PermissionControllerManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.utils.StringUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class ManageCameraPermissionsPreferenceControllerTest {
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private UserHandle mUserHandle1;
+    @Mock
+    private UserHandle mUserHandle2;
+    @Captor
+    private ArgumentCaptor<SensorPrivacyManager.OnSensorPrivacyChangedListener> mListener;
+
+    private ManageCameraPermissionsPreferenceController mPreferenceController;
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new Preference(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new ManageCameraPermissionsPreferenceController(mContext,
+                "key", mFragmentController, carUxRestrictions,
+                mMockSensorPrivacyManager, mUserManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mContext.getPackageName()).thenReturn("test.package");
+        when(mUserHandle1.getIdentifier()).thenReturn(1);
+        when(mUserHandle1.getIdentifier()).thenReturn(2);
+    }
+
+    @Test
+    public void getSummary_whenCameraIsOff_shouldReturnStringForOff() throws Exception {
+        setIsSensorPrivacyEnabled(true);
+        initializePreference();
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.camera_app_permission_summary_camera_off));
+    }
+
+    @Test
+    public void getSummary_whenCameraIsOn_shouldReturnLoadingString() throws Exception {
+        setIsSensorPrivacyEnabled(false);
+        initializePreference();
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.camera_settings_loading_app_permission_stats));
+    }
+
+    @Test
+    public void getSummary_whenCameraAppCountIsOne_shouldShowSingularString() throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        initializePreference();
+        setAppsForUser(1, 1, user1PermissionControllerManager);
+
+        Map<String, Object> arguments = new HashMap<>();
+        arguments.put("count", 1);
+        arguments.put("total_count", 1);
+
+        assertThat(mPreference.getSummary()).isEqualTo(StringUtil.getIcuPluralsString(mContext,
+                arguments, R.string.camera_app_permission_summary_camera_on));
+    }
+
+    @Test
+    public void getSummary_whenCameraAppCountIsGreaterThanOne_shouldShowPluralString()
+            throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        initializePreference();
+        setAppsForUser(5, 10, user1PermissionControllerManager);
+
+        Map<String, Object> arguments = new HashMap<>();
+        arguments.put("count", 5);
+        arguments.put("total_count", 10);
+
+        assertThat(mPreference.getSummary()).isEqualTo(StringUtil.getIcuPluralsString(mContext,
+                arguments, R.string.camera_app_permission_summary_camera_on));
+    }
+
+    @Test
+    public void getSummary_multipleUsers_addsAppCounts()
+            throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1, mUserHandle2));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        PermissionControllerManager user2PermissionControllerManager = setupUser(mUserHandle2);
+        initializePreference();
+        setAppsForUser(2, 4, user1PermissionControllerManager);
+
+        // verify that loading state persists until all callbacks have returned
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.camera_settings_loading_app_permission_stats));
+
+        setAppsForUser(1, 1, user2PermissionControllerManager);
+
+        Map<String, Object> arguments = new HashMap<>();
+        arguments.put("count", 3);
+        arguments.put("total_count", 5);
+
+        assertThat(mPreference.getSummary()).isEqualTo(StringUtil.getIcuPluralsString(mContext,
+                arguments, R.string.camera_app_permission_summary_camera_on));
+    }
+
+    @Test
+    public void getSummary_initializeTwiceBeforeCallbacksReturn_callbacksOnlyCalledOnce()
+            throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        // verifies that callbacks are only called once due to the loading state
+        setAppsForUser(2, 4, user1PermissionControllerManager);
+    }
+
+    private PermissionControllerManager setupUser(UserHandle userHandle)
+            throws Exception {
+        Context userContext = mock(Context.class);
+        doReturn(userContext).when(mContext).createPackageContextAsUser(anyString(),
+                anyInt(), eq(userHandle));
+        PermissionControllerManager permissionControllerManager = mock(
+                PermissionControllerManager.class);
+        when(userContext.getSystemService(PermissionControllerManager.class)).thenReturn(
+                permissionControllerManager);
+        return permissionControllerManager;
+    }
+
+    private void setAppsForUser(int grantedCount, int totalCount,
+            PermissionControllerManager permissionControllerManagerForUser) {
+        ArgumentCaptor<PermissionControllerManager.OnCountPermissionAppsResultCallback>
+                permissionAllAppsCountCallback = ArgumentCaptor.forClass(
+                PermissionControllerManager.OnCountPermissionAppsResultCallback.class);
+        ArgumentCaptor<PermissionControllerManager.OnCountPermissionAppsResultCallback>
+                permissionAccessCountCallback = ArgumentCaptor.forClass(
+                PermissionControllerManager.OnCountPermissionAppsResultCallback.class);
+        verify(permissionControllerManagerForUser).countPermissionApps(
+                eq(Collections.singletonList(Manifest.permission.CAMERA)), eq(/* flags= */ 0),
+                permissionAllAppsCountCallback.capture(), eq(null));
+        verify(permissionControllerManagerForUser).countPermissionApps(
+                eq(Collections.singletonList(Manifest.permission.CAMERA)),
+                eq(PermissionControllerManager.COUNT_ONLY_WHEN_GRANTED),
+                permissionAccessCountCallback.capture(), eq(null));
+        permissionAllAppsCountCallback.getValue().onCountPermissionApps(totalCount);
+        permissionAccessCountCallback.getValue().onCountPermissionApps(grantedCount);
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        verify(mMockSensorPrivacyManager).addSensorPrivacyListener(
+                eq(SensorPrivacyManager.Sensors.CAMERA), mListener.capture());
+    }
+
+    private void setIsSensorPrivacyEnabled(boolean isMuted) {
+        when(mMockSensorPrivacyManager.isSensorPrivacyEnabled(
+                eq(SensorPrivacyManager.Sensors.CAMERA))).thenReturn(isMuted);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/ManageMicPermissionsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/ManageMicPermissionsPreferenceControllerTest.java
new file mode 100644
index 000000000..003cdf14f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/ManageMicPermissionsPreferenceControllerTest.java
@@ -0,0 +1,242 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.hardware.SensorPrivacyManager;
+import android.os.UserHandle;
+import android.os.UserManager;
+import android.permission.PermissionControllerManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.utils.StringUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class ManageMicPermissionsPreferenceControllerTest {
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private UserHandle mUserHandle1;
+    @Mock
+    private UserHandle mUserHandle2;
+    @Captor
+    private ArgumentCaptor<SensorPrivacyManager.OnSensorPrivacyChangedListener> mListener;
+
+    private ManageMicPermissionsPreferenceController mPreferenceController;
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new Preference(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new ManageMicPermissionsPreferenceController(mContext,
+                "key", mFragmentController, carUxRestrictions,
+                mMockSensorPrivacyManager, mUserManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mContext.getPackageName()).thenReturn("test.package");
+        when(mUserHandle1.getIdentifier()).thenReturn(1);
+        when(mUserHandle1.getIdentifier()).thenReturn(2);
+    }
+
+    @Test
+    public void getSummary_whenMicrophoneIsOff_shouldReturnStringForOff() throws Exception {
+        setIsSensorPrivacyEnabled(true);
+        initializePreference();
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.microphone_app_permission_summary_microphone_off));
+    }
+
+    @Test
+    public void getSummary_whenLocationIsOn_shouldReturnLoadingString() throws Exception {
+        setIsSensorPrivacyEnabled(false);
+        initializePreference();
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.microphone_settings_loading_app_permission_stats));
+    }
+
+    @Test
+    public void getSummary_whenLocationAppCountIsOne_shouldShowSingularString() throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        initializePreference();
+        setAppsForUser(1, 1, user1PermissionControllerManager);
+
+        Map<String, Object> arguments = new HashMap<>();
+        arguments.put("count", 1);
+        arguments.put("total_count", 1);
+
+        assertThat(mPreference.getSummary()).isEqualTo(StringUtil.getIcuPluralsString(mContext,
+                arguments, R.string.microphone_app_permission_summary_microphone_on));
+    }
+
+    @Test
+    public void getSummary_whenLocationAppCountIsGreaterThanOne_shouldShowPluralString()
+            throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        initializePreference();
+        setAppsForUser(5, 10, user1PermissionControllerManager);
+
+        Map<String, Object> arguments = new HashMap<>();
+        arguments.put("count", 5);
+        arguments.put("total_count", 10);
+
+        assertThat(mPreference.getSummary()).isEqualTo(StringUtil.getIcuPluralsString(mContext,
+                arguments, R.string.microphone_app_permission_summary_microphone_on));
+    }
+
+    @Test
+    public void getSummary_multipleUsers_addsAppCounts()
+            throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1, mUserHandle2));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        PermissionControllerManager user2PermissionControllerManager = setupUser(mUserHandle2);
+        initializePreference();
+        setAppsForUser(2, 4, user1PermissionControllerManager);
+
+        // verify that loading state persists until all callbacks have returned
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.microphone_settings_loading_app_permission_stats));
+
+        setAppsForUser(1, 1, user2PermissionControllerManager);
+
+        Map<String, Object> arguments = new HashMap<>();
+        arguments.put("count", 3);
+        arguments.put("total_count", 5);
+
+        assertThat(mPreference.getSummary()).isEqualTo(StringUtil.getIcuPluralsString(mContext,
+                arguments, R.string.microphone_app_permission_summary_microphone_on));
+    }
+
+    @Test
+    public void getSummary_initializeTwiceBeforeCallbacksReturn_callbacksOnlyCalledOnce()
+            throws Exception {
+        setIsSensorPrivacyEnabled(false);
+
+        when(mUserManager.getUserProfiles()).thenReturn(List.of(mUserHandle1));
+        PermissionControllerManager user1PermissionControllerManager = setupUser(mUserHandle1);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        // verifies that callbacks are only called once due to the loading state
+        setAppsForUser(2, 4, user1PermissionControllerManager);
+    }
+
+    private PermissionControllerManager setupUser(UserHandle userHandle)
+            throws Exception {
+        Context userContext = mock(Context.class);
+        doReturn(userContext).when(mContext).createPackageContextAsUser(anyString(),
+                anyInt(), eq(userHandle));
+        PermissionControllerManager permissionControllerManager = mock(
+                PermissionControllerManager.class);
+        when(userContext.getSystemService(PermissionControllerManager.class)).thenReturn(
+                permissionControllerManager);
+        return permissionControllerManager;
+    }
+
+    private void setAppsForUser(int grantedCount, int totalCount,
+            PermissionControllerManager permissionControllerManagerForUser) {
+        ArgumentCaptor<PermissionControllerManager.OnCountPermissionAppsResultCallback>
+                permissionAllAppsCountCallback = ArgumentCaptor.forClass(
+                PermissionControllerManager.OnCountPermissionAppsResultCallback.class);
+        ArgumentCaptor<PermissionControllerManager.OnCountPermissionAppsResultCallback>
+                permissionAccessCountCallback = ArgumentCaptor.forClass(
+                PermissionControllerManager.OnCountPermissionAppsResultCallback.class);
+        verify(permissionControllerManagerForUser).countPermissionApps(
+                eq(Collections.singletonList(Manifest.permission.RECORD_AUDIO)), eq(/* flags= */ 0),
+                permissionAllAppsCountCallback.capture(), eq(null));
+        verify(permissionControllerManagerForUser).countPermissionApps(
+                eq(Collections.singletonList(Manifest.permission.RECORD_AUDIO)),
+                eq(PermissionControllerManager.COUNT_ONLY_WHEN_GRANTED),
+                permissionAccessCountCallback.capture(), eq(null));
+        permissionAllAppsCountCallback.getValue().onCountPermissionApps(totalCount);
+        permissionAccessCountCallback.getValue().onCountPermissionApps(grantedCount);
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        verify(mMockSensorPrivacyManager).addSensorPrivacyListener(
+                eq(SensorPrivacyManager.Sensors.MICROPHONE), mListener.capture());
+    }
+
+    private void setIsSensorPrivacyEnabled(boolean isMuted) {
+        when(mMockSensorPrivacyManager.isSensorPrivacyEnabled(
+                eq(SensorPrivacyManager.Sensors.MICROPHONE))).thenReturn(isMuted);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/MicTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/MicTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..ef635967b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/MicTogglePreferenceControllerTest.java
@@ -0,0 +1,226 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.hardware.SensorPrivacyManager;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class MicTogglePreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private ColoredSwitchPreference mSwitchPreference;
+    private MicTogglePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private UserHandle mUserHandle;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+    @Mock
+    private UserManager mMockUserManager;
+    @Captor
+    private ArgumentCaptor<SensorPrivacyManager.OnSensorPrivacyChangedListener> mListener;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        mUserHandle = mContext.getUser();
+        setMicMuteFeatureAvailable(true);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new MicTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mMockSensorPrivacyManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+    }
+
+    @Test
+    public void micMuteUnavailable_preferenceIsHidden() {
+        setMicMuteFeatureAvailable(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void micMuteAvailable_preferenceIsShown() {
+        setMicMuteFeatureAvailable(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void baseUserRestricted_preferenceIsDisabled() {
+        when(mMockSensorPrivacyManager
+                .supportsSensorToggle(eq(SensorPrivacyManager.Sensors.MICROPHONE)))
+                .thenReturn(true);
+        when(mMockUserManager.hasBaseUserRestriction(eq(UserManager.DISALLOW_MICROPHONE_TOGGLE),
+                eq(mUserHandle))).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void userRestricted_availableForViewing() {
+        when(mMockSensorPrivacyManager
+                .supportsSensorToggle(eq(SensorPrivacyManager.Sensors.MICROPHONE)))
+                .thenReturn(true);
+        when(mMockUserManager.hasBaseUserRestriction(eq(UserManager.DISALLOW_MICROPHONE_TOGGLE),
+                eq(mUserHandle))).thenReturn(false);
+        when(mMockUserManager.hasUserRestriction(eq(UserManager.DISALLOW_MICROPHONE_TOGGLE)))
+                .thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onPreferenceClicked_clickMicEnabled_shouldSetPrivacySensor() {
+        initializePreference(/* isMicEnabled= */ true);
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+
+        mSwitchPreference.performClick();
+
+        verify(mMockSensorPrivacyManager).setSensorPrivacyForProfileGroup(
+                eq(SensorPrivacyManager.Sources.SETTINGS),
+                eq(SensorPrivacyManager.Sensors.MICROPHONE),
+                eq(true));
+        setIsSensorPrivacyEnabled(true);
+
+        mListener.getValue().onSensorPrivacyChanged(SensorPrivacyManager.Sensors.MICROPHONE, true);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onPreferenceClicked_clickMicDisabled_shouldClearPrivacySensor() {
+        initializePreference(/* isMicEnabled= */ false);
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+
+        mSwitchPreference.performClick();
+
+        verify(mMockSensorPrivacyManager).setSensorPrivacyForProfileGroup(
+                eq(SensorPrivacyManager.Sources.SETTINGS),
+                eq(SensorPrivacyManager.Sensors.MICROPHONE),
+                eq(false));
+        setIsSensorPrivacyEnabled(false);
+        mListener.getValue().onSensorPrivacyChanged(SensorPrivacyManager.Sensors.MICROPHONE, false);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_micDisabled_shouldUpdateChecked() {
+        initializePreference(/* isMicEnabled= */ false);
+
+        setIsSensorPrivacyEnabled(false);
+        mListener.getValue().onSensorPrivacyChanged(SensorPrivacyManager.Sensors.MICROPHONE, false);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_micEnabled_shouldUpdateChecked() {
+        initializePreference(/* isMicEnabled= */ true);
+
+        setIsSensorPrivacyEnabled(true);
+        mListener.getValue().onSensorPrivacyChanged(SensorPrivacyManager.Sensors.MICROPHONE, true);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onStop_removesSensorPrivacyListener() {
+        initializePreference(/* isMicEnabled= */ true);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mMockSensorPrivacyManager).removeSensorPrivacyListener(
+                SensorPrivacyManager.Sensors.MICROPHONE, mListener.getValue());
+    }
+
+    private void initializePreference(boolean isMicEnabled) {
+        setIsSensorPrivacyEnabled(!isMicEnabled);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        verify(mMockSensorPrivacyManager).addSensorPrivacyListener(
+                eq(SensorPrivacyManager.Sensors.MICROPHONE), mListener.capture());
+    }
+
+    private void setIsSensorPrivacyEnabled(boolean isMuted) {
+        when(mMockSensorPrivacyManager.isSensorPrivacyEnabled(
+                eq(SensorPrivacyManager.Sensors.MICROPHONE))).thenReturn(isMuted);
+    }
+
+    private void setMicMuteFeatureAvailable(boolean isAvailable) {
+        when(mMockSensorPrivacyManager
+                .supportsSensorToggle(eq(SensorPrivacyManager.Sensors.MICROPHONE)))
+                .thenReturn(isAvailable);
+        when(mMockUserManager.hasBaseUserRestriction(eq(UserManager.DISALLOW_MICROPHONE_TOGGLE),
+                eq(mUserHandle))).thenReturn(!isAvailable);
+        when(mMockUserManager.hasUserRestriction(eq(UserManager.DISALLOW_MICROPHONE_TOGGLE)))
+                .thenReturn(!isAvailable);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneAccessPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneAccessPreferenceControllerTest.java
new file mode 100644
index 000000000..d42ed2058
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneAccessPreferenceControllerTest.java
@@ -0,0 +1,111 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.hardware.SensorPrivacyManager;
+import android.platform.test.flag.junit.SetFlagsRule;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class MicrophoneAccessPreferenceControllerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private Preference mPreference;
+    private MicrophoneAccessPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSetFlagsRule.enableFlags(Flags.FLAG_MICROPHONE_PRIVACY_UPDATES);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(SensorPrivacyManager.class, withSettings().lenient())
+                .startMocking();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        when(SensorPrivacyManager.getInstance(mContext)).thenReturn(mMockSensorPrivacyManager);
+        mPreference = new Preference(mContext);
+        mPreferenceController = new MicrophoneAccessPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_supportsSensorToggle_getDefaultAvailabilityStatus_available() {
+        when(mMockSensorPrivacyManager.supportsSensorToggle(
+                SensorPrivacyManager.Sensors.MICROPHONE)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void onCreate_notSupportsSensorToggle_getDefaultAvailabilityStatus_notAvailable() {
+        when(mMockSensorPrivacyManager.supportsSensorToggle(
+                SensorPrivacyManager.Sensors.MICROPHONE)).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneInfotainmentAppsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneInfotainmentAppsPreferenceControllerTest.java
new file mode 100644
index 000000000..c474ccb49
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneInfotainmentAppsPreferenceControllerTest.java
@@ -0,0 +1,177 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.Manifest;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
+import android.hardware.SensorPrivacyManager;
+import android.os.Process;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class MicrophoneInfotainmentAppsPreferenceControllerTest {
+
+    private static final int USER_ID1 = 1;
+    private static final int USER_ID2 = 2;
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LogicalPreferenceGroup mPreference;
+    private MicrophoneInfotainmentAppsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    private CharSequence mBadgedAppLabel1 = "badgedAppLabel1";
+    private CharSequence mBadgedAppLabel2 = "badgedAppLabel2";
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+    private UserHandle mUserHandle;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(PermissionUtils.class, withSettings().lenient())
+                .startMocking();
+
+        mUserHandle = Process.myUserHandle();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new MicrophoneInfotainmentAppsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mMockPackageManager, mMockSensorPrivacyManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_verifySensorType_isMicrophone() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getSensorPrivacyManager()).isEqualTo(
+                mMockSensorPrivacyManager);
+        assertThat(mPreferenceController.getPrivacySensorType()).isEqualTo(
+                SensorPrivacyManager.Sensors.MICROPHONE);
+    }
+
+    @Test
+    public void onCreate_verifyChildrenPreference() throws PackageManager.NameNotFoundException {
+        initChildren();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(mBadgedAppLabel1);
+        assertThat(mPreference.getPreference(1).getTitle()).isEqualTo(mBadgedAppLabel2);
+    }
+
+    @Test
+    public void onCreate_triggerListener_uiUpdate() throws PackageManager.NameNotFoundException {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(0);
+
+        initChildren();
+        SensorPrivacyManager.OnSensorPrivacyChangedListener.SensorPrivacyChangedParams params =
+                mock(SensorPrivacyManager.OnSensorPrivacyChangedListener
+                        .SensorPrivacyChangedParams.class);
+        mPreferenceController.getListener().onSensorPrivacyChanged(params);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(mBadgedAppLabel1);
+        assertThat(mPreference.getPreference(1).getTitle()).isEqualTo(mBadgedAppLabel2);
+    }
+
+    private void initChildren() throws PackageManager.NameNotFoundException {
+        String packageName1 = "packageName1";
+        CharSequence appLabel1 = "appLabel1";
+        PackageInfo packageInfo1 = createPackageInfo(packageName1, USER_ID1, appLabel1,
+                mBadgedAppLabel1);
+        String packageName2 = "packageName2";
+        CharSequence appLabel2 = "appLabel2";
+        PackageInfo packageInfo2 = createPackageInfo(packageName2, USER_ID2, appLabel2,
+                mBadgedAppLabel2);
+        when(PermissionUtils.getPackagesWithPermissionGroup(
+                mContext, Manifest.permission_group.MICROPHONE, mUserHandle,
+                /* showSystem= */ false)).thenReturn(List.of(packageInfo1, packageInfo2));
+    }
+
+    private PackageInfo createPackageInfo(String packageName, int uid, CharSequence appLabel,
+            CharSequence badgedAppLabel) throws PackageManager.NameNotFoundException {
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+        applicationInfo.packageName = packageName;
+        applicationInfo.uid = uid;
+
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.packageName = packageName;
+        packageInfo.applicationInfo = applicationInfo;
+        int userId = mUserHandle.getIdentifier();
+        when(mMockPackageManager.getApplicationInfoAsUser(
+                packageName, PackageManager.GET_META_DATA, userId)).thenReturn(applicationInfo);
+        when(mMockPackageManager.getApplicationLabel(applicationInfo)).thenReturn(appLabel);
+        when(mMockPackageManager.getUserBadgedLabel(appLabel, mUserHandle)).thenReturn(
+                badgedAppLabel);
+
+        return packageInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneRecentAccessViewAllPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneRecentAccessViewAllPreferenceControllerTest.java
new file mode 100644
index 000000000..99b6f280f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneRecentAccessViewAllPreferenceControllerTest.java
@@ -0,0 +1,183 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.Manifest;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.graphics.drawable.Drawable;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.RecentAppOpsAccess;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.time.Clock;
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class MicrophoneRecentAccessViewAllPreferenceControllerTest {
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private MicrophoneRecentAccessViewAllPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private RecentAppOpsAccess mRecentMicrophoneAccesses;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new MicrophoneRecentAccessViewAllPreferenceController(mContext,
+                "key", mFragmentController, carUxRestrictions,
+                mRecentMicrophoneAccesses);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+    }
+
+    @Test
+    public void updateState_noSystemAppsByDefault() {
+        initializePreference();
+        verify(mRecentMicrophoneAccesses, never()).getAppListSorted(/* showSystem= */ true);
+    }
+
+    @Test
+    public void setShowSystem_showsSystemApps() {
+        initializePreference();
+        mPreferenceController.setShowSystem(true);
+        verify(mRecentMicrophoneAccesses).getAppListSorted(/* showSystem= */ true);
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_showsEmptyState() {
+        initializePreference();
+
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(
+                mContext.getString(R.string.microphone_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_someRecentRequests_displaysAppInformation() {
+        initializePreference();
+
+        String fakeLabel = "Test app 1";
+        RecentAppOpsAccess.Access fakeAccess = new RecentAppOpsAccess.Access("com.test",
+                UserHandle.CURRENT, mock(Drawable.class), fakeLabel,
+                "fake contentDescription", Clock.systemDefaultZone().millis());
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(fakeAccess);
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(fakeLabel);
+        assertThat(mPreference.getPreference(0).getSummary().toString()).contains("min. ago");
+    }
+
+    @Test
+    public void refreshUi_recentRequests_launchMicrophoneSettings() {
+        initializePreference();
+
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+        assertThat(intent.getStringExtra(Intent.EXTRA_PERMISSION_GROUP_NAME))
+            .isEqualTo(Manifest.permission_group.MICROPHONE);
+    }
+
+    @Test
+    public void refreshUi_newRecentRequests_listIsUpdated() {
+        initializePreference();
+
+        List<RecentAppOpsAccess.Access> list1 = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list1);
+
+        List<RecentAppOpsAccess.Access> list2 = new ArrayList<>(list1);
+        list2.add(mock(RecentAppOpsAccess.Access.class));
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list1.size());
+
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list2);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list2.size());
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+    }
+}
+
diff --git a/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneRecentAccessesPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneRecentAccessesPreferenceControllerTest.java
new file mode 100644
index 000000000..bf0fa44c5
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/privacy/MicrophoneRecentAccessesPreferenceControllerTest.java
@@ -0,0 +1,264 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.privacy;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.graphics.drawable.Drawable;
+import android.hardware.SensorPrivacyManager;
+import android.os.UserHandle;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.RecentAppOpsAccess;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+import java.time.Clock;
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class MicrophoneRecentAccessesPreferenceControllerTest {
+    private static final int RECENT_APPS_MAX_COUNT = 2;
+
+    private final Context mContext = Mockito.spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceCategory mPreference;
+    private MicrophoneRecentAccessesPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private RecentAppOpsAccess mRecentMicrophoneAccesses;
+    @Mock
+    private SensorPrivacyManager mMockSensorPrivacyManager;
+    @Captor
+    private ArgumentCaptor<SensorPrivacyManager.OnSensorPrivacyChangedListener> mListener;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        CarUxRestrictions carUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new PreferenceCategory(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new MicrophoneRecentAccessesPreferenceController(mContext,
+                "key", mFragmentController, carUxRestrictions,
+                mRecentMicrophoneAccesses, RECENT_APPS_MAX_COUNT, mMockSensorPrivacyManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        doNothing().when(mContext).startActivity(any());
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void micMuted_preferenceIsHidden() {
+        setIsSensorPrivacyEnabled(true);
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void micNotMuted_preferenceIsShown() {
+        setIsSensorPrivacyEnabled(false);
+        initializePreference();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_micEnabled_shouldShow() {
+        initializePreference();
+
+        setIsSensorPrivacyEnabled(false);
+        mListener.getValue().onSensorPrivacyChanged(SensorPrivacyManager.Sensors.MICROPHONE, false);
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void onListenerUpdate_micDisabled_shouldHide() {
+        initializePreference();
+
+        setIsSensorPrivacyEnabled(true);
+        mListener.getValue().onSensorPrivacyChanged(SensorPrivacyManager.Sensors.MICROPHONE, true);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_messageDisplayed() {
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(
+                mContext.getString(R.string.microphone_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_exceptForSomeRecentSystemAppRequests_showsViewAll() {
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.singletonList(mock(RecentAppOpsAccess.Access.class)));
+        mPreferenceController.refreshUi();
+
+        // includes preference for "View all"
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreference.getPreference(1).getTitle()).isEqualTo(
+                mContext.getString(R.string.microphone_settings_recent_requests_view_all_title));
+    }
+
+    @Test
+    @UiThreadTest
+    public void refreshUi_clickViewAll_launchesFragment() {
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.singletonList(mock(RecentAppOpsAccess.Access.class)));
+        mPreferenceController.refreshUi();
+
+        // click on the "View all" preference
+        mPreference.getPreference(1).performClick();
+        verify(mFragmentController)
+                .launchFragment(any(MicrophoneRecentAccessViewAllFragment.class));
+    }
+
+    @Test
+    public void refreshUi_noRecentRequests_includingNoSystemAppRequests_doesNotShowViewAll() {
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(Collections.emptyList());
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ true))
+                .thenReturn(Collections.emptyList());
+        mPreferenceController.refreshUi();
+
+        // no preference for "View all"
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(
+                mContext.getString(R.string.microphone_no_recent_access));
+    }
+
+    @Test
+    public void refreshUi_someRecentRequests_displaysAppInformation() {
+        String fakeLabel = "Test app 1";
+        RecentAppOpsAccess.Access fakeAccess = new RecentAppOpsAccess.Access("com.test",
+                UserHandle.CURRENT, mock(Drawable.class), fakeLabel,
+                "fake contentDescription", Clock.systemDefaultZone().millis());
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(fakeAccess);
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(fakeLabel);
+        assertThat(mPreference.getPreference(0).getSummary().toString()).contains("min. ago");
+    }
+
+    @Test
+    public void refreshUi_someRecentRequests_preferencesAddedToScreen_capsAtMax() {
+        List<RecentAppOpsAccess.Access> list = Arrays.asList(
+                mock(RecentAppOpsAccess.Access.class),
+                mock(RecentAppOpsAccess.Access.class),
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(RECENT_APPS_MAX_COUNT);
+    }
+
+    @Test
+    public void refreshUi_recentRequests_launchMicrophoneSettings() {
+        List<RecentAppOpsAccess.Access> list = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list);
+        mPreferenceController.refreshUi();
+
+        mPreference.getPreference(0).performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Intent.ACTION_MANAGE_APP_PERMISSION);
+    }
+
+    @Test
+    public void refreshUi_newRecentRequests_listIsUpdated() {
+        List<RecentAppOpsAccess.Access> list1 = Collections.singletonList(
+                mock(RecentAppOpsAccess.Access.class));
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list1);
+
+        List<RecentAppOpsAccess.Access> list2 = new ArrayList<>(list1);
+        list2.add(mock(RecentAppOpsAccess.Access.class));
+
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list1.size());
+
+        when(mRecentMicrophoneAccesses.getAppListSorted(/* showSystem= */ false))
+                .thenReturn(list2);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(list2.size());
+    }
+
+    private void initializePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        verify(mMockSensorPrivacyManager).addSensorPrivacyListener(
+                eq(SensorPrivacyManager.Sensors.MICROPHONE), mListener.capture());
+    }
+
+    private void setIsSensorPrivacyEnabled(boolean isMuted) {
+        when(mMockSensorPrivacyManager.isSensorPrivacyEnabled(
+                eq(SensorPrivacyManager.Sensors.MICROPHONE))).thenReturn(isMuted);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/AddNewProfileTaskTest.java b/tests/multivalent/src/com/android/car/settings/profiles/AddNewProfileTaskTest.java
new file mode 100644
index 000000000..16ae29c97
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/AddNewProfileTaskTest.java
@@ -0,0 +1,202 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.ActivityManager;
+import android.car.ResultCallback;
+import android.car.user.CarUserManager;
+import android.car.user.UserCreationResult;
+import android.car.user.UserStopResponse;
+import android.car.user.UserStopResult;
+import android.car.util.concurrent.AndroidAsyncFuture;
+import android.car.util.concurrent.AndroidFuture;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.AsyncTask;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.annotation.Nullable;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.testutils.PollingCheck;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+@RunWith(AndroidJUnit4.class)
+public class AddNewProfileTaskTest {
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private AddNewProfileTask mTask;
+    private final int mNewUserId = 15;
+
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private CarUserManager mCarUserManager;
+    @Mock
+    private AddNewProfileTask.AddNewProfileListener mAddNewProfileListener;
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+
+    @Before
+    public void setUp() {
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        int foregroundUserId = ActivityManager.getCurrentUser();
+        when(mContext.getUser()).thenReturn(UserHandle.of(foregroundUserId));
+        mTask = new AddNewProfileTask(mContext, mCarUserManager, mAddNewProfileListener);
+    }
+
+    @Test
+    public void createNewUser_success() {
+        String newUserName = "Test name";
+        UserInfo newUser = new UserInfo(mNewUserId, newUserName, /* flags= */ 0);
+
+        mockCreateUser(newUser, UserCreationResult.STATUS_SUCCESSFUL);
+
+        mTask.execute(newUserName);
+        // wait for async task
+        PollingCheck.waitFor(() -> mTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mCarUserManager).createUser(newUserName, /* flags= */ 0);
+    }
+
+    @Test
+    public void userCreated_switchToNewUser() {
+        String newUserName = "Test name";
+        UserInfo newUser = new UserInfo(mNewUserId, newUserName, /* flags= */ 0);
+
+        mockCreateUser(newUser, UserCreationResult.STATUS_SUCCESSFUL);
+
+        mTask.execute(newUserName);
+        // wait for async task
+        PollingCheck.waitFor(() -> mTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mCarUserManager).switchUser(newUser.id);
+    }
+
+    @Test
+    public void userCreated_successCalled() {
+        String newUserName = "Test name";
+        UserInfo newUser = new UserInfo(mNewUserId, newUserName, /* flags= */ 0);
+
+        mockCreateUser(newUser, UserCreationResult.STATUS_SUCCESSFUL);
+
+        mTask.execute(newUserName);
+        // wait for async task
+        PollingCheck.waitFor(() -> mTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mAddNewProfileListener).onProfileAddedSuccess();
+        verify(mCarUserManager).switchUser(mNewUserId);
+    }
+
+    @Test
+    public void userNotCreated_failureCalled() {
+        String newUserName = "Test name";
+
+        mockCreateUser(/* user= */ null, UserCreationResult.STATUS_ANDROID_FAILURE);
+
+        mTask.execute(newUserName);
+        // wait for async task
+        PollingCheck.waitFor(() -> mTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mAddNewProfileListener).onProfileAddedFailure();
+    }
+
+    @Test
+    public void userCreatedOnPassenger_success_stopsAndStartsUser() {
+        String newUserName = "Test name";
+        UserInfo newUser = new UserInfo(mNewUserId, newUserName, /* flags= */ 0);
+
+        mockCreateUser(newUser, UserCreationResult.STATUS_SUCCESSFUL);
+
+        // Pretend to execute off of passenger user
+        int foregroundUserId = ActivityManager.getCurrentUser();
+        when(mContext.getUser()).thenReturn(UserHandle.of(foregroundUserId + 1));
+
+        mTask.execute(newUserName);
+        // wait for async task
+        PollingCheck.waitFor(() -> mTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mAddNewProfileListener).onProfileAddedSuccess();
+
+        ArgumentCaptor<ResultCallback<UserStopResponse>> captor =
+                ArgumentCaptor.forClass(ResultCallback.class);
+        verify(mCarUserManager).stopUser(any(), any(), captor.capture());
+
+        ResultCallback<UserStopResponse> callback = captor.getValue();
+        UserStopResponse result = new UserStopResponse(UserStopResult.STATUS_SUCCESSFUL);
+        callback.onResult(result);
+
+        verify(mCarUserManager).startUser(any(), any(), any());
+    }
+
+    @Test
+    public void userCreatedOnPassenger_failure_doesNotStartUser() {
+        String newUserName = "Test name";
+        UserInfo newUser = new UserInfo(mNewUserId, newUserName, /* flags= */ 0);
+
+        mockCreateUser(newUser, UserCreationResult.STATUS_SUCCESSFUL);
+
+        // Pretend to execute off of passenger user
+        int foregroundUserId = ActivityManager.getCurrentUser();
+        when(mContext.getUser()).thenReturn(UserHandle.of(foregroundUserId + 1));
+
+        mTask.execute(newUserName);
+        // wait for async task
+        PollingCheck.waitFor(() -> mTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mAddNewProfileListener).onProfileAddedSuccess();
+
+        ArgumentCaptor<ResultCallback<UserStopResponse>> captor =
+                ArgumentCaptor.forClass(ResultCallback.class);
+        verify(mCarUserManager).stopUser(any(), any(), captor.capture());
+
+        ResultCallback<UserStopResponse> callback = captor.getValue();
+        UserStopResponse result = new UserStopResponse(UserStopResult.STATUS_ANDROID_FAILURE);
+        callback.onResult(result);
+
+        verify(mCarUserManager, never()).startUser(any(), any(), any());
+    }
+
+    private void mockCreateUser(@Nullable UserInfo user, int status) {
+        AndroidFuture<UserCreationResult> future = new AndroidFuture<>();
+        future.complete(new UserCreationResult(status, user == null ? null : user.getUserHandle()));
+        when(mCarUserManager.createUser(anyString(), anyInt()))
+                .thenReturn(new AndroidAsyncFuture<>(future));
+        if (user != null) {
+            when(mUserManager.getUserInfo(user.id)).thenReturn(user);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/AddProfileHandlerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/AddProfileHandlerTest.java
new file mode 100644
index 000000000..100f4e0a6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/AddProfileHandlerTest.java
@@ -0,0 +1,224 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+import static com.android.car.settings.profiles.AddProfileHandler.CONFIRM_CREATE_NEW_PROFILE_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.user.CarUserManager;
+import android.car.user.UserCreationResult;
+import android.car.util.concurrent.AndroidAsyncFuture;
+import android.car.util.concurrent.AndroidFuture;
+import android.content.Context;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.ExecutionException;
+import java.util.concurrent.TimeUnit;
+import java.util.concurrent.TimeoutException;
+
+@RunWith(AndroidJUnit4.class)
+public class AddProfileHandlerTest {
+    private static final int ADD_PROFILE_TASK_TIMEOUT = 10; // in seconds
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_ADD_USER;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private AddProfileHandler mAddProfileHandler;
+    private LifecycleOwner mLifecycleOwner;
+    private TestAddProfilePreferenceController mPreferenceController;
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private CarUserManager mCarUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new TestAddProfilePreferenceController(mContext,
+                "key", mMockFragmentController, mCarUxRestrictions);
+        mPreference = new Preference(mContext);
+        mAddProfileHandler = new AddProfileHandler(mContext,
+                mMockFragmentController, mPreferenceController);
+        mAddProfileHandler.setCarUserManager(mCarUserManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void userRestricted_canNotAddProfile() {
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_ADD_USER)).thenReturn(true);
+
+        assertThat(mAddProfileHandler.canAddProfiles(mUserManager)).isFalse();
+    }
+
+    @Test
+    public void userNotRestricted_canAddProfile() {
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_ADD_USER)).thenReturn(false);
+
+        assertThat(mAddProfileHandler.canAddProfiles(mUserManager)).isTrue();
+    }
+
+    /* Test that onCreateNewProfileConfirmed invokes a creation of a new non-admin. */
+    @Test
+    public void newProfileConfirmed_invokesCreateNewUser()
+            throws ExecutionException, InterruptedException, TimeoutException {
+        AndroidFuture<UserCreationResult> future = new AndroidFuture<>();
+        UserHandle newUserHandle = UserHandle.of(1001);
+        future.complete(new UserCreationResult(UserCreationResult.STATUS_SUCCESSFUL,
+                newUserHandle));
+        when(mUserManager.getUserInfo(anyInt())).thenReturn(null);
+        when(mCarUserManager.createUser(anyString(), anyInt()))
+                .thenReturn(new AndroidAsyncFuture<>(future));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mAddProfileHandler.mConfirmCreateNewProfileListener.onConfirm(/* arguments= */ null);
+        // wait for async task
+        mAddProfileHandler.mAddNewProfileTask.get(ADD_PROFILE_TASK_TIMEOUT, TimeUnit.SECONDS);
+        verify(mCarUserManager).createUser(
+                ResourceTestUtils.getString(mContext, "user_new_user_name"), /* flags= */ 0);
+    }
+
+    /* Test that if profile can add other profiles, clicking on the button creates a dialog to
+    confirm. */
+    @Test
+    public void testCallOnClick_showAddProfileDialog() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mAddProfileHandler.showAddProfileDialog();
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(CONFIRM_CREATE_NEW_PROFILE_DIALOG_TAG));
+    }
+
+    @Test
+    public void getAddProfilePreferenceAvailabilityStatus_demoUser_available() {
+        when(mUserManager.isDemoUser()).thenReturn(true);
+        assertThat(mAddProfileHandler.getAddProfilePreferenceAvailabilityStatus(mContext))
+                .isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAddProfilePreferenceAvailabilityStatus_notRestricted_available() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, false);
+        assertThat(mAddProfileHandler.getAddProfilePreferenceAvailabilityStatus(mContext))
+                .isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAddProfilePreferenceAvailabilityStatus_notDemoUser_restrictedByUm_disabled() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, true);
+        assertThat(mAddProfileHandler.getAddProfilePreferenceAvailabilityStatus(mContext))
+                .isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAddProfilePreferenceAvailabilityStatus_notDemoUser_restrictedByDpm_viewing() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        assertThat(mAddProfileHandler.getAddProfilePreferenceAvailabilityStatus(mContext))
+                .isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAddProfilePreferenceAvailabilityStatus_notDemoUser_restrictedByBoth_disabled() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, true);
+        assertThat(mAddProfileHandler.getAddProfilePreferenceAvailabilityStatus(mContext))
+                .isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void runClickableWhileDisabled_restrictedByDpm_showAdminDialog() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+
+        mAddProfileHandler.runClickableWhileDisabled();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mMockFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private class TestAddProfilePreferenceController
+            extends PreferenceController<Preference> {
+
+        TestAddProfilePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected Class<Preference> getPreferenceType() {
+            return Preference.class;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/AddProfilePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/AddProfilePreferenceControllerTest.java
new file mode 100644
index 000000000..9e7e33ca0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/AddProfilePreferenceControllerTest.java
@@ -0,0 +1,299 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+import static com.android.car.settings.profiles.AddProfilePreferenceController.MAX_PROFILES_LIMIT_REACHED_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AddProfilePreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_ADD_USER;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private AddProfilePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new AddProfilePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUserManager);
+        mPreferenceController.setUserManager(mUserManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_userInDemoMode_showsExitRetailModeButton() {
+        when(mUserManager.isDemoUser()).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getTitle()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "exit_retail_button_text"));
+    }
+
+    @Test
+    public void onCreate_userCanAddNewProfile_showsAddProfileButton() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_ADD_USER)).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getTitle()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "add_profile_text"));
+    }
+
+    @Test
+    public void onCreate_userCanAddNewProfile_showsAddProfileButton_zoneWrite() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_ADD_USER)).thenReturn(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getTitle()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "add_profile_text"));
+    }
+
+    @Test
+    public void onCreate_userCanAddNewProfile_showsAddProfileButton_zoneRead() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_ADD_USER)).thenReturn(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getTitle()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "add_profile_text"));
+    }
+
+    @Test
+    public void onCreate_userCanAddNewProfile_showsAddProfileButton_zoneHidden() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.hasUserRestriction(UserManager.DISALLOW_ADD_USER)).thenReturn(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_userRestrictedByDpmFromAddingNewProfileAndNotInDemo_availableForViewing() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.canAddMoreUsers()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onCreate_addingNewProfileAndNotInDemo_availableForViewing_zoneWrite() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.canAddMoreUsers()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onCreate_addingNewProfileAndNotInDemo_availableForViewing_zoneRead() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.canAddMoreUsers()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onCreate_addingNewProfileAndNotInDemo_availableForViewing_zoneHidden() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.canAddMoreUsers()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCreate_userRestrictedByUmFromAddingNewProfileAndNotInDemo_buttonDisabled() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_addingNewProfileAndNotInDemo_buttonDisabled_zoneWrite() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_addingNewProfileAndNotInDemo_buttonDisabled_zoneRead() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_addingNewProfileAndNotInDemo_buttonDisabled_zoneHidden() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    /* Test that if the max num of profiles is reached, clicking on the button informs user of
+    that. */
+    @Test
+    public void testCallOnClick_profileLimitReached_showErrorDialog() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mUserManager, TEST_RESTRICTION, false);
+        when(mUserManager.canAddMoreUsers()).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(MAX_PROFILES_LIMIT_REACHED_DIALOG_TAG));
+    }
+
+    @Test
+    @UiThreadTest
+    public void disabledClick_restrictedByDpm_dialog() {
+        when(mUserManager.isDemoUser()).thenReturn(false);
+        when(mUserManager.canAddMoreUsers()).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ChooseNewAdminPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ChooseNewAdminPreferenceControllerTest.java
new file mode 100644
index 000000000..c3ef9041b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ChooseNewAdminPreferenceControllerTest.java
@@ -0,0 +1,168 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.internal.user.UserHelper;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class ChooseNewAdminPreferenceControllerTest {
+    private static final UserInfo TEST_ADMIN_USER = new UserInfo(/* id= */ 10,
+            "TEST_USER_NAME", /* flags= */ 0);
+    private static final UserInfo TEST_OTHER_USER = new UserInfo(/* id= */ 11,
+            "TEST_OTHER_NAME", /* flags= */ 0);
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ChooseNewAdminPreferenceController mController;
+    private ConfirmationDialogFragment mDialog;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mProfileHelper;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mDialog = new ConfirmationDialogFragment.Builder(mContext).build();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(ProfileHelper.class, withSettings().lenient())
+                .mockStatic(UserHelper.class)
+                .startMocking();
+        when(ProfileHelper.getInstance(any(Context.class))).thenReturn(mProfileHelper);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreference);
+        mController = new ChooseNewAdminPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mController.setAdminInfo(TEST_ADMIN_USER);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testOnCreate_hasPreviousDialog_dialogListenerSet() {
+        when(mFragmentController.findDialogByTag(
+                ConfirmationDialogFragment.TAG)).thenReturn(mDialog);
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mDialog.getConfirmListener()).isNotNull();
+    }
+
+    @Test
+    public void testCheckInitialized_noAdminInfoSet_throwsError() {
+        ChooseNewAdminPreferenceController controller = new ChooseNewAdminPreferenceController(
+                mContext, /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(controller, mPreference));
+    }
+
+    @Test
+    public void testUserClicked_opensDialog() {
+        mController.profileClicked(/* userToMakeAdmin= */ TEST_OTHER_USER);
+
+        verify(mFragmentController).showDialog(any(), eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    public void testAssignNewAdminAndRemoveOldAdmin_grantAdminCalled() {
+        mController.assignNewAdminAndRemoveOldAdmin(TEST_OTHER_USER);
+
+        ExtendedMockito.verify(() -> UserHelper.grantAdminPermissions(mContext,
+                TEST_OTHER_USER.getUserHandle()));
+    }
+
+    @Test
+    public void testAssignNewAdminAndRemoveOldAdmin_removeUserCalled() {
+        mController.assignNewAdminAndRemoveOldAdmin(TEST_OTHER_USER);
+
+        verify(mProfileHelper).removeProfile(any(), eq(TEST_ADMIN_USER));
+    }
+
+    @Test
+    public void testAssignNewAdminAndRemoveOldAdmin_success_noErrorDialog() {
+        when(mProfileHelper.removeProfile(any(), eq(TEST_ADMIN_USER)))
+                .thenReturn(ProfileHelper.REMOVE_PROFILE_RESULT_SUCCESS);
+
+        mController.assignNewAdminAndRemoveOldAdmin(TEST_OTHER_USER);
+
+        verify(mFragmentController, never()).showDialog(any(), any());
+    }
+
+    @Test
+    public void testAssignNewAdminAndRemoveOldAdmin_failure_errorDialog() {
+        when(mProfileHelper.removeProfile(any(), eq(TEST_ADMIN_USER)))
+                .thenReturn(ProfileHelper.REMOVE_PROFILE_RESULT_FAILED);
+
+        mController.assignNewAdminAndRemoveOldAdmin(TEST_OTHER_USER);
+
+        verify(mFragmentController).showDialog(any(), any());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/DemoProfileDialogHandlerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/DemoProfileDialogHandlerTest.java
new file mode 100644
index 000000000..831eb9ec0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/DemoProfileDialogHandlerTest.java
@@ -0,0 +1,60 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.android.car.settings.profiles.DemoProfileDialogHandler.CONFIRM_EXIT_RETAIL_MODE_DIALOG_TAG;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+
+import androidx.test.core.app.ApplicationProvider;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+public class DemoProfileDialogHandlerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private DemoProfileDialogHandler mDemoProfileDialogHandler;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mDemoProfileDialogHandler = new DemoProfileDialogHandler(mContext,
+                mMockFragmentController);
+    }
+
+    @Test
+    public void testCallOnClick_demoUser_exitRetailMode() {
+        mDemoProfileDialogHandler.showExitRetailDialog();
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(CONFIRM_EXIT_RETAIL_MODE_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/EditProfileNameFragmentTest.java b/tests/multivalent/src/com/android/car/settings/profiles/EditProfileNameFragmentTest.java
new file mode 100644
index 000000000..fe0afb93c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/EditProfileNameFragmentTest.java
@@ -0,0 +1,124 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.verify;
+
+import android.content.pm.UserInfo;
+import android.os.UserManager;
+import android.widget.EditText;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.MenuItem;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class EditProfileNameFragmentTest {
+
+    private EditProfileNameFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    private UserManager mUserManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+    }
+
+    /**
+     * Tests that user name of the profile in question is displayed in the TextInputEditTest field.
+     */
+    @Test
+    public void testUserNameDisplayedInDetails() throws Throwable {
+        String testUserName = "test_user";
+        UserInfo testUser = new UserInfo(/* id= */ 10, testUserName, /* flags= */ 0);
+        setUpFragment(testUser);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        EditText userNameEditText = mActivity.findViewById(R.id.profile_name_text_edit);
+        assertThat(userNameEditText.getText().toString()).isEqualTo(testUserName);
+    }
+
+    /**
+     * Tests that clicking OK saves the new name for the user.
+     */
+    @Test
+    @UiThreadTest
+    public void testClickingOkSavesNewUserName() throws Throwable {
+        int userId = 10;
+        UserInfo testUser = new UserInfo(userId, "user_name", /* flags= */ 0);
+        setUpFragment(testUser);
+        EditText userNameEditText = mActivity.findViewById(R.id.profile_name_text_edit);
+        MenuItem okButton = mFragment.getToolbarMenuItems().get(0);
+
+        String newUserName = "new_user_name";
+        userNameEditText.requestFocus();
+        userNameEditText.setText(newUserName);
+        assertThat(okButton.isEnabled()).isTrue();
+        okButton.performClick();
+
+        verify(mUserManager).setUserName(userId, newUserName);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testEmptyUsernameCannotBeSaved() throws Throwable {
+        UserInfo testUser = new UserInfo(/* id= */ 10, "user_name", /* flags= */ 0);
+        setUpFragment(testUser);
+        EditText userNameEditText = mActivity.findViewById(R.id.profile_name_text_edit);
+        MenuItem okButton = mFragment.getToolbarMenuItems().get(0);
+
+        userNameEditText.requestFocus();
+        userNameEditText.setText("");
+
+        assertThat(okButton.isEnabled()).isFalse();
+    }
+
+    private void setUpFragment(UserInfo userInfo) throws Throwable {
+        String editProfileFragment = "edit_profile_fragment";
+        mFragment = EditProfileNameFragment.newInstance(userInfo);
+        mFragment.mUserManager = mUserManager;
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, mFragment, editProfileFragment)
+                    .commitNow();
+        });
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/PermissionsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/PermissionsPreferenceControllerTest.java
new file mode 100644
index 000000000..d49831c67
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/PermissionsPreferenceControllerTest.java
@@ -0,0 +1,173 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.preference.SwitchPreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class PermissionsPreferenceControllerTest {
+
+    private static final String TEST_RESTRICTION = UserManager.DISALLOW_ADD_USER;
+    private static final UserInfo TEST_USER = new UserInfo(/* id= */ 10,
+            "TEST_USER_NAME", /* flags= */ 0);
+
+    // Keep in sync with the number of elements in the list in PermissionsPreferenceController
+    private static final int NUM_PERMISSIONS = 4;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private PermissionsPreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreferenceGroup;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(UserManager.class, withSettings().lenient())
+                .startMocking();
+
+        ExtendedMockito.when(UserManager.get(mContext)).thenReturn(mMockUserManager);
+
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+
+        mPreferenceController = new PermissionsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setUserInfo(TEST_USER);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testRefreshUi_populatesGroup() {
+        mPreferenceController.refreshUi();
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(NUM_PERMISSIONS);
+    }
+
+    @Test
+    public void testRefreshUi_callingTwice_noDuplicates() {
+        mPreferenceController.refreshUi();
+        mPreferenceController.refreshUi();
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(NUM_PERMISSIONS);
+    }
+
+    @Test
+    public void testRefreshUi_setToFalse() {
+        SwitchPreference preference = getPreferenceForRestriction(mPreferenceGroup,
+                TEST_RESTRICTION);
+        preference.setChecked(true);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION, TEST_USER.getUserHandle()))
+                .thenReturn(true);
+        mPreferenceController.refreshUi();
+        assertThat(preference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testRefreshUi_setToTrue() {
+        SwitchPreference preference = getPreferenceForRestriction(mPreferenceGroup,
+                TEST_RESTRICTION);
+        preference.setChecked(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION, TEST_USER.getUserHandle()))
+                .thenReturn(false);
+        mPreferenceController.refreshUi();
+        assertThat(preference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testOnPreferenceChange_changeToFalse() {
+        SwitchPreference preference = getPreferenceForRestriction(mPreferenceGroup,
+                TEST_RESTRICTION);
+        preference.callChangeListener(true);
+        verify(mMockUserManager)
+                .setUserRestriction(TEST_RESTRICTION, false, TEST_USER.getUserHandle());
+    }
+
+    @Test
+    public void testOnPreferenceChange_changeToTrue() {
+        SwitchPreference preference = getPreferenceForRestriction(mPreferenceGroup,
+                TEST_RESTRICTION);
+        preference.callChangeListener(false);
+        verify(mMockUserManager)
+                .setUserRestriction(TEST_RESTRICTION, true, TEST_USER.getUserHandle());
+    }
+
+    private SwitchPreference getPreferenceForRestriction(
+            PreferenceGroup preferenceGroup, String restriction) {
+        for (int i = 0; i < preferenceGroup.getPreferenceCount(); i++) {
+            SwitchPreference preference = (SwitchPreference) preferenceGroup.getPreference(i);
+            if (restriction.equals(preference.getExtras().getString(
+                    PermissionsPreferenceController.PERMISSION_TYPE_KEY))) {
+                return preference;
+            }
+        }
+        return null;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsActionButtonsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsActionButtonsPreferenceControllerTest.java
new file mode 100644
index 000000000..1989d5bd5
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsActionButtonsPreferenceControllerTest.java
@@ -0,0 +1,418 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static android.content.pm.UserInfo.FLAG_ADMIN;
+import static android.content.pm.UserInfo.FLAG_INITIALIZED;
+
+import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.profiles.ProfileDetailsActionButtonsPreferenceController.MAKE_ADMIN_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.Bundle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.internal.user.UserHelper;
+import com.android.car.settings.R;
+import com.android.car.settings.common.ActionButtonInfo;
+import com.android.car.settings.common.ActionButtonsPreference;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class ProfileDetailsActionButtonsPreferenceControllerTest {
+    private static final String TEST_PROFILE_NAME = "Test Profile Name";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ActionButtonsPreference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ProfileDetailsActionButtonsPreferenceController mPreferenceController;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private RemoveProfileHandler mRemoveProfileHandler;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new ActionButtonsPreference(mContext);
+        mPreferenceController = new ProfileDetailsActionButtonsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mMockProfileHelper, mMockUserManager, mRemoveProfileHandler);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onStart_userIsViewingSelf_renameButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getRenameButton().isVisible()).isTrue();
+    }
+
+    @Test
+    public void onStart_userIsNotViewingSelf_renameButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getRenameButton().isVisible()).isFalse();
+    }
+
+    @Test
+    public void onStart_isAdminViewingNonAdmin_makeAdminButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getMakeAdminButton().isVisible()).isTrue();
+    }
+
+    @Test
+    public void onStart_isAdminViewingAdmin_makeAdminButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME,
+                FLAG_INITIALIZED | FLAG_ADMIN);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getMakeAdminButton().isVisible()).isFalse();
+    }
+
+    @Test
+    public void onStart_isAdminViewingSelf_manageOtherProfilesButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME,
+                FLAG_INITIALIZED | FLAG_ADMIN);
+        List<UserInfo> otherUsers = new ArrayList<>();
+        otherUsers.add(userInfo);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        when(mMockProfileHelper.getAllLivingProfiles(any())).thenReturn(otherUsers);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mRemoveProfileHandler.canRemoveProfile(userInfo)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getProfilesButton().isVisible()).isTrue();
+        assertThat(getProfilesButton().getText())
+                .isEqualTo(mContext.getString(R.string.manage_other_profiles_button_text));
+    }
+
+    @Test
+    public void onStart_isAdminViewingOther_manageOtherProfilesButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME,
+                FLAG_INITIALIZED | FLAG_ADMIN);
+        List<UserInfo> otherUsers = new ArrayList<>();
+        otherUsers.add(userInfo);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        when(mMockProfileHelper.getAllLivingProfiles(any())).thenReturn(otherUsers);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getProfilesButton().isVisible()).isFalse();
+    }
+
+    @Test
+    public void onStart_isNonAdmin_addAProfileButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME,
+                FLAG_INITIALIZED | FLAG_ADMIN);
+        List<UserInfo> otherUsers = new ArrayList<>();
+        otherUsers.add(userInfo);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockUserManager.isAdminUser()).thenReturn(false);
+        when(mMockProfileHelper.getAllLivingProfiles(any())).thenReturn(otherUsers);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getProfilesButton().isVisible()).isTrue();
+        assertThat(getProfilesButton().getText())
+                .isEqualTo(mContext.getString(R.string.add_a_profile_button_text));
+    }
+
+    @Test
+    public void onStart_isAdmin_isOnlyProfile_makeAddAProfileButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME,
+                FLAG_INITIALIZED | FLAG_ADMIN);
+        List<UserInfo> otherUsers = new ArrayList<>();
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        when(mMockProfileHelper.getAllLivingProfiles(any())).thenReturn(otherUsers);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getProfilesButton().isVisible()).isTrue();
+        assertThat(getProfilesButton().getText())
+                .isEqualTo(mContext.getString(R.string.add_a_profile_button_text));
+    }
+
+    @Test
+    public void onStart_profileIsRemovable_deleteButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mRemoveProfileHandler.canRemoveProfile(userInfo)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getDeleteButton().isVisible()).isTrue();
+    }
+
+    @Test
+    public void onStart_profileIsNotRemovable_deleteButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.hasUserRestriction(UserManager.DISALLOW_REMOVE_USER))
+                .thenReturn(true);
+        when(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* allowRemoveCurrentProcessUser */ false)).thenReturn(DISABLED_FOR_PROFILE);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getDeleteButton().isVisible()).isFalse();
+    }
+
+    @Test
+    public void onStart_userIsViewingSelf_deleteButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* allowRemoveCurrentProcessUser */ false)).thenReturn(DISABLED_FOR_PROFILE);
+        when(mRemoveProfileHandler.canRemoveProfile(userInfo)).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getDeleteButton().isVisible()).isFalse();
+    }
+
+    @Test
+    public void onStart_userIsNotViewingSelf_deleteButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mRemoveProfileHandler.canRemoveProfile(userInfo)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(getDeleteButton().isVisible()).isTrue();
+    }
+
+    @Test
+    public void onCreate_hasPreviousDeleteDialog_dialogListenerSet() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mRemoveProfileHandler).resetListeners();
+    }
+
+    @Test
+    public void onRenameButtonClicked_launchEditProfileNameFragment() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        getRenameButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).launchFragment(any(EditProfileNameFragment.class));
+    }
+
+    @Test
+    public void onMakeAdminButtonClicked_showsConfirmationDialog() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        getMakeAdminButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(MAKE_ADMIN_DIALOG_TAG));
+    }
+
+    @Test
+    public void onDeleteButtonClicked_showsConfirmationDialog() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mRemoveProfileHandler.canRemoveProfile(userInfo)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        getDeleteButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mRemoveProfileHandler).showConfirmRemoveProfileDialog();
+    }
+
+    @Test
+    public void onMakeAdminConfirmed_makeProfileAdmin() {
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                UserHelper.class).startMocking();
+
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        Bundle arguments = new Bundle();
+        arguments.putParcelable(ProfilesDialogProvider.KEY_PROFILE_TO_MAKE_ADMIN, userInfo);
+        mPreferenceController.mMakeAdminConfirmListener.onConfirm(arguments);
+
+        ExtendedMockito.verify(
+                () -> UserHelper.grantAdminPermissions(mContext, userInfo.getUserHandle()));
+    }
+
+    @Test
+    public void onMakeAdminConfirmed_goBack() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        Bundle arguments = new Bundle();
+        arguments.putParcelable(ProfilesDialogProvider.KEY_PROFILE_TO_MAKE_ADMIN, userInfo);
+        mPreferenceController.mMakeAdminConfirmListener.onConfirm(arguments);
+
+        verify(mFragmentController).goBack();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onManageOtherProfilesButtonClicked_launchProfilesListFragment() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        List<UserInfo> otherUsers = new ArrayList<>();
+        otherUsers.add(userInfo);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        when(mMockProfileHelper.getAllLivingProfiles(any())).thenReturn(otherUsers);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        getProfilesButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).launchFragment(any(ProfilesListFragment.class));
+    }
+
+    private ActionButtonInfo getRenameButton() {
+        return mPreference.getButton(ActionButtons.BUTTON1);
+    }
+
+    private ActionButtonInfo getMakeAdminButton() {
+        return mPreference.getButton(ActionButtons.BUTTON2);
+    }
+
+    private ActionButtonInfo getProfilesButton() {
+        return mPreference.getButton(ActionButtons.BUTTON3);
+    }
+
+    private ActionButtonInfo getDeleteButton() {
+        return mPreference.getButton(ActionButtons.BUTTON4);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsBasePreferenceControllerTest.java
new file mode 100644
index 000000000..c482f5a4d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsBasePreferenceControllerTest.java
@@ -0,0 +1,114 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.testng.Assert.assertThrows;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+@RunWith(AndroidJUnit4.class)
+public class ProfileDetailsBasePreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private TestProfileDetailsBasePreferenceController mPreferenceController;
+    private Preference mPreference;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserInfo mUserInfo;
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new TestProfileDetailsBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreference = new Preference(mContext);
+    }
+
+    @Test
+    public void testCheckInitialized_missingUserInfo() {
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mPreference));
+    }
+
+    @Test
+    public void testOnStart_registerListener() {
+        mPreferenceController.setUserInfo(mUserInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mContext).registerReceiver(eq(mPreferenceController.mProfileUpdateReceiver), any());
+    }
+
+    @Test
+    public void testOnStop_unregisterListener() {
+        mPreferenceController.setUserInfo(mUserInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mContext).unregisterReceiver(mPreferenceController.mProfileUpdateReceiver);
+    }
+
+    private static class TestProfileDetailsBasePreferenceController extends
+            ProfileDetailsBasePreferenceController<Preference> {
+
+        TestProfileDetailsBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected Class<Preference> getPreferenceType() {
+            return Preference.class;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsDeletePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsDeletePreferenceControllerTest.java
new file mode 100644
index 000000000..4008d183c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsDeletePreferenceControllerTest.java
@@ -0,0 +1,197 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static android.content.pm.UserInfo.FLAG_INITIALIZED;
+
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ProfileDetailsDeletePreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_REMOVE_USER;
+    private static final String TEST_PROFILE_NAME = "Test Profile Name";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ProfileDetailsDeletePreferenceController mPreferenceController;
+    private RemoveProfileHandler mRemoveProfileHandler;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+        mRemoveProfileHandler = new RemoveProfileHandler(
+                mContext, mMockProfileHelper, mMockUserManager, mMockFragmentController);
+        mPreferenceController = new ProfileDetailsDeletePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions,
+                mMockProfileHelper, mRemoveProfileHandler);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+    }
+
+    @Test
+    public void onCreate_userNotRestricted_deleteButtonShown() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void onCreate_userRestrictedByUm_deleteButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_userRestrictedByDpm_deleteButtonVisible() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onCreate_userIsViewingSelf_deleteButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 0, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mRemoveProfileHandler.canRemoveProfile(userInfo)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_userIsNotViewingSelf_deleteButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 0, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mRemoveProfileHandler.canRemoveProfile(userInfo)).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_isDemoUser_deleteButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockUserManager.isDemoUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_isDemoUserAndRestrictedByDpm_deleteButtonHidden() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        when(mMockUserManager.isDemoUser()).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void disabledClick_restrictedByDpm_dialog() {
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mMockFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsEndSessionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsEndSessionPreferenceControllerTest.java
new file mode 100644
index 000000000..53ed96c2a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsEndSessionPreferenceControllerTest.java
@@ -0,0 +1,272 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.app.admin.DevicePolicyManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.UserHandle;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public final class ProfileDetailsEndSessionPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private CarUiPreference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ProfileDetailsEndSessionPreferenceController mPreferenceController;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private DevicePolicyManager mDpm;
+    @Mock
+    private UserHandle mUserHandle;
+    @Mock
+    private ProfileHelper mProfileHelper;
+    @Mock
+    private UserInfo mUserInfo;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(ProfileHelper.class, withSettings().lenient())
+                .startMocking();
+
+        ExtendedMockito.when(ProfileHelper.getInstance(mContext)).thenReturn(mProfileHelper);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiPreference(mContext);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_nullDpm_unsupportedOnDevice() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(null);
+        initPreferenceController();
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nullDpm_unsupportedOnDevice_zoneWrite() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(null);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nullDpm_unsupportedOnDevice_zoneRead() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(null);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nullDpm_unsupportedOnDevice_zoneHidden() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(null);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutDisabled_unsupportedOnDevice() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(false);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutDisabled_unsupportedOnDevice_zoneWrite() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(false);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutDisabled_unsupportedOnDevice_zoneRead() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(false);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutDisabled_unsupportedOnDevice_zoneHidden() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(false);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noLogoutUser_unsupportedOnDevice() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(null);
+        initPreferenceController();
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noLogoutUser_unsupportedOnDevice_zoneWrite() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(null);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noLogoutUser_unsupportedOnDevice_zoneRead() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(null);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noLogoutUser_unsupportedOnDevice_zoneHidden() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(null);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutEnabled_hasLogoutUser_available() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutEnabled_hasLogoutUser_available_zoneWrite() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutEnabled_hasLogoutUser_available_zoneRead() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_logoutEnabled_hasLogoutUser_available_zoneHidden() {
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+        when(mDpm.isLogoutEnabled()).thenReturn(true);
+        when(mDpm.getLogoutUser()).thenReturn(mUserHandle);
+        initPreferenceController();
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onClick_logoutProfile() {
+        initPreferenceController();
+        mPreferenceController.handlePreferenceClicked(mPreference);
+        verify(mProfileHelper).logoutProfile();
+    }
+
+    private void initPreferenceController() {
+        mPreferenceController = new ProfileDetailsEndSessionPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        mPreferenceController.setUserInfo(mUserInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsHeaderPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsHeaderPreferenceControllerTest.java
new file mode 100644
index 000000000..f227ec5f9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfileDetailsHeaderPreferenceControllerTest.java
@@ -0,0 +1,127 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static android.content.pm.UserInfo.FLAG_ADMIN;
+import static android.content.pm.UserInfo.FLAG_INITIALIZED;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ProfileDetailsHeaderPreferenceControllerTest {
+    private static final String TEST_PROFILE_NAME = "Test Profile Name";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ProfileDetailsHeaderPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new ProfileDetailsHeaderPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setProfileHelper(mMockProfileHelper);
+    }
+
+    @Test
+    public void onCreate_elementHasTitle() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, /* flags= */ 0);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getTitle()).isNotNull();
+    }
+
+    @Test
+    public void onCreate_profileNotSetup_setsSummary() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, /* flags= */ 0);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "user_summary_not_set_up"));
+    }
+
+    @Test
+    public void onCreate_profileSetup_noSummary() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isNull();
+    }
+
+    @Test
+    public void onCreate_isAdmin_notCurrentProfile() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME,
+                FLAG_INITIALIZED | FLAG_ADMIN);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(false);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "user_admin"));
+    }
+
+    @Test
+    public void onCreate_isAdmin_currentProfile() {
+        UserInfo userInfo = new UserInfo(/* id= */ 10, TEST_PROFILE_NAME,
+                FLAG_INITIALIZED | FLAG_ADMIN);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(true);
+        mPreferenceController.setUserInfo(userInfo);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "signed_in_admin_user"));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfilesBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfilesBasePreferenceControllerTest.java
new file mode 100644
index 000000000..c9e485d25
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfilesBasePreferenceControllerTest.java
@@ -0,0 +1,249 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static android.content.pm.UserInfo.FLAG_ADMIN;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.UserInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class ProfilesBasePreferenceControllerTest {
+
+    private static final UserInfo TEST_CURRENT_USER = new UserInfo(/* id= */ 10,
+            "TEST_USER_NAME", /* flags= */ 0);
+    private static final UserInfo TEST_OTHER_USER = new UserInfo(/* id= */ 11,
+            "TEST_OTHER_NAME", /* flags= */ 0);
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private TestProfilesBasePreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreferenceGroup;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mProfileHelper;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .spyStatic(ProfileHelper.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new TestProfilesBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        ExtendedMockito.doReturn(mProfileHelper)
+                .when(() -> ProfileHelper.getInstance(eq(mContext)));
+        when(mProfileHelper.getCurrentProcessUserInfo()).thenReturn(TEST_CURRENT_USER);
+        when(mProfileHelper.isCurrentProcessUser(TEST_CURRENT_USER)).thenReturn(true);
+        when(mProfileHelper.getAllSwitchableProfiles()).thenReturn(
+                Collections.singletonList(TEST_OTHER_USER));
+        when(mProfileHelper.getAllLivingProfiles(any())).thenReturn(
+                Collections.singletonList(TEST_OTHER_USER));
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_registersOnUsersUpdateListener() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mContext).registerReceiver(eq(mPreferenceController.mProfileUpdateReceiver), any());
+    }
+
+    @Test
+    public void onCreate_populatesUsers() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void onCreate_populatesOtherUsers() {
+        mPreferenceController.getPreferenceProvider().setIncludeCurrentProfile(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void onCreate_populatesGuestUsers() {
+        mPreferenceController.getPreferenceProvider().setIncludeCurrentProfile(true);
+        mPreferenceController.getPreferenceProvider().setIncludeGuest(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(3);
+    }
+
+    @Test
+    public void onDestroy_unregistersOnUsersUpdateListener() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onDestroy(mLifecycleOwner);
+
+        verify(mContext).unregisterReceiver(eq(mPreferenceController.mProfileUpdateReceiver));
+    }
+
+    @Test
+    public void refreshUi_userChange_updatesGroup() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        // Store the list of previous Preferences.
+        List<Preference> currentPreferences = new ArrayList<>();
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            currentPreferences.add(mPreferenceGroup.getPreference(i));
+        }
+
+        // Mock a change so that other user becomes an admin.
+        UserInfo adminOtherUser = new UserInfo(/* id= */ 11, "TEST_OTHER_NAME", FLAG_ADMIN);
+        when(mProfileHelper.getAllSwitchableProfiles()).thenReturn(
+                Collections.singletonList(adminOtherUser));
+        when(mProfileHelper.getAllLivingProfiles(any())).thenReturn(
+                Arrays.asList(TEST_OTHER_USER, adminOtherUser));
+
+        mPreferenceController.refreshUi();
+
+        List<Preference> newPreferences = new ArrayList<>();
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            newPreferences.add(mPreferenceGroup.getPreference(i));
+        }
+
+        assertThat(newPreferences).containsNoneIn(currentPreferences);
+    }
+
+    @Test
+    public void refreshUi_noChange_doesNotUpdateGroup() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        // Store the list of previous Preferences.
+        List<Preference> currentPreferences = new ArrayList<>();
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            currentPreferences.add(mPreferenceGroup.getPreference(i));
+        }
+
+        mPreferenceController.refreshUi();
+
+        List<Preference> newPreferences = new ArrayList<>();
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            newPreferences.add(mPreferenceGroup.getPreference(i));
+        }
+
+        assertThat(newPreferences).containsExactlyElementsIn(currentPreferences);
+    }
+
+    @Test
+    public void onUsersUpdated_updatesGroup() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        // Store the list of previous Preferences.
+        List<Preference> currentPreferences = new ArrayList<>();
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            currentPreferences.add(mPreferenceGroup.getPreference(i));
+        }
+
+        // Mock a change so that other user becomes an admin.
+        UserInfo adminOtherUser = new UserInfo(/* id= */ 11, "TEST_OTHER_NAME", FLAG_ADMIN);
+        when(mProfileHelper.getAllSwitchableProfiles()).thenReturn(
+                Collections.singletonList(adminOtherUser));
+        when(mProfileHelper.getAllLivingProfiles(any())).thenReturn(
+                Arrays.asList(TEST_OTHER_USER, adminOtherUser));
+
+        mPreferenceController.mProfileUpdateReceiver.onReceive(mContext, new Intent());
+
+        List<Preference> newPreferences = new ArrayList<>();
+        for (int i = 0; i < mPreferenceGroup.getPreferenceCount(); i++) {
+            newPreferences.add(mPreferenceGroup.getPreference(i));
+        }
+
+        assertThat(newPreferences).containsNoneIn(currentPreferences);
+    }
+
+    private static class TestProfilesBasePreferenceController extends
+            ProfilesBasePreferenceController {
+
+        TestProfilesBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected void profileClicked(UserInfo userInfo) {
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfilesEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfilesEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..b39ffcfe2
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfilesEntryPreferenceControllerTest.java
@@ -0,0 +1,93 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static com.android.car.settings.common.TopLevelMenuFragment.FRAGMENT_MENU_PREFERENCE_KEY;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.fragment.app.Fragment;
+import androidx.preference.Preference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ProfilesEntryPreferenceControllerTest {
+    private static final String PREFERENCE_KEY = "key";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private Preference mPreference;
+    private ProfilesEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new ProfilesEntryPreferenceController(mContext,
+                PREFERENCE_KEY, mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    @UiThreadTest
+    public void handlePreferenceClicked_returnsTrue() {
+        assertThat(mPreferenceController.handlePreferenceClicked(mPreference)).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void handlePreferenceClicked_launchesProfileDetailsFragment() {
+        mPreferenceController.handlePreferenceClicked(mPreference);
+        verify(mFragmentController).launchFragment(any(ProfileDetailsFragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void handlePreferenceClicked_fragmentHasKeyArgument() {
+        mPreferenceController.handlePreferenceClicked(mPreference);
+        ArgumentCaptor<Fragment> fragmentArgumentCaptor = ArgumentCaptor.forClass(Fragment.class);
+        verify(mFragmentController).launchFragment(fragmentArgumentCaptor.capture());
+
+        Fragment fragment = fragmentArgumentCaptor.getValue();
+        assertThat(fragment.getArguments().getString(FRAGMENT_MENU_PREFERENCE_KEY)).isEqualTo(
+                PREFERENCE_KEY);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/ProfilesListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/ProfilesListPreferenceControllerTest.java
new file mode 100644
index 000000000..9bea50a58
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/ProfilesListPreferenceControllerTest.java
@@ -0,0 +1,138 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static android.content.pm.UserInfo.FLAG_ADMIN;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class ProfilesListPreferenceControllerTest {
+
+    private static final UserInfo TEST_CURRENT_USER = new UserInfo(/* id= */ 10,
+            "TEST_USER_NAME", FLAG_ADMIN);
+    private static final UserInfo TEST_OTHER_USER = new UserInfo(/* id= */ 11,
+            "TEST_OTHER_NAME", /* flags= */ 0);
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ProfilesListPreferenceController mPreferenceController;
+    private LogicalPreferenceGroup mPreferenceGroup;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mProfileHelper;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(ProfileHelper.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new ProfilesListPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        mPreferenceController.getPreferenceProvider().setIncludeCurrentProfile(true);
+        mPreferenceController.getPreferenceProvider().setIncludeGuest(true);
+        ExtendedMockito.when(ProfileHelper.getInstance(mContext)).thenReturn(mProfileHelper);
+        when(mProfileHelper.getCurrentProcessUserInfo()).thenReturn(TEST_CURRENT_USER);
+        when(mProfileHelper.isCurrentProcessUser(TEST_CURRENT_USER)).thenReturn(true);
+        when(mProfileHelper.getAllSwitchableProfiles()).thenReturn(
+                Collections.singletonList(TEST_OTHER_USER));
+        when(mProfileHelper.getAllLivingProfiles(any())).thenReturn(
+                Collections.singletonList(TEST_OTHER_USER));
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void testPreferencePerformClick_currentAdminUser_openNewFragment() {
+        mPreferenceGroup.getPreference(0).performClick();
+
+        verify(mFragmentController).launchFragment(any(ProfileDetailsFragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void testPreferencePerformClick_otherNonAdminUser_openNewFragment() {
+        mPreferenceGroup.getPreference(1).performClick();
+
+        verify(mFragmentController).launchFragment(any(ProfileDetailsPermissionsFragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void testPreferencePerformClick_guestUser_noAction() {
+        mPreferenceGroup.getPreference(2).performClick();
+
+        verify(mFragmentController, never()).launchFragment(any());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/profiles/RemoveProfileHandlerTest.java b/tests/multivalent/src/com/android/car/settings/profiles/RemoveProfileHandlerTest.java
new file mode 100644
index 000000000..261659957
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/profiles/RemoveProfileHandlerTest.java
@@ -0,0 +1,243 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.profiles;
+
+import static android.content.pm.UserInfo.FLAG_INITIALIZED;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.profiles.ProfilesDialogProvider.ANY_PROFILE;
+import static com.android.car.settings.profiles.ProfilesDialogProvider.KEY_PROFILE_TYPE;
+import static com.android.car.settings.profiles.ProfilesDialogProvider.LAST_ADMIN;
+import static com.android.car.settings.profiles.RemoveProfileHandler.REMOVE_PROFILE_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.ActivityManager;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.Bundle;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+@RunWith(AndroidJUnit4.class)
+public class RemoveProfileHandlerTest {
+    private static final String TEST_PROFILE_NAME = "Test Profile Name";
+    private static final String TEST_RESTRICTION = UserManager.DISALLOW_REMOVE_USER;
+    private static final int FOREGROUND_USER_ID = 1000;
+    private static final int SECONDARY_USER_ID = 1001;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private MockitoSession mSession;
+    private RemoveProfileHandler mRemoveProfileHandler;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSession = ExtendedMockito.mockitoSession()
+                .spyStatic(ActivityManager.class)
+                .spyStatic(UserHandle.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        ExtendedMockito.doReturn(FOREGROUND_USER_ID).when(ActivityManager::getCurrentUser);
+        ExtendedMockito.doReturn(FOREGROUND_USER_ID).when(UserHandle::myUserId);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        mRemoveProfileHandler = new RemoveProfileHandler(
+                mContext, mMockProfileHelper, mMockUserManager, mMockFragmentController);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void userNotRestricted_canRemoveProfile() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ false);
+
+        assertThat(mRemoveProfileHandler.canRemoveProfile(userInfo)).isTrue();
+    }
+
+    @Test
+    public void userRestricted_cannotRemoveProfile() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(true);
+
+        assertThat(mRemoveProfileHandler.canRemoveProfile(userInfo)).isFalse();
+    }
+
+    @Test
+    public void viewingForegroundUser_cannotRemoveProfile() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ false);
+        ExtendedMockito.doReturn(SECONDARY_USER_ID).when(UserHandle::myUserId);
+
+        assertThat(mRemoveProfileHandler.canRemoveProfile(userInfo)).isFalse();
+    }
+
+    @Test
+    public void viewingSystemUser_cannotRemoveProfile() {
+        UserInfo userInfo = mockCurrentUserInfo(0, /* isCurrentProcess */ false);
+
+        assertThat(mRemoveProfileHandler.canRemoveProfile(userInfo)).isFalse();
+    }
+
+    @Test
+    public void isDemoUser_cannotRemoveProfile() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ true);
+        when(mMockUserManager.isDemoUser()).thenReturn(true);
+
+        assertThat(mRemoveProfileHandler.canRemoveProfile(userInfo)).isFalse();
+    }
+
+    @Test
+    public void hasPreviousDeleteDialog_dialogListenerSet() {
+        UserInfo userInfo = new UserInfo(FOREGROUND_USER_ID, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        mRemoveProfileHandler.setUserInfo(userInfo);
+        ConfirmationDialogFragment dialog = new ConfirmationDialogFragment.Builder(
+                mContext).build();
+        when(mMockFragmentController.findDialogByTag(REMOVE_PROFILE_DIALOG_TAG)).thenReturn(dialog);
+
+        mRemoveProfileHandler.resetListeners();
+
+        assertThat(dialog.getConfirmListener()).isNotNull();
+    }
+
+    @Test
+    public void showConfirmRemoveProfileDialog_showsConfirmationDialog() {
+        mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ false);
+
+        mRemoveProfileHandler.showConfirmRemoveProfileDialog();
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(REMOVE_PROFILE_DIALOG_TAG));
+    }
+
+    @Test
+    public void onDeleteConfirmed_removeProfile() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ false);
+        Bundle arguments = new Bundle();
+        arguments.putString(KEY_PROFILE_TYPE, ANY_PROFILE);
+        mRemoveProfileHandler.mRemoveConfirmListener.onConfirm(arguments);
+
+        verify(mMockProfileHelper).removeProfile(mContext, userInfo);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onDeleteConfirmed_lastAdmin_launchChooseNewAdminFragment() {
+        mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ false);
+
+        Bundle arguments = new Bundle();
+        arguments.putString(KEY_PROFILE_TYPE, LAST_ADMIN);
+        mRemoveProfileHandler.mRemoveConfirmListener.onConfirm(arguments);
+
+        verify(mMockFragmentController).launchFragment(any(ChooseNewAdminFragment.class));
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_availableForProcess_available() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ true);
+
+        assertThat(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* availableForCurrentProcessUser */ true)).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notCurrentUser_notAvailableForProcess_available() {
+        UserInfo userInfo = mockCurrentUserInfo(SECONDARY_USER_ID, /* isCurrentProcess */ false);
+
+        assertThat(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* availableForCurrentProcessUser */ false)).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_currentUser_notAvailableForCurrentUser_disable() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ true);
+
+        assertThat(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* availableForCurrentProcessUser */ false)).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notCurrentUser_availableForCurrentUser_disable() {
+        UserInfo userInfo = mockCurrentUserInfo(SECONDARY_USER_ID, /* isCurrentProcess */ false);
+
+        assertThat(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* availableForCurrentProcessUser */ true)).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_disable() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        assertThat(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* availableForCurrentProcessUser */ true)).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_allowCurrentProcess_onlyRestrictedByDpm_viewing() {
+        UserInfo userInfo = mockCurrentUserInfo(FOREGROUND_USER_ID, /* isCurrentProcess */ true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        assertThat(mRemoveProfileHandler.getAvailabilityStatus(mContext, userInfo,
+                /* availableForCurrentProcessUser */ true)).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    private UserInfo mockCurrentUserInfo(int userId, boolean isCurrentProcess) {
+        UserInfo userInfo = new UserInfo(userId, TEST_PROFILE_NAME, FLAG_INITIALIZED);
+        mRemoveProfileHandler.setUserInfo(userInfo);
+        when(mMockProfileHelper.isCurrentProcessUser(userInfo)).thenReturn(isCurrentProcess);
+        return userInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/AdaptiveBrightnessSwitchTest.java b/tests/multivalent/src/com/android/car/settings/qc/AdaptiveBrightnessSwitchTest.java
new file mode 100644
index 000000000..fbfb4a3ff
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/AdaptiveBrightnessSwitchTest.java
@@ -0,0 +1,201 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+import android.provider.Settings;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AdaptiveBrightnessSwitchTest extends BaseSettingsQCItemTestCase {
+    private AdaptiveBrightnessSwitch mSwitch;
+    private boolean mIsAdaptiveBrightnessSupported;
+    private boolean mInitialAdaptiveBrightnessState;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSwitch = new TestAdaptiveBrightnessSwitch(mContext);
+        mIsAdaptiveBrightnessSupported = true;
+        mInitialAdaptiveBrightnessState = isAdaptiveBrightnessEnabled();
+    }
+
+    @After
+    public void tearDown() {
+        setAdaptiveBrightnessEnabled(mInitialAdaptiveBrightnessState);
+    }
+
+    @Test
+    public void getQCItem_unsupported_returnsNull() {
+        mIsAdaptiveBrightnessSupported = false;
+        QCItem item = mSwitch.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    @Test
+    public void getQCItem_supported_returnsRow() {
+        QCItem item = mSwitch.getQCItem();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneWrite() {
+        mSwitch.setAvailabilityStatusForZone("write");
+        QCRow row = getQCRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneRead() {
+        mSwitch.setAvailabilityStatusForZone("read");
+        QCRow row = getQCRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneHidden() {
+        mSwitch.setAvailabilityStatusForZone("hidden");
+        QCItem item = mSwitch.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    @Test
+    public void getQCItem_titleSet() {
+        QCRow row = getQCRow();
+        assertThat(row.getTitle()).isEqualTo(mContext.getString(R.string.auto_brightness_title));
+    }
+
+    @Test
+    public void getQCItem_hasActionSwitch() {
+        QCRow row = getQCRow();
+        assertThat(row.getEndItems().size()).isEqualTo(1);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.getType()).isEqualTo(QCItem.QC_TYPE_ACTION_SWITCH);
+    }
+
+    @Test
+    public void getQCItem_adaptiveBrightnessOn_switchChecked() {
+        setAdaptiveBrightnessEnabled(true);
+        QCRow row = getQCRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_adaptiveBrightnessOff_switchUnchecked() {
+        setAdaptiveBrightnessEnabled(false);
+        QCRow row = getQCRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_switchDisabled() {
+        setAdaptiveBrightnessEnabled(false);
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_BRIGHTNESS, /* restricted= */ true);
+        QCRow row = getQCRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_switchClickableWhileDisabled() {
+        setAdaptiveBrightnessEnabled(false);
+        setUserRestriction(UserManager.DISALLOW_CONFIG_BRIGHTNESS, /* restricted= */ true);
+        QCRow row = getQCRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_enable_enablesAdaptiveBrightness() {
+        setAdaptiveBrightnessEnabled(false);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mSwitch.onNotifyChange(intent);
+        assertThat(isAdaptiveBrightnessEnabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_disable_disablesAdaptiveBrightness() {
+        setAdaptiveBrightnessEnabled(true);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, false);
+        mSwitch.onNotifyChange(intent);
+        assertThat(isAdaptiveBrightnessEnabled()).isFalse();
+    }
+
+    private QCRow getQCRow() {
+        QCItem item = mSwitch.getQCItem();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+
+    private boolean isAdaptiveBrightnessEnabled() {
+        int brightnessMode = Settings.System.getInt(mContext.getContentResolver(),
+                Settings.System.SCREEN_BRIGHTNESS_MODE,
+                Settings.System.SCREEN_BRIGHTNESS_MODE_MANUAL);
+        return brightnessMode != Settings.System.SCREEN_BRIGHTNESS_MODE_MANUAL;
+    }
+
+    private void setAdaptiveBrightnessEnabled(boolean enabled) {
+        Settings.System.putInt(mContext.getContentResolver(),
+                Settings.System.SCREEN_BRIGHTNESS_MODE,
+                enabled ? Settings.System.SCREEN_BRIGHTNESS_MODE_AUTOMATIC
+                        : Settings.System.SCREEN_BRIGHTNESS_MODE_MANUAL);
+    }
+
+    private class TestAdaptiveBrightnessSwitch extends AdaptiveBrightnessSwitch {
+
+        TestAdaptiveBrightnessSwitch(Context context) {
+            super(context);
+        }
+
+        @Override
+        boolean supportsAdaptiveBrightness() {
+            return mIsAdaptiveBrightnessSupported;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/BaseSettingsQCItemTestCase.java b/tests/multivalent/src/com/android/car/settings/qc/BaseSettingsQCItemTestCase.java
new file mode 100644
index 000000000..887e67643
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/BaseSettingsQCItemTestCase.java
@@ -0,0 +1,62 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.test.core.app.ApplicationProvider;
+
+import org.junit.Before;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+public abstract class BaseSettingsQCItemTestCase {
+    protected final Context mContext = spy(ApplicationProvider.getApplicationContext());
+
+    @Mock
+    protected UserManager mUm;
+    @Mock
+    protected DevicePolicyManager mDpm;
+
+    @Before
+    public final void baseSetUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUm);
+        when(mContext.getSystemService(DevicePolicyManager.class)).thenReturn(mDpm);
+
+        when(mUm.hasBaseUserRestriction(any(), any())).thenReturn(false);
+        when(mUm.hasUserRestriction(any())).thenReturn(false);
+        when(mDpm.isDeviceManaged()).thenReturn(false);
+    }
+
+    protected void setBaseUserRestriction(String restriction, boolean restricted) {
+        when(mUm.hasBaseUserRestriction(eq(restriction), any())).thenReturn(restricted);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUm);
+    }
+
+    protected void setUserRestriction(String restriction, boolean restricted) {
+        when(mUm.hasUserRestriction(restriction)).thenReturn(restricted);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUm);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/BluetoothSwitchTest.java b/tests/multivalent/src/com/android/car/settings/qc/BluetoothSwitchTest.java
new file mode 100644
index 000000000..2ae149f4c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/BluetoothSwitchTest.java
@@ -0,0 +1,179 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.bluetooth.BluetoothAdapter;
+import android.content.Intent;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothSwitchTest extends BaseSettingsQCItemTestCase {
+    private BluetoothSwitch mBluetoothSwitch;
+    private MockitoSession mSession;
+
+    @Mock
+    private BluetoothAdapter mBluetoothAdapter;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                BluetoothAdapter.class, withSettings().lenient()).startMocking();
+        when(BluetoothAdapter.getDefaultAdapter()).thenReturn(mBluetoothAdapter);
+        when(mBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        mBluetoothSwitch = new BluetoothSwitch(mContext);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getQCItem_createsRow() {
+        QCItem item = mBluetoothSwitch.getQCItem();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneWrite() {
+        mBluetoothSwitch.setAvailabilityStatusForZone("write");
+        QCItem item = mBluetoothSwitch.getQCItem();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneRead() {
+        mBluetoothSwitch.setAvailabilityStatusForZone("read");
+        QCItem item = mBluetoothSwitch.getQCItem();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneHidden() {
+        mBluetoothSwitch.setAvailabilityStatusForZone("hidden");
+        QCItem item = mBluetoothSwitch.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    @Test
+    public void getQCItem_titleSet() {
+        QCList list = (QCList) mBluetoothSwitch.getQCItem();
+        QCRow row = list.getRows().get(0);
+        assertThat(row.getTitle()).isEqualTo(mContext.getString(R.string.bluetooth_settings_title));
+    }
+
+    @Test
+    public void getQCItem_hasActionSwitch() {
+        QCList list = (QCList) mBluetoothSwitch.getQCItem();
+        QCRow row = list.getRows().get(0);
+        assertThat(row.getEndItems().size()).isEqualTo(1);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.getType()).isEqualTo(QCItem.QC_TYPE_ACTION_SWITCH);
+    }
+
+    @Test
+    public void getQCItem_bluetoothOn_switchChecked() {
+        QCList list = (QCList) mBluetoothSwitch.getQCItem();
+        QCActionItem actionItem = list.getRows().get(0).getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_bluetoothOff_switchUnchecked() {
+        when(mBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_OFF);
+        QCList list = (QCList) mBluetoothSwitch.getQCItem();
+        QCActionItem actionItem = list.getRows().get(0).getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_switchDisabled() {
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_BLUETOOTH, /* restricted= */ true);
+        QCList list = (QCList) mBluetoothSwitch.getQCItem();
+        QCActionItem actionItem = list.getRows().get(0).getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_switchClickableWhileDisabled() {
+        setUserRestriction(UserManager.DISALLOW_CONFIG_BLUETOOTH, /* restricted= */ true);
+        QCList list = (QCList) mBluetoothSwitch.getQCItem();
+        QCActionItem actionItem = list.getRows().get(0).getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_enable_enablesBluetooth() {
+        when(mBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_OFF);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mBluetoothSwitch.onNotifyChange(intent);
+        verify(mBluetoothAdapter).enable();
+    }
+
+    @Test
+    public void onNotifyChange_disable_disablesBluetooth() {
+        when(mBluetoothAdapter.getState()).thenReturn(BluetoothAdapter.STATE_ON);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, false);
+        mBluetoothSwitch.onNotifyChange(intent);
+        verify(mBluetoothAdapter).disable();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/BluetoothSwitchWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/BluetoothSwitchWorkerTest.java
new file mode 100644
index 000000000..6e47365a7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/BluetoothSwitchWorkerTest.java
@@ -0,0 +1,64 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.bluetooth.BluetoothAdapter;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.IntentFilter;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothSwitchWorkerTest {
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private BluetoothSwitchWorker mWorker;
+
+    @Before
+    public void setUp() {
+        mWorker = new BluetoothSwitchWorker(mContext, SettingsQCRegistry.BLUETOOTH_SWITCH_URI);
+    }
+
+    @Test
+    public void onSubscribe_registersReceiver() {
+        ArgumentCaptor<IntentFilter> captor = ArgumentCaptor.forClass(IntentFilter.class);
+        mWorker.onQCItemSubscribe();
+        verify(mContext).registerReceiver(any(BroadcastReceiver.class), captor.capture());
+        assertThat(captor.getValue().hasAction(BluetoothAdapter.ACTION_STATE_CHANGED)).isTrue();
+    }
+
+    @Test
+    public void onUnsubscribe_unregistersReceiver() {
+        ArgumentCaptor<BroadcastReceiver> captor = ArgumentCaptor.forClass(BroadcastReceiver.class);
+        mWorker.onQCItemSubscribe();
+        verify(mContext).registerReceiver(captor.capture(), any(IntentFilter.class));
+        mWorker.onQCItemUnsubscribe();
+        verify(mContext).unregisterReceiver(captor.getValue());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderMultiDisplaysTest.java b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderMultiDisplaysTest.java
new file mode 100644
index 000000000..86510fd0b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderMultiDisplaysTest.java
@@ -0,0 +1,35 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.Mockito.when;
+
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class BrightnessSliderMultiDisplaysTest extends BrightnessSliderTestCase {
+    @Override
+    protected BrightnessSlider getBrightnessSlider() {
+        when(mUm.isVisibleBackgroundUsersSupported()).thenReturn(true);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mUm);
+        return new BrightnessSlider(mContext);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderTest.java b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderTest.java
new file mode 100644
index 000000000..606d2bf95
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderTest.java
@@ -0,0 +1,70 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.qc.QCSlider;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class BrightnessSliderTest extends BrightnessSliderTestCase {
+    @Override
+    protected BrightnessSlider getBrightnessSlider() {
+        return new BrightnessSlider(mContext);
+    }
+
+    @Test
+    public void getQCItem_createsSlider_zoneWrite() {
+        BrightnessSlider brightnessSlider = getBrightnessSlider();
+        brightnessSlider.setAvailabilityStatusForZone("write");
+        QCItem item = brightnessSlider.getQCItem();
+        QCList list = (QCList) item;
+        QCRow row = list.getRows().get(0);
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsSlider_zoneRead() {
+        BrightnessSlider brightnessSlider = getBrightnessSlider();
+        brightnessSlider.setAvailabilityStatusForZone("read");
+        QCItem item = brightnessSlider.getQCItem();
+        QCList list = (QCList) item;
+        QCRow row = list.getRows().get(0);
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.isEnabled()).isFalse();
+        assertThat(slider.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsSlider_zoneHidden() {
+        BrightnessSlider brightnessSlider = getBrightnessSlider();
+        brightnessSlider.setAvailabilityStatusForZone("hidden");
+        QCItem item = brightnessSlider.getQCItem();
+        assertThat(item).isNull();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderTestCase.java b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderTestCase.java
new file mode 100644
index 000000000..0c69a3c03
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderTestCase.java
@@ -0,0 +1,119 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_SLIDER_VALUE;
+import static com.android.settingslib.display.BrightnessUtils.GAMMA_SPACE_MAX;
+import static com.android.settingslib.display.BrightnessUtils.convertGammaToLinear;
+import static com.android.settingslib.display.BrightnessUtils.convertLinearToGamma;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Intent;
+import android.os.PowerManager;
+import android.os.UserHandle;
+import android.os.UserManager;
+import android.provider.Settings;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.qc.QCSlider;
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.MockitoAnnotations;
+
+public abstract class BrightnessSliderTestCase extends BaseSettingsQCItemTestCase {
+    private BrightnessSlider mBrightnessSlider;
+    private int mMaximumBacklight;
+    private int mMinimumBacklight;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mBrightnessSlider = getBrightnessSlider();
+        PowerManager powerManager = mContext.getSystemService(PowerManager.class);
+        mMaximumBacklight = powerManager.getMaximumScreenBrightnessSetting();
+        mMinimumBacklight = powerManager.getMinimumScreenBrightnessSetting();
+    }
+
+    @Test
+    public void getQCItem_titleSet() {
+        QCRow row = getBrightnessRow();
+        assertThat(row.getTitle()).isEqualTo(mContext.getString(R.string.qc_display_brightness));
+    }
+
+    @Test
+    public void getQCItem_createsSlider() {
+        QCRow row = getBrightnessRow();
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.getMax()).isEqualTo(GAMMA_SPACE_MAX);
+        assertThat(slider.getValue()).isEqualTo(
+                convertLinearToGamma(getScreenBrightness(), mMinimumBacklight, mMaximumBacklight));
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_sliderDisabled() {
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_BRIGHTNESS, /* restricted= */ true);
+        QCRow row = getBrightnessRow();
+        QCSlider slider = row.getSlider();
+        assertThat(slider.isEnabled()).isFalse();
+        assertThat(slider.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_sliderClickableWhileDisabled() {
+        setUserRestriction(UserManager.DISALLOW_CONFIG_BRIGHTNESS, /* restricted= */ true);
+        QCRow row = getBrightnessRow();
+        QCSlider slider = row.getSlider();
+        assertThat(slider.isEnabled()).isFalse();
+        assertThat(slider.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_updatesBrightness() {
+        int oldValue = getScreenBrightness();
+        int newValue = oldValue == 50 ? 51 : 50; // ensure we use a different value
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_SLIDER_VALUE, newValue);
+        mBrightnessSlider.onNotifyChange(intent);
+        assertThat(getScreenBrightness()).isEqualTo(
+                convertGammaToLinear(newValue, mMinimumBacklight, mMaximumBacklight));
+        // restore old value
+        Settings.System.putIntForUser(mContext.getContentResolver(),
+                Settings.System.SCREEN_BRIGHTNESS, oldValue, UserHandle.myUserId());
+    }
+
+    protected abstract BrightnessSlider getBrightnessSlider();
+
+    protected QCRow getBrightnessRow() {
+        QCItem item = mBrightnessSlider.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+
+    private int getScreenBrightness() {
+        int gamma = mBrightnessSlider.getSeekbarValue();
+        return convertGammaToLinear(gamma, mMinimumBacklight, mMaximumBacklight);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderWithIconTest.java b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderWithIconTest.java
new file mode 100644
index 000000000..8edcb09d0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/BrightnessSliderWithIconTest.java
@@ -0,0 +1,42 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class BrightnessSliderWithIconTest extends BrightnessSliderTestCase {
+    @Override
+    protected BrightnessSlider getBrightnessSlider() {
+        return new BrightnessSliderWithIcon(mContext);
+    }
+
+    @Test
+    public void getQCItem_iconSet() {
+        QCRow row = getBrightnessRow();
+        assertThat(row.getStartIcon()).isNotNull();
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_brightness);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/CallVolumeSliderTest.java b/tests/multivalent/src/com/android/car/settings/qc/CallVolumeSliderTest.java
new file mode 100644
index 000000000..f5430621a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/CallVolumeSliderTest.java
@@ -0,0 +1,123 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.qc.QCSlider;
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class CallVolumeSliderTest extends VolumeSliderTestCase {
+    private CallVolumeSlider mVolumeSlider;
+
+    @Before
+    public void setUp() {
+        super.setUp();
+        mVolumeSlider = new TestCallVolumeSlider(mContext);
+    }
+
+    @Test
+    public void getQCItem_titleSet() {
+        verifyTitleSet(getCallVolumeSlider(), R.string.test_volume_call);
+    }
+
+    @Test
+    public void getQCItem_iconSet() {
+        verifyIconSet(getCallVolumeSlider(), R.drawable.test_icon);
+    }
+
+    @Test
+    public void getQCItem_createsSlider() {
+        verifySliderCreated(getCallVolumeSlider());
+    }
+
+    @Test
+    public void getQCItem_createsSlider_zoneWrite() {
+        mVolumeSlider.setAvailabilityStatusForZone("write");
+        QCRow row = getCallVolumeSlider();
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsSlider_zoneRead() {
+        mVolumeSlider.setAvailabilityStatusForZone("read");
+        QCRow row = getCallVolumeSlider();
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.isEnabled()).isFalse();
+        assertThat(slider.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsSlider_zoneHidden() {
+        mVolumeSlider.setAvailabilityStatusForZone("hidden");
+        QCItem item = mVolumeSlider.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_sliderDisabled() {
+        setBaseUserRestriction(UserManager.DISALLOW_ADJUST_VOLUME, /* restricted= */ true);
+        verifyBaseUmRestriction(getCallVolumeSlider());
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_sliderClickableWhileDisabled() {
+        setUserRestriction(UserManager.DISALLOW_ADJUST_VOLUME, /* restricted= */ true);
+        verifyUmRestriction(getCallVolumeSlider());
+    }
+
+    @Test
+    public void onNotifyChange_updatesVolume() {
+        verifyVolumeChanged(mVolumeSlider, GROUP_ID);
+    }
+
+    protected QCRow getCallVolumeSlider() {
+        QCItem item = mVolumeSlider.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+
+    private static class TestCallVolumeSlider extends CallVolumeSlider {
+        TestCallVolumeSlider(Context context) {
+            super(context);
+        }
+
+        @Override
+        protected int carVolumeItemsXml() {
+            return R.xml.test_car_volume_items;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/DisabledQCToastBroadcastReceiverTest.java b/tests/multivalent/src/com/android/car/settings/qc/DisabledQCToastBroadcastReceiverTest.java
new file mode 100644
index 000000000..025df010b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/DisabledQCToastBroadcastReceiverTest.java
@@ -0,0 +1,96 @@
+/*
+ * Copyright (C) 2023 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.content.Intent;
+import android.os.Bundle;
+import android.widget.Toast;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+@RunWith(AndroidJUnit4.class)
+public class DisabledQCToastBroadcastReceiverTest {
+    private static final String TEST_MESSAGE = "test_message";
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private DisabledQCToastBroadcastReceiver mReceiver;
+    private MockitoSession mSession;
+
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    public void setUp() {
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        mReceiver = new DisabledQCToastBroadcastReceiver();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onReceive_validMessage_createsToast() {
+        Bundle bundle = new Bundle();
+        bundle.putString(DisabledQCToastBroadcastReceiver.DISABLED_QC_TOAST_KEY, TEST_MESSAGE);
+        Intent intent = new Intent()
+                .putExtras(bundle);
+
+        mReceiver.onReceive(mContext, intent);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(TEST_MESSAGE), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    @Test
+    public void onReceive_nullMessage_doesNotCreateToast() {
+        Intent intent = new Intent();
+
+        mReceiver.onReceive(mContext, intent);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(TEST_MESSAGE), anyInt()), never());
+        verify(mMockToast, never()).show();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/HotspotRowTest.java b/tests/multivalent/src/com/android/car/settings/qc/HotspotRowTest.java
new file mode 100644
index 000000000..3932ca6d1
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/HotspotRowTest.java
@@ -0,0 +1,183 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Intent;
+import android.net.ConnectivityManager;
+import android.net.TetheringManager;
+import android.net.wifi.SoftApConfiguration;
+import android.net.wifi.WifiManager;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+import com.android.internal.util.ConcurrentUtils;
+import com.android.settingslib.wifi.WifiUtils;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class HotspotRowTest extends BaseSettingsQCItemTestCase {
+    private static final String TEST_SSID = "TEST_SSID";
+    private static final String TEST_PASSWORD = "TEST_PASSWORD";
+
+    private HotspotRow mHotspotRow;
+
+    @Mock
+    private WifiManager mWifiManager;
+    @Mock
+    private TetheringManager mTetheringManager;
+    @Mock
+    private SoftApConfiguration mSoftApConfiguration;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(TetheringManager.class)).thenReturn(mTetheringManager);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mWifiManager);
+        when(mSoftApConfiguration.getSsid()).thenReturn(TEST_SSID);
+        when(mSoftApConfiguration.getPassphrase()).thenReturn(TEST_PASSWORD);
+        when(mSoftApConfiguration.getSecurityType()).thenReturn(
+                SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+        when(mWifiManager.getSoftApConfiguration()).thenReturn(mSoftApConfiguration);
+
+        mHotspotRow = getHotspotRowInstance();
+    }
+
+    @Test
+    public void getQCItem_setsTitleAndIcon() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_DISABLED);
+        QCRow row = getHotspotRow();
+        assertThat(row.getTitle()).isEqualTo(mContext.getString(R.string.hotspot_settings_title));
+        assertThat(row.getStartIcon()).isNotNull();
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_hotspot);
+    }
+
+    @Test
+    public void getQCItem_hotspotDisabled_returnsRow() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_DISABLED);
+        QCRow row = getHotspotRow();
+        assertThat(row.getSubtitle()).isEqualTo(
+                mContext.getString(R.string.wifi_hotspot_state_off));
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hotspotEnabled_noDevices_returnsRow() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_ENABLED);
+        QCRow row = getHotspotRow();
+        assertThat(row.getSubtitle()).isEqualTo(String.format("%s / %s", TEST_SSID, TEST_PASSWORD));
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_hotspotEnabled_hasDevices_returnsRow() {
+        int connectedDevices = 1;
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_ENABLED);
+        mHotspotRow.setConnectedDevicesCount(connectedDevices);
+        QCRow row = getHotspotRow();
+        assertThat(row.getSubtitle()).isEqualTo(
+                WifiUtils.getWifiTetherSummaryForConnectedDevices(mContext, connectedDevices));
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_switchDisabled() {
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_TETHERING, /* restricted= */ true);
+        QCRow row = getHotspotRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_switchClickableWhileDisabled() {
+        setUserRestriction(UserManager.DISALLOW_CONFIG_TETHERING, /* restricted= */ true);
+        QCRow row = getHotspotRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_togglesHotspot() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_DISABLED);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mHotspotRow.onNotifyChange(intent);
+        verify(mTetheringManager).startTethering(eq(ConnectivityManager.TETHERING_WIFI),
+                eq(ConcurrentUtils.DIRECT_EXECUTOR), any());
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneWrite() {
+        mHotspotRow.setAvailabilityStatusForZone("write");
+        QCRow row = getHotspotRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneRead() {
+        mHotspotRow.setAvailabilityStatusForZone("read");
+        QCRow row = getHotspotRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneHidden() {
+        mHotspotRow.setAvailabilityStatusForZone("hidden");
+        QCItem item = mHotspotRow.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    protected QCRow getHotspotRow() {
+        QCItem item = mHotspotRow.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+
+    protected HotspotRow getHotspotRowInstance() {
+        return new HotspotRow(mContext);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/HotspotRowWithActionTest.java b/tests/multivalent/src/com/android/car/settings/qc/HotspotRowWithActionTest.java
new file mode 100644
index 000000000..d20097160
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/HotspotRowWithActionTest.java
@@ -0,0 +1,40 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCRow;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class HotspotRowWithActionTest extends HotspotRowTest {
+    @Override
+    protected HotspotRow getHotspotRowInstance() {
+        return new HotspotRowWithAction(mContext);
+    }
+
+    @Test
+    public void getQCItem_setPrimaryAction_returnsRow() {
+        QCRow row = getHotspotRow();
+        assertThat(row.getPrimaryAction()).isNotNull();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/HotspotRowWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/HotspotRowWorkerTest.java
new file mode 100644
index 000000000..7b471e7fb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/HotspotRowWorkerTest.java
@@ -0,0 +1,121 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.net.TetheringManager;
+import android.net.wifi.SoftApInfo;
+import android.net.wifi.WifiClient;
+import android.net.wifi.WifiManager;
+import android.os.HandlerExecutor;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Collections;
+import java.util.List;
+import java.util.concurrent.Executor;
+
+@RunWith(AndroidJUnit4.class)
+public class HotspotRowWorkerTest {
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private HotspotRowWorker mWorker;
+
+    @Mock
+    private WifiManager mWifiManager;
+    @Mock
+    private TetheringManager mTetheringManager;
+    @Mock
+    private HotspotRow mQCItem;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mWifiManager);
+        when(mContext.getSystemService(TetheringManager.class)).thenReturn(mTetheringManager);
+        mWorker = new HotspotRowWorker(mContext, SettingsQCRegistry.HOTSPOT_ROW_URI);
+        mWorker.setQCItem(mQCItem);
+    }
+
+    @Test
+    public void onSubscribe_registersCallbacks() {
+        mWorker.onQCItemSubscribe();
+        verify(mTetheringManager).registerTetheringEventCallback(any(HandlerExecutor.class),
+                any(TetheringManager.TetheringEventCallback.class));
+        verify(mWifiManager).registerSoftApCallback(any(Executor.class),
+                any(WifiManager.SoftApCallback.class));
+    }
+
+    @Test
+    public void onUnsubscribe_unregistersCallbacks() {
+        ArgumentCaptor<TetheringManager.TetheringEventCallback> tetheringEventCaptor =
+                ArgumentCaptor.forClass(TetheringManager.TetheringEventCallback.class);
+        ArgumentCaptor<WifiManager.SoftApCallback> softApCaptor = ArgumentCaptor.forClass(
+                WifiManager.SoftApCallback.class);
+        mWorker.onQCItemSubscribe();
+        verify(mTetheringManager).registerTetheringEventCallback(any(HandlerExecutor.class),
+                tetheringEventCaptor.capture());
+        verify(mWifiManager).registerSoftApCallback(any(Executor.class),
+                softApCaptor.capture());
+
+        mWorker.onQCItemUnsubscribe();
+        verify(mTetheringManager).unregisterTetheringEventCallback(tetheringEventCaptor.getValue());
+        verify(mWifiManager).unregisterSoftApCallback(softApCaptor.getValue());
+    }
+
+    @Test
+    public void onTetheringSupported_updatesQCItem() {
+        when(mQCItem.getHotspotSupported()).thenReturn(true);
+        ArgumentCaptor<TetheringManager.TetheringEventCallback> tetheringEventCaptor =
+                ArgumentCaptor.forClass(TetheringManager.TetheringEventCallback.class);
+        mWorker.onQCItemSubscribe();
+        verify(mTetheringManager).registerTetheringEventCallback(any(HandlerExecutor.class),
+                tetheringEventCaptor.capture());
+
+        TetheringManager.TetheringEventCallback callback = tetheringEventCaptor.getValue();
+        callback.onTetheringSupported(false);
+        verify(mQCItem).setHotspotSupported(false);
+    }
+
+    @Test
+    public void onConnectedClientsChanged_updatesQCItem() {
+        ArgumentCaptor<WifiManager.SoftApCallback> softApCaptor = ArgumentCaptor.forClass(
+                WifiManager.SoftApCallback.class);
+        mWorker.onQCItemSubscribe();
+        verify(mWifiManager).registerSoftApCallback(any(Executor.class),
+                softApCaptor.capture());
+
+        WifiManager.SoftApCallback callback = softApCaptor.getValue();
+        SoftApInfo info = mock(SoftApInfo.class);
+        List<WifiClient> clients = Collections.singletonList(mock(WifiClient.class));
+        callback.onConnectedClientsChanged(info, clients);
+        verify(mQCItem).setConnectedDevicesCount(1);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/HotspotTileTest.java b/tests/multivalent/src/com/android/car/settings/qc/HotspotTileTest.java
new file mode 100644
index 000000000..a5c586274
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/HotspotTileTest.java
@@ -0,0 +1,165 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Intent;
+import android.net.ConnectivityManager;
+import android.net.TetheringManager;
+import android.net.wifi.WifiManager;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCTile;
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.Executor;
+
+@RunWith(AndroidJUnit4.class)
+public class HotspotTileTest extends BaseSettingsQCItemTestCase {
+    private HotspotTile mHotspotTile;
+
+    @Mock
+    private TetheringManager mTetheringManager;
+    @Mock
+    private WifiManager mWifiManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(TetheringManager.class)).thenReturn(mTetheringManager);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mWifiManager);
+
+        mHotspotTile = new HotspotTile(mContext);
+    }
+
+    @Test
+    public void getQCItem_titleAndIconSet() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_DISABLED);
+        QCTile tile = getTile();
+        assertThat(tile.getSubtitle()).isEqualTo(
+                mContext.getString(R.string.hotspot_settings_title));
+        assertThat(tile.getIcon()).isNotNull();
+    }
+
+    @Test
+    public void getQCItem_hotspotDisabled_tileUnchecked() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_DISABLED);
+        QCTile tile = getTile();
+        assertThat(tile.isChecked()).isFalse();
+        assertThat(tile.isEnabled()).isTrue();
+        assertThat(tile.isAvailable()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_hotspotEnabled_tileChecked() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_ENABLED);
+        QCTile tile = getTile();
+        assertThat(tile.isChecked()).isTrue();
+        assertThat(tile.isEnabled()).isTrue();
+        assertThat(tile.isAvailable()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_hotspotBusy_tileDisabled() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_ENABLING);
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hotspotUnsupported_tileUnavailable() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_DISABLED);
+        mHotspotTile.setHotspotSupported(false);
+        QCTile tile = getTile();
+        assertThat(tile.isAvailable()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_tileDisabled() {
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_TETHERING, /* restricted= */ true);
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_tileClickableWhileDisabled() {
+        setUserRestriction(UserManager.DISALLOW_CONFIG_TETHERING, /* restricted= */ true);
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_togglesHotspot() {
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_DISABLED);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mHotspotTile.onNotifyChange(intent);
+        verify(mTetheringManager).startTethering(eq(ConnectivityManager.TETHERING_WIFI),
+                any(Executor.class), any(TetheringManager.StartTetheringCallback.class));
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneWrite() {
+        mHotspotTile.setAvailabilityStatusForZone("write");
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_ENABLED);
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneRead() {
+        mHotspotTile.setAvailabilityStatusForZone("read");
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_ENABLED);
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneHidden() {
+        mHotspotTile.setAvailabilityStatusForZone("hidden");
+        when(mWifiManager.getWifiApState()).thenReturn(WifiManager.WIFI_AP_STATE_ENABLED);
+        QCItem item = mHotspotTile.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    private QCTile getTile() {
+        QCItem item = mHotspotTile.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCTile).isTrue();
+        return (QCTile) item;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/HotspotTileWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/HotspotTileWorkerTest.java
new file mode 100644
index 000000000..a364adee6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/HotspotTileWorkerTest.java
@@ -0,0 +1,87 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.net.TetheringManager;
+import android.net.wifi.WifiManager;
+import android.os.HandlerExecutor;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.Executor;
+
+@RunWith(AndroidJUnit4.class)
+public class HotspotTileWorkerTest {
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private HotspotTileWorker mWorker;
+
+    @Mock
+    private WifiManager mWifiManager;
+    @Mock
+    private TetheringManager mTetheringManager;
+    @Mock
+    private HotspotTile mQCItem;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mWifiManager);
+        when(mContext.getSystemService(TetheringManager.class)).thenReturn(mTetheringManager);
+        mWorker = new HotspotTileWorker(mContext, SettingsQCRegistry.HOTSPOT_TILE_URI);
+        mWorker.setQCItem(mQCItem);
+    }
+
+    @Test
+    public void onSubscribe_registersCallbacks() {
+        mWorker.onQCItemSubscribe();
+        verify(mTetheringManager).registerTetheringEventCallback(any(HandlerExecutor.class),
+                any(TetheringManager.TetheringEventCallback.class));
+        verify(mWifiManager).registerSoftApCallback(any(Executor.class),
+                any(WifiManager.SoftApCallback.class));
+    }
+
+    @Test
+    public void onUnsubscribe_unregistersCallbacks() {
+        ArgumentCaptor<TetheringManager.TetheringEventCallback> tetheringEventCaptor =
+                ArgumentCaptor.forClass(TetheringManager.TetheringEventCallback.class);
+        ArgumentCaptor<WifiManager.SoftApCallback> softApCaptor = ArgumentCaptor.forClass(
+                WifiManager.SoftApCallback.class);
+        mWorker.onQCItemSubscribe();
+        verify(mTetheringManager).registerTetheringEventCallback(any(HandlerExecutor.class),
+                tetheringEventCaptor.capture());
+        verify(mWifiManager).registerSoftApCallback(any(Executor.class),
+                softApCaptor.capture());
+
+        mWorker.onQCItemUnsubscribe();
+        verify(mTetheringManager).unregisterTetheringEventCallback(tetheringEventCaptor.getValue());
+        verify(mWifiManager).unregisterSoftApCallback(softApCaptor.getValue());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderTest.java b/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderTest.java
new file mode 100644
index 000000000..78b86b9dc
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderTest.java
@@ -0,0 +1,101 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class MediaVolumeSliderTest extends VolumeSliderTestCase {
+
+    private MediaVolumeSlider mVolumeSlider;
+
+    @Before
+    public void setUp() {
+        super.setUp();
+        mVolumeSlider = getMediaVolumeSliderInstance();
+    }
+
+    @Test
+    public void getQCItem_titleSet() {
+        verifyTitleSet(getMediaVolumeSlider(), R.string.test_volume_music);
+    }
+
+    @Test
+    public void getQCItem_iconSet() {
+        verifyIconSet(getMediaVolumeSlider(), R.drawable.test_icon);
+    }
+
+    @Test
+    public void getQCItem_createsSlider() {
+        verifySliderCreated(getMediaVolumeSlider());
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_sliderDisabled() {
+        setBaseUserRestriction(UserManager.DISALLOW_ADJUST_VOLUME, /* restricted= */ true);
+        verifyBaseUmRestriction(getMediaVolumeSlider());
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_sliderClickableWhileDisabled() {
+        setUserRestriction(UserManager.DISALLOW_ADJUST_VOLUME, /* restricted= */ true);
+        verifyUmRestriction(getMediaVolumeSlider());
+    }
+
+    @Test
+    public void onNotifyChange_updatesVolume() {
+        verifyVolumeChanged(mVolumeSlider, GROUP_ID);
+    }
+
+    protected QCRow getMediaVolumeSlider() {
+        QCItem item = mVolumeSlider.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+
+    protected MediaVolumeSlider getMediaVolumeSliderInstance() {
+        return new TestMediaVolumeSlider(mContext);
+    }
+
+    private static class TestMediaVolumeSlider extends MediaVolumeSlider {
+        TestMediaVolumeSlider(Context context) {
+            super(context);
+        }
+
+        @Override
+        protected int carVolumeItemsXml() {
+            return R.xml.test_car_volume_items;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderWithoutIconTest.java b/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderWithoutIconTest.java
new file mode 100644
index 000000000..ab5bdfe61
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderWithoutIconTest.java
@@ -0,0 +1,51 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import android.content.Context;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class MediaVolumeSliderWithoutIconTest extends MediaVolumeSliderTest {
+
+    @Test
+    public void getQCItem_iconSet() {
+        verifyIconNotSet(getMediaVolumeSlider());
+    }
+
+    @Override
+    protected MediaVolumeSlider getMediaVolumeSliderInstance() {
+        return new TestMediaVolumeSliderWithoutIcon(mContext);
+    }
+
+    private static class TestMediaVolumeSliderWithoutIcon extends MediaVolumeSliderWithoutIcon {
+        TestMediaVolumeSliderWithoutIcon(Context context) {
+            super(context);
+        }
+
+        @Override
+        protected int carVolumeItemsXml() {
+            return R.xml.test_car_volume_items;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderWorkerTest.java
new file mode 100644
index 000000000..9d4eac065
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MediaVolumeSliderWorkerTest.java
@@ -0,0 +1,84 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.media.CarAudioManager;
+import android.content.Context;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.CarSettingsApplication;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class MediaVolumeSliderWorkerTest {
+    protected static final int GROUP_ID = 0;
+    protected static final int FLAGS = 0;
+    protected static final int TEST_ZONE_ID = 1;
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private MediaVolumeSliderWorker mWorker;
+
+    @Mock
+    private CarSettingsApplication mCarSettingsApplication;
+    @Mock
+    protected CarAudioManager mCarAudioManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getApplicationContext()).thenReturn(mCarSettingsApplication);
+        when(mCarSettingsApplication.getCarAudioManager()).thenReturn(mCarAudioManager);
+        when(mCarSettingsApplication.getMyAudioZoneId()).thenReturn(TEST_ZONE_ID);
+
+        mWorker = new MediaVolumeSliderWorker(mContext,
+                SettingsQCRegistry.MEDIA_VOLUME_SLIDER_URI);
+    }
+
+    @Test
+    public void onSubscribe_registerCarVolumeCallback() {
+        mWorker.onQCItemSubscribe();
+        verify(mCarAudioManager).registerCarVolumeCallback(any());
+    }
+
+    @Test
+    public void onUnsubscribe_unregisterCarVolumeCallback() {
+        mWorker.onQCItemSubscribe();
+        mWorker.onQCItemUnsubscribe();
+        verify(mCarAudioManager).unregisterCarVolumeCallback(any());
+    }
+
+    @Test
+    public void onGroupVolumeChanged_updateVolumeAndMute() {
+        mWorker.getVolumeChangeCallback().onGroupVolumeChanged(TEST_ZONE_ID, GROUP_ID, FLAGS);
+        verify(mCarAudioManager).getVolumeGroupIdForUsage(eq(TEST_ZONE_ID), anyInt());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MobileDataBaseWorkerTestCase.java b/tests/multivalent/src/com/android/car/settings/qc/MobileDataBaseWorkerTestCase.java
new file mode 100644
index 000000000..9eea8179c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MobileDataBaseWorkerTestCase.java
@@ -0,0 +1,108 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.content.ContentResolver;
+import android.content.Context;
+import android.database.ContentObserver;
+import android.net.Uri;
+import android.telephony.SubscriptionManager;
+
+import androidx.test.core.app.ApplicationProvider;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+public abstract class MobileDataBaseWorkerTestCase<E extends MobileDataBaseWorker> {
+    private static final int DEFAULT_SUB_ID = 1;
+
+    protected final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private E mWorker;
+    private MockitoSession mSession;
+
+    @Mock
+    private ContentResolver mContentResolver;
+
+    protected abstract E getWorker();
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(SubscriptionManager.class, withSettings().lenient())
+                .startMocking();
+
+        when(mContext.getContentResolver()).thenReturn(mContentResolver);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onSubscribe_validSubId_registerObserver() {
+        createWorker(DEFAULT_SUB_ID);
+        mWorker.onQCItemSubscribe();
+        // There will be an additional observer for data subscription
+        verify(mContentResolver, (times(2))).registerContentObserver(any(Uri.class), eq(false),
+                any(ContentObserver.class));
+    }
+
+    @Test
+    public void onSubscribe_invalidSubId_doesNotRegisterObserver() {
+        createWorker(SubscriptionManager.INVALID_SUBSCRIPTION_ID);
+        mWorker.onQCItemSubscribe();
+        // There will be an additional observer for data subscription
+        verify(mContentResolver).registerContentObserver(any(Uri.class), eq(false),
+                any(ContentObserver.class));
+    }
+
+    @Test
+    public void onUnsubscribe_unregistersObserver() {
+        createWorker(DEFAULT_SUB_ID);
+        ArgumentCaptor<ContentObserver> captor = ArgumentCaptor.forClass(ContentObserver.class);
+        mWorker.onQCItemSubscribe();
+        // There will be an additional observer for data subscription
+        verify(mContentResolver, times(2)).registerContentObserver(any(Uri.class), eq(false),
+                captor.capture());
+        mWorker.onQCItemUnsubscribe();
+        verify(mContentResolver).unregisterContentObserver(captor.getValue());
+    }
+
+    private void createWorker(int subId) {
+        when(SubscriptionManager.getDefaultDataSubscriptionId()).thenReturn(subId);
+        mWorker = getWorker();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MobileDataRowTest.java b/tests/multivalent/src/com/android/car/settings/qc/MobileDataRowTest.java
new file mode 100644
index 000000000..57c6301da
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MobileDataRowTest.java
@@ -0,0 +1,200 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertNull;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+import android.telephony.TelephonyManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.datasubscription.DataSubscription;
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+import com.android.settingslib.net.DataUsageController;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileDataRowTest extends BaseSettingsQCItemTestCase {
+    private static final String TEST_NETWORK_NAME = "TEST_NETWORK";
+
+    private MobileDataRow mMobileDataRow;
+
+    @Mock
+    private DataUsageController mDataUsageController;
+    @Mock
+    private TelephonyManager mTelephonyManager;
+    @Mock
+    private DataSubscription mDataSubscription;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(TelephonyManager.class)).thenReturn(mTelephonyManager);
+        mMobileDataRow = new TestMobileDataRow(mContext);
+        mMobileDataRow.setSubscription(mDataSubscription);
+        when(mDataSubscription.isDataSubscriptionInactive()).thenReturn(true);
+    }
+
+    @Test
+    public void getQCItem_mobileDataDisabled_switchUnchecked() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(false);
+        QCRow row = getRow();
+        assertThat(row.getEndItems().get(0).isChecked()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_mobileDataDisabled_nullSubtitleAndActionText() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(false);
+        QCRow row = getRow();
+        assertEquals(mContext.getString(R.string.mobile_network_state_off), row.getSubtitle());
+        assertNull(row.getActionText());
+    }
+
+    @Test
+    public void getQCItem_noNetworkName_dataSubscriptionFlagOn_validSubtitle() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn("");
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        QCRow row = getRow();
+        assertEquals(mContext.getString(
+                R.string.connectivity_inactive_prompt), row.getSubtitle());
+    }
+
+    @Test
+    public void getQCItem_hasNetworkName_setsSubtitle() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        QCRow row = getRow();
+        assertThat(row.getSubtitle()).isEqualTo(TEST_NETWORK_NAME);
+    }
+
+    @Test
+    public void getQCItem_dataDisabled_setsSubtitle() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(false);
+        QCRow row = getRow();
+        assertThat(row.getSubtitle()).isEqualTo(
+                mContext.getString(R.string.mobile_network_state_off));
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_switchDisabled() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS, /* restricted= */ true);
+        QCRow row = getRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_switchClickableWhileDisabled() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        setUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS, /* restricted= */ true);
+        QCRow row = getRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_togglesMobileData() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(false);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mMobileDataRow.onNotifyChange(intent);
+        verify(mDataUsageController).setMobileDataEnabled(true);
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneWrite() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        mMobileDataRow.setAvailabilityStatusForZone("write");
+        QCRow row = getRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneRead() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        mMobileDataRow.setAvailabilityStatusForZone("read");
+        QCRow row = getRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneHidden() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        mMobileDataRow.setAvailabilityStatusForZone("hidden");
+        QCItem item = mMobileDataRow.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    private QCRow getRow() {
+        QCItem item = mMobileDataRow.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+
+    private class TestMobileDataRow extends MobileDataRow {
+
+        TestMobileDataRow(Context context) {
+            super(context);
+        }
+
+        @Override
+        DataUsageController getDataUsageController(Context context) {
+            return mDataUsageController;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MobileDataRowWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/MobileDataRowWorkerTest.java
new file mode 100644
index 000000000..4f6ee1e34
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MobileDataRowWorkerTest.java
@@ -0,0 +1,33 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileDataRowWorkerTest extends MobileDataBaseWorkerTestCase<MobileDataRowWorker> {
+
+    @Override
+    protected MobileDataRowWorker getWorker() {
+        MobileDataRowWorker mobileDataRowWorker =
+                new MobileDataRowWorker(mContext, SettingsQCRegistry.MOBILE_DATA_ROW_URI);
+        mobileDataRowWorker.setQCItem(new MobileDataRow(mContext));
+        return mobileDataRowWorker;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MobileDataTileTest.java b/tests/multivalent/src/com/android/car/settings/qc/MobileDataTileTest.java
new file mode 100644
index 000000000..1440b1913
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MobileDataTileTest.java
@@ -0,0 +1,191 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+import android.telephony.TelephonyManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCTile;
+import com.android.car.settings.R;
+import com.android.settingslib.net.DataUsageController;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileDataTileTest extends BaseSettingsQCItemTestCase {
+    private static final String TEST_NETWORK_NAME = "TEST_NETWORK";
+
+    private MobileDataTile mMobileDataTile;
+
+    @Mock
+    private DataUsageController mDataUsageController;
+    @Mock
+    private TelephonyManager mTelephonyManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(TelephonyManager.class)).thenReturn(mTelephonyManager);
+        mMobileDataTile = new TestMobileDataTile(mContext);
+    }
+
+    @Test
+    public void getQCItem_mobileDataUnsupported_returnsNull() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(false);
+        QCItem item = mMobileDataTile.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    @Test
+    public void getQCItem_mobileDataDisabled_tileUnchecked() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(false);
+        QCTile tile = getTile();
+        assertThat(tile.isChecked()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_mobileDataEnabled_tileChecked() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        QCTile tile = getTile();
+        assertThat(tile.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_noNetworkName_setsDefaultSubtitle() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn("");
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        QCTile tile = getTile();
+        assertThat(tile.getSubtitle()).isEqualTo(
+                mContext.getString(R.string.mobile_network_toggle_title));
+    }
+
+    @Test
+    public void getQCItem_hasNetworkName_setsSubtitle() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        QCTile tile = getTile();
+        assertThat(tile.getSubtitle()).isEqualTo(TEST_NETWORK_NAME);
+    }
+
+    @Test
+    public void getQCItem_dataDisabled_setsSubtitle() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(false);
+        QCTile tile = getTile();
+        assertThat(tile.getSubtitle()).isEqualTo(
+                mContext.getString(R.string.mobile_network_state_off));
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_tileDisabled() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS, /* restricted= */ true);
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_tileClickableWhileDisabled() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(true);
+        setUserRestriction(UserManager.DISALLOW_CONFIG_MOBILE_NETWORKS, /* restricted= */ true);
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_togglesMobileData() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        when(mTelephonyManager.getNetworkOperatorName()).thenReturn(TEST_NETWORK_NAME);
+        when(mDataUsageController.isMobileDataEnabled()).thenReturn(false);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mMobileDataTile.onNotifyChange(intent);
+        verify(mDataUsageController).setMobileDataEnabled(true);
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneWrite() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        mMobileDataTile.setAvailabilityStatusForZone("write");
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneRead() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        mMobileDataTile.setAvailabilityStatusForZone("read");
+        QCTile tile = getTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneHidden() {
+        when(mDataUsageController.isMobileDataSupported()).thenReturn(true);
+        mMobileDataTile.setAvailabilityStatusForZone("hidden");
+        QCItem item = mMobileDataTile.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    private QCTile getTile() {
+        QCItem item = mMobileDataTile.getQCItem();
+        assertThat(item instanceof QCTile).isTrue();
+        return (QCTile) item;
+    }
+
+    private class TestMobileDataTile extends MobileDataTile {
+
+        TestMobileDataTile(Context context) {
+            super(context);
+        }
+
+        @Override
+        DataUsageController getDataUsageController(Context context) {
+            return mDataUsageController;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/MobileDataTileWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/MobileDataTileWorkerTest.java
new file mode 100644
index 000000000..98bcdee27
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/MobileDataTileWorkerTest.java
@@ -0,0 +1,29 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class MobileDataTileWorkerTest extends MobileDataBaseWorkerTestCase<MobileDataTileWorker> {
+    @Override
+    protected MobileDataTileWorker getWorker() {
+        return new MobileDataTileWorker(mContext, SettingsQCRegistry.MOBILE_DATA_TILE_URI);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/NavigationVolumeSliderTest.java b/tests/multivalent/src/com/android/car/settings/qc/NavigationVolumeSliderTest.java
new file mode 100644
index 000000000..7195d3304
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/NavigationVolumeSliderTest.java
@@ -0,0 +1,131 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.qc.QCSlider;
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class NavigationVolumeSliderTest extends VolumeSliderTestCase {
+    private NavigationVolumeSlider mVolumeSlider;
+
+    @Before
+    public void setUp() {
+        super.setUp();
+        mVolumeSlider = new TestNavigationVolumeSlider(mContext);
+    }
+
+    @Test
+    public void getQCItem_titleSet() {
+        verifyTitleSet(getNavigationVolumeSlider(), R.string.test_volume_navigation);
+    }
+
+    @Test
+    public void getQCItem_iconSet() {
+        verifyIconSet(getNavigationVolumeSlider(), R.drawable.test_icon);
+    }
+
+    @Test
+    public void getQCItem_createsSlider() {
+        verifySliderCreated(getNavigationVolumeSlider());
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_sliderDisabled() {
+        setBaseUserRestriction(UserManager.DISALLOW_ADJUST_VOLUME, /* restricted= */ true);
+        verifyBaseUmRestriction(getNavigationVolumeSlider());
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_sliderClickableWhileDisabled() {
+        setUserRestriction(UserManager.DISALLOW_ADJUST_VOLUME, /* restricted= */ true);
+        verifyUmRestriction(getNavigationVolumeSlider());
+    }
+
+    @Test
+    public void onNotifyChange_updatesVolume() {
+        verifyVolumeChanged(mVolumeSlider, GROUP_ID);
+    }
+
+    @Test
+    public void getQCItem_createsVolumeSlider_zoneWrite() {
+        mVolumeSlider.setAvailabilityStatusForZone("write");
+        QCItem item = mVolumeSlider.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        QCSlider slider = row.getSlider();
+        assertThat(slider.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsVolumeSlider_zoneRead() {
+        mVolumeSlider.setAvailabilityStatusForZone("read");
+        QCItem item = mVolumeSlider.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        QCSlider slider = row.getSlider();
+        assertThat(slider.isEnabled()).isFalse();
+        assertThat(slider.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsVolumeSlider_zoneHidden() {
+        mVolumeSlider.setAvailabilityStatusForZone("hidden");
+        QCItem item = mVolumeSlider.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    protected QCRow getNavigationVolumeSlider() {
+        QCItem item = mVolumeSlider.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+
+    private static class TestNavigationVolumeSlider extends NavigationVolumeSlider {
+        TestNavigationVolumeSlider(Context context) {
+            super(context);
+        }
+
+        @Override
+        protected int carVolumeItemsXml() {
+            return R.xml.test_car_volume_items;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/PairedBluetoothDevicesTest.java b/tests/multivalent/src/com/android/car/settings/qc/PairedBluetoothDevicesTest.java
new file mode 100644
index 000000000..c7fd74949
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/PairedBluetoothDevicesTest.java
@@ -0,0 +1,459 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static android.os.UserManager.DISALLOW_BLUETOOTH;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+import static com.android.car.settings.qc.PairedBluetoothDevices.BLUETOOTH_BUTTON;
+import static com.android.car.settings.qc.PairedBluetoothDevices.EXTRA_BUTTON_TYPE;
+import static com.android.car.settings.qc.PairedBluetoothDevices.EXTRA_DEVICE_KEY;
+import static com.android.car.settings.qc.PairedBluetoothDevices.MEDIA_BUTTON;
+import static com.android.car.settings.qc.PairedBluetoothDevices.PHONE_BUTTON;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothClass;
+import android.bluetooth.BluetoothDevice;
+import android.bluetooth.BluetoothProfile;
+import android.content.Intent;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothAdapter;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+import com.android.settingslib.bluetooth.LocalBluetoothProfile;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.HashSet;
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class PairedBluetoothDevicesTest extends BaseSettingsQCItemTestCase {
+    private static final String DEFAULT_NAME = "DEFAULT_NAME";
+    private static final String DEFAULT_SUMMARY = "DEFAULT_SUMMARY";
+    private static final String DEFAULT_ADDRESS = "F6:8F:AC:E8:32:50";
+
+    private PairedBluetoothDevices mPairedBluetoothDevices;
+    private MockitoSession mSession;
+    private ArrayList<CachedBluetoothDevice> mCachedDevices = new ArrayList<>();
+    private Set<BluetoothDevice> mBondedDevices = new HashSet<>();
+
+    @Mock
+    private BluetoothAdapter mBluetoothAdapter;
+    @Mock
+    private LocalBluetoothAdapter mLocalBluetoothAdapter;
+    @Mock
+    private LocalBluetoothManager mBluetoothManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSession = ExtendedMockito.mockitoSession()
+                .strictness(Strictness.LENIENT)
+                .mockStatic(BluetoothAdapter.class)
+                .mockStatic(LocalBluetoothManager.class)
+                .startMocking();
+        when(BluetoothAdapter.getDefaultAdapter()).thenReturn(mBluetoothAdapter);
+        when(mBluetoothAdapter.isEnabled()).thenReturn(true);
+        when(LocalBluetoothManager.getInstance(any(), any())).thenReturn(mBluetoothManager);
+        when(mBluetoothManager.getBluetoothAdapter()).thenReturn(mLocalBluetoothAdapter);
+        when(mLocalBluetoothAdapter.getBondedDevices()).thenReturn(mBondedDevices);
+
+        CachedBluetoothDeviceManager deviceManager = mock(CachedBluetoothDeviceManager.class);
+        when(mBluetoothManager.getCachedDeviceManager()).thenReturn(deviceManager);
+        when(deviceManager.getCachedDevicesCopy()).thenReturn(mCachedDevices);
+
+        mPairedBluetoothDevices = new PairedBluetoothDevices(mContext);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getQCItem_bluetoothDisallowed_returnsNull() {
+        setUserRestriction(DISALLOW_BLUETOOTH, true);
+        QCItem item = mPairedBluetoothDevices.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    @Test
+    public void getQCItem_bluetoothDisabled_returnsBluetoothDisabledMessage() {
+        when(mBluetoothAdapter.isEnabled()).thenReturn(false);
+        QCItem item = mPairedBluetoothDevices.getQCItem();
+        assertThat(item).isNotNull();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        assertThat(row.getTitle()).isEqualTo(
+                mContext.getString(R.string.qc_bluetooth_off_devices_info));
+        assertThat(row.getStartIcon()).isNotNull();
+    }
+
+    @Test
+    public void getQCItem_noDevices_returnsPairMessage() {
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        assertThat(row.getTitle()).isEqualTo(
+                mContext.getString(R.string.qc_bluetooth_on_no_devices_info));
+        assertThat(row.getStartIcon()).isNotNull();
+    }
+
+    @Test
+    public void getQCItem_hasDevices_hasRows() {
+        addBluetoothDevice("Device1", /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        addBluetoothDevice("Device2",  /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list.getRows().size()).isEqualTo(2);
+    }
+
+    @Test
+    public void getQCItem_hasDevices_onlyDisplaysHumanReadableNames() {
+        addBluetoothDevice("Device1", /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        addBluetoothDevice("Device2",  /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ false);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list.getRows().size()).isEqualTo(1);
+    }
+
+    @Test
+    public void getQCItem_limitsDeviceCount() {
+        addBluetoothDevice("Device1", /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        addBluetoothDevice("Device2",  /* connected= */ false, /* busy= */ false,
+                /* phoneEnabled= */ false, /* mediaEnabled= */ false,
+                /* hasHumanReadableName= */ true);
+        addBluetoothDevice("Device3",  /* connected= */ false, /* busy= */ false,
+                /* phoneEnabled= */ false, /* mediaEnabled= */ false,
+                /* hasHumanReadableName= */ true);
+        addBluetoothDevice("Device4",  /* connected= */ false, /* busy= */ false,
+                /* phoneEnabled= */ false, /* mediaEnabled= */ false,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list.getRows().size()).isEqualTo(3);
+    }
+
+    @Test
+    public void getQCItem_setsTitle() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        assertThat(row.getTitle()).isEqualTo(DEFAULT_NAME);
+    }
+
+    @Test
+    public void getQCItem_bluetoothDisabled_togglesUpdated() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ false, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        QCActionItem btToggle = row.getEndItems().get(0);
+        QCActionItem phoneToggle = row.getEndItems().get(1);
+        QCActionItem mediaToggle = row.getEndItems().get(2);
+        assertThat(btToggle.isChecked()).isFalse();
+        assertThat(btToggle.isEnabled()).isTrue();
+        assertThat(phoneToggle.isAvailable()).isFalse();
+        assertThat(mediaToggle.isAvailable()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_bluetoothEnabled_togglesUpdated() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        QCActionItem btToggle = row.getEndItems().get(0);
+        QCActionItem phoneToggle = row.getEndItems().get(1);
+        QCActionItem mediaToggle = row.getEndItems().get(2);
+        assertThat(btToggle.isChecked()).isTrue();
+        assertThat(btToggle.isEnabled()).isTrue();
+        assertThat(phoneToggle.isChecked()).isTrue();
+        assertThat(phoneToggle.isEnabled()).isTrue();
+        assertThat(phoneToggle.isAvailable()).isTrue();
+        assertThat(mediaToggle.isChecked()).isTrue();
+        assertThat(mediaToggle.isEnabled()).isTrue();
+        assertThat(mediaToggle.isAvailable()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_isBusy_togglesDisabled() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ true,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        QCActionItem btToggle = row.getEndItems().get(0);
+        QCActionItem phoneToggle = row.getEndItems().get(1);
+        QCActionItem mediaToggle = row.getEndItems().get(2);
+        assertThat(btToggle.isEnabled()).isFalse();
+        assertThat(phoneToggle.isEnabled()).isFalse();
+        assertThat(mediaToggle.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_togglesDisabled() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_BLUETOOTH, /* restricted= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        QCActionItem btToggle = row.getEndItems().get(0);
+        QCActionItem phoneToggle = row.getEndItems().get(1);
+        QCActionItem mediaToggle = row.getEndItems().get(2);
+        assertThat(btToggle.isEnabled()).isTrue();
+        assertThat(phoneToggle.isEnabled()).isFalse();
+        assertThat(phoneToggle.isClickableWhileDisabled()).isFalse();
+        assertThat(mediaToggle.isEnabled()).isFalse();
+        assertThat(mediaToggle.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_togglesClickableWhileDisabled() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        setUserRestriction(UserManager.DISALLOW_CONFIG_BLUETOOTH, /* restricted= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        QCActionItem btToggle = row.getEndItems().get(0);
+        QCActionItem phoneToggle = row.getEndItems().get(1);
+        QCActionItem mediaToggle = row.getEndItems().get(2);
+        assertThat(btToggle.isEnabled()).isTrue();
+        assertThat(phoneToggle.isEnabled()).isFalse();
+        assertThat(phoneToggle.isClickableWhileDisabled()).isTrue();
+        assertThat(mediaToggle.isEnabled()).isFalse();
+        assertThat(mediaToggle.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_toggleBluetooth() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ false, /* busy= */ true,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        Intent intent = new Intent();
+        intent.putExtra(EXTRA_DEVICE_KEY, DEFAULT_ADDRESS);
+        intent.putExtra(EXTRA_BUTTON_TYPE, BLUETOOTH_BUTTON);
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mPairedBluetoothDevices.onNotifyChange(intent);
+        CachedBluetoothDevice device = mCachedDevices.get(0);
+        verify(device).connect();
+    }
+
+    @Test
+    public void onNotifyChange_togglePhone() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ false, /* busy= */ true,
+                /* phoneEnabled= */ false, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        Intent intent = new Intent();
+        intent.putExtra(EXTRA_DEVICE_KEY, DEFAULT_ADDRESS);
+        intent.putExtra(EXTRA_BUTTON_TYPE, PHONE_BUTTON);
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mPairedBluetoothDevices.onNotifyChange(intent);
+        CachedBluetoothDevice device = mCachedDevices.get(0);
+        LocalBluetoothProfile profile = getProfile(device, BluetoothProfile.HEADSET_CLIENT);
+        verify(profile).setEnabled(any(), eq(true));
+    }
+
+    @Test
+    public void onNotifyChange_toggleMedia() {
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ false, /* busy= */ true,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ false,
+                /* hasHumanReadableName= */ true);
+        Intent intent = new Intent();
+        intent.putExtra(EXTRA_DEVICE_KEY, DEFAULT_ADDRESS);
+        intent.putExtra(EXTRA_BUTTON_TYPE, MEDIA_BUTTON);
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mPairedBluetoothDevices.onNotifyChange(intent);
+        CachedBluetoothDevice device = mCachedDevices.get(0);
+        LocalBluetoothProfile profile = getProfile(device, BluetoothProfile.A2DP_SINK);
+        verify(profile).setEnabled(any(), eq(true));
+    }
+
+    @Test
+    public void getQCItem_createsItem_bluetoothDisabled_zoneWrite() {
+        when(mBluetoothAdapter.isEnabled()).thenReturn(false);
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("write");
+        QCItem item = mPairedBluetoothDevices.getQCItem();
+        assertThat(item).isNotNull();
+    }
+
+    @Test
+    public void getQCItem_createsItem_bluetoothDisabled_zoneRead() {
+        when(mBluetoothAdapter.isEnabled()).thenReturn(false);
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("read");
+        QCItem item = mPairedBluetoothDevices.getQCItem();
+        assertThat(item).isNotNull();
+    }
+
+    @Test
+    public void getQCItem_createsItem_bluetoothDisabled_zoneHidden() {
+        when(mBluetoothAdapter.isEnabled()).thenReturn(false);
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("hidden");
+        QCItem item = mPairedBluetoothDevices.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    @Test
+    public void getQCItem_createsItem_noDevices_zoneWrite() {
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("write");
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        assertThat(row.getStartIcon()).isNotNull();
+    }
+
+    @Test
+    public void getQCItem_createsItem_noDevices_zoneRead() {
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("read");
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list.getRows().size()).isEqualTo(1);
+        QCRow row = list.getRows().get(0);
+        assertThat(row.getStartIcon()).isNotNull();
+    }
+
+    @Test
+    public void getQCItem_createsItem_noDevices_zoneHidden() {
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("hidden");
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list).isNull();
+    }
+
+    @Test
+    public void getQCItem_createsToggles_bluetoothEnabled_zoneWrite() {
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("write");
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        QCActionItem btToggle = row.getEndItems().get(0);
+        QCActionItem phoneToggle = row.getEndItems().get(1);
+        QCActionItem mediaToggle = row.getEndItems().get(2);
+        assertThat(btToggle.isEnabled()).isTrue();
+        assertThat(phoneToggle.isEnabled()).isTrue();
+        assertThat(mediaToggle.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsToggles_bluetoothEnabled_zoneRead() {
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("read");
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        QCRow row = list.getRows().get(0);
+        QCActionItem btToggle = row.getEndItems().get(0);
+        QCActionItem phoneToggle = row.getEndItems().get(1);
+        QCActionItem mediaToggle = row.getEndItems().get(2);
+        assertThat(btToggle.isEnabled()).isFalse();
+        assertThat(phoneToggle.isEnabled()).isFalse();
+        assertThat(mediaToggle.isEnabled()).isFalse();
+        assertThat(btToggle.isClickableWhileDisabled()).isTrue();
+        assertThat(phoneToggle.isClickableWhileDisabled()).isTrue();
+        assertThat(mediaToggle.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsToggles_bluetoothEnabled_zoneHidden() {
+        mPairedBluetoothDevices.setAvailabilityStatusForZone("hidden");
+        addBluetoothDevice(DEFAULT_NAME, /* connected= */ true, /* busy= */ false,
+                /* phoneEnabled= */ true, /* mediaEnabled= */ true,
+                /* hasHumanReadableName= */ true);
+        QCList list = (QCList) mPairedBluetoothDevices.getQCItem();
+        assertThat(list).isNull();
+    }
+
+    private void addBluetoothDevice(String name, boolean connected, boolean busy,
+            boolean phoneEnabled, boolean mediaEnabled, boolean hasHumanReadableName) {
+        CachedBluetoothDevice cachedDevice = mock(CachedBluetoothDevice.class);
+        BluetoothDevice device = mock(BluetoothDevice.class);
+        when(cachedDevice.getDevice()).thenReturn(device);
+        when(device.getBondState()).thenReturn(BluetoothDevice.BOND_BONDED);
+        when(cachedDevice.getName()).thenReturn(name);
+        when(cachedDevice.getAddress()).thenReturn(DEFAULT_ADDRESS);
+        when(cachedDevice.isConnected()).thenReturn(connected);
+        when(cachedDevice.isBusy()).thenReturn(busy);
+        when(cachedDevice.getCarConnectionSummary(anyBoolean())).thenReturn(DEFAULT_SUMMARY);
+        when(cachedDevice.hasHumanReadableName()).thenReturn(hasHumanReadableName);
+        BluetoothClass btClass = mock(BluetoothClass.class);
+        when(cachedDevice.getBtClass()).thenReturn(btClass);
+        when(btClass.getMajorDeviceClass()).thenReturn(BluetoothClass.Device.Major.PHONE);
+        LocalBluetoothProfile phoneProfile = mock(LocalBluetoothProfile.class);
+        LocalBluetoothProfile mediaProfile = mock(LocalBluetoothProfile.class);
+        when(phoneProfile.getProfileId()).thenReturn(BluetoothProfile.HEADSET_CLIENT);
+        when(mediaProfile.getProfileId()).thenReturn(BluetoothProfile.A2DP_SINK);
+        when(phoneProfile.isEnabled(any())).thenReturn(phoneEnabled);
+        when(mediaProfile.isEnabled(any())).thenReturn(mediaEnabled);
+        when(cachedDevice.getProfiles()).thenReturn(Arrays.asList(phoneProfile, mediaProfile));
+        mCachedDevices.add(cachedDevice);
+        mBondedDevices.add(device);
+    }
+
+    private LocalBluetoothProfile getProfile(CachedBluetoothDevice device, int profileId) {
+        for (LocalBluetoothProfile profile : device.getProfiles()) {
+            if (profile.getProfileId() == profileId) {
+                return profile;
+            }
+        }
+        return null;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/PairedBluetoothDevicesWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/PairedBluetoothDevicesWorkerTest.java
new file mode 100644
index 000000000..cd51c07b2
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/PairedBluetoothDevicesWorkerTest.java
@@ -0,0 +1,82 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.content.Context;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.BluetoothEventManager;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class PairedBluetoothDevicesWorkerTest {
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private PairedBluetoothDevicesWorker mWorker;
+    private MockitoSession mSession;
+
+    @Mock
+    private LocalBluetoothManager mLocalBluetoothManager;
+    @Mock
+    private BluetoothEventManager mBluetoothEventManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                LocalBluetoothManager.class, withSettings().lenient()).startMocking();
+        when(LocalBluetoothManager.getInstance(any(), any())).thenReturn(mLocalBluetoothManager);
+        when(mLocalBluetoothManager.getEventManager()).thenReturn(mBluetoothEventManager);
+        mWorker = new PairedBluetoothDevicesWorker(mContext,
+                SettingsQCRegistry.PAIRED_BLUETOOTH_DEVICES_URI);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onSubscribe_registersReceiver() {
+        mWorker.onQCItemSubscribe();
+        verify(mBluetoothEventManager).registerCallback(mWorker);
+    }
+
+    @Test
+    public void onUnsubscribe_unregistersReceiver() {
+        mWorker.onQCItemSubscribe();
+        mWorker.onQCItemUnsubscribe();
+        verify(mBluetoothEventManager).unregisterCallback(mWorker);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/QCTestUtils.java b/tests/multivalent/src/com/android/car/settings/qc/QCTestUtils.java
new file mode 100644
index 000000000..62f1bd7af
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/QCTestUtils.java
@@ -0,0 +1,27 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import android.content.ContentResolver;
+import android.net.Uri;
+
+public class QCTestUtils {
+    public static final String AUTHORITY = "com.android.car.settings.test.unit";
+    public static final Uri URI = new Uri.Builder().scheme(ContentResolver.SCHEME_CONTENT)
+            .authority(AUTHORITY).appendPath("SettingsQCProviderTest")
+            .build();
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/SettingsQCBroadcastReceiverTest.java b/tests/multivalent/src/com/android/car/settings/qc/SettingsQCBroadcastReceiverTest.java
new file mode 100644
index 000000000..322b6a5e1
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/SettingsQCBroadcastReceiverTest.java
@@ -0,0 +1,61 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.content.Context;
+import android.content.Intent;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class SettingsQCBroadcastReceiverTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private SettingsQCBroadcastReceiver mReceiver;
+    private TestSettingsQCItem mQCItem;
+
+    @Before
+    public void setUp() {
+        SettingsQCRegistry.sUriToQC.clear();
+        SettingsQCRegistry.sUriToQC.put(QCTestUtils.URI, TestSettingsQCItem.class);
+        mReceiver = new TestSettingsQCBroadcastReceiver();
+        mQCItem = spy(new TestSettingsQCItem(mContext));
+    }
+
+    @Test
+    public void onReceive_notifiesChange() {
+        Intent intent = new Intent();
+        intent.setAction(QCTestUtils.URI.toString());
+        mReceiver.onReceive(mContext, intent);
+        verify(mQCItem).onNotifyChange(intent);
+    }
+
+    private class TestSettingsQCBroadcastReceiver extends SettingsQCBroadcastReceiver {
+        @Override
+        SettingsQCItem createQCItemInstance(Context context,
+                Class<? extends SettingsQCItem> qcItem) {
+            return mQCItem;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/SettingsQCProviderTest.java b/tests/multivalent/src/com/android/car/settings/qc/SettingsQCProviderTest.java
new file mode 100644
index 000000000..37d974ff3
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/SettingsQCProviderTest.java
@@ -0,0 +1,99 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.testng.Assert.assertThrows;
+
+import android.content.Context;
+import android.net.Uri;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class SettingsQCProviderTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private SettingsQCProvider mProvider;
+
+    @Before
+    public void setUp() {
+        SettingsQCRegistry.sUriToQC.clear();
+        SettingsQCRegistry.sUriToQC.put(QCTestUtils.URI, TestSettingsQCItem.class);
+        mProvider = new SettingsQCProvider();
+        ExtendedMockito.spyOn(mProvider);
+        ExtendedMockito.doReturn(mContext).when(mProvider).getContext();
+        ExtendedMockito.doReturn(mContext.getPackageName()).when(mProvider).getCallingPackage();
+    }
+
+    @Test
+    public void onCreate_allowlistSet() {
+        mProvider.onCreate();
+        Set<String> allowlist = mProvider.getAllowlistedPackages();
+        assertThat(allowlist.contains(QCTestUtils.AUTHORITY)).isTrue();
+    }
+
+    @Test
+    public void onBind_invalidUri_throwsException() {
+        mProvider.onCreate();
+        assertThrows(IllegalArgumentException.class,
+                () -> mProvider.onBind(Uri.EMPTY));
+    }
+
+    @Test
+    public void onBind_validUri_returnsQCItem() {
+        mProvider.onCreate();
+        assertThat(mProvider.onBind(QCTestUtils.URI)).isNotNull();
+    }
+
+    @Test
+    public void onSubscribe_startsBackgroundWorker() {
+        mProvider.onCreate();
+        mProvider.onSubscribed(QCTestUtils.URI);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        SettingsQCBackgroundWorker worker = mProvider.mSubscribedWorkers.get(QCTestUtils.URI);
+        assertThat(worker).isNotNull();
+        assertThat(worker instanceof TestSettingsQCBackgroundWorker).isTrue();
+        TestSettingsQCBackgroundWorker testWorker = (TestSettingsQCBackgroundWorker) worker;
+        assertThat(testWorker.isSubscribed()).isTrue();
+    }
+
+    @Test
+    public void onSubscribe_stopsBackgroundWorker() {
+        mProvider.onCreate();
+        mProvider.onSubscribed(QCTestUtils.URI);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        SettingsQCBackgroundWorker worker = mProvider.mSubscribedWorkers.get(QCTestUtils.URI);
+        assertThat(worker).isNotNull();
+        assertThat(worker instanceof TestSettingsQCBackgroundWorker).isTrue();
+        TestSettingsQCBackgroundWorker testWorker = (TestSettingsQCBackgroundWorker) worker;
+        mProvider.onUnsubscribed(QCTestUtils.URI);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(testWorker.isSubscribed()).isFalse();
+        assertThat(mProvider.mSubscribedWorkers.containsKey(QCTestUtils.URI)).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/SettingsQCRegistryTest.java b/tests/multivalent/src/com/android/car/settings/qc/SettingsQCRegistryTest.java
new file mode 100644
index 000000000..ee01de392
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/SettingsQCRegistryTest.java
@@ -0,0 +1,74 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.net.Uri;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class SettingsQCRegistryTest {
+    @Before
+    public void setUp() {
+        SettingsQCRegistry.sUriToQC.clear();
+        SettingsQCRegistry.sUriToQC.put(QCTestUtils.URI, TestSettingsQCItem.class);
+    }
+
+    @Test
+    public void getQCClassByUri_validUri_returnsClass() {
+        Class<? extends SettingsQCItem> clazz = SettingsQCRegistry.getQCClassByUri(QCTestUtils.URI);
+        assertThat(clazz).isNotNull();
+    }
+
+    @Test
+    public void getQCClassByUri_invalidUri_returnsNull() {
+        Class<? extends SettingsQCItem> clazz = SettingsQCRegistry.getQCClassByUri(Uri.EMPTY);
+        assertThat(clazz).isNull();
+    }
+
+    @Test
+    public void removeParameterFromUri_removesParameters() {
+        Uri uri = SettingsQCRegistry.removeParameterFromUri(QCTestUtils.URI);
+        assertThat(uri).isEqualTo(QCTestUtils.URI);
+    }
+
+    @Test
+    public void isValidUri_validUri_returnsTrue() {
+        assertThat(SettingsQCRegistry.isValidUri(QCTestUtils.URI)).isTrue();
+    }
+
+    @Test
+    public void isValidUri_invalidUri_returnsFalse() {
+        assertThat(SettingsQCRegistry.isValidUri(Uri.EMPTY)).isFalse();
+    }
+
+    @Test
+    public void isValidAction_validAction_returnsTrue() {
+        assertThat(SettingsQCRegistry.isValidAction(QCTestUtils.URI.toString())).isTrue();
+    }
+
+    @Test
+    public void isValidAction_invalidAction_returnsFalse() {
+        assertThat(SettingsQCRegistry.isValidAction(Uri.EMPTY.toString())).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/TestSettingsQCBackgroundWorker.java b/tests/multivalent/src/com/android/car/settings/qc/TestSettingsQCBackgroundWorker.java
new file mode 100644
index 000000000..f6bb8e46a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/TestSettingsQCBackgroundWorker.java
@@ -0,0 +1,49 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import android.content.Context;
+import android.net.Uri;
+
+import java.io.IOException;
+
+public class TestSettingsQCBackgroundWorker extends SettingsQCBackgroundWorker<TestSettingsQCItem> {
+
+    private boolean mIsSubscribed;
+
+    public TestSettingsQCBackgroundWorker(Context context, Uri uri) {
+        super(context, uri);
+    }
+
+    @Override
+    public void close() throws IOException {
+    }
+
+    @Override
+    protected void onQCItemSubscribe() {
+        mIsSubscribed = true;
+    }
+
+    @Override
+    protected void onQCItemUnsubscribe() {
+        mIsSubscribed = false;
+    }
+
+    boolean isSubscribed() {
+        return mIsSubscribed;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/TestSettingsQCItem.java b/tests/multivalent/src/com/android/car/settings/qc/TestSettingsQCItem.java
new file mode 100644
index 000000000..0e912a4f7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/TestSettingsQCItem.java
@@ -0,0 +1,45 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import android.content.Context;
+import android.net.Uri;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCTile;
+
+public class TestSettingsQCItem extends SettingsQCItem {
+
+    public TestSettingsQCItem(Context context) {
+        super(context);
+    }
+
+    @Override
+    QCItem getQCItem() {
+        return new QCTile.Builder().build();
+    }
+
+    @Override
+    Uri getUri() {
+        return QCTestUtils.URI;
+    }
+
+    @Override
+    Class<? extends SettingsQCBackgroundWorker> getBackgroundWorkerClass() {
+        return TestSettingsQCBackgroundWorker.class;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/VolumeSliderTestCase.java b/tests/multivalent/src/com/android/car/settings/qc/VolumeSliderTestCase.java
new file mode 100644
index 000000000..f69464891
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/VolumeSliderTestCase.java
@@ -0,0 +1,118 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static android.car.media.CarAudioManager.AUDIO_FEATURE_VOLUME_GROUP_MUTING;
+
+import static com.android.car.qc.QCItem.QC_ACTION_SLIDER_VALUE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.media.CarAudioManager;
+import android.content.Intent;
+
+import com.android.car.qc.QCRow;
+import com.android.car.qc.QCSlider;
+import com.android.car.settings.CarSettingsApplication;
+
+import org.junit.Before;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+public abstract class VolumeSliderTestCase extends BaseSettingsQCItemTestCase {
+    protected static final int GROUP_ID = 0;
+    protected static final int TEST_MIN_VOLUME = 0;
+    protected static final int TEST_VOLUME = 40;
+    protected static final int TEST_NEW_VOLUME = 80;
+    protected static final int TEST_MAX_VOLUME = 100;
+    protected static final int TEST_ZONE_ID = 1;
+
+    @Mock
+    private CarSettingsApplication mCarSettingsApplication;
+    @Mock
+    protected CarAudioManager mCarAudioManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getApplicationContext()).thenReturn(mCarSettingsApplication);
+
+        when(mCarSettingsApplication.getCarAudioManager()).thenReturn(mCarAudioManager);
+
+        when(mCarSettingsApplication.getMyAudioZoneId()).thenReturn(TEST_ZONE_ID);
+        when(mCarAudioManager.getVolumeGroupIdForUsage(eq(TEST_ZONE_ID), anyInt()))
+                .thenReturn(GROUP_ID);
+        when(mCarAudioManager.getGroupMinVolume(TEST_ZONE_ID, GROUP_ID))
+                .thenReturn(TEST_MIN_VOLUME);
+        when(mCarAudioManager.getGroupVolume(TEST_ZONE_ID, GROUP_ID))
+                .thenReturn(TEST_VOLUME);
+        when(mCarAudioManager.getGroupMaxVolume(TEST_ZONE_ID, GROUP_ID))
+                .thenReturn(TEST_MAX_VOLUME);
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_VOLUME_GROUP_MUTING)).thenReturn(
+                true);
+        when(mCarAudioManager.isVolumeGroupMuted(TEST_ZONE_ID, GROUP_ID)).thenReturn(false);
+    }
+
+    protected void verifyTitleSet(QCRow row, int titleResId) {
+        assertThat(row.getTitle()).isEqualTo(mContext.getString(titleResId));
+    }
+
+    protected void verifyIconSet(QCRow row, int iconResId) {
+        assertThat(row.getStartIcon().getResId()).isEqualTo(iconResId);
+    }
+
+    protected void verifyIconNotSet(QCRow row) {
+        assertThat(row.getStartIcon()).isNull();
+    }
+
+    protected void verifySliderCreated(QCRow row) {
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.getMin()).isEqualTo(TEST_MIN_VOLUME);
+        assertThat(slider.getMax()).isEqualTo(TEST_MAX_VOLUME);
+        assertThat(slider.getValue()).isEqualTo(TEST_VOLUME);
+    }
+
+    protected void verifyVolumeChanged(BaseVolumeSlider slider, int groupId) {
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_SLIDER_VALUE, TEST_NEW_VOLUME);
+        intent.putExtra(BaseVolumeSlider.EXTRA_GROUP_ID, groupId);
+        slider.onNotifyChange(intent);
+        verify(mCarAudioManager).setGroupVolume(
+                eq(TEST_ZONE_ID), eq(groupId), eq(TEST_NEW_VOLUME), anyInt());
+    }
+
+    protected void verifyBaseUmRestriction(QCRow row) {
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.isEnabled()).isFalse();
+        assertThat(slider.isClickableWhileDisabled()).isFalse();
+    }
+
+    protected void verifyUmRestriction(QCRow row) {
+        QCSlider slider = row.getSlider();
+        assertThat(slider).isNotNull();
+        assertThat(slider.isEnabled()).isFalse();
+        assertThat(slider.isClickableWhileDisabled()).isTrue();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/WifiBaseWorkerTestCase.java b/tests/multivalent/src/com/android/car/settings/qc/WifiBaseWorkerTestCase.java
new file mode 100644
index 000000000..6d131ea3b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/WifiBaseWorkerTestCase.java
@@ -0,0 +1,71 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+
+import org.junit.Before;
+import org.junit.Test;
+
+import java.io.IOException;
+
+public abstract class WifiBaseWorkerTestCase<E extends WifiBaseWorker> {
+    protected final Context mContext = ApplicationProvider.getApplicationContext();
+    private E mWorker;
+
+    protected abstract E getWorker();
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mWorker = getWorker();
+    }
+
+    @Test
+    public void onCreate_lifecycleCreated() {
+        assertThat(mWorker.getLifecycle().getCurrentState()).isEqualTo(Lifecycle.State.CREATED);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onSubscribe_lifecycleResumed() {
+        mWorker.onQCItemSubscribe();
+        assertThat(mWorker.getLifecycle().getCurrentState()).isEqualTo(Lifecycle.State.RESUMED);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onUnsubscribe_lifecycleCreated() {
+        mWorker.onQCItemSubscribe();
+        mWorker.onQCItemUnsubscribe();
+        assertThat(mWorker.getLifecycle().getCurrentState()).isEqualTo(Lifecycle.State.CREATED);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onClose_lifecycleDestroyed() throws IOException {
+        mWorker.onQCItemSubscribe();
+        mWorker.close();
+        assertThat(mWorker.getLifecycle().getCurrentState()).isEqualTo(Lifecycle.State.DESTROYED);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/WifiRowTest.java b/tests/multivalent/src/com/android/car/settings/qc/WifiRowTest.java
new file mode 100644
index 000000000..a571f50bc
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/WifiRowTest.java
@@ -0,0 +1,285 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Intent;
+import android.net.wifi.WifiInfo;
+import android.net.wifi.WifiManager;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCActionItem;
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCList;
+import com.android.car.qc.QCRow;
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiRowTest extends BaseSettingsQCItemTestCase {
+    private WifiRow mWifiRow;
+
+    @Mock
+    private WifiManager mWifiManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mWifiManager);
+
+        mWifiRow = new WifiRow(mContext);
+    }
+
+    @Test
+    public void getQCItem_setsTitle() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        QCRow row = getWifiRow();
+        assertThat(row.getTitle()).isEqualTo(mContext.getString(R.string.wifi_settings));
+    }
+
+    @Test
+    public void getQCItem_wifiDisabled_returnsRow() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(mContext.getString(R.string.wifi_disabled));
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_disabled);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_wifiNotConnected_returnsRow() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(WifiManager.UNKNOWN_SSID);
+        when(wifiInfo.getNetworkId()).thenReturn(-1);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(mContext.getString(R.string.wifi_disconnected));
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_disconnected);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_wifiConnected_returnsRow() {
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(testSSID);
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_passpointWifiConnected_hasFriendlyName_returnsRow() {
+        String testTitle = "TEST_TITLE";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isPasspointAp()).thenReturn(true);
+        when(wifiInfo.getPasspointProviderFriendlyName()).thenReturn(testTitle);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(testTitle);
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_passpointWifiConnected_noFriendlyName_returnsRow() {
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isPasspointAp()).thenReturn(true);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(testSSID);
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_osuWifiConnected_hasFriendlyName_returnsRow() {
+        String testTitle = "TEST_TITLE";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isOsuAp()).thenReturn(true);
+        when(wifiInfo.getPasspointProviderFriendlyName()).thenReturn(testTitle);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(testTitle);
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_osuWifiConnected_noFriendlyName_returnsRow() {
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isOsuAp()).thenReturn(true);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(testSSID);
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isChecked()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_switchDisabled() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_WIFI, /* restricted= */ true);
+        QCRow row = getWifiRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_switchClickableWhileDisabled() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        setUserRestriction(UserManager.DISALLOW_CONFIG_WIFI, /* restricted= */ true);
+        QCRow row = getWifiRow();
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_togglesWifi() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mWifiRow.onNotifyChange(intent);
+        verify(mWifiManager).setWifiEnabled(true);
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneWrite() {
+        mWifiRow.setAvailabilityStatusForZone("write");
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(testSSID);
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneRead() {
+        mWifiRow.setAvailabilityStatusForZone("read");
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCRow row = getWifiRow();
+        assertThat(row.getSubtitle()).isEqualTo(testSSID);
+        assertThat(row.getStartIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        QCActionItem actionItem = row.getEndItems().get(0);
+        assertThat(actionItem.isEnabled()).isFalse();
+        assertThat(actionItem.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsRow_zoneHidden() {
+        mWifiRow.setAvailabilityStatusForZone("hidden");
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCItem item = mWifiRow.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    private QCRow getWifiRow() {
+        QCItem item = mWifiRow.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCList).isTrue();
+        QCList list = (QCList) item;
+        assertThat(list.getRows().size()).isEqualTo(1);
+        return list.getRows().get(0);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/WifiRowWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/WifiRowWorkerTest.java
new file mode 100644
index 000000000..1a3047a68
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/WifiRowWorkerTest.java
@@ -0,0 +1,29 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiRowWorkerTest extends WifiBaseWorkerTestCase<WifiRowWorker> {
+    @Override
+    protected WifiRowWorker getWorker() {
+        return new WifiRowWorker(mContext, SettingsQCRegistry.WIFI_ROW_URI);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/WifiTileTest.java b/tests/multivalent/src/com/android/car/settings/qc/WifiTileTest.java
new file mode 100644
index 000000000..7659a75d7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/WifiTileTest.java
@@ -0,0 +1,258 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import static com.android.car.qc.QCItem.QC_ACTION_TOGGLE_STATE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Intent;
+import android.net.wifi.WifiInfo;
+import android.net.wifi.WifiManager;
+import android.os.UserManager;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.qc.QCItem;
+import com.android.car.qc.QCTile;
+import com.android.car.settings.R;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiTileTest extends BaseSettingsQCItemTestCase {
+    private WifiTile mWifiTile;
+
+    @Mock
+    private WifiManager mWifiManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mWifiManager);
+
+        mWifiTile = new WifiTile(mContext);
+    }
+
+    @Test
+    public void getQCItem_wifiDisabled_returnsTile() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        QCTile tile = getWifiTile();
+        assertThat(tile.getIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_disabled);
+        assertThat(tile.isChecked()).isFalse();
+        assertThat(tile.getSubtitle()).isEqualTo(mContext.getString(R.string.wifi_disabled));
+    }
+
+    @Test
+    public void getQCItem_wifiNotConnected_returnsTile() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(WifiManager.UNKNOWN_SSID);
+        when(wifiInfo.getNetworkId()).thenReturn(-1);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        QCTile tile = getWifiTile();
+        assertThat(tile.getIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_disconnected);
+        assertThat(tile.isChecked()).isTrue();
+        assertThat(tile.getSubtitle()).isEqualTo(mContext.getString(R.string.wifi_disconnected));
+    }
+
+    @Test
+    public void getQCItem_wifiConnected_returnsTile() {
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCTile tile = getWifiTile();
+        assertThat(tile.getIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        assertThat(tile.isChecked()).isTrue();
+        assertThat(tile.getSubtitle()).isEqualTo(testSSID);
+    }
+
+    @Test
+    public void getQCItem_passpointWifiConnected_hasFriendlyName_returnsTile() {
+        String testTitle = "TEST_TITLE";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isPasspointAp()).thenReturn(true);
+        when(wifiInfo.getPasspointProviderFriendlyName()).thenReturn(testTitle);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCTile tile = getWifiTile();
+        assertThat(tile.getIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        assertThat(tile.isChecked()).isTrue();
+        assertThat(tile.getSubtitle()).isEqualTo(testTitle);
+    }
+
+    @Test
+    public void getQCItem_passpointWifiConnected_noFriendlyName_returnsRow() {
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isPasspointAp()).thenReturn(true);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCTile tile = getWifiTile();
+        assertThat(tile.getIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        assertThat(tile.isChecked()).isTrue();
+        assertThat(tile.getSubtitle()).isEqualTo(testSSID);
+    }
+
+    @Test
+    public void getQCItem_osuWifiConnected_hasFriendlyName_returnsTile() {
+        String testTitle = "TEST_TITLE";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isOsuAp()).thenReturn(true);
+        when(wifiInfo.getPasspointProviderFriendlyName()).thenReturn(testTitle);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCTile tile = getWifiTile();
+        assertThat(tile.getIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        assertThat(tile.isChecked()).isTrue();
+        assertThat(tile.getSubtitle()).isEqualTo(testTitle);
+    }
+
+    @Test
+    public void getQCItem_osuWifiConnected_noFriendlyName_returnsTile() {
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.isOsuAp()).thenReturn(true);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCTile tile = getWifiTile();
+        assertThat(tile.getIcon().getResId()).isEqualTo(R.drawable.ic_qc_wifi_level_4);
+        assertThat(tile.isChecked()).isTrue();
+        assertThat(tile.getSubtitle()).isEqualTo(testSSID);
+    }
+
+    @Test
+    public void getQCItem_hasBaseUmRestriction_tileDisabled() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        setBaseUserRestriction(UserManager.DISALLOW_CONFIG_WIFI, /* restricted= */ true);
+        QCTile tile = getWifiTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isFalse();
+    }
+
+    @Test
+    public void getQCItem_hasUmRestriction_tileClickableWhileDisabled() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        setUserRestriction(UserManager.DISALLOW_CONFIG_WIFI, /* restricted= */ true);
+        QCTile tile = getWifiTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void onNotifyChange_togglesWifi() {
+        when(mWifiManager.isWifiEnabled()).thenReturn(false);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_DISABLED);
+        Intent intent = new Intent();
+        intent.putExtra(QC_ACTION_TOGGLE_STATE, true);
+        mWifiTile.onNotifyChange(intent);
+        verify(mWifiManager).setWifiEnabled(true);
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneWrite() {
+        mWifiTile.setAvailabilityStatusForZone("write");
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCTile tile = getWifiTile();
+        assertThat(tile.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneRead() {
+        mWifiTile.setAvailabilityStatusForZone("read");
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCTile tile = getWifiTile();
+        assertThat(tile.isEnabled()).isFalse();
+        assertThat(tile.isClickableWhileDisabled()).isTrue();
+    }
+
+    @Test
+    public void getQCItem_createsTile_zoneHidden() {
+        mWifiTile.setAvailabilityStatusForZone("hidden");
+        String testSSID = "TEST_SSID";
+        when(mWifiManager.isWifiEnabled()).thenReturn(true);
+        when(mWifiManager.getWifiState()).thenReturn(WifiManager.WIFI_STATE_ENABLED);
+        WifiInfo wifiInfo = mock(WifiInfo.class);
+        when(wifiInfo.getSSID()).thenReturn(testSSID);
+        when(wifiInfo.getNetworkId()).thenReturn(1);
+        when(wifiInfo.getRssi()).thenReturn(-90);
+        when(mWifiManager.getConnectionInfo()).thenReturn(wifiInfo);
+        when(mWifiManager.calculateSignalLevel(anyInt())).thenReturn(4);
+        QCItem item = mWifiTile.getQCItem();
+        assertThat(item).isNull();
+    }
+
+    private QCTile getWifiTile() {
+        QCItem item = mWifiTile.getQCItem();
+        assertThat(item).isNotNull();
+        assertThat(item instanceof QCTile).isTrue();
+        return (QCTile) item;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/qc/WifiTileWorkerTest.java b/tests/multivalent/src/com/android/car/settings/qc/WifiTileWorkerTest.java
new file mode 100644
index 000000000..0bf8c4afd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/qc/WifiTileWorkerTest.java
@@ -0,0 +1,29 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.qc;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiTileWorkerTest extends WifiBaseWorkerTestCase<WifiTileWorker> {
+    @Override
+    protected WifiTileWorker getWorker() {
+        return new WifiTileWorker(mContext, SettingsQCRegistry.WIFI_TILE_URI);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/search/CarSettingsSearchIndexablesProviderTest.java b/tests/multivalent/src/com/android/car/settings/search/CarSettingsSearchIndexablesProviderTest.java
new file mode 100644
index 000000000..f86737683
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/search/CarSettingsSearchIndexablesProviderTest.java
@@ -0,0 +1,405 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.search;
+
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_NON_INDEXABLE_KEYS_KEY_VALUE;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_CLASS_NAME;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_ENTRIES;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_ICON_RESID;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_INTENT_ACTION;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_INTENT_TARGET_CLASS;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_INTENT_TARGET_PACKAGE;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_KEY;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_KEYWORDS;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_SCREEN_TITLE;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_SUMMARY_OFF;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_SUMMARY_ON;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_TITLE;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_RAW_USER_ID;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_XML_RES_CLASS_NAME;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_XML_RES_ICON_RESID;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_XML_RES_INTENT_ACTION;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_XML_RES_INTENT_TARGET_CLASS;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_XML_RES_INTENT_TARGET_PACKAGE;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_XML_RES_RANK;
+import static android.provider.SearchIndexablesContract.COLUMN_INDEX_XML_RES_RESID;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.database.Cursor;
+import android.provider.SearchIndexableResource;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.search.Indexable;
+import com.android.settingslib.search.SearchIndexableData;
+import com.android.settingslib.search.SearchIndexableRaw;
+import com.android.settingslib.search.SearchIndexableResources;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.Collection;
+import java.util.Collections;
+import java.util.HashSet;
+import java.util.List;
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class CarSettingsSearchIndexablesProviderTest {
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+
+    private CarSettingsSearchIndexablesProvider mProvider;
+    private SearchIndexableResources mSearchIndexableResources;
+
+    @Before
+    public void setup() {
+        mSearchIndexableResources = new SearchIndexableResources() {
+            Set<SearchIndexableData> mValues = new HashSet<>();
+
+            @Override
+            public Collection<SearchIndexableData> getProviderValues() {
+                return mValues;
+            }
+
+            @Override
+            public void addIndex(SearchIndexableData indexBundle) {
+                mValues.add(indexBundle);
+            }
+        };
+
+        mProvider = new CarSettingsSearchIndexablesProvider();
+        mProvider.setResources(mSearchIndexableResources);
+    }
+
+    @Test
+    public void queryXmlResources_onEmptyResources_returnsEmptyList() {
+        assertThat(mProvider.queryXmlResources(null).getCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void queryXmlResources_fillsColumns() {
+        SearchIndexableResource res = makeResource(/* seed= */ 50);
+
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setResources(Collections.singletonList(res));
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class,
+                        provider));
+
+        Cursor c = mProvider.queryXmlResources(null);
+
+        assertThat(c.getCount()).isEqualTo(1);
+
+        c.moveToFirst();
+
+        assertEqual(c, res);
+    }
+
+    @Test
+    public void queryXmlResources_returnsAllRows() {
+        List<SearchIndexableResource> resources = List.of(makeResource(/* seed= */ 1),
+                makeResource(/* seed= */ 2),
+                makeResource(/* seed= */ 3));
+
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setResources(resources);
+
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class,
+                        provider));
+
+        Cursor c = mProvider.queryXmlResources(null);
+
+        assertThat(c.getCount()).isEqualTo(resources.size());
+
+        int i = 0;
+        while (c.moveToNext()) {
+            assertEqual(c, resources.get(i++));
+        }
+    }
+
+    @Test
+    public void queryXmlResources_onPartiallyFilledFields_returnsPartialRows() {
+        SearchIndexableResource res = makeResource(/* seed= */ 100);
+        res.intentTargetPackage = null;
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setResources(Collections.singletonList(res));
+
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class,
+                        provider));
+
+
+        Cursor c = mProvider.queryXmlResources(null);
+
+        assertThat(c.getCount()).isEqualTo(1);
+
+        c.moveToFirst();
+
+        assertEqual(c, res);
+    }
+
+    @Test
+    public void queryXmlResources_onNullResources_returnsEmptyList() {
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class,
+                        new TestSearchIndexProvider()));
+
+        assertThat(mProvider.queryXmlResources(null).getCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void queryRawData_fillsColumns() {
+        SearchIndexableRaw rawData = makeRawData(/* seed= */ 99);
+
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setRawData(Collections.singletonList(rawData));
+
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class, provider));
+
+        Cursor c = mProvider.queryRawData(null);
+
+        assertThat(c.getCount()).isEqualTo(1);
+
+        c.moveToFirst();
+
+        assertEqual(c, rawData);
+    }
+
+    @Test
+    public void queryRawData_returnsAllRows() {
+        List<SearchIndexableRaw> rawData = List.of(makeRawData(/* seed= */ 1),
+                makeRawData(/* seed= */ 2), makeRawData(/* seed= */ 3));
+
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setRawData(rawData);
+
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class, provider));
+
+        Cursor c = mProvider.queryRawData(null);
+
+        assertThat(c.getCount()).isEqualTo(rawData.size());
+        int i = 0;
+
+        while (c.moveToNext()) {
+            assertEqual(c, rawData.get(i++));
+        }
+    }
+
+    @Test
+    public void queryRawData_onPartiallyFilledFields_returnsPartialRows() {
+        SearchIndexableRaw rawData = makeRawData(/* seed= */ 99);
+        rawData.className = null;
+        rawData.keywords = null;
+
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setRawData(Collections.singletonList(rawData));
+
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class, provider));
+
+        Cursor c = mProvider.queryRawData(null);
+
+        assertThat(c.getCount()).isEqualTo(1);
+
+        c.moveToFirst();
+
+        assertEqual(c, rawData);
+    }
+
+    @Test
+    public void queryRawData_onEmptyResources_returnsEmpty() {
+        assertThat(mProvider.queryRawData(null).getCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void queryRawData_onNullRawDataList_returnsEmptyList() {
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class,
+                        new TestSearchIndexProvider()));
+
+        assertThat(mProvider.queryRawData(null).getCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void queryNonIndexableKeys_fillsColumns() {
+        String key = "key1";
+
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setNonIndexableKeys(Collections.singletonList(key));
+
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class, provider));
+
+        Cursor c = mProvider.queryNonIndexableKeys(null);
+
+        assertThat(c.getCount()).isEqualTo(1);
+
+        c.moveToFirst();
+
+        assertThat(c.getString(COLUMN_INDEX_NON_INDEXABLE_KEYS_KEY_VALUE)).isEqualTo(key);
+    }
+
+    @Test
+    public void queryNonIndexableKeys_returnsAllRows() {
+        List<String> keys = List.of("key1", "key2", "key3");
+
+        TestSearchIndexProvider provider = new TestSearchIndexProvider();
+        provider.setNonIndexableKeys(keys);
+
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class, provider));
+
+        Cursor c = mProvider.queryNonIndexableKeys(null);
+
+        assertThat(c.getCount()).isEqualTo(keys.size());
+        int i = 0;
+
+        while (c.moveToNext()) {
+            assertThat(c.getString(COLUMN_INDEX_NON_INDEXABLE_KEYS_KEY_VALUE)).isEqualTo(
+                    keys.get(i++));
+        }
+    }
+
+    @Test
+    public void queryNonIndexableKeys_onEmptyResources_returnsEmpty() {
+        assertThat(mProvider.queryNonIndexableKeys(null).getCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void queryNonIndexableKeys_onNullNonIndexableKeysList_returnsEmptyList() {
+        mSearchIndexableResources.addIndex(
+                new SearchIndexableData(TestSearchIndexProvider.class,
+                        new TestSearchIndexProvider()));
+
+        assertThat(mProvider.queryNonIndexableKeys(null).getCount()).isEqualTo(0);
+    }
+
+    private SearchIndexableResource makeResource(int seed) {
+        int rank = seed;
+        int resId = seed + 1;
+        String className = seed + "className";
+        int iconResId = seed + 2;
+        String action = seed + "action";
+        String intentPackage = seed + "package";
+        String intentClass = seed + "class";
+
+        SearchIndexableResource resource = new SearchIndexableResource(rank, resId, className,
+                iconResId);
+        resource.intentAction = action;
+        resource.intentTargetPackage = intentPackage;
+        resource.intentTargetClass = intentClass;
+
+        return resource;
+    }
+
+    private void assertEqual(Cursor c, SearchIndexableResource res) {
+        assertThat(c.getInt(COLUMN_INDEX_XML_RES_RANK)).isEqualTo(res.rank);
+        assertThat(c.getInt(COLUMN_INDEX_XML_RES_RESID)).isEqualTo(res.xmlResId);
+        assertThat(c.getString(COLUMN_INDEX_XML_RES_CLASS_NAME)).isEqualTo(res.className);
+        assertThat(c.getInt(COLUMN_INDEX_XML_RES_ICON_RESID)).isEqualTo(res.iconResId);
+        assertThat(c.getString(COLUMN_INDEX_XML_RES_INTENT_ACTION)).isEqualTo(res.intentAction);
+        assertThat(c.getString(COLUMN_INDEX_XML_RES_INTENT_TARGET_PACKAGE)).isEqualTo(
+                res.intentTargetPackage);
+        assertThat(c.getString(COLUMN_INDEX_XML_RES_INTENT_TARGET_CLASS)).isEqualTo(
+                res.intentTargetClass);
+    }
+
+    private SearchIndexableRaw makeRawData(int seed) {
+        SearchIndexableRaw rawData = new SearchIndexableRaw(mContext);
+        rawData.title = seed + "title";
+        rawData.summaryOn = seed + "summaryOn";
+        rawData.summaryOff = seed + "summaryOff";
+        rawData.entries = seed + "entries";
+        rawData.keywords = seed + "keywords";
+        rawData.screenTitle = seed + "screenTitle";
+        rawData.className = seed + "className";
+        rawData.iconResId = seed;
+        rawData.intentAction = seed + "intentAction";
+        rawData.intentTargetPackage = seed + "intentTargetPackage";
+        rawData.intentTargetClass = seed + "intentTargetClass";
+        rawData.key = seed + "key";
+        rawData.userId = seed + 1;
+        return rawData;
+    }
+
+    private void assertEqual(Cursor c, SearchIndexableRaw raw) {
+        assertThat(c.getString(COLUMN_INDEX_RAW_TITLE)).isEqualTo(raw.title);
+        assertThat(c.getString(COLUMN_INDEX_RAW_SUMMARY_ON)).isEqualTo(raw.summaryOn);
+        assertThat(c.getString(COLUMN_INDEX_RAW_SUMMARY_OFF)).isEqualTo(raw.summaryOff);
+        assertThat(c.getString(COLUMN_INDEX_RAW_ENTRIES)).isEqualTo(raw.entries);
+        assertThat(c.getString(COLUMN_INDEX_RAW_KEYWORDS)).isEqualTo(raw.keywords);
+        assertThat(c.getString(COLUMN_INDEX_RAW_SCREEN_TITLE)).isEqualTo(raw.screenTitle);
+        assertThat(c.getString(COLUMN_INDEX_RAW_CLASS_NAME)).isEqualTo(raw.className);
+        assertThat(c.getInt(COLUMN_INDEX_RAW_ICON_RESID)).isEqualTo(raw.iconResId);
+        assertThat(c.getString(COLUMN_INDEX_RAW_INTENT_ACTION)).isEqualTo(raw.intentAction);
+        assertThat(c.getString(COLUMN_INDEX_RAW_INTENT_TARGET_PACKAGE)).isEqualTo(
+                raw.intentTargetPackage);
+        assertThat(c.getString(COLUMN_INDEX_RAW_INTENT_TARGET_CLASS)).isEqualTo(
+                raw.intentTargetClass);
+        assertThat(c.getString(COLUMN_INDEX_RAW_KEY)).isEqualTo(raw.key);
+        assertThat(c.getInt(COLUMN_INDEX_RAW_USER_ID)).isEqualTo(raw.userId);
+    }
+
+    private static class TestSearchIndexProvider implements Indexable.SearchIndexProvider {
+        private List<SearchIndexableResource> mResources;
+        private List<SearchIndexableRaw> mRawData;
+        private List<String> mNonIndexableKeys;
+
+        TestSearchIndexProvider() {
+        }
+
+        @Override
+        public List<SearchIndexableResource> getXmlResourcesToIndex(Context context,
+                boolean enabled) {
+            return mResources;
+        }
+
+        @Override
+        public List<SearchIndexableRaw> getRawDataToIndex(Context context, boolean enabled) {
+            return mRawData;
+        }
+
+        @Override
+        public List<SearchIndexableRaw> getDynamicRawDataToIndex(Context context, boolean enabled) {
+            return mRawData;
+        }
+
+        @Override
+        public List<String> getNonIndexableKeys(Context context) {
+            return mNonIndexableKeys;
+        }
+
+        void setResources(List<SearchIndexableResource> resources) {
+            mResources = resources;
+        }
+
+        void setRawData(List<SearchIndexableRaw> rawData) {
+            mRawData = rawData;
+        }
+
+        void setNonIndexableKeys(List<String> nonIndexableKeys) {
+            mNonIndexableKeys = nonIndexableKeys;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/ChooseLockPatternFragmentTest.java b/tests/multivalent/src/com/android/car/settings/security/ChooseLockPatternFragmentTest.java
new file mode 100644
index 000000000..7876d03b9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/ChooseLockPatternFragmentTest.java
@@ -0,0 +1,97 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoAnnotations;
+
+/**
+ * Tests for ChooseLockPatternFragment class.
+ */
+@RunWith(AndroidJUnit4.class)
+public class ChooseLockPatternFragmentTest {
+    private ChooseLockPatternFragment mFragment;
+    private FragmentManager mFragmentManager;
+
+    @Rule
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+    }
+
+    /**
+     * A test to verify that onComplete is called when save worker succeeds
+     */
+    @Test
+    public void testOnCompleteIsCalledWhenSaveWorkerSucceeds() {
+        ChooseLockPatternFragment spyFragment = spy(mFragment);
+        doNothing().when(spyFragment).onComplete();
+
+        spyFragment.onChosenLockSaveFinished(true);
+
+        verify(spyFragment).onComplete();
+    }
+
+    /**
+     * A test to verify that the UI stage is updated when save worker fails
+     */
+    @Test
+    public void testStageIsUpdatedWhenSaveWorkerFails() {
+        ChooseLockPatternFragment spyFragment = spy(mFragment);
+        doNothing().when(spyFragment).updateStage(ChooseLockPatternFragment.Stage.SaveFailure);
+
+        spyFragment.onChosenLockSaveFinished(false);
+
+        verify(spyFragment, never()).onComplete();
+        verify(spyFragment).updateStage(ChooseLockPatternFragment.Stage.SaveFailure);
+    }
+
+    private void setUpFragment() throws Throwable {
+        String chooseLockPatternFragmentTag = "choose_lock_pattern_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(
+                            R.id.fragment_container, new ChooseLockPatternFragment(),
+                            chooseLockPatternFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (ChooseLockPatternFragment) mFragmentManager
+                .findFragmentByTag(chooseLockPatternFragmentTag);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/ChooseLockPinPasswordFragmentTest.java b/tests/multivalent/src/com/android/car/settings/security/ChooseLockPinPasswordFragmentTest.java
new file mode 100644
index 000000000..a12ab8189
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/ChooseLockPinPasswordFragmentTest.java
@@ -0,0 +1,162 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+/**
+ * Tests for ChooseLockPinPasswordFragment class.
+ */
+@RunWith(AndroidJUnit4.class)
+public class ChooseLockPinPasswordFragmentTest {
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private ChooseLockPinPasswordFragment mFragment;
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    PasswordHelper mMockPasswordHelper;
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+    @Rule
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
+
+    @Before
+    public void setUp() {
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        when(mMockPasswordHelper.getCredentialValidationErrorMessages()).thenReturn("");
+    }
+
+    /**
+     * A test to verify that onComplete is called is finished when save worker succeeds
+     */
+    @Test
+    public void testOnCompleteIsCalledWhenSaveWorkerSucceeds() throws Throwable {
+        setUpFragment(/* isPin= */ true);
+        ChooseLockPinPasswordFragment spyFragment = spy(mFragment);
+        doNothing().when(spyFragment).onComplete();
+
+        spyFragment.onChosenLockSaveFinished(true);
+
+        verify(spyFragment).onComplete();
+    }
+
+    /**
+     * A test to verify that the UI stage is updated when save worker fails
+     */
+    @Test
+    public void testStageIsUpdatedWhenSaveWorkerFails() throws Throwable {
+        setUpFragment(/* isPin= */ true);
+        ChooseLockPinPasswordFragment spyFragment = spy(mFragment);
+        doNothing().when(spyFragment).updateStage(ChooseLockPinPasswordFragment.Stage.SaveFailure);
+
+        spyFragment.onChosenLockSaveFinished(false);
+
+        verify(spyFragment, never()).onComplete();
+        verify(spyFragment).updateStage(ChooseLockPinPasswordFragment.Stage.SaveFailure);
+    }
+
+    @Test
+    @UiThreadTest
+    public void pin_saveFailure_hintSet() throws Throwable {
+        setUpFragment(/* isPin= */ true);
+        ChooseLockPinPasswordFragment spyFragment = spy(mFragment);
+
+        spyFragment.updateStage(ChooseLockPinPasswordFragment.Stage.SaveFailure);
+
+        assertThat(spyFragment.getHintText()).isEqualTo(
+                mContext.getString(R.string.error_saving_lockpin));
+    }
+
+    @Test
+    @UiThreadTest
+    public void pin_confirmWrong_hintSet() throws Throwable {
+        setUpFragment(/* isPin= */ true);
+        ChooseLockPinPasswordFragment spyFragment = spy(mFragment);
+
+        spyFragment.updateStage(ChooseLockPinPasswordFragment.Stage.ConfirmWrong);
+
+        assertThat(spyFragment.getHintText()).isEqualTo(
+                mContext.getString(R.string.confirm_pins_dont_match));
+    }
+
+    @Test
+    @UiThreadTest
+    public void password_saveFailure_hintSet() throws Throwable {
+        setUpFragment(/* isPin= */ false);
+        ChooseLockPinPasswordFragment spyFragment = spy(mFragment);
+
+        spyFragment.updateStage(ChooseLockPinPasswordFragment.Stage.SaveFailure);
+
+        assertThat(spyFragment.getHintText()).isEqualTo(
+                mContext.getString(R.string.error_saving_password));
+    }
+
+    @Test
+    @UiThreadTest
+    public void password_confirmWrong_hintSet() throws Throwable {
+        setUpFragment(/* isPin= */ false);
+        ChooseLockPinPasswordFragment spyFragment = spy(mFragment);
+
+        spyFragment.updateStage(ChooseLockPinPasswordFragment.Stage.ConfirmWrong);
+
+        assertThat(spyFragment.getHintText()).isEqualTo(
+                mContext.getString(R.string.confirm_passwords_dont_match));
+    }
+
+    private void setUpFragment(boolean isPin) throws Throwable {
+        String chooseLockPinPasswordFragmentTag = "choose_lock_pin_password_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(
+                            R.id.fragment_container, isPin
+                                    ? ChooseLockPinPasswordFragment.newPinInstance()
+                                    : ChooseLockPinPasswordFragment.newPasswordInstance(),
+                            chooseLockPinPasswordFragmentTag)
+                    .commitNow();
+        });
+        mFragment = (ChooseLockPinPasswordFragment) mFragmentManager
+                .findFragmentByTag(chooseLockPinPasswordFragmentTag);
+        mFragment.setPasswordHelper(mMockPasswordHelper);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/ChooseLockTypePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/security/ChooseLockTypePreferenceControllerTest.java
new file mode 100644
index 000000000..08570116b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/ChooseLockTypePreferenceControllerTest.java
@@ -0,0 +1,283 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.security.ChooseLockTypePreferenceController.LOCK_CHECK;
+import static com.android.internal.widget.LockPatternUtils.CREDENTIAL_TYPE_NONE;
+import static com.android.internal.widget.LockPatternUtils.CREDENTIAL_TYPE_PASSWORD;
+import static com.android.internal.widget.LockPatternUtils.CREDENTIAL_TYPE_PATTERN;
+import static com.android.internal.widget.LockPatternUtils.CREDENTIAL_TYPE_PIN;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.Activity;
+import android.app.admin.DevicePolicyManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+
+import androidx.fragment.app.Fragment;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionTextPreference;
+import com.android.internal.widget.LockPatternUtils;
+import com.android.internal.widget.LockscreenCredential;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ChooseLockTypePreferenceControllerTest {
+
+    private static final LockscreenCredential TEST_LOCKSCREEN_CREDENTIAL =
+            LockscreenCredential.createPin("1234");
+    private static final int TEST_PASSWORD_QUALITY = DevicePolicyManager.PASSWORD_QUALITY_NUMERIC;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private ChooseLockTypePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mUserManager;
+    @Mock
+    private LockPatternUtils mLockPatternUtils;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiTwoActionTextPreference(mContext);
+        mPreferenceController = new ChooseLockTypePreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions, mUserManager,
+                mLockPatternUtils);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        when(mUserManager.isGuestUser()).thenReturn(false);
+        when(mLockPatternUtils.getCredentialTypeForUser(anyInt())).thenReturn(CREDENTIAL_TYPE_NONE);
+    }
+
+    @Test
+    public void preferenceClicked_screenLockActivityLaunched() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        ArgumentCaptor<Intent> intentArgumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mFragmentController).startActivityForResult(intentArgumentCaptor.capture(),
+                eq(LOCK_CHECK), any());
+
+        Intent intent = intentArgumentCaptor.getValue();
+        assertThat(intent.getComponent().getClassName()).isEqualTo(
+                VerifyLockChangeActivity.class.getName());
+    }
+
+    @Test
+    public void activityResult_resultNotOk_fragmentNotLaunched() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.processActivityResult(LOCK_CHECK,
+                Activity.RESULT_CANCELED, /* data= */ null);
+
+        verify(mFragmentController, never()).launchFragment(any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void activityResult_resultOk_fragmentLaunched() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.processActivityResult(LOCK_CHECK,
+                Activity.RESULT_OK, /* data= */ null);
+
+        verify(mFragmentController).launchFragment(any(ChooseLockTypeFragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void activityResult_resultOk_currentScreenLockSet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.processActivityResult(LOCK_CHECK,
+                Activity.RESULT_OK, createDataBundle());
+
+        ArgumentCaptor<Fragment> fragmentArgumentCaptor = ArgumentCaptor.forClass(Fragment.class);
+        verify(mFragmentController).launchFragment(fragmentArgumentCaptor.capture());
+
+        Fragment fragment = fragmentArgumentCaptor.getValue();
+        assertThat((LockscreenCredential) fragment.getArguments().getParcelable(
+                PasswordHelper.EXTRA_CURRENT_SCREEN_LOCK)).isEqualTo(TEST_LOCKSCREEN_CREDENTIAL);
+    }
+
+    @Test
+    @UiThreadTest
+    public void activityResult_resultOk_passwordQualitySet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.processActivityResult(LOCK_CHECK,
+                Activity.RESULT_OK, createDataBundle());
+
+        ArgumentCaptor<Fragment> fragmentArgumentCaptor = ArgumentCaptor.forClass(Fragment.class);
+        verify(mFragmentController).launchFragment(fragmentArgumentCaptor.capture());
+
+        Fragment fragment = fragmentArgumentCaptor.getValue();
+        assertThat(fragment.getArguments().getInt(
+                PasswordHelper.EXTRA_CURRENT_PASSWORD_QUALITY)).isEqualTo(TEST_PASSWORD_QUALITY);
+    }
+
+    @Test
+    public void isNotGuestUser_isAvailable() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void isNotGuestUser_isAvailable_zoneWrite() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void isNotGuestUser_isAvailable_zoneRead() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void isNotGuestUser_isAvailable_zoneHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void isGuestUser_isNotAvailable() {
+        when(mUserManager.isGuestUser()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void isGuestUser_isNotAvailable_zoneWrite() {
+        when(mUserManager.isGuestUser()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void isGuestUser_isNotAvailable_zoneRead() {
+        when(mUserManager.isGuestUser()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void isGuestUser_isNotAvailable_zoneHidden() {
+        when(mUserManager.isGuestUser()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void lockTypeNone_setsSummary() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "security_lock_none"));
+    }
+
+    @Test
+    public void lockTypePattern_setsSummary() {
+        when(mLockPatternUtils.getCredentialTypeForUser(anyInt()))
+                .thenReturn(CREDENTIAL_TYPE_PATTERN);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "security_lock_pattern"));
+    }
+
+    @Test
+    public void lockTypePin_setsSummary() {
+        when(mLockPatternUtils.getCredentialTypeForUser(anyInt())).thenReturn(CREDENTIAL_TYPE_PIN);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "security_lock_pin"));
+    }
+
+    @Test
+    public void lockTypePassword_setsSummary() {
+        when(mLockPatternUtils.getCredentialTypeForUser(anyInt()))
+                .thenReturn(CREDENTIAL_TYPE_PASSWORD);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "security_lock_password"));
+    }
+
+    private Intent createDataBundle() {
+        Intent intent = new Intent();
+        intent.putExtra(PasswordHelper.EXTRA_CURRENT_SCREEN_LOCK, TEST_LOCKSCREEN_CREDENTIAL);
+        intent.putExtra(PasswordHelper.EXTRA_CURRENT_PASSWORD_QUALITY, TEST_PASSWORD_QUALITY);
+        return intent;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/ConfirmLockLockoutHelperTest.java b/tests/multivalent/src/com/android/car/settings/security/ConfirmLockLockoutHelperTest.java
new file mode 100644
index 000000000..c3673e2d9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/ConfirmLockLockoutHelperTest.java
@@ -0,0 +1,156 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.contains;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.reset;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.os.CountDownTimer;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.internal.runner.junit4.statement.UiThreadStatement;
+
+import com.android.internal.widget.LockPatternUtils;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ConfirmLockLockoutHelperTest {
+    private static final int TEST_USER = 100;
+
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private ConfirmLockLockoutHelper mConfirmLockLockoutHelper;
+
+    @Mock
+    private LockPatternUtils mLockPatternUtils;
+    @Mock
+    private ConfirmLockLockoutHelper.ConfirmLockUIController mUIController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mConfirmLockLockoutHelper = new ConfirmLockLockoutHelper(mContext, TEST_USER,
+                mLockPatternUtils);
+        mConfirmLockLockoutHelper.setConfirmLockUIController(mUIController);
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsZero_doesNothing() {
+        runOnCheckCompletedWithTimeout(0);
+
+        verify(mLockPatternUtils, never()).setLockoutAttemptDeadline(TEST_USER, 0);
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsZero_noTimer() {
+        runOnCheckCompletedWithTimeout(0);
+
+        assertThat(mConfirmLockLockoutHelper.getCountDownTimer()).isNull();
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsPositive_setsLockoutDeadline() {
+        runOnCheckCompletedWithTimeout(1000);
+
+        verify(mLockPatternUtils).setLockoutAttemptDeadline(TEST_USER, 1000);
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsPositive_refreshesUILocked() {
+        when(mLockPatternUtils.getLockoutAttemptDeadline(TEST_USER)).thenReturn(1000L);
+        runOnCheckCompletedWithTimeout(1000);
+
+        verify(mUIController).refreshUI(true);
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsPositive_createsTimer() {
+        runOnCheckCompletedWithTimeout(1000);
+
+        assertThat(mConfirmLockLockoutHelper.getCountDownTimer()).isNotNull();
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsPositive_timerTickUpdatesErrorText() {
+        runOnCheckCompletedWithTimeout(1000);
+
+        reset(mUIController);
+        CountDownTimer timer = mConfirmLockLockoutHelper.getCountDownTimer();
+        timer.onTick(1000);
+
+        verify(mUIController).setErrorText(contains("1"));
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsPositive_onFinishUpdatesErrorText() {
+        runOnCheckCompletedWithTimeout(1000);
+
+        reset(mUIController);
+        CountDownTimer timer = mConfirmLockLockoutHelper.getCountDownTimer();
+        timer.onFinish();
+
+        verify(mUIController).setErrorText("");
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsPositive_onFinishUpdatesUINotLocked() {
+        runOnCheckCompletedWithTimeout(1000);
+
+        reset(mUIController);
+        CountDownTimer timer = mConfirmLockLockoutHelper.getCountDownTimer();
+        timer.onFinish();
+
+        verify(mUIController).refreshUI(false);
+    }
+
+    @Test
+    public void onCheckCompletedWithTimeout_timeoutIsPositive_onPauseUpdatesErrorText() {
+        runOnCheckCompletedWithTimeout(1000);
+
+        reset(mUIController);
+        CountDownTimer timer = mConfirmLockLockoutHelper.getCountDownTimer();
+        timer.onTick(1000);
+
+        verify(mUIController).setErrorText(contains("1"));
+
+        mConfirmLockLockoutHelper.onPauseUI();
+
+        verify(mUIController).setErrorText("");
+    }
+
+    private void runOnCheckCompletedWithTimeout(int timeout) {
+        try {
+            // Needs to be called on the UI thread due to the CountDownTimer.
+            UiThreadStatement.runOnUiThread(() -> {
+                mConfirmLockLockoutHelper.onCheckCompletedWithTimeout(timeout);
+            });
+        } catch (Throwable throwable) {
+            throwable.printStackTrace();
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/ConfirmLockPinPasswordFragmentTest.java b/tests/multivalent/src/com/android/car/settings/security/ConfirmLockPinPasswordFragmentTest.java
new file mode 100644
index 000000000..5add2d837
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/ConfirmLockPinPasswordFragmentTest.java
@@ -0,0 +1,85 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.view.View;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.TestSettingsScreenLockActivity;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoAnnotations;
+
+/**
+ * Tests for ConfirmLockPinPasswordFragment class.
+ */
+@RunWith(AndroidJUnit4.class)
+public class ConfirmLockPinPasswordFragmentTest {
+    private ConfirmLockPinPasswordFragment mFragment;
+    private FragmentManager mFragmentManager;
+
+    @Rule
+    public ActivityTestRule<TestSettingsScreenLockActivity> mActivityTestRule =
+            new ActivityTestRule<>(TestSettingsScreenLockActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+    }
+
+    /**
+     * A test to verify that the Enter key is re-enabled when verification fails.
+     */
+    @Test
+    public void testEnterKeyIsEnabledWhenCheckFails() throws Throwable {
+        View enterKey = mFragment.getView().findViewById(R.id.key_enter);
+        mActivityTestRule.runOnUiThread(() -> {
+            enterKey.setEnabled(false);
+            mFragment.onCheckCompleted(false, 0);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(enterKey.isEnabled()).isTrue();
+    }
+
+    private void setUpFragment() throws Throwable {
+        String confirmLockPinPasswordFragmentTag = "confirm_lock_pin_password_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(
+                            R.id.fragment_container,
+                            ConfirmLockPinPasswordFragment.newPinInstance(),
+                            confirmLockPinPasswordFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (ConfirmLockPinPasswordFragment) mFragmentManager
+                .findFragmentByTag(confirmLockPinPasswordFragmentTag);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/CredentialsResetPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/security/CredentialsResetPreferenceControllerTest.java
new file mode 100644
index 000000000..163478293
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/CredentialsResetPreferenceControllerTest.java
@@ -0,0 +1,293 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+import static com.android.car.settings.testutils.EnterpriseTestUtils.mockUserRestrictionSetByDpm;
+import static com.android.car.settings.testutils.EnterpriseTestUtils.mockUserRestrictionSetByUm;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+/** Unit test for {@link CredentialsResetPreferenceController} with mock setup. */
+@RunWith(AndroidJUnit4.class)
+public class CredentialsResetPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_CREDENTIALS;
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private final LifecycleOwner mLifecycleOwner = new TestLifecycleOwner();
+    private CarUiPreference mPreference;
+    private CredentialsResetPreferenceController mPreferenceController;
+
+    @Mock
+    private CarUxRestrictions mMockCarUxRestrictions;
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new CredentialsResetPreferenceController(mContext,
+                "key", mMockFragmentController, mMockCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_disabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_disabled_zoneWrite() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_disabled_zoneRead() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByUm_disabled_zoneHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_viewing() {
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_viewing_zoneWrite() {
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("wrtie");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_viewing_zoneRead() {
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByDpm_viewing_zoneHidden() {
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByBothUmDpm_disabled() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByBothUmDpm_disabled_zoneWrite() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByBothUmDpm_disabled_zoneRead() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictedByBothUmDpm_disabled_zoneHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_unrestricted_available() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_unrestricted_available_zoneWrite() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_unrestricted_available_zoneRead() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_unrestricted_available_zoneHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, false);
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByDpm_showDialog() {
+        mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mMockFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/LockTypeBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/security/LockTypeBasePreferenceControllerTest.java
new file mode 100644
index 000000000..8ad22b39a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/LockTypeBasePreferenceControllerTest.java
@@ -0,0 +1,268 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static android.car.feature.Flags.FLAG_SUPPORTS_SECURE_PASSENGER_USERS;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.security.LockTypeBasePreferenceController.CHOOSE_LOCK_REQUEST;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.car.CarOccupantZoneManager;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+import android.platform.test.flag.junit.SetFlagsRule;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.CarSettingsApplication;
+import com.android.car.settings.common.ActivityResultCallback;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionTextPreference;
+import com.android.internal.widget.LockscreenCredential;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class LockTypeBasePreferenceControllerTest {
+    private static final int MATCHING_PASSWORD_QUALITY =
+            DevicePolicyManager.PASSWORD_QUALITY_NUMERIC;
+    private static final int NON_MATCHING_PASSWORD_QUALITY =
+            DevicePolicyManager.PASSWORD_QUALITY_UNSPECIFIED;
+    private static final LockscreenCredential NONE_LOCKSCREEN_CREDENTIAL =
+            LockscreenCredential.createNone();
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private TestLockTypeBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private CarSettingsApplication mCarSettingsApplication;
+
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getApplicationContext()).thenReturn(mCarSettingsApplication);
+        when(mCarSettingsApplication.getMyOccupantZoneType()).thenReturn(
+                CarOccupantZoneManager.OCCUPANT_TYPE_DRIVER);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiTwoActionTextPreference(mContext);
+        mPreferenceController = new TestLockTypeBasePreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        mPreference.getExtras().putParcelable(
+                PasswordHelper.EXTRA_CURRENT_SCREEN_LOCK, NONE_LOCKSCREEN_CREDENTIAL);
+        mPreference.getExtras().putInt(
+                PasswordHelper.EXTRA_CURRENT_PASSWORD_QUALITY, NON_MATCHING_PASSWORD_QUALITY);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mMockUserManager.isGuestUser()).thenReturn(false);
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_returnsTrue() {
+        assertThat(mPreferenceController.handlePreferenceClicked(mPreference)).isTrue();
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_launchesIntent() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+        verify(mFragmentController).startActivityForResult(any(Intent.class),
+                eq(CHOOSE_LOCK_REQUEST), any(ActivityResultCallback.class));
+    }
+
+    @Test
+    public void testRefreshUi_isCurrentLock() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setCurrentPasswordQuality(MATCHING_PASSWORD_QUALITY);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "current_screen_lock"));
+    }
+
+    @Test
+    public void testRefreshUi_isNotCurrentLock() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setCurrentPasswordQuality(NON_MATCHING_PASSWORD_QUALITY);
+        mPreferenceController.refreshUi();
+        assertThat(mPreference.getSummary()).isNotEqualTo(
+                ResourceTestUtils.getString(mContext, "current_screen_lock"));
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_guestUser() {
+        when(mMockUserManager.isGuestUser()).thenReturn(true);
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_guestUser_zoneWrite() {
+        when(mMockUserManager.isGuestUser()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_guestUser_zoneRead() {
+        when(mMockUserManager.isGuestUser()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_guestUser_zoneHidden() {
+        when(mMockUserManager.isGuestUser()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_otherUser() {
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_otherUser_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_otherUser_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_otherUser_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_driverUser_isAvailable() {
+        mPreferenceController.setIsSecureLockType(true);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_passengerUser_secureLockSupported_isAvailable() {
+        mPreferenceController.setIsSecureLockType(true);
+        when(mCarSettingsApplication.getMyOccupantZoneType()).thenReturn(
+                CarOccupantZoneManager.OCCUPANT_TYPE_FRONT_PASSENGER);
+        mSetFlagsRule.enableFlags(FLAG_SUPPORTS_SECURE_PASSENGER_USERS);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_passengerUser_secureLockUnSupported_isNotAvailable() {
+        mPreferenceController.setIsSecureLockType(true);
+        when(mCarSettingsApplication.getMyOccupantZoneType()).thenReturn(
+                CarOccupantZoneManager.OCCUPANT_TYPE_FRONT_PASSENGER);
+        mSetFlagsRule.disableFlags(FLAG_SUPPORTS_SECURE_PASSENGER_USERS);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testControllerPassword_isSet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreferenceController.getCurrentPassword()).isEqualTo(
+                NONE_LOCKSCREEN_CREDENTIAL);
+    }
+
+    @Test
+    public void testControllerPasswordQuality_isSet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreferenceController.getCurrentPasswordQuality()).isEqualTo(
+                NON_MATCHING_PASSWORD_QUALITY);
+    }
+
+    private class TestLockTypeBasePreferenceController extends LockTypeBasePreferenceController {
+        private boolean mIsSecureLockType = false;
+
+        TestLockTypeBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+            mUserManager = mMockUserManager;
+        }
+
+        @Override
+        protected Intent activityToOpen() {
+            return new Intent();
+        }
+
+        @Override
+        protected int[] allowedPasswordQualities() {
+            return new int[]{MATCHING_PASSWORD_QUALITY};
+        }
+
+        @Override
+        protected boolean isSecureLockType() {
+            return mIsSecureLockType;
+        }
+
+        void setIsSecureLockType(boolean secure) {
+            mIsSecureLockType = secure;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/security/PasswordHelperTest.java b/tests/multivalent/src/com/android/car/settings/security/PasswordHelperTest.java
new file mode 100644
index 000000000..f5be3b65d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/security/PasswordHelperTest.java
@@ -0,0 +1,308 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.security;
+
+import static android.app.admin.DevicePolicyManager.PASSWORD_COMPLEXITY_HIGH;
+import static android.app.admin.DevicePolicyManager.PASSWORD_COMPLEXITY_LOW;
+import static android.app.admin.DevicePolicyManager.PASSWORD_COMPLEXITY_MEDIUM;
+import static android.app.admin.DevicePolicyManager.PASSWORD_COMPLEXITY_NONE;
+
+import static com.android.internal.widget.LockPatternUtils.CREDENTIAL_TYPE_NONE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.when;
+
+import android.app.admin.DevicePolicyManager;
+import android.app.admin.PasswordMetrics;
+import android.content.Context;
+import android.os.UserHandle;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.internal.widget.LockPatternUtils;
+import com.android.internal.widget.LockscreenCredential;
+import com.android.settingslib.utils.StringUtil;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+@RunWith(AndroidJUnit4.class)
+public final class PasswordHelperTest {
+    // Never valid
+    private static final String SHORT_SEQUENTIAL_PASSWORD = "111";
+    private static final String LENGTH_3_PATTERN = "123";
+    // Only valid when None/Low complexity
+    private static final String MEDIUM_SEQUENTIAL_PASSWORD = "22222";
+    private static final String LONG_SEQUENTIAL_PASSWORD = "111111111";
+    // Valid for None/Low/Medium complexity
+    private static final String MEDIUM_ALPHANUMERIC_PASSWORD = "a11r1";
+    private static final String MEDIUM_PIN_PASSWORD = "11397";
+    // Valid for all complexities
+    private static final String LONG_ALPHANUMERIC_PASSWORD = "a11r1t131";
+    private static final String LONG_PIN_PASSWORD = "113982125";
+    private static final String LENGTH_4_PATTERN = "1234";
+
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private int mUserId;
+    private PasswordMetrics mPasswordMetrics;
+
+    @Mock
+    LockPatternUtils mLockPatternUtils;
+    @Mock
+    LockscreenCredential mExistingCredential;
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+
+    @Before
+    public void setUp() {
+        mUserId = UserHandle.myUserId();
+        mPasswordMetrics = new PasswordMetrics(CREDENTIAL_TYPE_NONE);
+        when(mLockPatternUtils.getPasswordHistoryHashFactor(any(), anyInt()))
+                .thenReturn(new byte[0]);
+    }
+
+    private LockscreenCredential createPassword(String password) {
+        return LockscreenCredential.createPassword(password);
+    }
+
+    private LockscreenCredential createPin(String pin) {
+        return LockscreenCredential.createPin(pin);
+    }
+
+    private LockscreenCredential createPattern(String patternString) {
+        return LockscreenCredential.createPattern(LockPatternUtils.byteArrayToPattern(
+                    patternString.getBytes()));
+    }
+
+    private String passwordTooShort(int lengthRequired) {
+        return StringUtil.getIcuPluralsString(mContext, lengthRequired,
+                R.string.lockpassword_password_too_short);
+    }
+
+    private String pinTooShort(int lengthRequired) {
+        return StringUtil.getIcuPluralsString(mContext, lengthRequired,
+                R.string.lockpassword_pin_too_short);
+    }
+
+    private String patternTooShort(int lengthRequired) {
+        return StringUtil.getIcuPluralsString(mContext, lengthRequired,
+                R.string.lockpattern_recording_incorrect_too_short);
+    }
+
+    private PasswordHelper newPasswordHelper(
+            @DevicePolicyManager.PasswordComplexity int complexity) {
+        return new PasswordHelper(mContext, mUserId, mLockPatternUtils, mPasswordMetrics,
+                complexity);
+    }
+
+    private void assertCredentialValid(@DevicePolicyManager.PasswordComplexity int minComplexity,
+            LockscreenCredential credential) {
+        PasswordHelper helper = newPasswordHelper(minComplexity);
+
+        // Test the overload of validateCredential() that doesn't require the existing credential.
+        assertThat(helper.validateCredential(credential)).isTrue();
+        assertThat(helper.getCredentialValidationErrorMessages()).isEqualTo("");
+
+        // Test the overload of validateCredential() that requires the existing credential.
+        assertThat(helper.validateCredential(credential, mExistingCredential)).isTrue();
+        assertThat(helper.getCredentialValidationErrorMessages()).isEqualTo("");
+
+    }
+
+    private void assertCredentialInvalid(@DevicePolicyManager.PasswordComplexity int minComplexity,
+            LockscreenCredential credential, String expectedError) {
+        PasswordHelper helper = newPasswordHelper(minComplexity);
+
+        // Test the overload of validateCredential() that doesn't require the existing credential.
+        assertThat(helper.validateCredential(credential)).isFalse();
+        assertThat(helper.getCredentialValidationErrorMessages()).isEqualTo(expectedError);
+
+        // Test the overload of validateCredential() that requires the existing credential.
+        assertThat(helper.validateCredential(credential, mExistingCredential)).isFalse();
+        assertThat(helper.getCredentialValidationErrorMessages()).isEqualTo(expectedError);
+    }
+
+    @Test
+    public void passwordComplexityNone_shortSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_NONE,
+                createPassword(SHORT_SEQUENTIAL_PASSWORD),
+                passwordTooShort(4));
+    }
+
+    @Test
+    public void passwordComplexityNone_mediumSequentialPassword_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_NONE, createPassword(MEDIUM_SEQUENTIAL_PASSWORD));
+    }
+
+    @Test
+    public void passwordComplexityLow_shortSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_LOW,
+                createPassword(SHORT_SEQUENTIAL_PASSWORD),
+                passwordTooShort(4));
+    }
+
+    @Test
+    public void passwordComplexityLow_mediumSequentialPassword_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_LOW, createPassword(MEDIUM_SEQUENTIAL_PASSWORD));
+    }
+
+    @Test
+    public void passwordComplexityMedium_shortSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_MEDIUM,
+                createPassword(SHORT_SEQUENTIAL_PASSWORD),
+                passwordTooShort(4));
+    }
+
+    @Test
+    public void passwordComplexityMedium_mediumSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_MEDIUM,
+                createPassword(MEDIUM_SEQUENTIAL_PASSWORD),
+                mContext.getString(R.string.lockpassword_pin_no_sequential_digits));
+    }
+
+    @Test
+    public void passwordComplexityMedium_mediumAlphanumericPassword_valid() {
+        assertCredentialValid(
+                PASSWORD_COMPLEXITY_MEDIUM,
+                createPassword(MEDIUM_ALPHANUMERIC_PASSWORD));
+    }
+
+    @Test
+    public void passwordComplexityHigh_mediumSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_HIGH,
+                createPassword(MEDIUM_SEQUENTIAL_PASSWORD),
+                passwordTooShort(6) + "\n"
+                    + mContext.getString(R.string.lockpassword_pin_no_sequential_digits));
+    }
+
+    @Test
+    public void passwordComplexityHigh_mediumAlphanumericPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_HIGH,
+                createPassword(MEDIUM_ALPHANUMERIC_PASSWORD),
+                passwordTooShort(6));
+    }
+
+    @Test
+    public void passwordComplexityHigh_longSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_HIGH,
+                createPassword(LONG_SEQUENTIAL_PASSWORD),
+                mContext.getString(R.string.lockpassword_pin_no_sequential_digits));
+    }
+
+    @Test
+    public void passwordComplexityHigh_longAlphanumericPassword_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_HIGH, createPassword(LONG_ALPHANUMERIC_PASSWORD));
+    }
+
+    @Test
+    public void pinComplexityNone_shortSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_NONE,
+                createPin(SHORT_SEQUENTIAL_PASSWORD),
+                pinTooShort(4));
+    }
+
+    @Test
+    public void pinComplexityNone_mediumSequentialPassword_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_NONE, createPin(MEDIUM_SEQUENTIAL_PASSWORD));
+    }
+
+    @Test
+    public void pinComplexityLow_shortSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_LOW,
+                createPin(SHORT_SEQUENTIAL_PASSWORD),
+                pinTooShort(4));
+    }
+
+    @Test
+    public void pinComplexityLow_mediumSequentialPassword_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_LOW, createPin(MEDIUM_SEQUENTIAL_PASSWORD));
+    }
+
+    @Test
+    public void pinComplexityMedium_shortSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_MEDIUM,
+                createPin(SHORT_SEQUENTIAL_PASSWORD),
+                pinTooShort(4));
+    }
+
+    @Test
+    public void pinComplexityMedium_mediumSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_MEDIUM,
+                createPin(MEDIUM_SEQUENTIAL_PASSWORD),
+                mContext.getString(R.string.lockpassword_pin_no_sequential_digits));
+    }
+
+    @Test
+    public void pinComplexityMedium_mediumPinPassword_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_MEDIUM, createPin(MEDIUM_PIN_PASSWORD));
+    }
+
+    @Test
+    public void pinComplexityHigh_mediumPinPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_HIGH,
+                createPin(MEDIUM_PIN_PASSWORD),
+                pinTooShort(8));
+    }
+
+    @Test
+    public void pinComplexityHigh_longSequentialPassword_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_HIGH,
+                createPin(LONG_SEQUENTIAL_PASSWORD),
+                mContext.getString(R.string.lockpassword_pin_no_sequential_digits));
+    }
+
+    @Test
+    public void pinComplexityHigh_longPinPassword_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_HIGH, createPin(LONG_PIN_PASSWORD));
+    }
+
+    @Test
+    public void patternComplexityNone_length3Pattern_invalid() {
+        assertCredentialInvalid(
+                PASSWORD_COMPLEXITY_NONE,
+                createPattern(LENGTH_3_PATTERN),
+                patternTooShort(4));
+    }
+
+    @Test
+    public void patternComplexityNone_length4Pattern_valid() {
+        assertCredentialValid(PASSWORD_COMPLEXITY_NONE, createPattern(LENGTH_4_PATTERN));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/sound/AudioRouteItemTest.java b/tests/multivalent/src/com/android/car/settings/sound/AudioRouteItemTest.java
new file mode 100644
index 000000000..825b26581
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/sound/AudioRouteItemTest.java
@@ -0,0 +1,80 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.sound;
+
+import static android.media.AudioDeviceInfo.TYPE_BLUETOOTH_A2DP;
+import static android.media.AudioDeviceInfo.TYPE_BUS;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.media.AudioDeviceAttributes;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AudioRouteItemTest {
+
+    @Mock
+    private AudioDeviceAttributes mAudioDeviceAttributes;
+    @Mock
+    private CachedBluetoothDevice mCachedBluetoothDevice;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+    }
+
+    @Test
+    public void init_withAudioDeviceAttributes() {
+        String name = "audio";
+        String address = "audioAddress";
+        when(mAudioDeviceAttributes.getName()).thenReturn(name);
+        when(mAudioDeviceAttributes.getAddress()).thenReturn(address);
+        AudioRouteItem audioRouteItem = new AudioRouteItem(mAudioDeviceAttributes);
+
+        assertThat(audioRouteItem.getName()).isEqualTo(name);
+        assertThat(audioRouteItem.getAddress()).isEqualTo(address);
+        assertThat(audioRouteItem.getAudioRouteType()).isEqualTo(TYPE_BUS);
+        assertThat(audioRouteItem.getAudioDeviceAttributes()).isEqualTo(mAudioDeviceAttributes);
+        assertThat(audioRouteItem.getBluetoothDevice()).isNull();
+    }
+
+    @Test
+    public void init_withCachedBluetoothDevice() {
+        String name = "bluetooth";
+        String address = "bluetoothAddress";
+        when(mCachedBluetoothDevice.getName()).thenReturn(name);
+        when(mCachedBluetoothDevice.getAddress()).thenReturn(address);
+        AudioRouteItem audioRouteItem = new AudioRouteItem(mCachedBluetoothDevice);
+
+        assertThat(audioRouteItem.getName()).isEqualTo(name);
+        assertThat(audioRouteItem.getAddress()).isEqualTo(address);
+        assertThat(audioRouteItem.getAudioRouteType()).isEqualTo(TYPE_BLUETOOTH_A2DP);
+        assertThat(audioRouteItem.getAudioDeviceAttributes()).isNull();
+        assertThat(audioRouteItem.getBluetoothDevice()).isEqualTo(mCachedBluetoothDevice);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/sound/AudioRouteSelectorControllerTest.java b/tests/multivalent/src/com/android/car/settings/sound/AudioRouteSelectorControllerTest.java
new file mode 100644
index 000000000..a9c588808
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/sound/AudioRouteSelectorControllerTest.java
@@ -0,0 +1,160 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.sound;
+
+import static android.car.media.CarAudioManager.AUDIO_FEATURE_DYNAMIC_ROUTING;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.feature.Flags;
+import android.car.media.CarAudioManager;
+import android.content.Context;
+import android.platform.test.flag.junit.SetFlagsRule;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public class AudioRouteSelectorControllerTest {
+    private static final String ACTIVE_ADDRESS = "active_address";
+    private static final String ACTIVE_NAME = "active_name";
+    private static final String INACTIVE_NAME = "inactive_name";
+    private static final String INACTIVE_ADDRESS = "inactive_address";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private AudioRouteSelectorController mPreferenceController;
+    private ListPreference mPreference;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private AudioRoutesManager mAudioRoutesManager;
+    @Mock
+    private CarAudioManager mCarAudioManager;
+    @Mock
+    private AudioRouteItem mAudioRouteItem1;
+    @Mock
+    private AudioRouteItem mAudioRouteItem2;
+    @Mock
+    private Toast mMockToast;
+
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+
+    @Before
+    public void setUp() {
+        mSetFlagsRule.enableFlags(Flags.FLAG_CAR_AUDIO_DYNAMIC_DEVICES);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new AudioRouteSelectorController(mContext,
+                /* preferenceKey= */ "key", mFragmentController,
+                mCarUxRestrictions);
+        mPreference = new ListPreference(mContext);
+        mPreferenceController.setAudioRoutesManager(mAudioRoutesManager);
+        when(mAudioRoutesManager.getCarAudioManager()).thenReturn(mCarAudioManager);
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_DYNAMIC_ROUTING))
+                .thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        when(mAudioRouteItem1.getAddress()).thenReturn(ACTIVE_ADDRESS);
+        when(mAudioRouteItem1.getName()).thenReturn(ACTIVE_NAME);
+        when(mAudioRouteItem2.getAddress()).thenReturn(INACTIVE_ADDRESS);
+        when(mAudioRouteItem2.getName()).thenReturn(INACTIVE_NAME);
+        when(mAudioRoutesManager.isAudioRoutingEnabled()).thenReturn(true);
+        when(mAudioRoutesManager.getActiveDeviceAddress()).thenReturn(ACTIVE_ADDRESS);
+        when(mAudioRoutesManager.getAudioRouteList()).thenReturn(
+                Arrays.asList(ACTIVE_ADDRESS, INACTIVE_ADDRESS));
+        when(mAudioRoutesManager.getDeviceNameForAddress(ACTIVE_ADDRESS)).thenReturn(ACTIVE_NAME);
+        when(mAudioRoutesManager.getDeviceNameForAddress(INACTIVE_ADDRESS))
+                .thenReturn(INACTIVE_NAME);
+    }
+
+    @After
+    public void tearDown() {
+        if (mAudioRoutesManager != null) {
+            mAudioRoutesManager.tearDown();
+        }
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_testUpdatePreferenceOptions() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.getTitle().toString()).isEqualTo(
+                mContext.getString(R.string.audio_route_selector_title));
+        assertThat(mPreference.getSummary().toString()).isEqualTo(ACTIVE_NAME);
+        assertThat(mPreference.getValue().toString()).isEqualTo(ACTIVE_ADDRESS);
+        assertThat(mPreference.getEntries().length).isEqualTo(2);
+        assertThat(mPreference.getEntries()[0].toString()).isEqualTo(ACTIVE_NAME);
+        assertThat(mPreference.getEntries()[1].toString()).isEqualTo(INACTIVE_NAME);
+        assertThat(mPreference.getEntryValues()[0].toString()).isEqualTo(ACTIVE_ADDRESS);
+        assertThat(mPreference.getEntryValues()[1].toString()).isEqualTo(INACTIVE_ADDRESS);
+    }
+
+    @Test
+    public void onCreate_testHandlePreferenceChanged() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mPreferenceController.handlePreferenceChanged(mPreference, INACTIVE_ADDRESS);
+
+        verify(mAudioRoutesManager).updateAudioRoute(INACTIVE_ADDRESS);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/sound/AudioRoutesManagerTest.java b/tests/multivalent/src/com/android/car/settings/sound/AudioRoutesManagerTest.java
new file mode 100644
index 000000000..9e1306553
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/sound/AudioRoutesManagerTest.java
@@ -0,0 +1,215 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.sound;
+
+import static android.car.media.CarAudioManager.AUDIO_FEATURE_DYNAMIC_ROUTING;
+import static android.media.AudioAttributes.USAGE_MEDIA;
+import static android.media.AudioDeviceInfo.TYPE_BLUETOOTH_A2DP;
+import static android.media.AudioDeviceInfo.TYPE_BUS;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.media.CarAudioManager;
+import android.car.media.CarAudioZoneConfigInfo;
+import android.car.media.CarVolumeGroupInfo;
+import android.content.Context;
+import android.media.AudioAttributes;
+import android.media.AudioDeviceAttributes;
+import android.media.AudioDeviceInfo;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.CarSettingsApplication;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.bluetooth.CachedBluetoothDevice;
+import com.android.settingslib.bluetooth.CachedBluetoothDeviceManager;
+import com.android.settingslib.bluetooth.LocalBluetoothManager;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+import java.util.Map;
+
+@RunWith(AndroidJUnit4.class)
+public class AudioRoutesManagerTest {
+    private static final int USAGE = USAGE_MEDIA;
+    private static final int TEST_ZONE_ID = 0;
+    private static final String AUDIO_DEVICE_NAME = "audio";
+    private static final String AUDIO_DEVICE_ADDRESS = "audio_address";
+    private static final String BT_DEVICE_NAME = "bluetooth";
+    private static final String BT_DEVICE_ADDRESS = "bluetooth_address";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private MockitoSession mSession;
+    private AudioRoutesManager mAudioRoutesManager;
+    @Mock
+    private AudioRoutesManager.AudioZoneConfigUpdateListener mUpdateListener;
+    @Mock
+    private CarSettingsApplication mCarSettingsApplication;
+    @Mock
+    private CarAudioManager mCarAudioManager;
+    @Mock
+    private LocalBluetoothManager mBluetoothManager;
+    @Mock
+    private CachedBluetoothDeviceManager mCachedBluetoothDeviceManager;
+    @Mock
+    private CachedBluetoothDevice mCachedBluetoothDevice;
+    @Mock
+    private CarAudioZoneConfigInfo mCarAudioZoneConfigInfo;
+    @Mock
+    private CarVolumeGroupInfo mCarVolumeGroupInfo;
+    @Mock
+    private AudioAttributes mAudioAttributes;
+    @Mock
+    private AudioDeviceAttributes mAudioDeviceAttributes;
+    @Mock
+    private AudioDeviceAttributes mOtherAudioDeviceAttributes;
+    @Mock
+    private AudioDeviceInfo mAudioDeviceInfo;
+
+    @Before
+    public void setUp() throws Exception {
+        initMocks();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void init_verifyAudioRouteList() {
+        when(mAudioDeviceInfo.getAddress()).thenReturn(AUDIO_DEVICE_ADDRESS);
+        when(mCarVolumeGroupInfo.getAudioDeviceAttributes())
+                .thenReturn(new ArrayList<>(Collections.singleton(mAudioDeviceAttributes)));
+        mAudioRoutesManager = new AudioRoutesManager(mContext, USAGE);
+        mAudioRoutesManager.setUpdateListener(mUpdateListener);
+
+        List<String> audioRouteList = mAudioRoutesManager.getAudioRouteList();
+        assertThat(audioRouteList.size()).isEqualTo(2);
+        assertThat(audioRouteList.get(0)).isEqualTo(AUDIO_DEVICE_ADDRESS);
+        assertThat(audioRouteList.get(1)).isEqualTo(BT_DEVICE_ADDRESS);
+    }
+
+    @Test
+    public void init_verifyAudioRouteList_repeatAddress() {
+        when(mAudioDeviceInfo.getAddress()).thenReturn(AUDIO_DEVICE_ADDRESS);
+        when(mCarVolumeGroupInfo.getAudioDeviceAttributes())
+                .thenReturn(Arrays.asList(mAudioDeviceAttributes, mOtherAudioDeviceAttributes));
+        mAudioRoutesManager = new AudioRoutesManager(mContext, USAGE);
+        mAudioRoutesManager.setUpdateListener(mUpdateListener);
+
+        List<String> audioRouteList = mAudioRoutesManager.getAudioRouteList();
+        assertThat(audioRouteList.size()).isEqualTo(2);
+        assertThat(audioRouteList.get(0)).isEqualTo(AUDIO_DEVICE_ADDRESS);
+        assertThat(audioRouteList.get(1)).isEqualTo(BT_DEVICE_ADDRESS);
+    }
+
+    @Test
+    public void init_verifyActiveDeviceAddress() {
+        when(mAudioDeviceInfo.getAddress()).thenReturn(AUDIO_DEVICE_ADDRESS);
+        when(mCarVolumeGroupInfo.getAudioDeviceAttributes())
+                .thenReturn(new ArrayList<>(Collections.singleton(mAudioDeviceAttributes)));
+        mAudioRoutesManager = new AudioRoutesManager(mContext, USAGE);
+        mAudioRoutesManager.setUpdateListener(mUpdateListener);
+
+        assertThat(mAudioRoutesManager.getActiveDeviceAddress()).isEqualTo(AUDIO_DEVICE_ADDRESS);
+    }
+
+    @Test
+    public void init_verifyAudioRouteItemMap() {
+        when(mAudioDeviceInfo.getAddress()).thenReturn(AUDIO_DEVICE_ADDRESS);
+        when(mCarVolumeGroupInfo.getAudioDeviceAttributes())
+                .thenReturn(new ArrayList<>(Collections.singleton(mAudioDeviceAttributes)));
+        mAudioRoutesManager = new AudioRoutesManager(mContext, USAGE);
+        mAudioRoutesManager.setUpdateListener(mUpdateListener);
+
+        Map<String, AudioRouteItem> audioRouteItemMap = mAudioRoutesManager.getAudioRouteItemMap();
+        assertThat(audioRouteItemMap.size()).isEqualTo(2);
+        assertThat(audioRouteItemMap.containsKey(AUDIO_DEVICE_ADDRESS)).isTrue();
+        assertThat(audioRouteItemMap.get(AUDIO_DEVICE_ADDRESS).getName())
+                .isEqualTo(AUDIO_DEVICE_NAME);
+        assertThat(audioRouteItemMap.get(AUDIO_DEVICE_ADDRESS).getAddress())
+                .isEqualTo(AUDIO_DEVICE_ADDRESS);
+        assertThat(audioRouteItemMap.get(AUDIO_DEVICE_ADDRESS).getAudioRouteType())
+                .isEqualTo(TYPE_BUS);
+        assertThat(audioRouteItemMap.get(AUDIO_DEVICE_ADDRESS).getAudioDeviceAttributes())
+                .isEqualTo(mAudioDeviceAttributes);
+        assertThat(audioRouteItemMap.get(AUDIO_DEVICE_ADDRESS).getBluetoothDevice()).isNull();
+
+        assertThat(audioRouteItemMap.containsKey(BT_DEVICE_ADDRESS)).isTrue();
+        assertThat(audioRouteItemMap.get(BT_DEVICE_ADDRESS).getName())
+                .isEqualTo(BT_DEVICE_NAME);
+        assertThat(audioRouteItemMap.get(BT_DEVICE_ADDRESS).getAddress())
+                .isEqualTo(BT_DEVICE_ADDRESS);
+        assertThat(audioRouteItemMap.get(BT_DEVICE_ADDRESS).getAudioRouteType())
+                .isEqualTo(TYPE_BLUETOOTH_A2DP);
+        assertThat(audioRouteItemMap.get(BT_DEVICE_ADDRESS).getAudioDeviceAttributes()).isNull();
+        assertThat(audioRouteItemMap.get(BT_DEVICE_ADDRESS).getBluetoothDevice())
+                .isEqualTo(mCachedBluetoothDevice);
+    }
+
+    private void initMocks() {
+        MockitoAnnotations.initMocks(this);
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                LocalBluetoothManager.class, withSettings().lenient()).startMocking();
+        when(LocalBluetoothManager.getInstance(any(), any())).thenReturn(mBluetoothManager);
+        when(mBluetoothManager.getCachedDeviceManager()).thenReturn(mCachedBluetoothDeviceManager);
+        when(mCachedBluetoothDeviceManager.getCachedDevicesCopy())
+                .thenReturn(Collections.singleton(mCachedBluetoothDevice));
+        when(mCachedBluetoothDevice.getName()).thenReturn(BT_DEVICE_NAME);
+        when(mCachedBluetoothDevice.getAddress()).thenReturn(BT_DEVICE_ADDRESS);
+        when(mCachedBluetoothDevice.isConnectedA2dpDevice()).thenReturn(true);
+
+        when(mContext.getApplicationContext()).thenReturn(mCarSettingsApplication);
+        when(mCarSettingsApplication.getCarAudioManager()).thenReturn(mCarAudioManager);
+        when(mCarSettingsApplication.getMyAudioZoneId()).thenReturn(TEST_ZONE_ID);
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_DYNAMIC_ROUTING))
+                .thenReturn(true);
+        when(mCarAudioManager.getAudioZoneConfigInfos(TEST_ZONE_ID))
+                .thenReturn(new ArrayList<>(Collections.singleton(mCarAudioZoneConfigInfo)));
+        when(mCarAudioZoneConfigInfo.isActive()).thenReturn(true);
+        when(mCarAudioZoneConfigInfo.getConfigVolumeGroups())
+                .thenReturn(new ArrayList<>(Collections.singleton(mCarVolumeGroupInfo)));
+        when(mCarVolumeGroupInfo.getAudioAttributes())
+                .thenReturn(new ArrayList<>(Collections.singleton(mAudioAttributes)));
+        when(mAudioAttributes.getUsage()).thenReturn(USAGE);
+        when(mAudioDeviceAttributes.getAddress()).thenReturn(AUDIO_DEVICE_ADDRESS);
+        when(mAudioDeviceAttributes.getName()).thenReturn(AUDIO_DEVICE_NAME);
+        when(mOtherAudioDeviceAttributes.getAddress()).thenReturn(BT_DEVICE_ADDRESS);
+        when(mOtherAudioDeviceAttributes.getName()).thenReturn(BT_DEVICE_NAME);
+        when(mCarAudioManager.getOutputDeviceForUsage(TEST_ZONE_ID, USAGE))
+                .thenReturn(mAudioDeviceInfo);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/sound/RingtonePickerPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/sound/RingtonePickerPreferenceControllerTest.java
new file mode 100644
index 000000000..4a7dbabf0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/sound/RingtonePickerPreferenceControllerTest.java
@@ -0,0 +1,330 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.sound;
+
+import static com.android.car.settings.sound.RingtonePickerPreferenceController.COLUMN_LABEL;
+import static com.android.car.settings.sound.RingtonePickerPreferenceController.SILENT_ITEM_POS;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.atLeastOnce;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.database.Cursor;
+import android.media.AudioAttributes;
+import android.media.RingtoneManager;
+import android.net.Uri;
+import android.os.Bundle;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class RingtonePickerPreferenceControllerTest {
+
+    private static final int TEST_IDX = 10;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceManager mPreferenceManager;
+    private PreferenceScreen mScreen;
+
+    private PreferenceGroup mPreferenceGroup;
+    private RingtonePickerPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    private List<String> mTestValues;
+    private int mCurrIdx;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private RingtoneManager mRingtoneManager;
+    @Mock
+    private Cursor mCursor;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceManager = new PreferenceManager(mContext);
+        mScreen = mPreferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        mScreen.addPreference(mPreferenceGroup);
+
+        mPreferenceController = new RingtonePickerPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setRingtoneManager(mRingtoneManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        // Default list of ringtones.
+        List<String> ringtoneTitles = new ArrayList<>();
+        ringtoneTitles.add("Test Ringtone 1");
+        ringtoneTitles.add("Test Ringtone 2");
+        ringtoneTitles.add("Test Ringtone 3");
+        setUpCursor(ringtoneTitles);
+    }
+
+    @Test
+    public void onStart_noArgsSet_invalidRingtoneTypeSet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mRingtoneManager).setType(eq(-1));
+    }
+
+    @Test
+    public void onStart_setArgs_validRingtoneTypeSet() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, false);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        verify(mRingtoneManager).setType(eq(RingtoneManager.TYPE_RINGTONE));
+    }
+
+    @Test
+    public void onStart_doesNotShowSilent_noExtraPreference() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, false);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        // Add 2 ringtones.
+        List<String> ringtoneTitles = new ArrayList<>();
+        ringtoneTitles.add("Test Ringtone 1");
+        ringtoneTitles.add("Test Ringtone 2");
+        setUpCursor(ringtoneTitles);
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void onStart_showSilent_hasExtraPreference() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, true);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        // Add 2 ringtones.
+        List<String> ringtoneTitles = new ArrayList<>();
+        ringtoneTitles.add("Test Ringtone 1");
+        ringtoneTitles.add("Test Ringtone 2");
+        setUpCursor(ringtoneTitles);
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        // Has 2 ringtones + silent option.
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(3);
+    }
+
+    @Test
+    public void onStart_showSilent_firstPreferenceIsSilent() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, true);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        Preference preference = mPreferenceGroup.getPreference(0);
+        int posKey = Integer.parseInt(preference.getKey());
+        assertThat(posKey).isEqualTo(SILENT_ITEM_POS);
+    }
+
+    @Test
+    public void onStart_hasSilent_defaultRingtoneSelected() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, true);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        List<String> ringtoneTitles = new ArrayList<>();
+        ringtoneTitles.add("Test Ringtone 1");
+        ringtoneTitles.add("Test Ringtone 2");
+        setUpCursor(ringtoneTitles);
+
+        // Set the default ringtone to be the first ringtone (not counting 'silent').
+        Settings.System.putStringForUser(mContext.getContentResolver(), Settings.System.RINGTONE,
+                createUri(ringtoneTitles.get(0)).toString(), mContext.getUserId());
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        // Currently selected ringtone is the first ringtone in the list. However, since we also
+        // have the "silent" item, it is the second item in the overall list.
+        assertThat(mPreferenceController.getCurrentlySelectedPreferencePos()).isEqualTo(1);
+    }
+
+    @Test
+    public void onPreferenceClick_clickCurrentlySelectedItem_nothingChanges() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, true);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        List<String> ringtoneTitles = new ArrayList<>();
+        ringtoneTitles.add("Test Ringtone 1");
+        ringtoneTitles.add("Test Ringtone 2");
+        setUpCursor(ringtoneTitles);
+
+        // Set the default ringtone to be the first ringtone (not counting 'silent').
+        Settings.System.putStringForUser(mContext.getContentResolver(), Settings.System.RINGTONE,
+                createUri(ringtoneTitles.get(0)).toString(), mContext.getUserId());
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceGroup.getPreference(1).performClick();
+
+        // Currently selected ringtone is the first ringtone in the list. However, since we also
+        // have the "silent" item, it is the second item in the overall list.
+        assertThat(mPreferenceController.getCurrentlySelectedPreferencePos()).isEqualTo(1);
+    }
+
+    @Test
+    public void onPreferenceClick_clickDifferentItem_selectionChanges() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, true);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        List<String> ringtoneTitles = new ArrayList<>();
+        ringtoneTitles.add("Test Ringtone 1");
+        ringtoneTitles.add("Test Ringtone 2");
+        setUpCursor(ringtoneTitles);
+
+        // Set the default ringtone to be the first ringtone (not counting 'silent').
+        Settings.System.putStringForUser(mContext.getContentResolver(), Settings.System.RINGTONE,
+                createUri(ringtoneTitles.get(0)).toString(), mContext.getUserId());
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceGroup.getPreference(2).performClick();
+
+        assertThat(mPreferenceController.getCurrentlySelectedPreferencePos()).isEqualTo(2);
+    }
+
+    @Test
+    public void onStop_stopRingtone() {
+        Bundle args = new Bundle();
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_TYPE, RingtoneManager.TYPE_RINGTONE);
+        args.putBoolean(RingtoneManager.EXTRA_RINGTONE_SHOW_SILENT, true);
+        args.putInt(RingtoneManager.EXTRA_RINGTONE_AUDIO_ATTRIBUTES_FLAGS,
+                AudioAttributes.FLAG_BYPASS_INTERRUPTION_POLICY);
+
+        List<String> ringtoneTitles = new ArrayList<>();
+        ringtoneTitles.add("Test Ringtone 1");
+        ringtoneTitles.add("Test Ringtone 2");
+        setUpCursor(ringtoneTitles);
+
+        // Set the default ringtone to be the first ringtone (not counting 'silent').
+        Settings.System.putStringForUser(mContext.getContentResolver(), Settings.System.RINGTONE,
+                createUri(ringtoneTitles.get(0)).toString(), mContext.getUserId());
+
+        mPreferenceController.setArguments(args);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceGroup.getPreference(2).performClick();
+        mPreferenceController.onStop(mLifecycleOwner);
+
+        verify(mRingtoneManager, atLeastOnce()).stopPreviousRingtone();
+    }
+
+    // Set up the mock cursor to retrieve the values provided by {@code ringtoneTitles}.
+    private void setUpCursor(List<String> ringtoneTitles) {
+        mTestValues = new ArrayList<>(ringtoneTitles);
+
+        for (int i = 0; i < mTestValues.size(); i++) {
+            String value = mTestValues.get(i);
+            when(mRingtoneManager.getRingtonePosition(eq(createUri(value)))).thenReturn(i);
+        }
+
+        when(mRingtoneManager.getCursor()).thenReturn(mCursor);
+        when(mCursor.getColumnIndex(eq(COLUMN_LABEL))).thenReturn(TEST_IDX);
+        when(mCursor.moveToFirst()).then(invocation -> {
+            mCurrIdx = 0;
+            return null;
+        });
+        when(mCursor.moveToNext()).then(invocation -> {
+            if (mCurrIdx < mTestValues.size()) {
+                mCurrIdx += 1;
+            }
+            return null;
+        });
+        when(mCursor.getString(eq(TEST_IDX))).thenReturn(mTestValues.get(mCurrIdx));
+        when(mCursor.isAfterLast()).then(invocation -> mCurrIdx >= mTestValues.size());
+    }
+
+    private Uri createUri(String ringtoneTitle) {
+        return new Uri.Builder()
+                .scheme("test")
+                .authority("test")
+                .appendPath(ringtoneTitle)
+                .build();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/sound/VolumeSeekBarPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/sound/VolumeSeekBarPreferenceTest.java
new file mode 100644
index 000000000..ef8ffc364
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/sound/VolumeSeekBarPreferenceTest.java
@@ -0,0 +1,250 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.sound;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.expectThrows;
+
+import android.content.Context;
+import android.graphics.drawable.Drawable;
+import android.os.Parcel;
+import android.os.Parcelable;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.sound.VolumeSeekBarPreference.SavedVolumeState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public final class VolumeSeekBarPreferenceTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+
+    private VolumeSeekBarPreference mVolumeSeekBarPreference;
+
+    @Mock
+    private Drawable mMockMutedIconDrawable;
+
+    @Mock
+    private Drawable mMockUnMutedIconDrawable;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mVolumeSeekBarPreference = new VolumeSeekBarPreference(mContext);
+    }
+
+    @Test
+    public void constructor_failOnNullContext() {
+        NullPointerException thrown =
+                expectThrows(NullPointerException.class, () -> new VolumeSeekBarPreference(null));
+        assertWithMessage("Constructor Exception").that(thrown).hasMessageThat()
+                .contains("Context");
+    }
+
+    @Test
+    public void setMutedIcon_succeedsInSettingMutedIcon() {
+        mVolumeSeekBarPreference.setMutedIcon(mMockMutedIconDrawable);
+
+        assertWithMessage("Volume muted icon")
+                .that(mVolumeSeekBarPreference.getMutedIcon()).isEqualTo(mMockMutedIconDrawable);
+    }
+
+    @Test
+    public void setUnMutedIcon_succeedsInSettingUnMutedIcon() {
+        mVolumeSeekBarPreference.setUnMutedIcon(mMockUnMutedIconDrawable);
+
+        assertWithMessage("Volume un-muted icon")
+                .that(mVolumeSeekBarPreference.getUnMutedIcon())
+                .isEqualTo(mMockUnMutedIconDrawable);
+    }
+
+    @Test
+    public void setMutedIcon_withDefaults_setsIconToUnMuted() {
+        mVolumeSeekBarPreference.setUnMutedIcon(mMockUnMutedIconDrawable);
+        mVolumeSeekBarPreference.setMutedIcon(mMockMutedIconDrawable);
+
+        assertWithMessage("Preference icon")
+                .that(mVolumeSeekBarPreference.getIcon()).isEqualTo(mMockUnMutedIconDrawable);
+    }
+
+    @Test
+    public void setMutedIcon_afterSetIsMuteToTrue_setsIconToMuted() {
+        mVolumeSeekBarPreference.setIsMuted(true);
+
+        mVolumeSeekBarPreference.setMutedIcon(mMockMutedIconDrawable);
+
+        assertWithMessage("Preference icon")
+                .that(mVolumeSeekBarPreference.getIcon()).isEqualTo(mMockMutedIconDrawable);
+    }
+
+    @Test
+    public void setMutedIcon_afterSetIsMuteToFalse_setsIconToUnMuted() {
+        mVolumeSeekBarPreference.setIsMuted(true);
+
+        mVolumeSeekBarPreference.setMutedIcon(mMockMutedIconDrawable);
+
+        assertWithMessage("Preference icon")
+                .that(mVolumeSeekBarPreference.getIcon()).isEqualTo(mMockMutedIconDrawable);
+    }
+
+    @Test
+    public void setIsMuted_withMuted_succeeds() {
+        mVolumeSeekBarPreference.setIsMuted(true);
+
+        assertWithMessage("Is muted state")
+                .that(mVolumeSeekBarPreference.isMuted()).isEqualTo(true);
+    }
+
+    @Test
+    public void setIsMuted_withUnMuted_succeeds() {
+        mVolumeSeekBarPreference.setIsMuted(false);
+
+        assertWithMessage("Is muted state")
+                .that(mVolumeSeekBarPreference.isMuted()).isEqualTo(false);
+    }
+
+    @Test
+    public void setIsMuted_withMutedState_changesIconToMutedIcon() {
+        mVolumeSeekBarPreference.setMutedIcon(mMockMutedIconDrawable);
+        mVolumeSeekBarPreference.setUnMutedIcon(mMockUnMutedIconDrawable);
+        mVolumeSeekBarPreference.setIsMuted(false);
+
+        mVolumeSeekBarPreference.setIsMuted(true);
+
+        assertWithMessage("Preference icon")
+                .that(mVolumeSeekBarPreference.getIcon()).isEqualTo(mMockMutedIconDrawable);
+    }
+
+    @Test
+    public void setIsMuted_withUnMutedState_changesIconToUnMutedIcon() {
+        mVolumeSeekBarPreference.setMutedIcon(mMockMutedIconDrawable);
+        mVolumeSeekBarPreference.setUnMutedIcon(mMockUnMutedIconDrawable);
+        mVolumeSeekBarPreference.setIsMuted(true);
+
+        mVolumeSeekBarPreference.setIsMuted(false);
+
+        assertWithMessage("Preference icon")
+                .that(mVolumeSeekBarPreference.getIcon()).isEqualTo(mMockUnMutedIconDrawable);
+    }
+
+    @Test
+    public void onSaveInstanceState_withPersistent_doesNotReturnVolumeSavedState() {
+        mVolumeSeekBarPreference.setPersistent(true);
+        Parcelable parcelable = mVolumeSeekBarPreference.onSaveInstanceState();
+
+        assertWithMessage("Saved state").that(parcelable.getClass())
+                .isNotEqualTo(SavedVolumeState.class);
+    }
+
+    @Test
+    public void onSaveInstanceState_withoutPersistent_doesReturnVolumeSavedState() {
+        mVolumeSeekBarPreference.setPersistent(false);
+
+        Parcelable parcelable = mVolumeSeekBarPreference.onSaveInstanceState();
+
+        assertWithMessage("Saved state").that(parcelable.getClass())
+                .isEqualTo(SavedVolumeState.class);
+    }
+
+    @Test
+    public void onSaveInstanceState_withPersistent_returnsLastSetIsMuted() {
+        mVolumeSeekBarPreference.setPersistent(false);
+        mVolumeSeekBarPreference.setIsMuted(true);
+
+        Parcelable parcelable = mVolumeSeekBarPreference.onSaveInstanceState();
+
+        SavedVolumeState state =
+                ((SavedVolumeState) parcelable);
+
+        assertWithMessage("Saved state is muted").that(state.isMuted())
+                .isEqualTo(true);
+    }
+
+    @Test
+    public void onRestoreInstanceState_withMutedState_loadsIsUnMuted() {
+        Parcel parcel = mock(Parcel.class);
+        when(parcel.readBoolean()).thenReturn(false);
+        SavedVolumeState savedState = new SavedVolumeState(parcel);
+        mVolumeSeekBarPreference.setIsMuted(true);
+
+        mVolumeSeekBarPreference.onRestoreInstanceState(savedState);
+
+        assertWithMessage("Loaded is un-muted")
+                .that(mVolumeSeekBarPreference.isMuted())
+                .isEqualTo(false);
+    }
+
+    @Test
+    public void onRestoreInstanceState_withMutedState_loadsIsMuted() {
+        Parcel parcel = mock(Parcel.class);
+        when(parcel.readBoolean()).thenReturn(true);
+        SavedVolumeState savedState = new SavedVolumeState(parcel);
+        mVolumeSeekBarPreference.setIsMuted(false);
+
+        mVolumeSeekBarPreference.onRestoreInstanceState(savedState);
+
+        assertWithMessage("Loaded is muted")
+                .that(mVolumeSeekBarPreference.isMuted())
+                .isEqualTo(true);
+    }
+
+    @Test
+    public void writeToParcel_withMuted_writesMutedToParcel() {
+        Parcel parcel = mock(Parcel.class);
+        SavedVolumeState savedState = new SavedVolumeState(parcel);
+        savedState.setIsMuted(true);
+
+        savedState.writeToParcel(parcel, /* flags= */ 0);
+
+        verify(parcel).writeBoolean(true);
+    }
+
+    @Test
+    public void isMuted_forSaveVolumeState_readMutedState() {
+        Parcel parcel = mock(Parcel.class);
+        SavedVolumeState savedState = new SavedVolumeState(parcel);
+        savedState.setIsMuted(true);
+
+        assertWithMessage("Set is muted")
+                .that(savedState.isMuted())
+                .isEqualTo(true);
+    }
+
+    @Test
+    public void isMuted_loadsIsMutedFromParcel() {
+        Parcel parcel = mock(Parcel.class);
+        when(parcel.readBoolean()).thenReturn(true);
+        SavedVolumeState savedState = new SavedVolumeState(parcel);
+
+
+        assertWithMessage("Loaded is muted")
+                .that(savedState.isMuted())
+                .isEqualTo(true);
+    }
+
+}
diff --git a/tests/multivalent/src/com/android/car/settings/sound/VolumeSettingsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/sound/VolumeSettingsPreferenceControllerTest.java
new file mode 100644
index 000000000..00385045a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/sound/VolumeSettingsPreferenceControllerTest.java
@@ -0,0 +1,740 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.sound;
+
+import static android.car.media.CarAudioManager.AUDIO_FEATURE_DYNAMIC_ROUTING;
+import static android.car.media.CarAudioManager.AUDIO_FEATURE_VOLUME_GROUP_EVENTS;
+import static android.car.media.CarAudioManager.AUDIO_FEATURE_VOLUME_GROUP_MUTING;
+import static android.car.media.CarAudioManager.PRIMARY_AUDIO_ZONE;
+import static android.os.UserManager.DISALLOW_ADJUST_VOLUME;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.CarNotConnectedException;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.media.CarAudioManager;
+import android.car.media.CarVolumeGroupEvent;
+import android.car.media.CarVolumeGroupInfo;
+import android.content.Context;
+import android.media.AudioAttributes;
+import android.os.UserManager;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.car.settings.CarSettingsApplication;
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.SeekBarPreference;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class VolumeSettingsPreferenceControllerTest {
+
+    private static final int ZONE_ID = PRIMARY_AUDIO_ZONE;
+    private static final int INVALID_ZONE_ID = -1;
+
+    private static final String TEST_RESTRICTION = DISALLOW_ADJUST_VOLUME;
+
+    private static final int TEST_PRIMARY_ZONE_GROUP_0 = 0;
+    private static final int TEST_PRIMARY_ZONE_GROUP_1 = 1;
+    private static final int MIN_GAIN = 0;
+    private static final int MAX_GAIN = 100;
+    private static final int DEFAULT_GAIN = 50;
+    private static final int NEW_GAIN = 80;
+    private static final int STEP_SIZE = 2;
+    private static final int TEST_DEFAULT_VOLUME = DEFAULT_GAIN / STEP_SIZE;
+    private static final int TEST_NEW_VOLUME = NEW_GAIN / STEP_SIZE;
+    private static final int TEST_MIN_VOLUME = MIN_GAIN / STEP_SIZE;
+    private static final int TEST_MAX_VOLUME = MAX_GAIN / STEP_SIZE;
+    private static final int TEST_MIN_ACTIVATION_VOLUME = TEST_MIN_VOLUME + 1;
+    private static final int TEST_MAX_ACTIVATION_VOLUME = TEST_MAX_VOLUME - 1;
+    private static final CarVolumeGroupInfo TEST_PRIMARY_ZONE_DEFAULT_VOLUME_INFO =
+            new CarVolumeGroupInfo.Builder("group id " + TEST_PRIMARY_ZONE_GROUP_0,
+                    PRIMARY_AUDIO_ZONE, TEST_PRIMARY_ZONE_GROUP_0).setMuted(false)
+                    .setMinVolumeGainIndex(TEST_MIN_VOLUME).setMaxVolumeGainIndex(TEST_MAX_VOLUME)
+                    .setVolumeGainIndex(TEST_DEFAULT_VOLUME)
+                    .setMinActivationVolumeGainIndex(TEST_MIN_ACTIVATION_VOLUME)
+                    .setMaxActivationVolumeGainIndex(TEST_MAX_ACTIVATION_VOLUME).build();
+    private static final CarVolumeGroupInfo TEST_PRIMARY_ZONE_SECOND_VOLUME_INFO =
+            new CarVolumeGroupInfo.Builder("group id " + TEST_PRIMARY_ZONE_GROUP_1,
+                    PRIMARY_AUDIO_ZONE, TEST_PRIMARY_ZONE_GROUP_1).setMuted(false)
+                    .setMinVolumeGainIndex(TEST_MIN_VOLUME).setMaxVolumeGainIndex(TEST_MAX_VOLUME)
+                    .setVolumeGainIndex(TEST_DEFAULT_VOLUME)
+                    .setMinActivationVolumeGainIndex(TEST_MIN_ACTIVATION_VOLUME)
+                    .setMaxActivationVolumeGainIndex(TEST_MAX_ACTIVATION_VOLUME).build();
+    private static final CarVolumeGroupInfo TEST_PRIMARY_ZONE_NEW_VOLUME_INFO =
+            new CarVolumeGroupInfo.Builder("group id " + TEST_PRIMARY_ZONE_GROUP_0,
+                    PRIMARY_AUDIO_ZONE, TEST_PRIMARY_ZONE_GROUP_0).setMuted(false)
+                    .setMinVolumeGainIndex(TEST_MIN_VOLUME).setMaxVolumeGainIndex(TEST_MAX_VOLUME)
+                    .setVolumeGainIndex(TEST_NEW_VOLUME)
+                    .setMinActivationVolumeGainIndex(TEST_MIN_ACTIVATION_VOLUME)
+                    .setMaxActivationVolumeGainIndex(TEST_MAX_ACTIVATION_VOLUME).build();
+    private static final CarVolumeGroupInfo TEST_PRIMARY_ZONE_MUTED_GROUP_INFO =
+            new CarVolumeGroupInfo.Builder("group id " + TEST_PRIMARY_ZONE_GROUP_0,
+                    PRIMARY_AUDIO_ZONE, TEST_PRIMARY_ZONE_GROUP_0).setMuted(true)
+                    .setMinVolumeGainIndex(TEST_MIN_VOLUME).setMaxVolumeGainIndex(TEST_MAX_VOLUME)
+                    .setVolumeGainIndex(TEST_DEFAULT_VOLUME)
+                    .setMinActivationVolumeGainIndex(TEST_MIN_ACTIVATION_VOLUME)
+                    .setMaxActivationVolumeGainIndex(TEST_MAX_ACTIVATION_VOLUME).build();
+    private static final CarVolumeGroupEvent TEST_CAR_VOLUME_GROUP_EVENT_DEFAULT =
+            new CarVolumeGroupEvent.Builder(List.of(TEST_PRIMARY_ZONE_DEFAULT_VOLUME_INFO),
+                    CarVolumeGroupEvent.EVENT_TYPE_VOLUME_GAIN_INDEX_CHANGED,
+                    List.of(CarVolumeGroupEvent.EXTRA_INFO_VOLUME_INDEX_CHANGED_BY_UI)).build();
+    private static final CarVolumeGroupEvent TEST_CAR_VOLUME_GROUP_EVENT_NEW_VOLUME =
+            new CarVolumeGroupEvent.Builder(List.of(TEST_PRIMARY_ZONE_NEW_VOLUME_INFO),
+                    CarVolumeGroupEvent.EVENT_TYPE_VOLUME_GAIN_INDEX_CHANGED,
+                    List.of(CarVolumeGroupEvent.EXTRA_INFO_VOLUME_INDEX_CHANGED_BY_UI)).build();
+    private static final CarVolumeGroupEvent TEST_CAR_VOLUME_GROUP_EVENT_MUTED_GROUP =
+            new CarVolumeGroupEvent.Builder(List.of(TEST_PRIMARY_ZONE_MUTED_GROUP_INFO),
+                    CarVolumeGroupEvent.EVENT_TYPE_MUTE_CHANGED,
+                    List.of(CarVolumeGroupEvent.EXTRA_INFO_VOLUME_INDEX_CHANGED_BY_UI)).build();
+    private static final CarVolumeGroupEvent TEST_CAR_VOLUME_CONFIG_EVENT =
+            new CarVolumeGroupEvent.Builder(List.of(TEST_PRIMARY_ZONE_DEFAULT_VOLUME_INFO,
+                    TEST_PRIMARY_ZONE_SECOND_VOLUME_INFO),
+                    CarVolumeGroupEvent.EVENT_TYPE_ZONE_CONFIGURATION_CHANGED,
+                    List.of(CarVolumeGroupEvent.EXTRA_INFO_SHOW_UI)).build();
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private VolumeSettingsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarAudioManager mCarAudioManager;
+    @Mock
+    private VolumeSettingsRingtoneManager mRingtoneManager;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Toast mMockToast;
+    @Mock
+    private CarSettingsApplication mCarSettingsApplication;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        when(mCarAudioManager.getVolumeGroupCount(ZONE_ID)).thenReturn(1);
+        when(mCarAudioManager.getUsagesForVolumeGroupId(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(new int[]{AudioAttributes.USAGE_MEDIA,
+                        AudioAttributes.USAGE_VOICE_COMMUNICATION});
+        when(mCarAudioManager.getGroupMinVolume(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(TEST_MIN_VOLUME);
+        when(mCarAudioManager.getGroupVolume(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(TEST_DEFAULT_VOLUME);
+        when(mCarAudioManager.getGroupMaxVolume(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(TEST_MAX_VOLUME);
+        when(mCarAudioManager.isVolumeGroupMuted(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(false);
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_VOLUME_GROUP_MUTING))
+                .thenReturn(true);
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_DYNAMIC_ROUTING))
+                .thenReturn(false);
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_VOLUME_GROUP_EVENTS))
+                .thenReturn(false);
+        when(mCarAudioManager.isPlaybackOnVolumeGroupActive(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(false);
+        when(mCarAudioManager.getVolumeGroupInfo(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(TEST_PRIMARY_ZONE_DEFAULT_VOLUME_INFO);
+
+        when(mCarAudioManager.getUsagesForVolumeGroupId(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_1))
+                .thenReturn(new int[]{AudioAttributes.USAGE_VOICE_COMMUNICATION_SIGNALLING,
+                        AudioAttributes.USAGE_ASSISTANCE_NAVIGATION_GUIDANCE });
+        when(mCarAudioManager.getGroupMinVolume(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_1))
+                .thenReturn(TEST_MIN_VOLUME);
+        when(mCarAudioManager.getGroupVolume(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_1))
+                .thenReturn(TEST_DEFAULT_VOLUME);
+        when(mCarAudioManager.getGroupMaxVolume(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_1))
+                .thenReturn(TEST_MAX_VOLUME);
+        when(mCarAudioManager.isVolumeGroupMuted(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_1))
+                .thenReturn(false);
+        when(mCarAudioManager.getVolumeGroupInfo(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_1))
+                .thenReturn(TEST_PRIMARY_ZONE_SECOND_VOLUME_INFO);
+
+        when(mContext.getApplicationContext()).thenReturn(mCarSettingsApplication);
+        when(mCarSettingsApplication.getCarAudioManager()).thenReturn(mCarAudioManager);
+        when(mCarSettingsApplication.getMyAudioZoneId()).thenReturn(ZONE_ID);
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new TestVolumeSettingsPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions, mRingtoneManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testRefreshUi_serviceNotStarted() {
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void testRefreshUi_serviceStarted() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void onServiceConnected_registersVolumeCallback() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        verify(mCarAudioManager).registerCarVolumeCallback(
+                mPreferenceController.mVolumeChangeCallback);
+    }
+
+    @Test
+    public void testRefreshUi_serviceStarted_multipleCalls() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        // Calling this multiple times shouldn't increase the number of elements.
+        mPreferenceController.refreshUi();
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void testRefreshUi_createdPreferenceHasMinMax() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        SeekBarPreference preference = (SeekBarPreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.getMin()).isEqualTo(TEST_MIN_VOLUME);
+        assertThat(preference.getValue()).isEqualTo(TEST_DEFAULT_VOLUME);
+        assertThat(preference.getMax()).isEqualTo(TEST_MAX_VOLUME);
+    }
+
+    @Test
+    public void testOnPreferenceChange_noDynamicAudio_ringtonePlays() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        SeekBarPreference preference = (SeekBarPreference) mPreferenceGroup.getPreference(0);
+        preference.getOnPreferenceChangeListener().onPreferenceChange(preference, TEST_NEW_VOLUME);
+
+        verify(mRingtoneManager).playAudioFeedback(anyInt(), anyInt());
+    }
+
+    @Test
+    public void testOnPreferenceChange_dynamicAudio_playbackActive_ringtoneDoesNotPlay() {
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_DYNAMIC_ROUTING))
+                .thenReturn(true);
+        when(mCarAudioManager.isPlaybackOnVolumeGroupActive(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        SeekBarPreference preference = (SeekBarPreference) mPreferenceGroup.getPreference(0);
+        preference.getOnPreferenceChangeListener().onPreferenceChange(preference, TEST_NEW_VOLUME);
+
+        verify(mRingtoneManager, never()).playAudioFeedback(anyInt(), anyInt());
+    }
+
+    @Test
+    public void testOnPreferenceChange_dynamicAudio_playbackNotActive_ringtonePlays() {
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_DYNAMIC_ROUTING))
+                .thenReturn(true);
+        when(mCarAudioManager.isPlaybackOnVolumeGroupActive(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        SeekBarPreference preference = (SeekBarPreference) mPreferenceGroup.getPreference(0);
+        preference.getOnPreferenceChangeListener().onPreferenceChange(preference, TEST_NEW_VOLUME);
+
+        verify(mRingtoneManager).playAudioFeedback(anyInt(), anyInt());
+    }
+
+    @Test
+    public void testOnPreferenceChange_audioManagerSet() throws CarNotConnectedException {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        SeekBarPreference preference = (SeekBarPreference) mPreferenceGroup.getPreference(0);
+        preference.getOnPreferenceChangeListener().onPreferenceChange(preference, TEST_NEW_VOLUME);
+
+        verify(mCarAudioManager).setGroupVolume(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0, TEST_NEW_VOLUME,
+                /* flags= */ 0);
+    }
+
+    @Test
+    public void onGroupVolumeChanged_sameValue_doesNotUpdateVolumeSeekbar() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        SeekBarPreference preference = spy((SeekBarPreference) mPreferenceGroup.getPreference(0));
+        mPreferenceController.mVolumeChangeCallback.onGroupVolumeChanged(ZONE_ID,
+                TEST_PRIMARY_ZONE_GROUP_0, /* flags= */ 0);
+
+        verify(preference, never()).setValue(any(Integer.class));
+    }
+
+    @Test
+    public void onGroupVolumeChanged_differentValue_updatesVolumeSeekbar() {
+        when(mCarAudioManager.getVolumeGroupInfo(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(TEST_PRIMARY_ZONE_NEW_VOLUME_INFO);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        mPreferenceController.mVolumeChangeCallback.onGroupVolumeChanged(ZONE_ID,
+                TEST_PRIMARY_ZONE_GROUP_0, /* flags= */ 0);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        SeekBarPreference preference = (SeekBarPreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.getValue()).isEqualTo(TEST_NEW_VOLUME);
+    }
+
+    @Test
+    public void onGroupVolumeChanged_invalidZoneId_doesNotUpdateVolumeSeekbar() {
+        when(mCarAudioManager.getVolumeGroupInfo(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(TEST_PRIMARY_ZONE_NEW_VOLUME_INFO);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        mPreferenceController.mVolumeChangeCallback.onGroupVolumeChanged(INVALID_ZONE_ID,
+                TEST_PRIMARY_ZONE_GROUP_0, /* flags= */ 0);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        SeekBarPreference preference =
+                (SeekBarPreference) spy(mPreferenceGroup.getPreference(0));
+        verify(preference, never()).setValue(any(Integer.class));
+    }
+
+    @Test
+    public void onGroupMuteChanged_sameValue_doesNotUpdateIsMuted() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        mPreferenceController.mVolumeChangeCallback.onGroupMuteChanged(ZONE_ID,
+                TEST_PRIMARY_ZONE_GROUP_0, /* flags= */ 0);
+
+        verify(preference, never()).setIsMuted(any(Boolean.class));
+    }
+
+    @Test
+    public void onGroupMuteChanged_differentValue_updatesMutedState() {
+        when(mCarAudioManager.getVolumeGroupInfo(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(TEST_PRIMARY_ZONE_MUTED_GROUP_INFO);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        mPreferenceController.mVolumeChangeCallback.onGroupMuteChanged(ZONE_ID,
+                TEST_PRIMARY_ZONE_GROUP_0, /* flags= */ 0);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        VolumeSeekBarPreference preference =
+                (VolumeSeekBarPreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isMuted()).isEqualTo(true);
+    }
+
+    @Test
+    public void onGroupMuteChanged_differentValue_muteFeatureDisabled_doesNotUpdatesMutedState() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        when(mCarAudioManager.isVolumeGroupMuted(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(true);
+        when(mCarAudioManager.isAudioFeatureEnabled(AUDIO_FEATURE_VOLUME_GROUP_MUTING))
+                .thenReturn(false);
+        mPreferenceController.mVolumeChangeCallback.onGroupMuteChanged(ZONE_ID,
+                TEST_PRIMARY_ZONE_GROUP_0, /* flags= */ 0);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        VolumeSeekBarPreference preference =
+                (VolumeSeekBarPreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isMuted()).isEqualTo(false);
+    }
+
+    @Test
+    public void onGroupMuteChanged_invalidZoneId_doesNotUpdateMutedState() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        when(mCarAudioManager.isVolumeGroupMuted(ZONE_ID, TEST_PRIMARY_ZONE_GROUP_0))
+                .thenReturn(true);
+        mPreferenceController.mVolumeChangeCallback.onGroupMuteChanged(ZONE_ID,
+                TEST_PRIMARY_ZONE_GROUP_0, /* flags= */ 0);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        VolumeSeekBarPreference preference =
+                (VolumeSeekBarPreference) spy(mPreferenceGroup.getPreference(0));
+        verify(preference, never()).setIsMuted(any(Boolean.class));
+    }
+
+    @Test
+    public void onVolumeGroupEvent_sameGroupInfo_doesNotUpdateVolumeSeekbar() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        SeekBarPreference preference = spy((SeekBarPreference) mPreferenceGroup.getPreference(0));
+
+        mPreferenceController.mCarVolumeGroupEventCallback.onVolumeGroupEvent(
+                List.of(TEST_CAR_VOLUME_GROUP_EVENT_DEFAULT));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(preference, never()).setValue(any(Integer.class));
+    }
+
+    @Test
+    public void onVolumeGroupEvent_differentGroupInfo_updatesVolumeSeekbar() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        mPreferenceController.mCarVolumeGroupEventCallback.onVolumeGroupEvent(
+                List.of(TEST_CAR_VOLUME_GROUP_EVENT_NEW_VOLUME));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        SeekBarPreference preference = (SeekBarPreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.getValue()).isEqualTo(TEST_NEW_VOLUME);
+    }
+
+    @Test
+    public void onVolumeGroupEvent_invalidGroupInfo_doesNotUpdateVolumeSeekbar() {
+        CarVolumeGroupInfo invalidGroupInfo =
+                new CarVolumeGroupInfo.Builder("group id " + 0, 1 /* ZoneId */, 0).setMuted(false)
+                        .setMinVolumeGainIndex(TEST_MIN_VOLUME)
+                        .setMaxVolumeGainIndex(TEST_MAX_VOLUME)
+                        .setVolumeGainIndex(TEST_DEFAULT_VOLUME)
+                        .setMinActivationVolumeGainIndex(TEST_MIN_ACTIVATION_VOLUME)
+                        .setMaxActivationVolumeGainIndex(TEST_MAX_ACTIVATION_VOLUME).build();
+        CarVolumeGroupEvent eventWithInvalidGroupInfo =
+                new CarVolumeGroupEvent.Builder(List.of(invalidGroupInfo),
+                        CarVolumeGroupEvent.EVENT_TYPE_VOLUME_GAIN_INDEX_CHANGED,
+                        List.of(CarVolumeGroupEvent.EXTRA_INFO_VOLUME_INDEX_CHANGED_BY_UI)).build();
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        mPreferenceController.mCarVolumeGroupEventCallback.onVolumeGroupEvent(
+                List.of(eventWithInvalidGroupInfo));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        SeekBarPreference preference = spy((SeekBarPreference) mPreferenceGroup.getPreference(0));
+        verify(preference, never()).setValue(any(Integer.class));
+    }
+
+    @Test
+    public void onVolumeGroupEvent_groupMuteChanged_updatesVolumeSeekbar() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        mPreferenceController.mCarVolumeGroupEventCallback.onVolumeGroupEvent(
+                List.of(TEST_CAR_VOLUME_GROUP_EVENT_MUTED_GROUP));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        VolumeSeekBarPreference preference =
+                (VolumeSeekBarPreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isMuted()).isTrue();
+    }
+
+    @Test
+    public void onVolumeGroupEvent_groupMuteUnchanged_doesNotUpdateVolumeSeekbar() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        mPreferenceController.mCarVolumeGroupEventCallback.onVolumeGroupEvent(
+                List.of(TEST_CAR_VOLUME_GROUP_EVENT_DEFAULT));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        VolumeSeekBarPreference preference =
+                (VolumeSeekBarPreference) spy(mPreferenceGroup.getPreference(0));
+        verify(preference, never()).setIsMuted(any(Boolean.class));
+        assertThat(preference.isMuted()).isFalse();
+    }
+
+    @Test
+    public void onVolumeGroupEvent_groupConfigChange_updatesPreferences() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+        when(mCarAudioManager.getVolumeGroupCount(ZONE_ID)).thenReturn(2);
+
+        mPreferenceController.mCarVolumeGroupEventCallback.onVolumeGroupEvent(
+                List.of(TEST_CAR_VOLUME_CONFIG_EVENT));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_unavailable() {
+        mockUserRestrictionSetByUm(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_unavailable_zoneWrite() {
+        mockUserRestrictionSetByUm(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_unavailable_zoneRead() {
+        mockUserRestrictionSetByUm(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByUm_unavailable_zoneHidden() {
+        mockUserRestrictionSetByUm(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_unavailable() {
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_unavailable_zoneWrite() {
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_unavailable_zoneRead() {
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_restrictedByDpm_unavailable_zoneHidden() {
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_unrestricted_available() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_unrestricted_available_zoneWrite() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_unrestricted_available_zoneRead() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        assertThat(preference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_unrestricted_available_zoneHidden() {
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByDpm_showDialog() {
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        preference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByUm_showToast() {
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        VolumeSeekBarPreference preference =
+                spy((VolumeSeekBarPreference) mPreferenceGroup.getPreference(0));
+        preference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    private static class TestVolumeSettingsPreferenceController extends
+            VolumeSettingsPreferenceController {
+
+        TestVolumeSettingsPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions,
+                VolumeSettingsRingtoneManager ringtoneManager) {
+            super(context, preferenceKey, fragmentController, uxRestrictions, ringtoneManager);
+        }
+
+        @Override
+        public int carVolumeItemsXml() {
+            return R.xml.test_car_volume_items;
+        }
+    }
+
+    private void mockUserRestrictionSetByUm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+                .thenReturn(restricted);
+    }
+
+    private void mockUserRestrictionSetByDpm(boolean restricted) {
+        mockUserRestrictionSetByUm(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private void assertShowingBlockedToast() {
+        String toastText = mContext.getString(R.string.action_unavailable);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/AppsStorageStatsManagerTest.java b/tests/multivalent/src/com/android/car/settings/storage/AppsStorageStatsManagerTest.java
new file mode 100644
index 000000000..a063efc9b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/AppsStorageStatsManagerTest.java
@@ -0,0 +1,153 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+
+import android.app.usage.StorageStats;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.os.Bundle;
+
+import androidx.loader.app.LoaderManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.applications.StorageStatsSource;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AppsStorageStatsManagerTest {
+
+    private static final int USER_ID = 10;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private AppsStorageStatsManager mAppsStorageStatsManager;
+
+    @Captor
+    private ArgumentCaptor<LoaderManager.LoaderCallbacks<StorageStatsSource.AppStorageStats>>
+            mCallbacksArgumentCaptor;
+
+    @Mock
+    private AppsStorageStatsManager.Callback mCallback1;
+
+    @Mock
+    private AppsStorageStatsManager.Callback mCallback2;
+
+    @Mock
+    private LoaderManager mLoaderManager;
+
+    @Mock
+    private ApplicationInfo mApplicationInfo;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+
+        mAppsStorageStatsManager = new AppsStorageStatsManager(mContext);
+        mAppsStorageStatsManager.startLoading(mLoaderManager, mApplicationInfo, USER_ID, false,
+                false);
+        verify(mLoaderManager).restartLoader(eq(1), eq(Bundle.EMPTY),
+                mCallbacksArgumentCaptor.capture());
+    }
+
+    @Test
+    public void callback_onLoadFinished_listenerOnDataLoadedCalled() {
+        mAppsStorageStatsManager.registerListener(mCallback1);
+        mAppsStorageStatsManager.registerListener(mCallback2);
+
+        StorageStats stats = new StorageStats();
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, storageStats);
+
+        verify(mCallback1).onDataLoaded(storageStats, false, false);
+        verify(mCallback2).onDataLoaded(storageStats, false, false);
+    }
+
+    @Test
+    public void callback_unregisterListener_onlyOneListenerOnDataLoadedCalled() {
+        mAppsStorageStatsManager.registerListener(mCallback1);
+        mAppsStorageStatsManager.registerListener(mCallback2);
+        mAppsStorageStatsManager.unregisterListener(mCallback2);
+        StorageStats stats = new StorageStats();
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mCallbacksArgumentCaptor.getValue().onLoadFinished(null, storageStats);
+
+        verify(mCallback1).onDataLoaded(storageStats, false, false);
+        verify(mCallback2, never()).onDataLoaded(storageStats, false, false);
+    }
+
+    @Test
+    public void callback_notLoaded_listenerOnDataLoadedCalled() {
+        mAppsStorageStatsManager.registerListener(mCallback1);
+        mAppsStorageStatsManager.registerListener(mCallback2);
+
+        StorageStats stats = new StorageStats();
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        verify(mCallback1, never()).onDataLoaded(storageStats, false, false);
+        verify(mCallback2, never()).onDataLoaded(storageStats, false, false);
+    }
+
+    @Test
+    public void callback_cachedCleared_listenerOnDataLoadedCalled() {
+        mAppsStorageStatsManager = new AppsStorageStatsManager(mContext);
+        mAppsStorageStatsManager.startLoading(mLoaderManager, mApplicationInfo, USER_ID, true,
+                false);
+
+        mAppsStorageStatsManager.registerListener(mCallback1);
+        mAppsStorageStatsManager.registerListener(mCallback2);
+
+        StorageStats stats = new StorageStats();
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        verify(mCallback1, never()).onDataLoaded(storageStats, true, false);
+        verify(mCallback2, never()).onDataLoaded(storageStats, true, false);
+    }
+
+    @Test
+    public void callback_userDataCleared_listenerOnDataLoadedCalled() {
+        mAppsStorageStatsManager = new AppsStorageStatsManager(mContext);
+        mAppsStorageStatsManager.startLoading(mLoaderManager, mApplicationInfo, USER_ID, false,
+                true);
+
+        mAppsStorageStatsManager.registerListener(mCallback1);
+        mAppsStorageStatsManager.registerListener(mCallback2);
+
+        StorageStats stats = new StorageStats();
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        verify(mCallback1, never()).onDataLoaded(storageStats, false, true);
+        verify(mCallback2, never()).onDataLoaded(storageStats, false, true);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/FileSizeFormatterTest.java b/tests/multivalent/src/com/android/car/settings/storage/FileSizeFormatterTest.java
new file mode 100644
index 000000000..5d7a11490
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/FileSizeFormatterTest.java
@@ -0,0 +1,104 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.android.car.settings.storage.FileSizeFormatter.GIGABYTE_IN_BYTES;
+import static com.android.car.settings.storage.FileSizeFormatter.MEGABYTE_IN_BYTES;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.icu.util.MeasureUnit;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class FileSizeFormatterTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+
+    @Test
+    public void formatFileSize_zero() {
+        assertThat(
+            FileSizeFormatter.formatFileSize(
+                mContext,
+                0,
+                MeasureUnit.GIGABYTE,
+                GIGABYTE_IN_BYTES))
+            .isEqualTo("0.00 GB");
+    }
+
+    @Test
+    public void formatFileSize_smallSize() {
+        assertThat(
+            FileSizeFormatter.formatFileSize(
+                mContext,
+                MEGABYTE_IN_BYTES * 11,
+                MeasureUnit.GIGABYTE,
+                GIGABYTE_IN_BYTES))
+            .isEqualTo("0.01 GB");
+    }
+
+    @Test
+    public void formatFileSize_lessThanOneSize() {
+        assertThat(
+            FileSizeFormatter.formatFileSize(
+                mContext,
+                MEGABYTE_IN_BYTES * 155,
+                MeasureUnit.GIGABYTE,
+                GIGABYTE_IN_BYTES))
+            .isEqualTo("0.16 GB");
+    }
+
+    @Test
+    public void formatFileSize_greaterThanOneSize() {
+        assertThat(
+            FileSizeFormatter.formatFileSize(
+                mContext,
+                MEGABYTE_IN_BYTES * 1551,
+                MeasureUnit.GIGABYTE,
+                GIGABYTE_IN_BYTES))
+            .isEqualTo("1.6 GB");
+    }
+
+    @Test
+    public void formatFileSize_greaterThanTen() {
+        // Should round down due to truncation
+        assertThat(
+            FileSizeFormatter.formatFileSize(
+                mContext,
+                GIGABYTE_IN_BYTES * 15 + MEGABYTE_IN_BYTES * 50,
+                MeasureUnit.GIGABYTE,
+                GIGABYTE_IN_BYTES))
+            .isEqualTo("15 GB");
+    }
+
+    @Test
+    public void formatFileSize_handlesNegativeFileSizes() {
+        assertThat(
+            FileSizeFormatter.formatFileSize(
+                mContext,
+                MEGABYTE_IN_BYTES * -155,
+                MeasureUnit.GIGABYTE,
+                GIGABYTE_IN_BYTES))
+            .isEqualTo("-0.16 GB");
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageApplicationActionButtonsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageApplicationActionButtonsPreferenceControllerTest.java
new file mode 100644
index 000000000..7b54187a8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageApplicationActionButtonsPreferenceControllerTest.java
@@ -0,0 +1,431 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons;
+import static com.android.car.settings.storage.StorageApplicationActionButtonsPreferenceController.CONFIRM_CLEAR_STORAGE_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.testng.Assert.assertThrows;
+
+import android.app.usage.StorageStats;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+
+import androidx.fragment.app.DialogFragment;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.loader.app.LoaderManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ActionButtonInfo;
+import com.android.car.settings.common.ActionButtonsPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.RestrictedLockUtils;
+import com.android.settingslib.applications.ApplicationsState;
+import com.android.settingslib.applications.StorageStatsSource;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageApplicationActionButtonsPreferenceControllerTest {
+
+    private static final String PACKAGE_NAME = "Test Package Name";
+    private static final String TEST_MANAGE_STORAGE_ACTIVITY = "TestActivity";
+    private static final String SOURCE = "source";
+    private static final int UID = 12;
+    private static final String LABEL = "label";
+    private static final String SIZE_STR = "12.34 MB";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ActionButtonsPreference mActionButtonsPreference;
+    private StorageApplicationActionButtonsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ApplicationsState.AppEntry mMockAppEntry;
+    @Mock
+    private AppsStorageStatsManager mMockAppsStorageStatsManager;
+    @Mock
+    private LoaderManager mMockLoaderManager;
+    @Mock
+    private PackageManager mMockPm;
+    @Mock
+    private RestrictedLockUtils.EnforcedAdmin mEnforcedAdmin;
+
+    @Before
+    @UiThreadTest // required because controller uses a handler
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.uid = UID;
+        appInfo.sourceDir = SOURCE;
+        appInfo.packageName = PACKAGE_NAME;
+        appInfo.manageSpaceActivityName = TEST_MANAGE_STORAGE_ACTIVITY;
+
+        ApplicationsState.AppEntry appEntry = new ApplicationsState.AppEntry(mContext, appInfo,
+                1234L);
+        appEntry.label = LABEL;
+        appEntry.sizeStr = SIZE_STR;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+        appEntry.info.packageName = PACKAGE_NAME;
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mActionButtonsPreference = new ActionButtonsPreference(mContext);
+        mPreferenceController = new StorageApplicationActionButtonsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+
+        mPreferenceController.setPackageManager(mMockPm);
+    }
+
+    @Test
+    public void testCheckInitialized_noAppEntry_throwException() {
+        mPreferenceController.setPackageName(PACKAGE_NAME).setAppsStorageStatsManager(
+                mMockAppsStorageStatsManager).setLoaderManager(mMockLoaderManager);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mActionButtonsPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noPackageNameEntry_throwException() {
+        mPreferenceController.setAppEntry(mMockAppEntry).setAppsStorageStatsManager(
+                mMockAppsStorageStatsManager).setLoaderManager(mMockLoaderManager);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mActionButtonsPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noAppsStorageStatsManagerEntry_throwException() {
+        mPreferenceController.setAppEntry(mMockAppEntry).setPackageName(
+                PACKAGE_NAME).setLoaderManager(mMockLoaderManager);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mActionButtonsPreference));
+    }
+
+    @Test
+    public void testCheckInitialized_noLoaderManager_throwException() {
+        mPreferenceController.setAppEntry(mMockAppEntry).setPackageName(
+                PACKAGE_NAME).setAppsStorageStatsManager(mMockAppsStorageStatsManager);
+        assertThrows(IllegalStateException.class,
+                () -> PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                        mActionButtonsPreference));
+    }
+
+    @Test
+    public void onCreate_defaultStatus_shouldShowCacheButtons() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getClearCacheButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "storage_clear_cache_btn_text"));
+    }
+
+    @Test
+    public void onCreate_defaultStatus_shouldShowClearStorageButtons() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(getClearStorageButton().getText()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "storage_clear_user_data_text"));
+    }
+
+    @Test
+    public void handleClearCacheClick_disallowedBySystem_shouldNotDeleteApplicationCache() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAppsControlDisallowedAdmin(mEnforcedAdmin);
+        mPreferenceController.setAppsControlDisallowedBySystem(false);
+
+        doNothing().when(mMockPm).deleteApplicationCacheFiles(anyString(), any());
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 0;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+        getClearCacheButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mMockPm, never()).deleteApplicationCacheFiles(anyString(), any());
+    }
+
+    @Test
+    public void handleClearCacheClick_allowedBySystem_shouldNotDeleteApplicationCache() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAppsControlDisallowedAdmin(mEnforcedAdmin);
+        mPreferenceController.setAppsControlDisallowedBySystem(true);
+
+        doNothing().when(mMockPm).deleteApplicationCacheFiles(anyString(), any());
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 0;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+        getClearCacheButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mMockPm).deleteApplicationCacheFiles(anyString(), any());
+    }
+
+    @Test
+    public void handleClearDataClick_disallowedBySystem_shouldNotShowDialogToClear() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAppsControlDisallowedAdmin(mEnforcedAdmin);
+        mPreferenceController.setAppsControlDisallowedBySystem(false);
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 10;
+        stats.cacheBytes = 10;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+
+        assertThat(getClearStorageButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void handleClearDataClick_allowedBySystem_shouldShowDialogToClear() {
+        mMockAppEntry.info = new ApplicationInfo();
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAppsControlDisallowedAdmin(mEnforcedAdmin);
+        mPreferenceController.setAppsControlDisallowedBySystem(true);
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 10;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+        getClearStorageButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(DialogFragment.class),
+                eq(CONFIRM_CLEAR_STORAGE_DIALOG_TAG));
+    }
+
+    @Test
+    public void handleClearDataClick_hasValidManageSpaceActivity_shouldNotShowDialogToClear() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = PACKAGE_NAME;
+        info.manageSpaceActivityName = TEST_MANAGE_STORAGE_ACTIVITY;
+        mMockAppEntry.info = info;
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAppsControlDisallowedAdmin(mEnforcedAdmin);
+        mPreferenceController.setAppsControlDisallowedBySystem(true);
+
+        when(mMockPm.resolveActivity(any(Intent.class), eq(0))).thenReturn(new ResolveInfo());
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 10;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+        getClearStorageButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController, never()).showDialog(any(DialogFragment.class),
+                eq(CONFIRM_CLEAR_STORAGE_DIALOG_TAG));
+    }
+
+    @Test
+    public void handleClearDataClick_hasInvalidManageSpaceActivity_shouldShowDialogToClear() {
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = PACKAGE_NAME;
+        info.manageSpaceActivityName = TEST_MANAGE_STORAGE_ACTIVITY;
+        mMockAppEntry.info = info;
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.setAppsControlDisallowedAdmin(mEnforcedAdmin);
+        mPreferenceController.setAppsControlDisallowedBySystem(true);
+
+        when(mMockPm.resolveActivity(any(Intent.class), eq(0))).thenReturn(null);
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 10;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+        getClearStorageButton().getOnClickListener().onClick(/* view= */ null);
+
+        verify(mFragmentController).showDialog(any(DialogFragment.class),
+                eq(CONFIRM_CLEAR_STORAGE_DIALOG_TAG));
+    }
+
+    @Test
+    public void onDataLoaded_noResult_buttonsShouldBeDisabled() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.onDataLoaded(null, false, false);
+
+        assertThat(getClearCacheButton().isEnabled()).isFalse();
+        assertThat(getClearStorageButton().isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onDataLoaded_resultLoaded_cacheButtonsShouldBeEnabled() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 10;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+
+        assertThat(getClearCacheButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onDataLoaded_resultLoaded_dataButtonsShouldBeEnabled() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 10;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+
+        assertThat(getClearStorageButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void updateUiWithSize_resultLoaded_cacheButtonDisabledAndDataButtonsEnabled() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 50;
+        stats.cacheBytes = 0;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+
+        assertThat(getClearCacheButton().isEnabled()).isFalse();
+        assertThat(getClearStorageButton().isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onDataLoaded_resultLoaded_cacheButtonEnabledAndDataButtonDisabled() {
+        setupAndAssignPreference();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = 100;
+        stats.dataBytes = 10;
+        stats.cacheBytes = 10;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        mPreferenceController.onDataLoaded(storageStats, false, false);
+
+        assertThat(getClearCacheButton().isEnabled()).isTrue();
+        assertThat(getClearStorageButton().isEnabled()).isFalse();
+    }
+
+    private void setupAndAssignPreference() {
+        mPreferenceController.setAppEntry(mMockAppEntry).setPackageName(
+                PACKAGE_NAME).setAppsStorageStatsManager(mMockAppsStorageStatsManager)
+                .setLoaderManager(mMockLoaderManager);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mActionButtonsPreference);
+    }
+
+    private ActionButtonInfo getClearCacheButton() {
+        return mActionButtonsPreference.getButton(ActionButtons.BUTTON2);
+    }
+
+    private ActionButtonInfo getClearStorageButton() {
+        return mActionButtonsPreference.getButton(ActionButtons.BUTTON1);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageApplicationListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageApplicationListPreferenceControllerTest.java
new file mode 100644
index 000000000..2e62f9ec9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageApplicationListPreferenceControllerTest.java
@@ -0,0 +1,145 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageApplicationListPreferenceControllerTest {
+
+    private static final String SOURCE = "source";
+    private static final int UID = 12;
+    private static final String LABEL = "label";
+    private static final String SIZE_STR = "12.34 MB";
+    private static final String UPDATED_SIZE_STR = "15.34 MB";
+    private static final String PACKAGE_NAME = "com.google.packageName";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mLogicalPreferenceGroup;
+    private StorageApplicationListPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mLogicalPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mLogicalPreferenceGroup);
+        mPreferenceController = new StorageApplicationListPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mLogicalPreferenceGroup);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void defaultInitialize_hasNoPreference() {
+        assertThat(mLogicalPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void onDataLoaded_addPreference_hasOnePreference() {
+        ArrayList<ApplicationsState.AppEntry> apps = new ArrayList<>();
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.uid = UID;
+        appInfo.sourceDir = SOURCE;
+
+        ApplicationsState.AppEntry appEntry = new ApplicationsState.AppEntry(mContext, appInfo,
+                1234L);
+        appEntry.label = LABEL;
+        appEntry.sizeStr = SIZE_STR;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+        appEntry.info.packageName = PACKAGE_NAME;
+        apps.add(appEntry);
+
+        mPreferenceController.onDataLoaded(apps);
+
+        assertThat(mLogicalPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mLogicalPreferenceGroup.getPreference(0).getTitle()).isEqualTo(LABEL);
+        assertThat(mLogicalPreferenceGroup.getPreference(0).getSummary()).isEqualTo(SIZE_STR);
+    }
+
+    @Test
+    public void onDataLoaded_updatePreference_hasOnePreferenceWithUpdatedValues() {
+        ArrayList<ApplicationsState.AppEntry> apps = new ArrayList<>();
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.uid = UID;
+        appInfo.sourceDir = SOURCE;
+
+        ApplicationsState.AppEntry appEntry = new ApplicationsState.AppEntry(mContext, appInfo,
+                1234L);
+        appEntry.label = LABEL;
+        appEntry.sizeStr = SIZE_STR;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+        appEntry.info.packageName = PACKAGE_NAME;
+        apps.add(appEntry);
+
+        mPreferenceController.onDataLoaded(apps);
+
+        apps.clear();
+        appEntry = new ApplicationsState.AppEntry(mContext, appInfo, 1234L);
+        appEntry.label = LABEL;
+        appEntry.sizeStr = UPDATED_SIZE_STR;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+        appEntry.info.packageName = PACKAGE_NAME;
+        apps.add(appEntry);
+
+        mPreferenceController.onDataLoaded(apps);
+
+        assertThat(mLogicalPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+        assertThat(mLogicalPreferenceGroup.getPreference(0).getTitle()).isEqualTo(LABEL);
+        assertThat(mLogicalPreferenceGroup.getPreference(0).getSummary()).isEqualTo(
+                UPDATED_SIZE_STR);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageAsyncLoaderTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageAsyncLoaderTest.java
new file mode 100644
index 000000000..80b98b9ac
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageAsyncLoaderTest.java
@@ -0,0 +1,280 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.when;
+
+import android.app.usage.StorageStats;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.UserInfo;
+import android.os.UserHandle;
+import android.util.DataUnit;
+import android.util.SparseArray;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.profiles.ProfileHelper;
+import com.android.settingslib.applications.StorageStatsSource;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageAsyncLoaderTest {
+
+    private static final int PRIMARY_USER_ID = 0;
+    private static final int SECONDARY_USER_ID = 10;
+    private static final String PACKAGE_NAME_1 = "com.blah.test";
+    private static final String PACKAGE_NAME_2 = "com.blah.test2";
+    private static final long DEFAULT_QUOTA = DataUnit.MEBIBYTES.toBytes(64);
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private List<UserInfo> mUsers;
+
+    private StorageAsyncLoader mLoader;
+
+    @Mock
+    private StorageStatsSource mMockSource;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private ProfileHelper mMockProfileHelper;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+
+        mLoader = new StorageAsyncLoader(mContext, mMockSource, mMockPackageManager,
+                mMockProfileHelper);
+        UserInfo info = new UserInfo();
+        info.id = PRIMARY_USER_ID;
+        mUsers = new ArrayList<>();
+        mUsers.add(info);
+        when(mMockProfileHelper.getAllProfiles()).thenReturn(mUsers);
+        when(mMockSource.getCacheQuotaBytes(any(), anyInt())).thenReturn(DEFAULT_QUOTA);
+    }
+
+    @Test
+    public void testLoadingApps() throws Exception {
+        ApplicationInfo appInfo1 = createAppInfo(PACKAGE_NAME_1, 0, 1, 10,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+        ApplicationInfo appInfo2 = createAppInfo(PACKAGE_NAME_2, 0, 100, 1000,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Arrays.asList(appInfo1, appInfo2));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(1);
+        assertThat(result.get(PRIMARY_USER_ID).getGamesSize()).isEqualTo(0L);
+        assertThat(result.get(PRIMARY_USER_ID).getOtherAppsSize()).isEqualTo(2200L);
+    }
+
+    @Test
+    public void testGamesAreFiltered() throws Exception {
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 0, 1, 10,
+                ApplicationInfo.CATEGORY_GAME);
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Collections.singletonList(appInfo));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(1);
+        assertThat(result.get(PRIMARY_USER_ID).getGamesSize()).isEqualTo(11L);
+        assertThat(result.get(PRIMARY_USER_ID).getOtherAppsSize()).isEqualTo(0L);
+    }
+
+    @Test
+    public void testLegacyGamesAreFiltered() throws Exception {
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 0, 1, 10,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+        appInfo.flags = ApplicationInfo.FLAG_IS_GAME;
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Collections.singletonList(appInfo));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(1);
+        assertThat(result.get(PRIMARY_USER_ID).getGamesSize()).isEqualTo(11L);
+        assertThat(result.get(PRIMARY_USER_ID).getOtherAppsSize()).isEqualTo(0L);
+    }
+
+    @Test
+    public void testCacheIsNotIgnored() throws Exception {
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 100, 1, 10,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Collections.singletonList(appInfo));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(1);
+        assertThat(result.get(PRIMARY_USER_ID).getOtherAppsSize()).isEqualTo(111L);
+    }
+
+    @Test
+    public void testMultipleUsers() throws Exception {
+        UserInfo info = new UserInfo();
+        info.id = SECONDARY_USER_ID;
+        mUsers.add(info);
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 100, 1, 10,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ eq(0), anyInt()))
+                .thenReturn(Collections.singletonList(appInfo));
+        when(mMockSource.getExternalStorageStats(any(), eq(UserHandle.SYSTEM)))
+                .thenReturn(new StorageStatsSource.ExternalStorageStats(9, 2, 3, 4, 0));
+        when(mMockSource.getExternalStorageStats(any(), eq(new UserHandle(SECONDARY_USER_ID))))
+                .thenReturn(new StorageStatsSource.ExternalStorageStats(10, 3, 3, 4, 0));
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(2);
+        assertThat(result.get(PRIMARY_USER_ID).getExternalStats().totalBytes).isEqualTo(9L);
+        assertThat(result.get(SECONDARY_USER_ID).getExternalStats().totalBytes).isEqualTo(10L);
+    }
+
+    @Test
+    public void testUpdatedSystemAppCodeSizeIsCounted() throws Exception {
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 100, 1, 10,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+        appInfo.flags = ApplicationInfo.FLAG_SYSTEM & ApplicationInfo.FLAG_UPDATED_SYSTEM_APP;
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Collections.singletonList(appInfo));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(1);
+        assertThat(result.get(PRIMARY_USER_ID).getOtherAppsSize()).isEqualTo(111L);
+    }
+
+    @Test
+    public void testVideoAppsAreFiltered() throws Exception {
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 0, 1, 10,
+                ApplicationInfo.CATEGORY_VIDEO);
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Collections.singletonList(appInfo));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(1);
+        assertThat(result.get(PRIMARY_USER_ID).getVideoAppsSize()).isEqualTo(11L);
+        assertThat(result.get(PRIMARY_USER_ID).getOtherAppsSize()).isEqualTo(0L);
+    }
+
+    @Test
+    public void testRemovedPackageDoesNotCrash() throws Exception {
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 0, 1, 10,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Collections.singletonList(appInfo));
+        when(mMockSource.getStatsForPackage(any(), anyString(), any(UserHandle.class)))
+                .thenThrow(new PackageManager.NameNotFoundException());
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        // Should not crash.
+    }
+
+    @Test
+    public void testPackageIsNotDoubleCounted() throws Exception {
+        UserInfo info = new UserInfo();
+        info.id = SECONDARY_USER_ID;
+        mUsers.add(info);
+        when(mMockSource.getExternalStorageStats(anyString(), eq(UserHandle.SYSTEM)))
+                .thenReturn(new StorageStatsSource.ExternalStorageStats(9, 2, 3,
+                        4, 0));
+        when(mMockSource.getExternalStorageStats(anyString(),
+                eq(new UserHandle(SECONDARY_USER_ID))))
+                .thenReturn(new StorageStatsSource.ExternalStorageStats(10, 3, 3,
+                        4, 0));
+
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, 0, 1, 10,
+                ApplicationInfo.CATEGORY_VIDEO);
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ eq(0), anyInt()))
+                .thenReturn(Collections.singletonList(appInfo));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(2);
+        assertThat(result.get(PRIMARY_USER_ID).getVideoAppsSize()).isEqualTo(11L);
+        // No code size for the second user.
+        assertThat(result.get(SECONDARY_USER_ID).getVideoAppsSize()).isEqualTo(10L);
+    }
+
+    @Test
+    public void testCacheOveragesAreCountedAsFree() throws Exception {
+        ApplicationInfo appInfo = createAppInfo(PACKAGE_NAME_1, DEFAULT_QUOTA + 100, 1, 10,
+                ApplicationInfo.CATEGORY_UNDEFINED);
+
+        when(mMockPackageManager.getInstalledApplicationsAsUser(
+                /* getAllInstalledApplications= */ 0, PRIMARY_USER_ID))
+                .thenReturn(Collections.singletonList(appInfo));
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> result = mLoader.loadInBackground();
+
+        assertThat(result.size()).isEqualTo(1);
+        assertThat(result.get(PRIMARY_USER_ID).getOtherAppsSize()).isEqualTo(DEFAULT_QUOTA + 11);
+    }
+
+    private ApplicationInfo createAppInfo(String packageName, long cacheSize, long codeSize,
+            long dataSize, int category) throws Exception {
+        StorageStats stats = new StorageStats();
+        stats.codeBytes = codeSize;
+        stats.dataBytes = dataSize + cacheSize;
+        stats.cacheBytes = cacheSize;
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+
+        when(mMockSource.getStatsForPackage(any(), anyString(), any(UserHandle.class)))
+                .thenReturn(storageStats);
+
+        ApplicationInfo info = new ApplicationInfo();
+        info.packageName = packageName;
+        info.category = category;
+        PackageInfo packageInfo = new PackageInfo();
+        packageInfo.applicationInfo = info;
+        packageInfo.packageName = packageName;
+
+        return info;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageFileCategoryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageFileCategoryPreferenceControllerTest.java
new file mode 100644
index 000000000..2c2c1c7a3
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageFileCategoryPreferenceControllerTest.java
@@ -0,0 +1,136 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.ComponentName;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserHandle;
+import android.os.storage.VolumeInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.ProgressBarPreference;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.deviceinfo.StorageVolumeProvider;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageFileCategoryPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private ProgressBarPreference mProgressBarPreference;
+    private StorageFileCategoryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private UserHandle mUserHandle;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private StorageVolumeProvider mMockStorageVolumeProvider;
+    @Mock
+    private VolumeInfo mMockVolumeInfo;
+    @Mock
+    private Intent mMockIntent;
+    @Mock
+    private ComponentName mMockComponentName;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        int myUserId = UserHandle.myUserId();
+        mUserHandle = UserHandle.of(myUserId);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mProgressBarPreference = new ProgressBarPreference(mContext);
+        mPreferenceController = new StorageFileCategoryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions,
+                mMockStorageVolumeProvider);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mProgressBarPreference);
+
+        when(mMockStorageVolumeProvider.findEmulatedForPrivate(any())).thenReturn(mMockVolumeInfo);
+    }
+
+    @Test
+    public void onCreate_nonResolvableIntent_notSelectable() {
+        when(mMockVolumeInfo.buildBrowseIntent()).thenReturn(mMockIntent);
+        when(mMockIntent.resolveActivity(mContext.getPackageManager())).thenReturn(null);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mProgressBarPreference.isSelectable()).isFalse();
+    }
+
+    @Test
+    public void onCreate_resolvableIntent_selectable() {
+        when(mMockVolumeInfo.buildBrowseIntent()).thenReturn(mMockIntent);
+        when(mMockIntent.resolveActivity(mContext.getPackageManager()))
+                .thenReturn(mMockComponentName);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mProgressBarPreference.isSelectable()).isTrue();
+    }
+
+    @Test
+    public void handlePreferenceClicked_currentUserAndNoActivityToHandleIntent_doesNotThrow() {
+        when(mMockVolumeInfo.buildBrowseIntent()).thenReturn(mMockIntent);
+        when(mMockIntent.resolveActivity(mContext.getPackageManager())).thenReturn(null);
+
+        mProgressBarPreference.performClick();
+
+        verify(mContext, never()).startActivityAsUser(mMockIntent, mUserHandle);
+    }
+
+    @Test
+    public void handlePreferenceClicked_currentUserAndActivityToHandleIntent_startsNewActivity() {
+        when(mMockVolumeInfo.buildBrowseIntent()).thenReturn(mMockIntent);
+        when(mMockIntent.resolveActivity(mContext.getPackageManager()))
+                .thenReturn(mMockComponentName);
+
+        doNothing().when(mContext).startActivityAsUser(mMockIntent, mUserHandle);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mProgressBarPreference.performClick();
+
+        verify(mContext).startActivityAsUser(mMockIntent, mUserHandle);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageMediaCategoryDetailPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageMediaCategoryDetailPreferenceControllerTest.java
new file mode 100644
index 000000000..e5ab11c0c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageMediaCategoryDetailPreferenceControllerTest.java
@@ -0,0 +1,122 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.ApplicationsState;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageMediaCategoryDetailPreferenceControllerTest {
+
+    private static final String SOURCE = "source";
+    private static final int UID = 12;
+    private static final long EXTRA_AUDIO_BYTES = 100;
+    private static final String LABEL = "label";
+    private static final String SIZE_STR = "12.34 MB";
+    private static final String PACKAGE_NAME = "com.google.packageName";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mLogicalPreferenceGroup;
+    private StorageMediaCategoryDetailPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mLogicalPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mLogicalPreferenceGroup);
+        mPreferenceController = new StorageMediaCategoryDetailPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mLogicalPreferenceGroup);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_defaultInitialize_hasNoPreference() {
+        assertThat(mLogicalPreferenceGroup.getPreferenceCount()).isEqualTo(0);
+    }
+
+    @Test
+    public void onDataLoaded_addPreference_hasTwoPreferences() {
+        ArrayList<ApplicationsState.AppEntry> apps = new ArrayList<>();
+        ApplicationInfo appInfo = new ApplicationInfo();
+        appInfo.uid = UID;
+        appInfo.sourceDir = SOURCE;
+
+        ApplicationsState.AppEntry appEntry = new ApplicationsState.AppEntry(mContext, appInfo,
+                1234L);
+        appEntry.label = LABEL;
+        appEntry.sizeStr = SIZE_STR;
+        appEntry.icon = mContext.getDrawable(R.drawable.test_icon);
+        appEntry.info.packageName = PACKAGE_NAME;
+        apps.add(appEntry);
+
+        mPreferenceController.setExternalAudioBytes(EXTRA_AUDIO_BYTES);
+        mPreferenceController.onDataLoaded(apps);
+        // even when the manager notifies the controller again on data loaded the preference
+        // count should remain the same if new appEntries are not added.
+        mPreferenceController.onDataLoaded(apps);
+
+        assertThat(mLogicalPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+
+        assertThat(mLogicalPreferenceGroup.getPreference(0).getTitle()).isEqualTo(LABEL);
+        assertThat(mLogicalPreferenceGroup.getPreference(0).getSummary()).isEqualTo(SIZE_STR);
+
+        assertThat(mLogicalPreferenceGroup.getPreference(1).getTitle()).isEqualTo(
+                mContext.getString(R.string.storage_audio_files_title));
+        assertThat(mLogicalPreferenceGroup.getPreference(1).getSummary()).isEqualTo(
+                Long.toString(EXTRA_AUDIO_BYTES));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageMediaCategoryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageMediaCategoryPreferenceControllerTest.java
new file mode 100644
index 000000000..f091ef30b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageMediaCategoryPreferenceControllerTest.java
@@ -0,0 +1,76 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.ProgressBarPreference;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageMediaCategoryPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ProgressBarPreference mProgressBarPreference;
+    private StorageMediaCategoryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mProgressBarPreference = new ProgressBarPreference(mContext);
+        mPreferenceController = new StorageMediaCategoryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mProgressBarPreference);
+    }
+
+    @Test
+    @UiThreadTest
+    public void handlePreferenceClicked_shouldLaunchAccountSyncDetailsFragment() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mProgressBarPreference.performClick();
+
+        verify(mMockFragmentController).launchFragment(
+                any(StorageMediaCategoryDetailFragment.class));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageSettingsManagerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageSettingsManagerTest.java
new file mode 100644
index 000000000..cc1a24861
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageSettingsManagerTest.java
@@ -0,0 +1,160 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.os.Bundle;
+import android.os.storage.VolumeInfo;
+import android.util.SparseArray;
+
+import androidx.loader.app.LoaderManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.deviceinfo.PrivateStorageInfo;
+import com.android.settingslib.deviceinfo.StorageVolumeProvider;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageSettingsManagerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private VolumeInfo mVolumeInfo;
+    private StorageSettingsManager mStorageSettingsManager;
+
+    @Captor
+    private ArgumentCaptor<LoaderManager
+            .LoaderCallbacks<SparseArray<StorageAsyncLoader.AppsStorageResult>>> mAppsStorageResult;
+    @Captor
+    private ArgumentCaptor<LoaderManager.LoaderCallbacks<PrivateStorageInfo>> mVolumeSizeCallback;
+    @Mock
+    private StorageSettingsManager.VolumeListener mVolumeListener1;
+    @Mock
+    private StorageSettingsManager.VolumeListener mVolumeListener2;
+    @Mock
+    private LoaderManager mLoaderManager;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+
+        mStorageSettingsManager = new StorageSettingsManager(mContext, mVolumeInfo);
+        mStorageSettingsManager.startLoading(mLoaderManager);
+        verify(mLoaderManager, times(1)).restartLoader(eq(0), eq(Bundle.EMPTY),
+                mAppsStorageResult.capture());
+        verify(mLoaderManager, times(1)).restartLoader(eq(1), eq(Bundle.EMPTY),
+                mVolumeSizeCallback.capture());
+    }
+
+    @Test
+    public void volumeSizeCallback_onLoadFinished_listenerOnSizeCalculatedCalled()
+            throws Exception {
+        mStorageSettingsManager.registerListener(mVolumeListener1);
+        mStorageSettingsManager.registerListener(mVolumeListener2);
+
+        StorageVolumeProvider storageVolumeProvider = mock(StorageVolumeProvider.class);
+        when(storageVolumeProvider.getTotalBytes(any(), any())).thenReturn(10000L);
+        when(storageVolumeProvider.getFreeBytes(any(), any())).thenReturn(1000L);
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> data = new SparseArray<>();
+        mAppsStorageResult.getValue().onLoadFinished(null, data);
+
+        PrivateStorageInfo storageInfo = new VolumeSizesLoader(mContext, storageVolumeProvider,
+                null, mVolumeInfo).loadInBackground();
+
+        mVolumeSizeCallback.getValue().onLoadFinished(null, storageInfo);
+
+        verify(mVolumeListener1, times(1)).onDataLoaded(data, 9000L, 10000L);
+        verify(mVolumeListener2, times(1)).onDataLoaded(data, 9000L, 10000L);
+    }
+
+    @Test
+    public void appsStorageResult_unregisterListener_onlyOneListenerOnDataLoadedCalled()
+            throws Exception {
+        mStorageSettingsManager.registerListener(mVolumeListener1);
+        mStorageSettingsManager.registerListener(mVolumeListener2);
+        mStorageSettingsManager.unregisterlistener(mVolumeListener2);
+        SparseArray<StorageAsyncLoader.AppsStorageResult> data = new SparseArray<>();
+        mAppsStorageResult.getValue().onLoadFinished(null, data);
+
+        StorageVolumeProvider storageVolumeProvider = mock(StorageVolumeProvider.class);
+        when(storageVolumeProvider.getTotalBytes(any(), any())).thenReturn(10000L);
+        when(storageVolumeProvider.getFreeBytes(any(), any())).thenReturn(1000L);
+
+        PrivateStorageInfo storageInfo = new VolumeSizesLoader(mContext, storageVolumeProvider,
+                null, mVolumeInfo).loadInBackground();
+
+        mVolumeSizeCallback.getValue().onLoadFinished(null, storageInfo);
+
+        verify(mVolumeListener1, times(1)).onDataLoaded(data, 9000L, 10000L);
+        verify(mVolumeListener2, never()).onDataLoaded(data, 9000L, 10000L);
+    }
+
+    @Test
+    public void onReceivedSizes_storageResultNotLoaded_noListenersCalled()
+            throws Exception {
+        mStorageSettingsManager.registerListener(mVolumeListener1);
+        mStorageSettingsManager.registerListener(mVolumeListener2);
+        SparseArray<StorageAsyncLoader.AppsStorageResult> data = new SparseArray<>();
+
+        StorageVolumeProvider storageVolumeProvider = mock(StorageVolumeProvider.class);
+        when(storageVolumeProvider.getTotalBytes(any(), any())).thenReturn(10000L);
+        when(storageVolumeProvider.getFreeBytes(any(), any())).thenReturn(1000L);
+
+        PrivateStorageInfo storageInfo = new VolumeSizesLoader(mContext, storageVolumeProvider,
+                null, mVolumeInfo).loadInBackground();
+        mVolumeSizeCallback.getValue().onLoadFinished(null, storageInfo);
+
+        verify(mVolumeListener1, never()).onDataLoaded(data, 9000L, 10000L);
+        verify(mVolumeListener2, never()).onDataLoaded(data, 9000L, 10000L);
+    }
+
+    @Test
+    public void onReceivedSizes_volumeSizeNotLoaded_noListenersCalled()
+            throws Exception {
+        mStorageSettingsManager.registerListener(mVolumeListener1);
+        mStorageSettingsManager.registerListener(mVolumeListener2);
+
+        SparseArray<StorageAsyncLoader.AppsStorageResult> data = new SparseArray<>();
+        mAppsStorageResult.getValue().onLoadFinished(null, data);
+
+        StorageVolumeProvider storageVolumeProvider = mock(StorageVolumeProvider.class);
+        when(storageVolumeProvider.getTotalBytes(any(), any())).thenReturn(10000L);
+        when(storageVolumeProvider.getFreeBytes(any(), any())).thenReturn(1000L);
+
+        PrivateStorageInfo storageInfo = new VolumeSizesLoader(mContext, storageVolumeProvider,
+                null, mVolumeInfo).loadInBackground();
+
+        verify(mVolumeListener1, never()).onDataLoaded(data, 9000L, 10000L);
+        verify(mVolumeListener2, never()).onDataLoaded(data, 9000L, 10000L);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageSizeBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageSizeBasePreferenceControllerTest.java
new file mode 100644
index 000000000..5bce14eba
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageSizeBasePreferenceControllerTest.java
@@ -0,0 +1,130 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.verify;
+
+import android.app.usage.StorageStats;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.StorageStatsSource;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageSizeBasePreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private StorageAppDetailPreference mStorageAppDetailPreference;
+    private TestStorageSizeBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private AppsStorageStatsManager mAppsStorageStatsManager;
+
+    private static class TestStorageSizeBasePreferenceController extends
+            StorageSizeBasePreferenceController {
+
+        TestStorageSizeBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected long getSize() {
+            return 1_000_000_000;
+        }
+    }
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mStorageAppDetailPreference = new StorageAppDetailPreference(mContext);
+        mPreferenceController = new TestStorageSizeBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mStorageAppDetailPreference);
+    }
+
+    @Test
+    public void onCreate_defaultState_nothingIsSet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mStorageAppDetailPreference.getDetailText()).isNull();
+        assertThat(mPreferenceController.isCachedCleared()).isFalse();
+        assertThat(mPreferenceController.isDataCleared()).isFalse();
+        assertThat(mPreferenceController.getAppStorageStats()).isNull();
+    }
+
+    @Test
+    public void setAppsStorageStatsManager_shouldRegisterController() {
+        mPreferenceController.setAppsStorageStatsManager(mAppsStorageStatsManager);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        verify(mAppsStorageStatsManager).registerListener(mPreferenceController);
+    }
+
+    @Test
+    public void onDataLoaded_shouldUpdateCachedAndDataClearedState() {
+        mPreferenceController.onDataLoaded(null, true, true);
+
+        assertThat(mPreferenceController.isCachedCleared()).isTrue();
+        assertThat(mPreferenceController.isDataCleared()).isTrue();
+    }
+
+    @Test
+    public void onDataLoaded_appStorageStatsNotSet_shouldNotUpdateDetailText() {
+        mPreferenceController.onDataLoaded(null, true, true);
+
+        assertThat(mPreferenceController.getAppStorageStats()).isNull();
+        assertThat(mStorageAppDetailPreference.getDetailText()).isNull();
+    }
+
+    @Test
+    public void onDataLoaded_appStorageStatsSet_shouldUpdateDetailText() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        StorageStats stats = new StorageStats();
+        StorageStatsSource.AppStorageStats storageStats =
+                new StorageStatsSource.AppStorageStatsImpl(stats);
+        mPreferenceController.setAppStorageStats(storageStats);
+        mPreferenceController.onDataLoaded(null, true, true);
+
+        assertThat(mPreferenceController.getAppStorageStats()).isNotNull();
+        assertThat(mStorageAppDetailPreference.getDetailText()).isEqualTo("1.00 GB");
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageSystemCategoryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageSystemCategoryPreferenceControllerTest.java
new file mode 100644
index 000000000..9f0c71a1c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageSystemCategoryPreferenceControllerTest.java
@@ -0,0 +1,78 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.ProgressBarPreference;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageSystemCategoryPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ProgressBarPreference mProgressBarPreference;
+    private StorageSystemCategoryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mProgressBarPreference = new ProgressBarPreference(mContext);
+        mPreferenceController = new StorageSystemCategoryPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mProgressBarPreference);
+    }
+
+    @Test
+    @UiThreadTest
+    public void handlePreferenceClicked_openAlertDialog() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mProgressBarPreference.performClick();
+
+        verify(mMockFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                anyString());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageUsageBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageUsageBasePreferenceControllerTest.java
new file mode 100644
index 000000000..e0fd10558
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageUsageBasePreferenceControllerTest.java
@@ -0,0 +1,125 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.android.car.settings.storage.FileSizeFormatter.MEGABYTE_IN_BYTES;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.util.SparseArray;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.ProgressBarPreference;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.applications.StorageStatsSource;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageUsageBasePreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ProgressBarPreference mProgressBarPreference;
+    private TestStorageUsageBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mMockFragmentController;
+
+    private static class TestStorageUsageBasePreferenceController extends
+            StorageUsageBasePreferenceController {
+
+        TestStorageUsageBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        public long calculateCategoryUsage(
+                SparseArray<StorageAsyncLoader.AppsStorageResult> result, long usedSizeBytes) {
+            return 1_000_000_000;
+        }
+    }
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mProgressBarPreference = new ProgressBarPreference(mContext);
+        mPreferenceController = new TestStorageUsageBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mProgressBarPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_defaultInitialize_hasDefaultSummary() {
+        assertThat(mProgressBarPreference.getSummary().toString())
+                .isEqualTo(mContext.getString(R.string.memory_calculating_size));
+    }
+
+    @Test
+    public void onDataLoaded_setsSummary() {
+        SparseArray<StorageAsyncLoader.AppsStorageResult> results = new SparseArray<>();
+        StorageAsyncLoader.AppsStorageResult result =
+                new StorageAsyncLoader.AppsStorageResult(0, 0, 0, 0, 0);
+        result.setExternalStats(
+                new StorageStatsSource.ExternalStorageStats(
+                        MEGABYTE_IN_BYTES * 500, // total
+                        MEGABYTE_IN_BYTES * 100, // audio
+                        MEGABYTE_IN_BYTES * 150, // video
+                        MEGABYTE_IN_BYTES * 200, 0)); // image
+        results.put(0, result);
+        mPreferenceController.onDataLoaded(results, 100, 100);
+
+        assertThat(mProgressBarPreference.getSummary().toString()).isEqualTo("1.0 GB");
+    }
+
+    @Test
+    public void onDataLoaded_setProgressBarPercentage() {
+        SparseArray<StorageAsyncLoader.AppsStorageResult> results = new SparseArray<>();
+        StorageAsyncLoader.AppsStorageResult result =
+                new StorageAsyncLoader.AppsStorageResult(0, 0, 0, 0, 0);
+        result.setExternalStats(
+                new StorageStatsSource.ExternalStorageStats(
+                        MEGABYTE_IN_BYTES * 500, // total
+                        MEGABYTE_IN_BYTES * 100, // audio
+                        MEGABYTE_IN_BYTES * 150, // video
+                        MEGABYTE_IN_BYTES * 200, 0)); // image
+        results.put(0, result);
+        mPreferenceController.onDataLoaded(results, 100, 2_000_000_000);
+        // usage size is half the total size i.e. percentage of storage used should be 50.
+        assertThat(mProgressBarPreference.getProgress()).isEqualTo(50);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/StorageUtilsTest.java b/tests/multivalent/src/com/android/car/settings/storage/StorageUtilsTest.java
new file mode 100644
index 000000000..48610dd9a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/StorageUtilsTest.java
@@ -0,0 +1,118 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static android.os.storage.VolumeInfo.STATE_MOUNTED;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.os.Bundle;
+import android.os.storage.StorageManager;
+import android.os.storage.VolumeInfo;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class StorageUtilsTest {
+
+    @Mock
+    private StorageManager mStorageManager;
+
+    @Before
+    public void setUp() throws Exception {
+        MockitoAnnotations.initMocks(this);
+    }
+
+    @Test
+    public void maybeInitializeVolume_mounted_shouldReturnVolumeInfo() {
+        VolumeInfo volumeInfo = new VolumeInfo("id", VolumeInfo.TYPE_PRIVATE, null, "id");
+        volumeInfo.state = STATE_MOUNTED;
+
+        when(mStorageManager.findVolumeById(VolumeInfo.ID_PRIVATE_INTERNAL)).thenReturn(volumeInfo);
+
+        VolumeInfo expected = StorageUtils.maybeInitializeVolume(mStorageManager, null);
+
+        assertThat(expected).isEqualTo(volumeInfo);
+    }
+
+    @Test
+    public void maybeInitializeVolume_notMounted_shouldNotReturnVolumeInfo() {
+        VolumeInfo volumeInfo = new VolumeInfo("id", VolumeInfo.TYPE_PRIVATE, null, "id");
+
+        when(mStorageManager.findVolumeById(VolumeInfo.ID_PRIVATE_INTERNAL)).thenReturn(volumeInfo);
+
+        VolumeInfo expected = StorageUtils.maybeInitializeVolume(mStorageManager, null);
+
+        assertThat(expected).isNull();
+    }
+
+    @Test
+    public void maybeInitializeVolume_differentType_shouldNotReturnVolumeInfo() {
+        VolumeInfo volumeInfo = new VolumeInfo("id", VolumeInfo.TYPE_EMULATED, null, "id");
+
+        when(mStorageManager.findVolumeById(VolumeInfo.ID_PRIVATE_INTERNAL)).thenReturn(volumeInfo);
+
+        VolumeInfo expected = StorageUtils.maybeInitializeVolume(mStorageManager, null);
+
+        assertThat(expected).isNull();
+    }
+
+    @Test
+    public void maybeInitializeVolume_defaultId_notMounted_returnsNull() {
+        VolumeInfo volumeInfo = new VolumeInfo("id", VolumeInfo.TYPE_EMULATED, null, "id");
+        Bundle bundle = new Bundle();
+        when(mStorageManager.findVolumeById(VolumeInfo.ID_PRIVATE_INTERNAL)).thenReturn(volumeInfo);
+
+        VolumeInfo expected = StorageUtils.maybeInitializeVolume(mStorageManager, bundle);
+
+        assertThat(expected).isNull();
+    }
+
+    @Test
+    public void maybeInitializeVolume_getDefaultIdFromBundle_mounted_shouldReturnVolumeInfo() {
+        VolumeInfo volumeInfo = new VolumeInfo("id", VolumeInfo.TYPE_PRIVATE, null, "id");
+        volumeInfo.state = STATE_MOUNTED;
+        Bundle bundle = new Bundle();
+        when(mStorageManager.findVolumeById(VolumeInfo.ID_PRIVATE_INTERNAL)).thenReturn(volumeInfo);
+
+        VolumeInfo expected = StorageUtils.maybeInitializeVolume(mStorageManager, bundle);
+
+        assertThat(expected).isEqualTo(volumeInfo);
+    }
+
+    @Test
+    public void maybeInitializeVolume_getIdFromBundle_shouldReturnVolumeInfo() {
+        VolumeInfo volumeInfo = new VolumeInfo("id", VolumeInfo.TYPE_PRIVATE, null, "id");
+        volumeInfo.state = STATE_MOUNTED;
+        Bundle bundle = new Bundle();
+        bundle.putString(VolumeInfo.EXTRA_VOLUME_ID, VolumeInfo.ID_EMULATED_INTERNAL);
+        when(mStorageManager.findVolumeById(VolumeInfo.ID_EMULATED_INTERNAL)).thenReturn(
+                volumeInfo);
+
+        VolumeInfo expected = StorageUtils.maybeInitializeVolume(mStorageManager, bundle);
+
+        assertThat(expected).isEqualTo(volumeInfo);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/storage/VolumeSizesLoaderTest.java b/tests/multivalent/src/com/android/car/settings/storage/VolumeSizesLoaderTest.java
new file mode 100644
index 000000000..e8b621692
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/storage/VolumeSizesLoaderTest.java
@@ -0,0 +1,55 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.storage;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.os.storage.VolumeInfo;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.settingslib.deviceinfo.PrivateStorageInfo;
+import com.android.settingslib.deviceinfo.StorageVolumeProvider;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class VolumeSizesLoaderTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+
+    @Test
+    public void getVolumeSize_getsValidSizes() throws Exception {
+        VolumeInfo info = mock(VolumeInfo.class);
+        StorageVolumeProvider storageVolumeProvider = mock(StorageVolumeProvider.class);
+        when(storageVolumeProvider.getTotalBytes(any(), any())).thenReturn(10000L);
+        when(storageVolumeProvider.getFreeBytes(any(), any())).thenReturn(1000L);
+
+        PrivateStorageInfo storageInfo = new VolumeSizesLoader(mContext, storageVolumeProvider,
+                null, info).loadInBackground();
+
+        assertThat(storageInfo.freeBytes).isEqualTo(1000L);
+        assertThat(storageInfo.totalBytes).isEqualTo(10000L);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/AboutSettingsEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/AboutSettingsEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..c09504d0d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/AboutSettingsEntryPreferenceControllerTest.java
@@ -0,0 +1,71 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.Build;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class AboutSettingsEntryPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private AboutSettingsEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new AboutSettingsEntryPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_setsSummary() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.about_summary, Build.VERSION.RELEASE));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/BluetoothMacAddressPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/BluetoothMacAddressPreferenceControllerTest.java
new file mode 100644
index 000000000..db9c5082c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/BluetoothMacAddressPreferenceControllerTest.java
@@ -0,0 +1,159 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.bluetooth.BluetoothAdapter;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class BluetoothMacAddressPreferenceControllerTest {
+    private static final String TEST_ADDRESS = "address";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private BluetoothMacAddressPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mMockPm;
+    @Mock
+    private BluetoothAdapter mMockBluetoothAdapter;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+        when(mMockBluetoothAdapter.getAddress()).thenReturn(TEST_ADDRESS);
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new BluetoothMacAddressPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions, mMockBluetoothAdapter);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_setsAddress() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getSummary()).isEqualTo(TEST_ADDRESS);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureBluetooth_unsupportedOnDevice() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureBluetooth_unsupportedOnDevice_zoneWrite() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureBluetooth_unsupportedOnDevice_zoneRead() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_featureBluetooth_unsupportedOnDevice_zoneHidden() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_enableDefaultAdapter_availableForViewing() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_enableDefaultAdapter_availableForViewing_zoneWrite() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_enableDefaultAdapter_availableForViewing_zoneRead() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_enableDefaultAdapter_availableForViewing_zoneHidden() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/BuildNumberPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/BuildNumberPreferenceControllerTest.java
new file mode 100644
index 000000000..619ba9989
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/BuildNumberPreferenceControllerTest.java
@@ -0,0 +1,238 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.atLeastOnce;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+import android.provider.Settings;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.development.DevelopmentSettingsUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.utils.StringUtil;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.concurrent.CountDownLatch;
+import java.util.concurrent.TimeUnit;
+
+@RunWith(AndroidJUnit4.class)
+public class BuildNumberPreferenceControllerTest {
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private final CountDownLatch mCountDownLatch = new CountDownLatch(1);
+
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private BuildNumberPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    private int mDebounceInterval;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(UserManager.class, withSettings().lenient())
+                .mockStatic(Toast.class, withSettings().lenient())
+                .startMocking();
+        when(UserManager.get(mContext)).thenReturn(mMockUserManager);
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        when(mMockUserManager.hasUserRestriction(UserManager.DISALLOW_DEBUGGING_FEATURES))
+                .thenReturn(false);
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        // By default device is provisioned.
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVICE_PROVISIONED, 1);
+
+        // By default development settings is disabled.
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 0);
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new BuildNumberPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.onResume(mLifecycleOwner);
+
+        mDebounceInterval = mContext.getResources()
+                .getInteger(R.integer.config_preference_onclick_debounce_ms) + 100; // Add buffer
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_notProvisioned_returnFalse() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVICE_PROVISIONED, 0);
+        assertThat(mPreferenceController.handlePreferenceClicked(mPreference)).isFalse();
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_nonAdmin_returnFalse() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ false);
+
+        assertThat(mPreferenceController.handlePreferenceClicked(mPreference)).isFalse();
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_demoUser_returnsFalse() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+
+        assertThat(mPreferenceController.handlePreferenceClicked(mPreference)).isFalse();
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_adminUser_returnsTrue() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+
+        assertThat(mPreferenceController.handlePreferenceClicked(mPreference)).isTrue();
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_devSettingsDisabled_firstClick_noToast() {
+        mPreference.performClick();
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), anyString(), anyInt()), never());
+        verify(mMockToast, never()).show();
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_devSettingsDisabled_someClicks_showToast()
+            throws InterruptedException {
+        for (int i = 0; i < getTapsToShowToast(); i++) {
+            mPreference.performClick();
+            mCountDownLatch.await(mDebounceInterval, TimeUnit.MILLISECONDS);
+        }
+
+        int remainingClicks = getTapsToBecomeDeveloper() - getTapsToShowToast();
+        assertToastShown(StringUtil.getIcuPluralsString(mContext, remainingClicks,
+                R.string.show_dev_countdown));
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_devSettingsDisabled_allClicks_showDevEnabledToast()
+            throws InterruptedException {
+        for (int i = 0; i < getTapsToBecomeDeveloper(); i++) {
+            mPreference.performClick();
+            mCountDownLatch.await(mDebounceInterval, TimeUnit.MILLISECONDS);
+        }
+        assertToastShown(mContext.getString(R.string.show_dev_on));
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_devSettingsDisabled_allClicks_devSettingsEnabled()
+            throws InterruptedException {
+        for (int i = 0; i < getTapsToBecomeDeveloper(); i++) {
+            mPreference.performClick();
+            mCountDownLatch.await(mDebounceInterval, TimeUnit.MILLISECONDS);
+        }
+        assertThat(DevelopmentSettingsUtil.isDevelopmentSettingsEnabled(mContext)).isTrue();
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_devSettingsDisabled_extraClicks_noAlreadyDevToast()
+            throws InterruptedException {
+        int extraClicks = 100;
+        for (int i = 0; i < getTapsToBecomeDeveloper() + extraClicks; i++) {
+            mPreference.performClick();
+            mCountDownLatch.await(mDebounceInterval, TimeUnit.MILLISECONDS);
+        }
+        String alreadyDevString = mContext.getString(R.string.show_dev_already);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(alreadyDevString), anyInt()), never());
+    }
+
+    @Test
+    public void testHandlePreferenceClicked_devSettingsEnabled_click_showAlreadyDevToast() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+        mPreferenceController.onPause(mLifecycleOwner);
+        mPreferenceController.onResume(mLifecycleOwner);
+        mPreference.performClick();
+        assertToastShown(mContext.getString(R.string.show_dev_already));
+    }
+
+    private void assertToastShown(String toastText) {
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast, atLeastOnce()).show();
+    }
+
+    private void switchToUser(boolean isAdmin, boolean isDemo) {
+        when(mMockUserManager.isAdminUser()).thenReturn(isAdmin);
+        when(mMockUserManager.isDemoUser()).thenReturn(isDemo);
+        when(UserManager.isDeviceInDemoMode(mContext)).thenReturn(isDemo);
+    }
+
+    private int getTapsToBecomeDeveloper() {
+        return mContext.getResources().getInteger(R.integer.enable_developer_settings_click_count);
+    }
+
+    private int getTapsToShowToast() {
+        return mContext.getResources().getInteger(
+                R.integer.enable_developer_settings_clicks_to_show_toast_count);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/DeveloperOptionsEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/DeveloperOptionsEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..431f62f0b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/DeveloperOptionsEntryPreferenceControllerTest.java
@@ -0,0 +1,296 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.os.UserManager;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.development.DevelopmentSettingsUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class DeveloperOptionsEntryPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_DEBUGGING_FEATURES;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiPreference mPreference;
+    private DeveloperOptionsEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(UserManager.class, withSettings().lenient())
+                .startMocking();
+        when(UserManager.get(mContext)).thenReturn(mMockUserManager);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mContext.getSystemService(Context.USER_SERVICE)).thenReturn(mMockUserManager);;
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        doNothing().when(mContext).startActivity(any());
+
+        mPreference = new CarUiPreference(mContext);
+        mPreference.setIntent(new Intent(Settings.ACTION_APPLICATION_DEVELOPMENT_SETTINGS));
+        mPreferenceController = new DeveloperOptionsEntryPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_isAvailable() {
+        setDeveloperOptionsEnabled(true);
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_isAvailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        setDeveloperOptionsEnabled(true);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_isAvailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        setDeveloperOptionsEnabled(true);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_isAvailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        setDeveloperOptionsEnabled(true);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsDisabled_isUnavailable() {
+        setDeveloperOptionsEnabled(false);
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsDisabled_isUnavailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        setDeveloperOptionsEnabled(false);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsDisabled_isUnavailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        setDeveloperOptionsEnabled(false);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsDisabled_isUnavailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        setDeveloperOptionsEnabled(false);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_restrictedByUm_isUnavailable() {
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByUm(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_isUnavailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByUm(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_isUnavailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByUm(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_isUnavailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByUm(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_availableForViewing() {
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByDpm(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_availableForViewing_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByDpm(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_availableForViewing_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByDpm(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void testGetAvailabilityStatus_devOptionsEnabled_availableForViewing_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByDpm(true);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void performClick_startsActivity() {
+        setDeveloperOptionsEnabled(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mContext).startActivity(captor.capture());
+
+        Intent intent = captor.getValue();
+        assertThat(intent.getAction()).isEqualTo(Settings.ACTION_APPLICATION_DEVELOPMENT_SETTINGS);
+    }
+
+    @Test
+    @UiThreadTest
+    public void disabledClick_restrictedByDpm_dialog() {
+        setDeveloperOptionsEnabled(true);
+        mockUserRestrictionSetByDpm(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void setDeveloperOptionsEnabled(boolean enabled) {
+        DevelopmentSettingsUtil.setDevelopmentSettingsEnabled(mContext, enabled);
+    }
+
+    private void mockUserRestrictionSetByUm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+                .thenReturn(restricted);
+        if (restricted) {
+            when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+        }
+    }
+
+    private void mockUserRestrictionSetByDpm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+                .thenReturn(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/DualPaneFactoryResetFragmentTest.java b/tests/multivalent/src/com/android/car/settings/system/DualPaneFactoryResetFragmentTest.java
new file mode 100644
index 000000000..ba964a732
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/DualPaneFactoryResetFragmentTest.java
@@ -0,0 +1,64 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static android.app.Activity.RESULT_OK;
+
+import static com.android.car.settings.common.SubSettingsActivity.KEY_SUB_SETTINGS_FRAGMENT;
+import static com.android.car.settings.system.FactoryResetFragment.CHECK_LOCK_REQUEST_CODE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.junit.Assert.assertNotNull;
+
+import android.content.Intent;
+
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.DualPaneTestActivity;
+
+import org.junit.Rule;
+import org.junit.Test;
+
+public class DualPaneFactoryResetFragmentTest
+        extends FactoryResetFragmentTestCase<DualPaneTestActivity> {
+
+    @Rule
+    public ActivityTestRule<DualPaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(DualPaneTestActivity.class);
+
+    @Override
+    ActivityTestRule<DualPaneTestActivity> getActivityTestRule() {
+        return mActivityTestRule;
+    }
+
+    @Test
+    public void processActivityResult_resultOk_launchesFactoryResetConfirmActivity()
+            throws Throwable {
+        getActivityTestRule().runOnUiThread(() -> {
+            mFragment.processActivityResult(CHECK_LOCK_REQUEST_CODE, RESULT_OK, /* data= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        Intent intent = mActivity.getStartActivityListener().getLastValue();
+        assertNotNull(intent);
+        String fragmentClass = intent.getStringExtra(KEY_SUB_SETTINGS_FRAGMENT);
+        assertNotNull(fragmentClass);
+        assertThat(fragmentClass).isEqualTo(FactoryResetConfirmFragment.class.getName());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/FactoryResetAccountsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/FactoryResetAccountsPreferenceControllerTest.java
new file mode 100644
index 000000000..61ee36292
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/FactoryResetAccountsPreferenceControllerTest.java
@@ -0,0 +1,275 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.accounts.Account;
+import android.accounts.AccountManager;
+import android.accounts.AuthenticatorDescription;
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceCategory;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.stubbing.Answer;
+
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+
+/** Unit test for {@link FactoryResetAccountsPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class FactoryResetAccountsPreferenceControllerTest {
+    private final int mUserId = UserHandle.myUserId();
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreference;
+    private FactoryResetAccountsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    private Map<Integer, List<AuthenticatorDescription>> mAuthenticatorDescriptionMap;
+    private Map<Integer, List<Account>> mAccountMap;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private AccountManager mMockAccountManager;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mAuthenticatorDescriptionMap = new HashMap<>();
+        mAccountMap = new HashMap<>();
+        mAuthenticatorDescriptionMap.put(mUserId, new ArrayList<>());
+        mAccountMap.put(mUserId, new ArrayList<>());
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(AccountManager.class, withSettings().lenient())
+                .mockStatic(UserManager.class, withSettings().lenient())
+                .startMocking();
+        when(AccountManager.get(mContext)).thenReturn(mMockAccountManager);
+        updateAccountManagerMocks();
+        when(UserManager.get(mContext)).thenCallRealMethod();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreference = new PreferenceCategory(mContext);
+        screen.addPreference(mPreference);
+        mPreferenceController = new FactoryResetAccountsPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_addsTitlePreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreference.getPreference(0).getTitle()).isEqualTo(
+                mContext.getString(R.string.factory_reset_accounts));
+    }
+
+    @Test
+    public void refreshUi_accountsPresent_showsGroup() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        addAccountAndDescription(mUserId, "accountName");
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_noAccountsPresent_hidesGroup() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_multipleProfiles_showsAllAccounts() {
+        int profileId1 = 112;
+        int profileId2 = 113;
+        List<UserInfo> profiles = new ArrayList<>();
+        profiles.add(new UserInfo(profileId1, String.valueOf(profileId1), 0));
+        profiles.add(new UserInfo(profileId2, String.valueOf(profileId2), 0));
+        String accountName1 = "accountName1";
+        addAccountAndDescription(profileId1, accountName1);
+        String accountName2 = "accountName2";
+        addAccountAndDescription(profileId2, accountName2);
+
+        when(UserManager.get(mContext)).thenReturn(mMockUserManager);
+        when(mMockUserManager.getProfiles(mUserId)).thenReturn(profiles);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mPreferenceController.refreshUi();
+
+        // Title + two profiles with one account each.
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(3);
+        assertThat(mPreference.getPreference(1).getTitle()).isEqualTo(accountName1);
+        assertThat(mPreference.getPreference(2).getTitle()).isEqualTo(accountName2);
+    }
+
+    @Test
+    public void refreshUi_missingAccountDescription_skipsAccount() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        addAccountAndDescription(mUserId, "account name with desc");
+        String accountNameNoDesc = "account name no desc";
+        addAccount(mUserId, accountNameNoDesc);
+
+        mPreferenceController.refreshUi();
+
+        // Title + one account with valid description.
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+        assertThat(mPreference.getPreference(1).getTitle()).isNotEqualTo(accountNameNoDesc);
+    }
+
+    @Test
+    public void refreshUi_accountAdded_addsPreferenceToGroup() {
+        addAccountAndDescription(mUserId, "accountName");
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        String addedAccountName = "added account name";
+        addAccountAndDescription(mUserId, addedAccountName);
+        mPreferenceController.refreshUi();
+
+        // Title + one already present account + one newly added account.
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(3);
+        assertThat(mPreference.getPreference(2).getTitle()).isEqualTo(addedAccountName);
+    }
+
+    @Test
+    public void refreshUi_accountRemoved_removesPreferenceFromGroup() {
+        String accountNameToRemove = "account name to remove";
+        addAccountAndDescription(mUserId, accountNameToRemove);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(2);
+
+        clearAllAccounts();
+        mPreferenceController.refreshUi();
+
+        // Title only, all accounts removed.
+        assertThat(mPreference.getPreferenceCount()).isEqualTo(1);
+        assertThat(mPreference.getPreference(0).getTitle()).isNotEqualTo(accountNameToRemove);
+    }
+
+    private void addAccountAndDescription(int profileId, String accountName) {
+        addDescription(profileId, accountName);
+        addAccount(profileId, accountName);
+    }
+
+    private void addAccount(int profileId, String accountName) {
+        String type = accountName + "_type";
+        if (!mAccountMap.containsKey(profileId)) {
+            mAccountMap.put(profileId, new ArrayList<>());
+        }
+        mAccountMap.get(profileId).add(new Account(accountName, type));
+        updateAccountManagerMocks();
+    }
+
+    private void addDescription(int profileId, String accountName) {
+        String type = accountName + "_type";
+        if (!mAuthenticatorDescriptionMap.containsKey(profileId)) {
+            mAuthenticatorDescriptionMap.put(profileId, new ArrayList<>());
+        }
+        mAuthenticatorDescriptionMap.get(profileId).add(
+                new AuthenticatorDescription(type, "packageName",
+                        /* labelId= */ 0, /* iconId= */ 0, /* smallIconId= */ 0, /* prefId= */ 0));
+        updateAccountManagerMocks();
+    }
+
+    private void clearAllAccounts() {
+        mAuthenticatorDescriptionMap.clear();
+        mAccountMap.clear();
+        updateAccountManagerMocks();
+    }
+
+    private void updateAccountManagerMocks() {
+        when(mMockAccountManager.getAuthenticatorTypesAsUser(anyInt())).then(
+                (Answer<AuthenticatorDescription[]>) invocation -> {
+                    Object[] args = invocation.getArguments();
+                    int profileId = (Integer) args[0];
+                    return mAuthenticatorDescriptionMap.containsKey(profileId)
+                            ? mAuthenticatorDescriptionMap.get(profileId).toArray(
+                            new AuthenticatorDescription[0])
+                            : new AuthenticatorDescription[0];
+                });
+        when(mMockAccountManager.getAccountsAsUser(anyInt())).then(
+                (Answer<Account[]>) invocation -> {
+                    Object[] args = invocation.getArguments();
+                    int profileId = (Integer) args[0];
+                    return mAccountMap.containsKey(profileId)
+                            ? mAccountMap.get(profileId).toArray(new Account[0])
+                            : new Account[0];
+                });
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/FactoryResetConfirmFragmentTest.java b/tests/multivalent/src/com/android/car/settings/system/FactoryResetConfirmFragmentTest.java
new file mode 100644
index 000000000..59bdebcab
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/FactoryResetConfirmFragmentTest.java
@@ -0,0 +1,252 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.ProgressDialog;
+import android.content.Context;
+import android.content.Intent;
+import android.os.AsyncTask;
+import android.provider.Settings;
+import android.service.oemlock.OemLockManager;
+import android.service.persistentdata.PersistentDataBlockManager;
+
+import androidx.fragment.app.FragmentActivity;
+import androidx.fragment.app.FragmentManager;
+import androidx.preference.PreferenceManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.PollingCheck;
+import com.android.car.ui.toolbar.MenuItem;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class FactoryResetConfirmFragmentTest {
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private FactoryResetConfirmFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MenuItem mResetButton;
+
+    private int mDeviceProvisioned;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Mock
+    private PersistentDataBlockManager mPersistentDataBlockManager;
+    @Mock
+    private OemLockManager mOemLockManager;
+    @Mock
+    private FragmentActivity mMockActivity;
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivity.getSupportFragmentManager();
+        mDeviceProvisioned = Settings.Global.getInt(
+                mContext.getContentResolver(), Settings.Global.DEVICE_PROVISIONED, 0);
+        // Default to not provisioned.
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.DEVICE_PROVISIONED,
+                0);
+
+        setUpFragment();
+        when(mFragment.requireContext()).thenReturn(mContext);
+        when(mContext.getSystemService(PersistentDataBlockManager.class))
+                .thenReturn(mPersistentDataBlockManager);
+        when(mContext.getSystemService(OemLockManager.class)).thenReturn(mOemLockManager);
+        when(mFragment.requireActivity()).thenReturn(mMockActivity);
+        when(mFragment.getActivity()).thenReturn(mMockActivity);
+        mResetButton = mActivity.getToolbar().getMenuItems().get(0);
+    }
+
+    @After
+    public void tearDown() {
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.DEVICE_PROVISIONED,
+                mDeviceProvisioned);
+    }
+
+    @Test
+    public void confirmClicked_sendsResetIntent() throws Throwable {
+        triggerFactoryResetConfirmButton();
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mMockActivity).sendBroadcast(argumentCaptor.capture());
+        Intent resetIntent = argumentCaptor.getValue();
+        assertThat(resetIntent.getAction()).isEqualTo(Intent.ACTION_FACTORY_RESET);
+        assertThat(resetIntent.getPackage()).isEqualTo("android");
+        assertThat(resetIntent.getFlags() & Intent.FLAG_RECEIVER_FOREGROUND).isEqualTo(
+                Intent.FLAG_RECEIVER_FOREGROUND);
+        assertThat(resetIntent.getExtras().getString(Intent.EXTRA_REASON)).isEqualTo(
+                "MasterClearConfirm");
+    }
+
+    @Test
+    public void confirmClicked_resetEsimFalse_resetIntentReflectsChoice() throws Throwable {
+        PreferenceManager.getDefaultSharedPreferences(mContext).edit().putBoolean(
+                mContext.getString(R.string.pk_factory_reset_reset_esim), false).commit();
+
+        triggerFactoryResetConfirmButton();
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mMockActivity).sendBroadcast(argumentCaptor.capture());
+        Intent resetIntent = argumentCaptor.getValue();
+        assertThat(resetIntent.getExtras().getBoolean(Intent.EXTRA_WIPE_ESIMS)).isEqualTo(false);
+    }
+
+    @Test
+    public void confirmClicked_pdbManagerNull_sendsResetIntent() throws Throwable {
+        when(mContext.getSystemService(PersistentDataBlockManager.class)).thenReturn(null);
+
+        triggerFactoryResetConfirmButton();
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mMockActivity).sendBroadcast(argumentCaptor.capture());
+        Intent resetIntent = argumentCaptor.getValue();
+        assertThat(resetIntent.getAction()).isEqualTo(Intent.ACTION_FACTORY_RESET);
+    }
+
+    @Test
+    public void confirmClicked_oemUnlockAllowed_doesNotWipePdb() throws Throwable {
+        when(mOemLockManager.isOemUnlockAllowed()).thenReturn(true);
+
+        triggerFactoryResetConfirmButton();
+
+        verify(mPersistentDataBlockManager, never()).wipe();
+    }
+
+    @Test
+    public void confirmClicked_oemUnlockAllowed_sendsResetIntent() throws Throwable {
+        when(mOemLockManager.isOemUnlockAllowed()).thenReturn(true);
+
+        triggerFactoryResetConfirmButton();
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mMockActivity).sendBroadcast(argumentCaptor.capture());
+        Intent resetIntent = argumentCaptor.getValue();
+        assertThat(resetIntent.getAction()).isEqualTo(Intent.ACTION_FACTORY_RESET);
+    }
+
+    @Test
+    public void confirmClicked_noOemUnlockAllowed_notProvisioned_doesNotWipePdb() throws Throwable {
+        when(mOemLockManager.isOemUnlockAllowed()).thenReturn(false);
+
+        triggerFactoryResetConfirmButton();
+
+        verify(mPersistentDataBlockManager, never()).wipe();
+    }
+
+    @Test
+    public void confirmClicked_noOemUnlockAllowed_notProvisioned_sendsResetIntent()
+            throws Throwable {
+        when(mOemLockManager.isOemUnlockAllowed()).thenReturn(false);
+
+        triggerFactoryResetConfirmButton();
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mMockActivity).sendBroadcast(argumentCaptor.capture());
+        Intent resetIntent = argumentCaptor.getValue();
+        assertThat(resetIntent.getAction()).isEqualTo(Intent.ACTION_FACTORY_RESET);
+    }
+
+    @Test
+    public void confirmClicked_noOemUnlockAllowed_provisioned_wipesPdb() throws Throwable {
+        when(mOemLockManager.isOemUnlockAllowed()).thenReturn(false);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.DEVICE_PROVISIONED,
+                1);
+
+        triggerFactoryResetConfirmButton();
+        // wait for async task
+        PollingCheck.waitFor(
+                () -> mFragment.mPersistentDataWipeTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        verify(mPersistentDataBlockManager).wipe();
+    }
+
+    @Test
+    public void confirmClicked_noOemUnlockAllowed_provisioned_sendsResetIntent() throws Throwable {
+        when(mOemLockManager.isOemUnlockAllowed()).thenReturn(false);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.DEVICE_PROVISIONED,
+                1);
+
+        triggerFactoryResetConfirmButton();
+        // wait for async task
+        PollingCheck.waitFor(
+                () -> mFragment.mPersistentDataWipeTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(Intent.class);
+        verify(mMockActivity).sendBroadcast(argumentCaptor.capture());
+        Intent resetIntent = argumentCaptor.getValue();
+        assertThat(resetIntent.getAction()).isEqualTo(Intent.ACTION_FACTORY_RESET);
+    }
+
+    private void setUpFragment() throws Throwable {
+        String factoryResetConfirmFragmentTag = "factory_reset_confirm_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(
+                            R.id.fragment_container, new TestFactoryResetConfirmFragment(),
+                            factoryResetConfirmFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (FactoryResetConfirmFragment)
+                mFragmentManager.findFragmentByTag(factoryResetConfirmFragmentTag);
+        ExtendedMockito.spyOn(mFragment);
+    }
+
+    private void triggerFactoryResetConfirmButton() throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> mResetButton.performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+    }
+
+    public static class TestFactoryResetConfirmFragment extends FactoryResetConfirmFragment {
+        @Override
+        ProgressDialog getProgressDialog() {
+            ProgressDialog dialog = mock(ProgressDialog.class);
+            doNothing().when(dialog).show();
+            doNothing().when(dialog).hide();
+            return dialog;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/FactoryResetEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/FactoryResetEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..07d4deca4
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/FactoryResetEntryPreferenceControllerTest.java
@@ -0,0 +1,591 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static android.os.UserManager.DISALLOW_FACTORY_RESET;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+/** Unit test for {@link FactoryResetEntryPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class FactoryResetEntryPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private FactoryResetEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+    private int mDefaultDemoMode;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(UserManager.class)
+                .mockStatic(Toast.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+        when(UserManager.get(mContext)).thenReturn(mMockUserManager);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+
+        when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new FactoryResetEntryPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneWrite() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneRead() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneHidden() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_unrestricted_available() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_unrestricted_available_zoneWrite() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_unrestricted_available_zoneRead() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_unrestricted_available_zoneHidden() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_baseRestricted_notDpmRestricted_disabledForUser() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notDpmRestricted_disabledForUser_zoneWrite() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notDpmRestricted_disabledForUser_zoneRead() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notDpmRestricted_disabledForUser_zoneHidden() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_baseRestricted_dpmRestricted_disabledForUser() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_baseRestricted_disabledForUser_zoneWrite() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_baseRestricted_disabledForUser_zoneRead() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_baseRestricted_disabledForUser_zoneHidden() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notBaseRestricted_dpmRestricted_disabledForUser() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notBaseRestricted_disabledForUser_zoneWrite() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notBaseRestricted_disabledForUser_zoneRead() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notBaseRestricted_disabledForUser_zoneHidden() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_available() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_available_zoneWrite() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_available_zoneRead() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_available_zoneHidden() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_baseRestricted_disabledForUser() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_disabledForUser_zoneWrite() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_disabledForUser_zoneRead() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_disabledForUser_zoneHidden() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_dpmRestricted_disabledForUser() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_dpmRestricted_disabledForUser_zoneWrite() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_dpmRestricted_disabledForUser_zoneRead() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_demoMode_demoUser_dpmRestricted_disabledForUser_zoneHidden() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_showsBlockedToast_nonAdminUser() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_triggersAction_adminUser_unrestricted() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertNoToastAndNoDialog();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_showsBlockedToast_adminUser_baseRestricted_notDpmRestricted() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_showsBlockedToast_adminUser_baseRestricted_dpmRestricted() {
+        switchToUser(/* isAdmin= */ true, /* isDemo= */ false);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    @Test
+    public void performClick_showsBlockedDialog_adminUser_notBaseRestricted_dpmRestricted() {
+        switchToUser(/* isAdmin= */ true, /* false= */ false);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_triggersAction_demoUser_unrestricted() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertNoToastAndNoDialog();
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_showsBlockedToast_demoUser_baseRestricted() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addBaseUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingBlockedToast();
+    }
+
+    @Test
+    public void performClick_showsBlockedDialog_demoUser_dpmRestricted() {
+        switchToUser(/* isAdmin= */ false, /* isDemo= */ true);
+        addUserRestriction(DISALLOW_FACTORY_RESET);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void switchToUser(boolean isAdmin, boolean isDemo) {
+        when(mMockUserManager.isAdminUser()).thenReturn(isAdmin);
+        when(mMockUserManager.isDemoUser()).thenReturn(isDemo);
+        when(UserManager.isDeviceInDemoMode(mContext)).thenReturn(isDemo);
+    }
+
+    private void addBaseUserRestriction(String restriction) {
+        when(mMockUserManager.hasBaseUserRestriction(
+                eq(restriction), any())).thenReturn(true);
+    }
+
+    private void addUserRestriction(String restriction) {
+        when(mMockUserManager.hasUserRestriction(restriction)).thenReturn(true);
+    }
+
+    private void assertShowingBlockedToast() {
+        String toastText = mContext.getResources().getString(R.string.action_unavailable);
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), eq(toastText), anyInt()));
+        verify(mMockToast).show();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private void assertNoToastAndNoDialog() {
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(), anyString(), anyInt()), never());
+        verify(mMockToast, never()).show();
+        verify(mFragmentController, never())
+                .showDialog(any(ActionDisabledByAdminDialogFragment.class), anyString());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/FactoryResetEsimPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/FactoryResetEsimPreferenceControllerTest.java
new file mode 100644
index 000000000..6c40c02f6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/FactoryResetEsimPreferenceControllerTest.java
@@ -0,0 +1,182 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.system.FactoryResetEsimPreferenceController.KEY_SHOW_ESIM_RESET_CHECKBOX;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.SystemProperties;
+import android.provider.Settings;
+import android.telephony.euicc.EuiccManager;
+
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+/** Unit test for {@link FactoryResetEsimPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class FactoryResetEsimPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SwitchPreference mPreference;
+    private FactoryResetEsimPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    // Store value for reset after test run
+    private int mEuiccProvisioned;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private EuiccManager mMockEuiccManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        // store before value
+        mEuiccProvisioned = Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.EUICC_PROVISIONED, 0);
+
+        when(mContext.getSystemService(Context.EUICC_SERVICE)).thenReturn(mMockEuiccManager);
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.EUICC_PROVISIONED, 1);
+        // mocking SystemProperties since we can't set them here
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                SystemProperties.class, withSettings().lenient()).startMocking();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new SwitchPreference(mContext);
+        mPreferenceController = new FactoryResetEsimPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+        // put back previous value
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.EUICC_PROVISIONED,
+                mEuiccProvisioned);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyTrue_available() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.TRUE.toString());
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyTrue_available_zoneWrite() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.TRUE.toString());
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyTrue_available_zoneRead() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.TRUE.toString());
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyTrue_available_zoneHidden() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.TRUE.toString());
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyFalse_unsupportedOnDevice() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.FALSE.toString());
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyFalse_unsupportedOnDevice_zoneWrite() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.FALSE.toString());
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyFalse_unsupportedOnDevice_zoneRead() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.FALSE.toString());
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_showEsimPropertyFalse_unsupportedOnDevice_zoneHidden() {
+        ExtendedMockito.when(SystemProperties.get(eq(KEY_SHOW_ESIM_RESET_CHECKBOX), anyString()))
+                .thenReturn(Boolean.FALSE.toString());
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/FactoryResetFragmentTestCase.java b/tests/multivalent/src/com/android/car/settings/system/FactoryResetFragmentTestCase.java
new file mode 100644
index 000000000..86e5e520f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/FactoryResetFragmentTestCase.java
@@ -0,0 +1,112 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static android.app.Activity.RESULT_CANCELED;
+
+import static com.android.car.settings.system.FactoryResetFragment.CHECK_LOCK_REQUEST_CODE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.content.Context;
+import android.content.Intent;
+
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.filters.FlakyTest;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ActivityResultCallback;
+import com.android.car.settings.security.CheckLockActivity;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.TestEventListener;
+import com.android.car.ui.toolbar.MenuItem;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public abstract class FactoryResetFragmentTestCase<T extends BaseCarSettingsTestActivity> {
+
+    protected Context mContext = ApplicationProvider.getApplicationContext();
+    protected BaseCarSettingsTestActivity mActivity;
+    protected TestFactoryResetFragment mFragment;
+    protected FragmentManager mFragmentManager;
+
+    abstract ActivityTestRule<T> getActivityTestRule();
+
+    @Before
+    public void setUp() throws Throwable {
+        mActivity = getActivityTestRule().getActivity();
+        mFragmentManager = getActivityTestRule().getActivity().getSupportFragmentManager();
+        setUpFragment();
+    }
+
+    @Test
+    public void factoryResetButtonClicked_launchesCheckLockActivity() throws Throwable {
+        getActivityTestRule().runOnUiThread(() -> {
+            MenuItem factoryResetButton = mFragment.getToolbarMenuItems().get(0);
+            factoryResetButton.setEnabled(true);
+            factoryResetButton.performClick();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        mFragment.mStartActivityForResult.assertCalled();
+        assertThat(mFragment.mStartActivityForResult.getLastValue().getComponent().getClassName())
+                .isEqualTo(CheckLockActivity.class.getName());
+    }
+
+    @Test
+    @FlakyTest(bugId = 316036256)
+    public void processActivityResult_otherResultCode_doesNothing() {
+        mFragment.processActivityResult(CHECK_LOCK_REQUEST_CODE, RESULT_CANCELED, /* data= */ null);
+
+        Fragment launchedFragment = mFragmentManager.findFragmentById(
+                R.id.fragment_container);
+
+        assertThat(launchedFragment).isInstanceOf(FactoryResetFragment.class);
+    }
+
+    private void setUpFragment() throws Throwable {
+        String factoryResetFragmentTag = "factory_reset_fragment";
+        getActivityTestRule().runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new TestFactoryResetFragment(),
+                            factoryResetFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (TestFactoryResetFragment) mFragmentManager
+                .findFragmentByTag(factoryResetFragmentTag);
+    }
+
+    public static class TestFactoryResetFragment extends FactoryResetFragment {
+
+        TestEventListener<Intent> mStartActivityForResult = new TestEventListener<>();
+
+        @Override
+        public void startActivityForResult(Intent intent, int requestCode,
+                ActivityResultCallback callback) {
+            mStartActivityForResult.accept(intent);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/FactoryResetOtherProfilesPresentPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/FactoryResetOtherProfilesPresentPreferenceControllerTest.java
new file mode 100644
index 000000000..d34f52fd4
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/FactoryResetOtherProfilesPresentPreferenceControllerTest.java
@@ -0,0 +1,107 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.UserInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.profiles.ProfileHelper;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Collections;
+
+/** Unit test for {@link FactoryResetOtherProfilesPresentPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class FactoryResetOtherProfilesPresentPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private FactoryResetOtherProfilesPresentPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private ProfileHelper mProfileHelper;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                ProfileHelper.class, withSettings().lenient()).startMocking();
+        when(ProfileHelper.getInstance(any())).thenReturn(mProfileHelper);
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new FactoryResetOtherProfilesPresentPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_noSwitchableUsers_hidesPreference() {
+        when(mProfileHelper.getAllSwitchableProfiles()).thenReturn(Collections.emptyList());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void onCreate_switchableUsers_showsPreference() {
+        when(mProfileHelper.getAllSwitchableProfiles()).thenReturn(
+                Collections.singletonList(new UserInfo()));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/FirmwareVersionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/FirmwareVersionPreferenceControllerTest.java
new file mode 100644
index 000000000..003548383
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/FirmwareVersionPreferenceControllerTest.java
@@ -0,0 +1,71 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.Build;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class FirmwareVersionPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private FirmwareVersionPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new FirmwareVersionPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_setsSummary() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.about_summary, Build.VERSION.RELEASE_OR_CODENAME));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/HardwareInfoPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/HardwareInfoPreferenceControllerTest.java
new file mode 100644
index 000000000..c48262c61
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/HardwareInfoPreferenceControllerTest.java
@@ -0,0 +1,108 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.doNothing;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.doReturn;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.doThrow;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.Build;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.ExecutionException;
+import java.util.concurrent.FutureTask;
+
+@RunWith(AndroidJUnit4.class)
+public class HardwareInfoPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private HardwareInfoPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private FutureTask<String> mMsvSuffixTask;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new TestHardwareInfoPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_setsMsvSuffixSummary() throws ExecutionException, InterruptedException {
+        String msvSuffix = "msv_summary";
+        doNothing().when(mMsvSuffixTask).run();
+        doReturn(msvSuffix).when(mMsvSuffixTask).get();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.hardware_info_summary, Build.MODEL + msvSuffix));
+    }
+
+    @Test
+    public void onCreate_executionException_usesBuildModelSummary()
+            throws ExecutionException, InterruptedException {
+        doNothing().when(mMsvSuffixTask).run();
+        doThrow(ExecutionException.class).when(mMsvSuffixTask).get();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.hardware_info_summary, Build.MODEL));
+    }
+
+    private class TestHardwareInfoPreferenceController extends HardwareInfoPreferenceController {
+        TestHardwareInfoPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        FutureTask<String> createMsvSuffixTask() {
+            return mMsvSuffixTask;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/KernelVersionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/KernelVersionPreferenceControllerTest.java
new file mode 100644
index 000000000..28c0b2fbb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/KernelVersionPreferenceControllerTest.java
@@ -0,0 +1,70 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.DeviceInfoUtils;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class KernelVersionPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private KernelVersionPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new KernelVersionPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_setsSummary() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                DeviceInfoUtils.getFormattedKernelVersion(mContext));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/RegulatoryInfoDisplayActivityTest.java b/tests/multivalent/src/com/android/car/settings/system/RegulatoryInfoDisplayActivityTest.java
new file mode 100644
index 000000000..303ef8eff
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/RegulatoryInfoDisplayActivityTest.java
@@ -0,0 +1,92 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.withSettings;
+
+import android.os.SystemProperties;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+/** Unit test for {@link RegulatoryInfoDisplayActivity}. */
+@RunWith(AndroidJUnit4.class)
+public class RegulatoryInfoDisplayActivityTest {
+
+    private RegulatoryInfoDisplayActivity mActivity;
+    private MockitoSession mSession;
+
+    @Rule
+    public ActivityTestRule<RegulatoryInfoDisplayActivity> mActivityTestRule =
+            new ActivityTestRule<>(RegulatoryInfoDisplayActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                SystemProperties.class, withSettings().lenient()).startMocking();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getRegulatoryInfoImageFileName_skuIsNotEmpty() {
+        ExtendedMockito.when(SystemProperties.get(eq("ro.boot.hardware.sku"), anyString()))
+                .thenReturn("test");
+
+        assertThat(mActivity.getRegulatoryInfoImageFileName())
+                .isEqualTo("/data/misc/elabel/regulatory_info_test.png");
+    }
+
+    @Test
+    public void getRegulatoryInfoImageFileName_skuIsEmpty() {
+        ExtendedMockito.when(SystemProperties.get(eq("ro.boot.hardware.sku"), anyString()))
+                .thenReturn("");
+
+        assertThat(mActivity.getRegulatoryInfoImageFileName())
+                .isEqualTo("/data/misc/elabel/regulatory_info.png");
+    }
+
+    @Test
+    public void getSku_shouldReturnSystemProperty() {
+        String testSku = "test";
+        ExtendedMockito.when(SystemProperties.get(eq("ro.boot.hardware.sku"), anyString()))
+                .thenReturn(testSku);
+
+        assertThat(mActivity.getSku()).isEqualTo(testSku);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/RegulatoryInfoPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/RegulatoryInfoPreferenceControllerTest.java
new file mode 100644
index 000000000..534945de8
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/RegulatoryInfoPreferenceControllerTest.java
@@ -0,0 +1,165 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class RegulatoryInfoPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private RegulatoryInfoPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mPm;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreferenceController = new RegulatoryInfoPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.setPackageManager(mPm);
+    }
+
+    @Test
+    public void hasIntent_isAvailable() {
+        List<ResolveInfo> activities = new ArrayList<>();
+        activities.add(new ResolveInfo());
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void hasIntent_isAvailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        List<ResolveInfo> activities = new ArrayList<>();
+        activities.add(new ResolveInfo());
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void hasIntent_isAvailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        List<ResolveInfo> activities = new ArrayList<>();
+        activities.add(new ResolveInfo());
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void hasIntent_isAvailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        List<ResolveInfo> activities = new ArrayList<>();
+        activities.add(new ResolveInfo());
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void hasNoIntent_isNotAvailable() {
+        List<ResolveInfo> activities = new ArrayList<>();
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                PreferenceController.UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void hasNoIntent_isNotAvailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        List<ResolveInfo> activities = new ArrayList<>();
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void hasNoIntent_isNotAvailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        List<ResolveInfo> activities = new ArrayList<>();
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void hasNoIntent_isNotAvailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        List<ResolveInfo> activities = new ArrayList<>();
+        when(mPm.queryIntentActivities(any(Intent.class), eq(0)))
+                .thenReturn(activities);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.UNSUPPORTED_ON_DEVICE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/ResetAppPrefFragmentTest.java b/tests/multivalent/src/com/android/car/settings/system/ResetAppPrefFragmentTest.java
new file mode 100644
index 000000000..664e39270
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/ResetAppPrefFragmentTest.java
@@ -0,0 +1,228 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static org.junit.Assert.assertThrows;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.app.AppOpsManager;
+import android.app.INotificationManager;
+import android.content.Context;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.IPackageManager;
+import android.content.pm.PackageManager;
+import android.os.AsyncTask;
+import android.os.IBinder;
+import android.os.ServiceManager;
+import android.os.UserHandle;
+import android.os.UserManager;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.PollingCheck;
+import com.android.car.ui.toolbar.MenuItem;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.settingslib.RestrictedLockUtils;
+import com.android.settingslib.RestrictedLockUtilsInternal;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.ArrayList;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class ResetAppPrefFragmentTest {
+    private static final String ENABLED_PKG_NAME = "package.name.1";
+    private static final String DISABLED_PKG_NAME = "package.name.2";
+    private static final int UID = 1001010;
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private ResetAppPrefFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MenuItem mResetButton;
+    private MockitoSession mSession;
+    private List<ApplicationInfo> mAppInfoList;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Mock
+    private PackageManager mMockPm;
+    @Mock
+    private INotificationManager mINotificationManager;
+    @Mock
+    private IPackageManager mIPackageManager;
+    @Mock
+    private AppOpsManager mAppOpsManager;
+    @Mock
+    private RestrictedLockUtils.EnforcedAdmin mEnforcedAdmin;
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(ServiceManager.class, withSettings().lenient())
+                .mockStatic(RestrictedLockUtilsInternal.class, withSettings().lenient())
+                .mockStatic(UserHandle.class, withSettings().lenient())
+                .startMocking();
+        IBinder notificationBinder = mock(IBinder.class, withSettings().lenient());
+        IBinder packageManagerBinder = mock(IBinder.class, withSettings().lenient());
+        when(notificationBinder.queryLocalInterface("android.app.INotificationManager")).thenReturn(
+                mINotificationManager);
+        when(packageManagerBinder.queryLocalInterface(
+                "android.content.pm.IPackageManager")).thenReturn(mIPackageManager);
+        when(ServiceManager.getService(Context.NOTIFICATION_SERVICE)).thenReturn(
+                notificationBinder);
+        when(ServiceManager.getService("package")).thenReturn(packageManagerBinder);
+
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivity.getSupportFragmentManager();
+        setUpFragment();
+        ExtendedMockito.lenient().when(mFragment.requireContext()).thenReturn(mContext);
+        when(mContext.getApplicationContext()).thenReturn(mContext);
+        when(mContext.getSystemService(AppOpsManager.class)).thenReturn(mAppOpsManager);
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+        mAppInfoList = new ArrayList<>();
+        mAppInfoList.add(createApplicationInfo(ENABLED_PKG_NAME, true));
+        mAppInfoList.add(createApplicationInfo(DISABLED_PKG_NAME, false));
+        when(mMockPm.getInstalledApplications(anyInt())).thenReturn(mAppInfoList);
+        when(UserHandle.myUserId()).thenReturn(100);
+
+        mResetButton = mActivity.getToolbar().getMenuItems().get(0);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void resetClicked_resetsNotificationsForApps() throws Throwable {
+        triggerResetButtonAndWaitForTask();
+
+        verify(mINotificationManager)
+                .setNotificationsEnabledForPackage(ENABLED_PKG_NAME, UID, true);
+        verify(mINotificationManager)
+                .setNotificationsEnabledForPackage(DISABLED_PKG_NAME, UID, true);
+    }
+
+    @Test
+    public void resetClicked_appEnabled_doesNotEnable() throws Throwable {
+        when(mMockPm.getApplicationEnabledSetting(ENABLED_PKG_NAME))
+                .thenReturn(PackageManager.COMPONENT_ENABLED_STATE_DISABLED_USER);
+
+        triggerResetButtonAndWaitForTask();
+
+        verify(mMockPm, never()).setApplicationEnabledSetting(ENABLED_PKG_NAME,
+                PackageManager.COMPONENT_ENABLED_STATE_DEFAULT,
+                PackageManager.DONT_KILL_APP);
+    }
+
+    @Test
+    public void resetClicked_appDisabled_doesEnable() throws Throwable {
+        when(mMockPm.getApplicationEnabledSetting(DISABLED_PKG_NAME))
+                .thenReturn(PackageManager.COMPONENT_ENABLED_STATE_DISABLED_USER);
+
+        triggerResetButtonAndWaitForTask();
+
+        verify(mMockPm).setApplicationEnabledSetting(DISABLED_PKG_NAME,
+                PackageManager.COMPONENT_ENABLED_STATE_DEFAULT,
+                PackageManager.DONT_KILL_APP);
+    }
+
+    @Test
+    public void resetClicked_resetsApplicationPreferences() throws Throwable {
+        triggerResetButtonAndWaitForTask();
+
+        verify(mIPackageManager).resetApplicationPreferences(anyInt());
+    }
+
+    @Test
+    public void resetClicked_adminDisallowResetsApplicationPreferences() throws Throwable {
+        ExtendedMockito.when(RestrictedLockUtilsInternal.checkIfRestrictionEnforced(
+                        mActivity,
+                        UserManager.DISALLOW_APPS_CONTROL, UserHandle.myUserId()))
+                .thenReturn(mEnforcedAdmin);
+        ExtendedMockito.when(RestrictedLockUtilsInternal.hasBaseUserRestriction(mActivity,
+                        UserManager.DISALLOW_APPS_CONTROL, UserHandle.myUserId()))
+                .thenReturn(false);
+        assertThrows(NullPointerException.class, ()->triggerResetButtonAndWaitForTask());
+        verify(mIPackageManager, never()).resetApplicationPreferences(anyInt());
+    }
+
+    @Test
+    public void resetClicked_resetsAllModes() throws Throwable {
+        triggerResetButtonAndWaitForTask();
+
+        verify(mAppOpsManager).resetAllModes();
+    }
+
+    private void triggerResetButtonAndWaitForTask() throws Throwable {
+        mActivityTestRule.runOnUiThread(() -> mResetButton.performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        // wait for async task
+        PollingCheck.waitFor(
+                () -> mFragment.mResetTask.getStatus() == AsyncTask.Status.FINISHED);
+    }
+
+    private void setUpFragment() throws Throwable {
+        String resetPrefFragmentTag = "reset_app_pref_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(
+                            R.id.fragment_container, new ResetAppPrefFragment(),
+                            resetPrefFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (ResetAppPrefFragment)
+                mFragmentManager.findFragmentByTag(resetPrefFragmentTag);
+        ExtendedMockito.spyOn(mFragment);
+    }
+
+    private ApplicationInfo createApplicationInfo(String pkgName, boolean enabled) {
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+        applicationInfo.packageName = pkgName;
+        applicationInfo.uid = UID;
+        applicationInfo.sourceDir = "";
+        applicationInfo.enabled = enabled;
+        return applicationInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/ResetEsimPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/ResetEsimPreferenceControllerTest.java
new file mode 100644
index 000000000..674d2122a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/ResetEsimPreferenceControllerTest.java
@@ -0,0 +1,247 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.provider.Settings;
+import android.telephony.euicc.EuiccManager;
+
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+/** Unit test for {@link ResetEsimPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class ResetEsimPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SwitchPreference mPreference;
+    private ResetEsimPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    // Store values for reset after test run
+    private int mDevelopmentSettingsEnabled;
+    private int mEuiccProvisioned;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private EuiccManager mMockEuiccManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        // store before values
+        mDevelopmentSettingsEnabled = Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 0);
+        mEuiccProvisioned = Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.EUICC_PROVISIONED, 0);
+
+        when(mContext.getSystemService(Context.EUICC_SERVICE)).thenReturn(mMockEuiccManager);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 0);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.EUICC_PROVISIONED, 0);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new SwitchPreference(mContext);
+        mPreferenceController = new ResetEsimPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, mDevelopmentSettingsEnabled);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.EUICC_PROVISIONED,
+                mEuiccProvisioned);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disabledEuiccManager_unsupportedOnDevice() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disabledEuiccManager_unsupportedOnDevice_zoneWrite() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disabledEuiccManager_unsupportedOnDevice_zoneRead() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_disabledEuiccManager_unsupportedOnDevice_zoneHidden() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_unsupportedOnDevice() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_unsupportedOnDevice_zoneWrite() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_unsupportedOnDevice_zoneRead() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_unsupportedOnDevice_zoneHidden() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_developer_available() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_developer_available_zoneWrite() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_developer_available_zoneRead() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccNotProvisioned_developer_available_zoneHidden() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.DEVELOPMENT_SETTINGS_ENABLED, 1);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccProvisioned_available() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.EUICC_PROVISIONED, 1);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccProvisioned_available_zoneWrite() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.EUICC_PROVISIONED, 1);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccProvisioned_available_zoneRead() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.EUICC_PROVISIONED, 1);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_euiccProvisioned_available_zoneHidden() {
+        when(mMockEuiccManager.isEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(),
+                Settings.Global.EUICC_PROVISIONED, 1);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/ResetNetworkConfirmFragmentTest.java b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkConfirmFragmentTest.java
new file mode 100644
index 000000000..2e16ca2c6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkConfirmFragmentTest.java
@@ -0,0 +1,302 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+import static org.testng.Assert.assertThrows;
+
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothManager;
+import android.content.ContentResolver;
+import android.content.Context;
+import android.net.ConnectivityManager;
+import android.net.NetworkPolicyManager;
+import android.net.Uri;
+import android.net.wifi.WifiManager;
+import android.os.AsyncTask;
+import android.os.RecoverySystem;
+import android.provider.Telephony;
+import android.telephony.SubscriptionManager;
+import android.telephony.TelephonyManager;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.preference.PreferenceManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.settings.testutils.PollingCheck;
+import com.android.car.ui.toolbar.MenuItem;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class ResetNetworkConfirmFragmentTest {
+    private static final String SUBSCRIBER_ID = "test_id";
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private ResetNetworkConfirmFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MockitoSession mSession;
+    private MenuItem mResetButton;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Mock
+    private ConnectivityManager mMockConnectivityManager;
+    @Mock
+    private WifiManager mMockWifiManager;
+    @Mock
+    private BluetoothManager mMockBluetoothManager;
+    @Mock
+    private BluetoothAdapter mMockBluetoothAdapter;
+    @Mock
+    private TelephonyManager mMockTelephonyManager;
+    @Mock
+    private NetworkPolicyManager mMockNetworkPolicyManager;
+    @Mock
+    private ContentResolver mMockContentResolver;
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+        when(mFragment.getApplicationContext()).thenReturn(mContext);
+        setNetworkSubscriptionId("123");
+        mResetButton = mActivity.getToolbar().getMenuItems().get(0);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                RecoverySystem.class, withSettings().lenient()).startMocking();
+        when(mContext.getSystemService(Context.CONNECTIVITY_SERVICE)).thenReturn(
+                mMockConnectivityManager);
+        when(mContext.getSystemService(Context.WIFI_SERVICE)).thenReturn(mMockWifiManager);
+        when(mContext.getSystemService(Context.BLUETOOTH_SERVICE)).thenReturn(
+                mMockBluetoothManager);
+        when(mMockBluetoothManager.getAdapter()).thenReturn(mMockBluetoothAdapter);
+        when(mContext.getSystemService(Context.TELEPHONY_SERVICE)).thenReturn(
+                mMockTelephonyManager);
+        when(mMockTelephonyManager.getSubscriberId(anyInt())).then(invocation -> {
+            Object[] args = invocation.getArguments();
+            int subId = (Integer) args[0];
+            return subId == SubscriptionManager.INVALID_SUBSCRIPTION_ID ? null : SUBSCRIBER_ID;
+        });
+        when(mContext.getSystemService(Context.NETWORK_POLICY_SERVICE)).thenReturn(
+                mMockNetworkPolicyManager);
+        when(mContext.getContentResolver()).thenReturn(mMockContentResolver);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_connectivityManagerReset() {
+        mResetButton.performClick();
+        verify(mMockConnectivityManager).factoryReset();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_wifiManagerReset() {
+        mResetButton.performClick();
+        verify(mMockWifiManager).factoryReset();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_bluetoothAdapterReset() {
+        mResetButton.performClick();
+        verify(mMockBluetoothAdapter).clearBluetooth();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_cleanSmsRawTable() {
+        mResetButton.performClick();
+
+        ArgumentCaptor<Uri> argumentCaptor = ArgumentCaptor.forClass(Uri.class);
+        verify(mMockContentResolver, times(2)).delete(argumentCaptor.capture(), any(), any());
+        List<Uri> capturedUris = argumentCaptor.getAllValues();
+        Uri uri = getUriWithGivenPrefix(capturedUris, Telephony.Sms.CONTENT_URI);
+
+        assertThat(uri).isNotNull();
+    }
+
+    @Test
+    public void testResetButtonClick_euiccResetEnabled_euiccReset() throws Throwable {
+        setEuiccResetCheckbox(true);
+        mActivityTestRule.runOnUiThread(() -> mResetButton.performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // wait for async task
+        PollingCheck.waitFor(
+                () -> mFragment.mEraseEsimAsyncTask.getStatus() == AsyncTask.Status.FINISHED);
+
+        ExtendedMockito.verify(
+                () -> RecoverySystem.wipeEuiccData(any(), any()));
+    }
+
+    @Test
+    public void testResetButtonClick_euiccResetDisabled_euiccNotReset() throws Throwable {
+        setEuiccResetCheckbox(false);
+        mActivityTestRule.runOnUiThread(() -> mResetButton.performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        ExtendedMockito.verify(
+                () -> RecoverySystem.wipeEuiccData(any(), any()), never());
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_nonIntegerNetworkSubscriptionId_numberExceptionError() {
+        setNetworkSubscriptionId("abc");
+        assertThrows(NumberFormatException.class, () -> mResetButton.performClick());
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_emptyNetworkSubscriptionId_telephonyNotReset() {
+        setNetworkSubscriptionId("");
+        mResetButton.performClick();
+        verify(mMockTelephonyManager).factoryReset(SubscriptionManager.INVALID_SUBSCRIPTION_ID);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_validNetworkSubscriptionId_telephonyReset() {
+        mResetButton.performClick();
+        verify(mMockTelephonyManager).factoryReset(123);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_emptyNetworkSubscriptionId_networkManagerNotReset() {
+        setNetworkSubscriptionId("");
+        mResetButton.performClick();
+        verify(mMockNetworkPolicyManager).factoryReset(null);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_validNetworkSubscriptionId_networkManagerReset() {
+        setNetworkSubscriptionId("123");
+        mResetButton.performClick();
+        verify(mMockNetworkPolicyManager).factoryReset(SUBSCRIBER_ID);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_emptyNetworkSubscriptionId_noRestoreDefaultApn() {
+        setNetworkSubscriptionId("");
+        mResetButton.performClick();
+
+        ArgumentCaptor<Uri> argumentCaptor = ArgumentCaptor.forClass(Uri.class);
+        verify(mMockContentResolver, times(2)).delete(argumentCaptor.capture(), any(), any());
+        List<Uri> capturedUris = argumentCaptor.getAllValues();
+        Uri uri = getUriWithGivenPrefix(capturedUris,
+                ResetNetworkConfirmFragment.RESTORE_CARRIERS_URI);
+
+        assertThat(uri).isNotNull();
+        assertThat(uri.toString().contains("subId/")).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void testResetButtonClick_validNetworkSubscriptionId_restoreDefaultApn() {
+        setNetworkSubscriptionId("123");
+        mResetButton.performClick();
+
+        ArgumentCaptor<Uri> argumentCaptor = ArgumentCaptor.forClass(Uri.class);
+        verify(mMockContentResolver, times(2)).delete(argumentCaptor.capture(), any(), any());
+        List<Uri> capturedUris = argumentCaptor.getAllValues();
+        Uri uri = getUriWithGivenPrefix(capturedUris,
+                ResetNetworkConfirmFragment.RESTORE_CARRIERS_URI);
+
+        assertThat(uri).isNotNull();
+        assertThat(uri.toString().contains("subId/123")).isTrue();
+    }
+
+    private void setUpFragment() throws Throwable {
+        String resetNetworkConfirmFragmentTag = "reset_network_confirm_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new ResetNetworkConfirmFragment(),
+                            resetNetworkConfirmFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (ResetNetworkConfirmFragment)
+                mFragmentManager.findFragmentByTag(resetNetworkConfirmFragmentTag);
+        ExtendedMockito.spyOn(mFragment);
+    }
+
+    private Uri getUriWithGivenPrefix(List<Uri> uris, String prefix) {
+        for (Uri uri : uris) {
+            if (uri.toString().startsWith(prefix)) return uri;
+        }
+        return null;
+    }
+
+    private Uri getUriWithGivenPrefix(List<Uri> uris, Uri prefix) {
+        for (Uri uri : uris) {
+            if (uri.isPathPrefixMatch(prefix)) return uri;
+        }
+        return null;
+    }
+
+    private void setEuiccResetCheckbox(boolean isChecked) {
+        PreferenceManager.getDefaultSharedPreferences(mContext).edit().putBoolean(
+                mContext.getString(R.string.pk_reset_esim), isChecked).commit();
+    }
+
+    private void setNetworkSubscriptionId(String id) {
+        PreferenceManager.getDefaultSharedPreferences(mContext).edit().putString(
+                mContext.getString(R.string.pk_reset_network_subscription), id).commit();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/ResetNetworkEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..6518d816f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkEntryPreferenceControllerTest.java
@@ -0,0 +1,300 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.UserManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+/** Unit test for {@link ResetNetworkEntryPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class ResetNetworkEntryPreferenceControllerTest {
+    private static final String TEST_RESTRICTION = android.os.UserManager.DISALLOW_NETWORK_RESET;
+
+    private final Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private final LifecycleOwner mLifecycleOwner = new TestLifecycleOwner();
+    private CarUiPreference mPreference;
+    private ResetNetworkEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new CarUiPreference(mContext);
+        mPreferenceController = new ResetNetworkEntryPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser() {
+        mockUserIsAdmin(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneWrite() {
+        mockUserIsAdmin(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneRead() {
+        mockUserIsAdmin(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneHidden() {
+        mockUserIsAdmin(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByUm_disabledForUser() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByUm_disabledForUser_zoneWrite() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByUm_disabledForUser_zoneRead() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByUm_disabledForUser_zoneHidden() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByUm(true);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByDpm_disabledForUser() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByDpm_disabledForUser_zoneWrite() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByDpm_disabledForUser_zoneRead() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_restrictedByDpm_disabledForUser_zoneHidden() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notRestricted_available() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notRestricted_available_zoneWrite() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+        assertThat(mPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notRestricted_available_zoneRead() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+        assertThat(mPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_notRestricted_available_zoneHidden() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(false);
+
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void testDisabledClick_restrictedByDpm_showDialog() {
+        mockUserIsAdmin(true);
+        mockUserRestrictionSetByDpm(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void mockUserIsAdmin(boolean isAdmin) {
+        when(mMockUserManager.isAdminUser()).thenReturn(isAdmin);
+    }
+
+    private void mockUserRestrictionSetByUm(boolean restricted) {
+        when(mMockUserManager.hasBaseUserRestriction(eq(TEST_RESTRICTION), any()))
+                .thenReturn(restricted);
+    }
+
+    private void mockUserRestrictionSetByDpm(boolean restricted) {
+        mockUserRestrictionSetByUm(false);
+        when(mMockUserManager.hasUserRestriction(TEST_RESTRICTION)).thenReturn(restricted);
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/ResetNetworkFragmentTest.java b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkFragmentTest.java
new file mode 100644
index 000000000..11a19226d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkFragmentTest.java
@@ -0,0 +1,105 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static android.app.Activity.RESULT_OK;
+
+import static com.android.car.settings.system.ResetNetworkFragment.REQUEST_CODE;
+import static com.android.dx.mockito.inline.extended.ExtendedMockito.doNothing;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+
+import android.content.Intent;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.security.CheckLockActivity;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.car.ui.toolbar.MenuItem;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ResetNetworkFragmentTest {
+    private ResetNetworkFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MenuItem mResetButton;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+        mResetButton = mActivity.getToolbar().getMenuItems().get(0);
+
+        doNothing().when(mFragment).startActivityForResult(any(), anyInt());
+    }
+
+    @Test
+    @UiThreadTest
+    public void onResetButtonPressed_launchesCheckLockActivity() {
+        mResetButton.performClick();
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mFragment).startActivityForResult(captor.capture(), eq(REQUEST_CODE));
+        Intent intent = captor.getValue();
+        assertThat(intent.getComponent().getClassName())
+                .isEqualTo(CheckLockActivity.class.getName());
+    }
+
+    @Test
+    @UiThreadTest
+    public void onActivityResult_launchesResetNetworkConfirmFragment() {
+        mFragment.onActivityResult(REQUEST_CODE, RESULT_OK, new Intent());
+        verify(mFragment).launchFragment(any(ResetNetworkConfirmFragment.class));
+    }
+
+    private void setUpFragment() throws Throwable {
+        String resetNetworkFragmentTag = "reset_network_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new ResetNetworkFragment(),
+                            resetNetworkFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (ResetNetworkFragment)
+                mFragmentManager.findFragmentByTag(resetNetworkFragmentTag);
+        ExtendedMockito.spyOn(mFragment);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/ResetNetworkItemsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkItemsPreferenceControllerTest.java
new file mode 100644
index 000000000..c76fff50d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkItemsPreferenceControllerTest.java
@@ -0,0 +1,152 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class ResetNetworkItemsPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private ResetNetworkItemsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mMockPm;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new ResetNetworkItemsPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_containsDefaultDescription() {
+        setSystemFeatures(/* hasWifi= */ false, /* hasTelephony= */ false,
+                /* hasBluetooth= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertContainsString(mPreference.getTitle(),
+                mContext.getString(R.string.reset_network_desc));
+    }
+
+    @Test
+    public void onCreate_noWifi_doesNotContainWifiText() {
+        setSystemFeatures(/* hasWifi= */ false, /* hasTelephony= */ false,
+                /* hasBluetooth= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertDoesNotContainsString(mPreference.getTitle(),
+                mContext.getString(R.string.reset_network_item_wifi));
+    }
+
+    @Test
+    public void onCreate_noTelephony_doesNotContainTelephonyText() {
+        setSystemFeatures(/* hasWifi= */ false, /* hasTelephony= */ false,
+                /* hasBluetooth= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertDoesNotContainsString(mPreference.getTitle(),
+                mContext.getString(R.string.reset_network_item_mobile));
+    }
+
+    @Test
+    public void onCreate_noBluetooth_doesNotContainBluetoothText() {
+        setSystemFeatures(/* hasWifi= */ false, /* hasTelephony= */ false,
+                /* hasBluetooth= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertDoesNotContainsString(mPreference.getTitle(),
+                mContext.getString(R.string.reset_network_item_bluetooth));
+    }
+
+    @Test
+    public void onCreate_hasWifi_containsWifiText() {
+        setSystemFeatures(/* hasWifi= */ true, /* hasTelephony= */ false,
+                /* hasBluetooth= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertContainsString(mPreference.getTitle(),
+                mContext.getString(R.string.reset_network_item_wifi));
+    }
+
+    @Test
+    public void onCreate_hasTelephony_containsTelephonyText() {
+        setSystemFeatures(/* hasWifi= */ false, /* hasTelephony= */ true,
+                /* hasBluetooth= */ false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertContainsString(mPreference.getTitle(),
+                mContext.getString(R.string.reset_network_item_mobile));
+    }
+
+    @Test
+    public void onCreate_hasBluetooth_containsBluetoothText() {
+        setSystemFeatures(/* hasWifi= */ false, /* hasTelephony= */ false,
+                /* hasBluetooth= */ true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertContainsString(mPreference.getTitle(),
+                mContext.getString(R.string.reset_network_item_bluetooth));
+    }
+
+    private void setSystemFeatures(boolean hasWifi, boolean hasTelephony, boolean hasBluetooth) {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(hasWifi);
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)).thenReturn(hasTelephony);
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_BLUETOOTH)).thenReturn(hasBluetooth);
+    }
+
+    private void assertContainsString(CharSequence source, String pattern) {
+        assertThat(source).isNotNull();
+        String sourceString = source.toString();
+        assertThat(sourceString.contains(pattern)).isTrue();
+    }
+
+    private void assertDoesNotContainsString(CharSequence source, String pattern) {
+        assertThat(source).isNotNull();
+        String sourceString = source.toString();
+        assertThat(sourceString.contains(pattern)).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/ResetNetworkSubscriptionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkSubscriptionPreferenceControllerTest.java
new file mode 100644
index 000000000..47fade54b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/ResetNetworkSubscriptionPreferenceControllerTest.java
@@ -0,0 +1,479 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static android.telephony.SubscriptionManager.INVALID_SUBSCRIPTION_ID;
+import static android.telephony.SubscriptionManager.MIN_SUBSCRIPTION_ID_VALUE;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.telephony.SubscriptionInfo;
+import android.telephony.SubscriptionManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+/** Unit test for {@link ResetNetworkSubscriptionPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class ResetNetworkSubscriptionPreferenceControllerTest {
+    private static final int SUBID_1 = MIN_SUBSCRIPTION_ID_VALUE;
+    private static final int SUBID_2 = SUBID_1 + 1;
+    private static final int SUBID_3 = SUBID_2 + 1;
+    private static final int SUBID_4 = SUBID_3 + 1;
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private ResetNetworkSubscriptionPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mMockPm;
+    @Mock
+    private SubscriptionManager mMockSubscriptionManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+        // Default to AVAILABLE status. Tests for this behavior will do their own setup.
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)).thenReturn(true);
+        when(mContext.getSystemService(SubscriptionManager.class))
+                .thenReturn(mMockSubscriptionManager);
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList()).thenReturn(null);
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                SubscriptionManager.class, withSettings().lenient()).startMocking();
+        // Default to having no defaults. Tests for this behavior will do their own setup.
+        when(SubscriptionManager.isUsableSubIdValue(anyInt())).thenCallRealMethod();
+        when(SubscriptionManager.getDefaultSubscriptionId()).thenReturn(INVALID_SUBSCRIPTION_ID);
+        when(SubscriptionManager.getDefaultSmsSubscriptionId()).thenReturn(INVALID_SUBSCRIPTION_ID);
+        when(SubscriptionManager.getDefaultVoiceSubscriptionId()).thenReturn(
+                INVALID_SUBSCRIPTION_ID);
+        when(SubscriptionManager.getDefaultDataSubscriptionId()).thenReturn(
+                INVALID_SUBSCRIPTION_ID);
+
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new ResetNetworkSubscriptionPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyAvailable_available() {
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyAvailable_available_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyAvailable_available_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyAvailable_available_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyNotAvailable_unsupportedOnDevice() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)).thenReturn(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyNotAvailable_unsupportedOnDevice_zoneWrite() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyNotAvailable_unsupportedOnDevice_zoneRead() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_telephonyNotAvailable_unsupportedOnDevice_zoneHidden() {
+        when(mMockPm.hasSystemFeature(PackageManager.FEATURE_TELEPHONY)).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void refreshUi_nullSubscriptions_hidesPreference() {
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_nullSubscriptions_setsValue() {
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getValue()).isEqualTo(
+                String.valueOf(INVALID_SUBSCRIPTION_ID));
+    }
+
+    @Test
+    public void refreshUi_noSubscriptions_hidesPreference() {
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(Collections.emptyList());
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_noSubscriptions_setsValue() {
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(Collections.emptyList());
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getValue()).isEqualTo(
+                String.valueOf(INVALID_SUBSCRIPTION_ID));
+    }
+
+    @Test
+    public void refreshUi_oneSubscription_hidesPreference() {
+        List<SubscriptionInfo> subscriptionInfoList = Collections.singletonList(
+                createSubInfo(SUBID_1, "sub1"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_oneSubscription_setsValue() {
+        List<SubscriptionInfo> subscriptionInfoList = Collections.singletonList(
+                createSubInfo(SUBID_1, "sub1"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getValue()).isEqualTo(String.valueOf(SUBID_1));
+    }
+
+    @Test
+    public void refreshUi_multipleSubscriptions_showsPreference() {
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(createSubInfo(SUBID_1, "sub1"),
+                createSubInfo(SUBID_2, "sub2"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void refreshUi_multipleSubscriptions_populatesEntries() {
+        String displayName1 = "sub1";
+        String displayName2 = "sub2";
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(
+                createSubInfo(SUBID_1, displayName1), createSubInfo(SUBID_2, displayName2));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(Arrays.asList(mPreference.getEntries())).containsExactly(displayName1,
+                displayName2);
+        assertThat(Arrays.asList(mPreference.getEntryValues())).containsExactly(
+                String.valueOf(SUBID_1),
+                String.valueOf(SUBID_2));
+    }
+
+    @Test
+    public void refreshUi_defaultSelection_fourthPriority_system() {
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(
+                createSubInfo(SUBID_1, "sub1"), createSubInfo(SUBID_2, "sub2"),
+                createSubInfo(SUBID_3, "sub3"), createSubInfo(SUBID_4, "sub4"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        setDefaultSubscriptionId(SUBID_4);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getValue()).isEqualTo(String.valueOf(SUBID_4));
+    }
+
+    @Test
+    public void refreshUi_defaultSelection_thirdPriority_sms() {
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(createSubInfo(SUBID_1, "sub1"),
+                createSubInfo(SUBID_2, "sub2"), createSubInfo(SUBID_3, "sub3"),
+                createSubInfo(SUBID_4, "sub4"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        setDefaultSubscriptionId(SUBID_4);
+        setDefaultSmsSubscriptionId(SUBID_3);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getValue()).isEqualTo(String.valueOf(SUBID_3));
+    }
+
+    @Test
+    public void refreshUi_defaultSelection_secondPriority_voice() {
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(createSubInfo(SUBID_1, "sub1"),
+                createSubInfo(SUBID_2, "sub2"), createSubInfo(SUBID_3, "sub3"),
+                createSubInfo(SUBID_4, "sub4"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        setDefaultSubscriptionId(SUBID_4);
+        setDefaultSmsSubscriptionId(SUBID_3);
+        setDefaultVoiceSubscriptionId(SUBID_2);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getValue()).isEqualTo(String.valueOf(SUBID_2));
+    }
+
+    @Test
+    public void refreshUi_defaultSelection_firstPriority_data() {
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(createSubInfo(SUBID_1, "sub1"),
+                createSubInfo(SUBID_2, "sub2"), createSubInfo(SUBID_3, "sub3"),
+                createSubInfo(SUBID_4, "sub4"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+
+        setDefaultSubscriptionId(SUBID_4);
+        setDefaultSmsSubscriptionId(SUBID_3);
+        setDefaultVoiceSubscriptionId(SUBID_2);
+        setDefaultDataSubscriptionId(SUBID_1);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getValue()).isEqualTo(String.valueOf(SUBID_1));
+    }
+
+    @Test
+    public void refreshUi_title_fourthPriority_subscriptionNetworkIds() {
+        SubscriptionInfo subInfo = createSubInfo(
+                SUBID_1,
+                /* displayName= */ "",
+                /* carrierName= */ "",
+                /* number= */ "");
+        // Multiple subscriptions so that preference is shown / title is set.
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(subInfo,
+                createSubInfo(SUBID_2, "sub2"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+        setDefaultDataSubscriptionId(SUBID_1);
+
+        mPreferenceController.refreshUi();
+
+        String title = mPreference.getTitle().toString();
+        assertThat(title).contains(String.valueOf(subInfo.getMcc()));
+        assertThat(title).contains(String.valueOf(subInfo.getMnc()));
+        assertThat(title).contains(String.valueOf(subInfo.getSimSlotIndex()));
+        assertThat(title).contains(String.valueOf(subInfo.getSubscriptionId()));
+    }
+
+    @Test
+    public void refreshUi_title_thirdPriority_subscriptionCarrierName() {
+        SubscriptionInfo subInfo = createSubInfo(
+                SUBID_1,
+                /* displayName= */ "",
+                "carrierName",
+                /* number= */ "");
+        // Multiple subscriptions so that preference is shown / title is set.
+        // Multiple subscriptions so that preference is shown / title is set.
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(subInfo,
+                createSubInfo(SUBID_2, "sub2"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+        setDefaultDataSubscriptionId(SUBID_1);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getTitle()).isEqualTo(subInfo.getCarrierName());
+    }
+
+    @Test
+    public void refreshUi_title_secondPriority_subscriptionNumber() {
+        SubscriptionInfo subInfo = createSubInfo(
+                SUBID_1,
+                /* displayName= */ "",
+                "carrierName",
+                "number");
+        // Multiple subscriptions so that preference is shown / title is set.
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(subInfo,
+                createSubInfo(SUBID_2, "sub2"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+        setDefaultDataSubscriptionId(SUBID_1);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getTitle()).isEqualTo(subInfo.getNumber());
+    }
+
+    @Test
+    public void refreshUi_title_firstPriority_subscriptionDisplayName() {
+        SubscriptionInfo subInfo = createSubInfo(
+                SUBID_1,
+                "displayName",
+                "carrierName",
+                "number");
+        // Multiple subscriptions so that preference is shown / title is set.
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(subInfo,
+                createSubInfo(SUBID_2, "sub2"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+        setDefaultDataSubscriptionId(SUBID_1);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.getTitle()).isEqualTo(subInfo.getDisplayName());
+    }
+
+    @Test
+    public void handlePreferenceChanged_updatesTitle() {
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(createSubInfo(SUBID_1, "sub1"),
+                createSubInfo(SUBID_2, "sub2"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+        setDefaultDataSubscriptionId(SUBID_1);
+        mPreferenceController.refreshUi();
+
+        mPreference.callChangeListener(String.valueOf(SUBID_2));
+
+        assertThat(mPreference.getTitle()).isEqualTo("sub2");
+    }
+
+    @Test
+    public void handlePreferenceChanged_returnsTrue() {
+        List<SubscriptionInfo> subscriptionInfoList = Arrays.asList(createSubInfo(SUBID_1, "sub1"),
+                createSubInfo(SUBID_2, "sub2"));
+        when(mMockSubscriptionManager.getActiveSubscriptionInfoList())
+                .thenReturn(subscriptionInfoList);
+        setDefaultDataSubscriptionId(SUBID_1);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceController.handlePreferenceChanged(mPreference,
+                String.valueOf(SUBID_2))).isTrue();
+    }
+
+    /** Reduce SubscriptionInfo constructor args to the ones we care about here. */
+    private SubscriptionInfo createSubInfo(int subId, String displayName) {
+        return createSubInfo(subId, displayName, "carrierName", "number");
+    }
+
+    /** Reduce SubscriptionInfo constructor args to the ones we care about here. */
+    private SubscriptionInfo createSubInfo(int subId, String displayName, String carrierName,
+            String number) {
+        // Hidden constructor so resort to mocking.
+        SubscriptionInfo subscriptionInfo = mock(SubscriptionInfo.class);
+        when(subscriptionInfo.getSubscriptionId()).thenReturn(subId);
+        when(subscriptionInfo.getDisplayName()).thenReturn(displayName);
+        when(subscriptionInfo.getCarrierName()).thenReturn(carrierName);
+        when(subscriptionInfo.getNumber()).thenReturn(number);
+        when(subscriptionInfo.getSimSlotIndex()).thenReturn(111);
+        when(subscriptionInfo.getMcc()).thenReturn(222);
+        when(subscriptionInfo.getMnc()).thenReturn(333);
+        return subscriptionInfo;
+    }
+
+    private void setDefaultSubscriptionId(int id) {
+        when(SubscriptionManager.getDefaultSubscriptionId()).thenReturn(id);
+    }
+
+    private void setDefaultSmsSubscriptionId(int id) {
+        when(SubscriptionManager.getDefaultSmsSubscriptionId()).thenReturn(id);
+    }
+
+    private void setDefaultVoiceSubscriptionId(int id) {
+        when(SubscriptionManager.getDefaultVoiceSubscriptionId()).thenReturn(id);
+    }
+
+    private void setDefaultDataSubscriptionId(int id) {
+        when(SubscriptionManager.getDefaultDataSubscriptionId()).thenReturn(id);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/RestartSystemPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/RestartSystemPreferenceControllerTest.java
new file mode 100644
index 000000000..f28ae13f9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/RestartSystemPreferenceControllerTest.java
@@ -0,0 +1,176 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.system.RestartSystemPreferenceController.RESTART_SYSTEM_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.Bundle;
+import android.os.PowerManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiPreference;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoSession;
+import org.mockito.quality.Strictness;
+
+/** Unit test for {@link RestartSystemPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class RestartSystemPreferenceControllerTest {
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+    private CarUiPreference mPreference;
+    private MockitoSession mSession;
+    private RestartSystemPreferenceController mPreferenceController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PowerManager mMockPowerManager;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .initMocks(this)
+                .mockStatic(PowerManager.class)
+                .strictness(Strictness.LENIENT)
+                .startMocking();
+
+        when(mContext.getSystemService(PowerManager.class)).thenReturn(mMockPowerManager);
+
+        mPreference = new CarUiPreference(mContext);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void handlePreferenceClicked_showsDialog() {
+        mPreferenceController = new RestartSystemPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreferenceController.mDialogFragment.getConfirmListener()).isNotNull();
+        assertThat(mPreferenceController.mDialogFragment.getRejectListener()).isNull();
+
+        mPreference.performClick();
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(RESTART_SYSTEM_CONFIRM_DIALOG_TAG));
+    }
+
+    @Test
+    public void restartSystemConfirmationListener_continueToReboot() {
+        mPreferenceController = new RestartSystemPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mRestartSystemConfirmListener.onConfirm(new Bundle());
+
+        verify(mMockPowerManager, times(1)).reboot(null);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAccessPrivilege_unsupportedOnDevice() {
+        mPreferenceController = new RestartSystemPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions,
+                /* rebootPermissionGranted */ false);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAccessPrivilege_unsupportedOnDevice_zoneWrite() {
+        mPreferenceController = new RestartSystemPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions,
+                /* rebootPermissionGranted */ false);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAccessPrivilege_unsupportedOnDevice_zoneRead() {
+        mPreferenceController = new RestartSystemPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions,
+                /* rebootPermissionGranted */ false);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noAccessPrivilege_unsupportedOnDevice_zoneHidden() {
+        mPreferenceController = new RestartSystemPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions,
+                /* rebootPermissionGranted */ false);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/SinglePaneFactoryResetFragmentTest.java b/tests/multivalent/src/com/android/car/settings/system/SinglePaneFactoryResetFragmentTest.java
new file mode 100644
index 000000000..645646f3b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/SinglePaneFactoryResetFragmentTest.java
@@ -0,0 +1,57 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static android.app.Activity.RESULT_OK;
+
+import static com.android.car.settings.system.FactoryResetFragment.CHECK_LOCK_REQUEST_CODE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
+
+import org.junit.Rule;
+import org.junit.Test;
+
+public class SinglePaneFactoryResetFragmentTest
+        extends FactoryResetFragmentTestCase<SinglePaneTestActivity> {
+
+    @Rule
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
+
+    @Override
+    ActivityTestRule<SinglePaneTestActivity> getActivityTestRule() {
+        return mActivityTestRule;
+    }
+
+    @Test
+    public void processActivityResult_resultOk_updatesFragmentContainer()
+            throws Throwable {
+        getActivityTestRule().runOnUiThread(() -> {
+            mFragment.processActivityResult(CHECK_LOCK_REQUEST_CODE, RESULT_OK, /* data= */ null);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(mFragmentManager.findFragmentById(R.id.fragment_container))
+                .isInstanceOf(FactoryResetConfirmFragment.class);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/SystemUpdatePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/SystemUpdatePreferenceControllerTest.java
new file mode 100644
index 000000000..8c45c69de
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/SystemUpdatePreferenceControllerTest.java
@@ -0,0 +1,259 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+import android.os.PersistableBundle;
+import android.os.UserManager;
+import android.telephony.CarrierConfigManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.filters.FlakyTest;
+
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.Collections;
+
+/** Unit test for {@link SystemUpdatePreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class SystemUpdatePreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private SystemUpdatePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private PackageManager mMockPm;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(UserManager.class, withSettings().lenient())
+                .startMocking();
+        when(UserManager.get(mContext)).thenReturn(mMockUserManager);
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new SystemUpdatePreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_available() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_available_zoneWrite() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_adminUser_available_zoneRead() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    @FlakyTest(bugId = 316042666)
+    public void getAvailabilityStatus_adminUser_available_zoneHidden() {
+        when(mMockUserManager.isAdminUser()).thenReturn(true);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser() {
+        when(mMockUserManager.isAdminUser()).thenReturn(false);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneWrite() {
+        when(mMockUserManager.isAdminUser()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneRead() {
+        when(mMockUserManager.isAdminUser()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_nonAdminUser_disabledForUser_zoneHidden() {
+        when(mMockUserManager.isAdminUser()).thenReturn(false);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void onCreate_setsActivityLabelAsTitle() {
+        ApplicationInfo applicationInfo = new ApplicationInfo();
+        applicationInfo.flags |= ApplicationInfo.FLAG_SYSTEM;
+
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.applicationInfo = applicationInfo;
+        activityInfo.packageName = "some.test.package";
+        activityInfo.name = "SomeActivity";
+
+        String label = "Activity Label";
+        ResolveInfo resolveInfo = new ResolveInfo();
+        resolveInfo.nonLocalizedLabel = label;
+        resolveInfo.activityInfo = activityInfo;
+
+        Intent intent = new Intent();
+        when(mMockPm.queryIntentActivities(eq(intent), anyInt())).thenReturn(
+                Collections.singletonList(resolveInfo));
+        mPreference.setIntent(intent);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getTitle()).isEqualTo(label);
+    }
+
+    @Test
+    public void refreshUi_activityNotFound_hidesPreference() {
+        mPreference.setIntent(new Intent());
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void preferenceClicked_triggersClientInitiatedAction() {
+        // Arrange
+        String action = "action";
+        String key = "key";
+        String value = "value";
+
+        PersistableBundle config = new PersistableBundle();
+        config.putBoolean(CarrierConfigManager.KEY_CI_ACTION_ON_SYS_UPDATE_BOOL, true);
+        config.putString(CarrierConfigManager.KEY_CI_ACTION_ON_SYS_UPDATE_INTENT_STRING, action);
+        config.putString(CarrierConfigManager.KEY_CI_ACTION_ON_SYS_UPDATE_EXTRA_STRING, key);
+        config.putString(CarrierConfigManager.KEY_CI_ACTION_ON_SYS_UPDATE_EXTRA_VAL_STRING, value);
+
+        CarrierConfigManager mockConfigManager = mock(CarrierConfigManager.class);
+        when(mContext.getSystemService(CarrierConfigManager.class)).thenReturn(mockConfigManager);
+        when(mockConfigManager.getConfig()).thenReturn(config);
+        Context mockApplicationContext = mock(Context.class);
+        when(mContext.getApplicationContext()).thenReturn(mockApplicationContext);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        // Act
+        mPreference.performClick();
+
+        // Assert
+        ArgumentCaptor<Intent> captor = ArgumentCaptor.forClass(Intent.class);
+        verify(mockApplicationContext).sendBroadcast(captor.capture());
+        Intent broadcast = captor.getValue();
+        assertThat(broadcast.getAction()).isEqualTo(action);
+        assertThat(broadcast.getStringExtra(key)).isEqualTo(value);
+    }
+
+    @Test
+    public void preferenceClicked_handledReturnsFalse() {
+        CarrierConfigManager mockConfigManager = mock(CarrierConfigManager.class);
+        when(mContext.getSystemService(CarrierConfigManager.class)).thenReturn(mockConfigManager);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        assertThat(mPreference.getOnPreferenceClickListener().onPreferenceClick(
+                mPreference)).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/DeviceModelPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/DeviceModelPreferenceControllerTest.java
new file mode 100644
index 000000000..8e9cc1b7c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/DeviceModelPreferenceControllerTest.java
@@ -0,0 +1,72 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.hardwareinfo;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.Build;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.settingslib.DeviceInfoUtils;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class DeviceModelPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private DeviceModelPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new DeviceModelPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onCreate_setsSummary() {
+        String deviceModel = Build.MODEL + DeviceInfoUtils.getMsvSuffix();
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(deviceModel);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/HardwareRevisionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/HardwareRevisionPreferenceControllerTest.java
new file mode 100644
index 000000000..b54f41751
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/HardwareRevisionPreferenceControllerTest.java
@@ -0,0 +1,72 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.hardwareinfo;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.SystemProperties;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.filters.FlakyTest;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class HardwareRevisionPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private HardwareRevisionPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new HardwareRevisionPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    @FlakyTest(bugId = 316042666)
+    public void onCreate_setsSummary() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(
+                SystemProperties.get("ro.boot.hardware.revision"));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/SerialNumberPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/SerialNumberPreferenceControllerTest.java
new file mode 100644
index 000000000..0364f987a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/hardwareinfo/SerialNumberPreferenceControllerTest.java
@@ -0,0 +1,71 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.hardwareinfo;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.os.Build;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.filters.FlakyTest;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class SerialNumberPreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private SerialNumberPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new SerialNumberPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    @FlakyTest(bugId = 316036256)
+    public void onCreate_setsSummary() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreference.getSummary()).isEqualTo(Build.getSerial());
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/legal/LegalPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/legal/LegalPreferenceControllerTest.java
new file mode 100644
index 000000000..ddc3e3f5a
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/legal/LegalPreferenceControllerTest.java
@@ -0,0 +1,56 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.legal;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+
+import org.junit.runner.RunWith;
+
+/** Unit test for {@link LegalPreferenceController}. */
+@RunWith(AndroidJUnit4.class)
+public class LegalPreferenceControllerTest extends LegalPreferenceControllerTestCase {
+    @Override
+    protected LegalPreferenceController getPreferenceController() {
+        return new TestLegalPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Override
+    protected String getIntentAction() {
+        return "test_intent";
+    }
+
+    private static class TestLegalPreferenceController extends LegalPreferenceController {
+        private static final Intent INTENT = new Intent("test_intent");
+
+        TestLegalPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected Intent getIntent() {
+            return INTENT;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/legal/LegalPreferenceControllerTestCase.java b/tests/multivalent/src/com/android/car/settings/system/legal/LegalPreferenceControllerTestCase.java
new file mode 100644
index 000000000..5d36d8eb4
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/legal/LegalPreferenceControllerTestCase.java
@@ -0,0 +1,313 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.legal;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.pm.ActivityInfo;
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.content.pm.ResolveInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.filters.FlakyTest;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public abstract class LegalPreferenceControllerTestCase {
+    private static final String TEST_LABEL = "test_label";
+    private static final String TEST_PACKAGE_NAME = "com.android.car.settings.testutils";
+    private static final String TEST_ACTIVITY_NAME = "BaseTestActivity";
+
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private LegalPreferenceController mPreferenceController;
+
+    protected Context mContext = spy(ApplicationProvider.getApplicationContext());
+    protected CarUxRestrictions mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */
+            true, CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+    @Mock
+    protected FragmentController mFragmentController;
+    @Mock
+    private PackageManager mMockPm;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getPackageManager()).thenReturn(mMockPm);
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = getPreferenceController();
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    protected abstract LegalPreferenceController getPreferenceController();
+
+    protected abstract String getIntentAction();
+
+    @Test
+    public void getIntent_shouldUseRightIntent() {
+        Intent intent = mPreferenceController.getIntent();
+        assertThat(intent.getAction()).isEqualTo(getIntentAction());
+    }
+
+    @Test
+    public void getAvailabilityStatus_systemApp_shouldReturnAvailable() {
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ true));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_systemApp_shouldReturnAvailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ true));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_systemApp_shouldReturnAvailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ true));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_systemApp_shouldReturnAvailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ true));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSystemApp_shouldReturnUnsupported() {
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ false));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(UNSUPPORTED_ON_DEVICE);
+
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt())).thenReturn(null);
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSystemApp_shouldReturnUnsupported_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ false));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt())).thenReturn(null);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSystemApp_shouldReturnUnsupported_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ false));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt())).thenReturn(null);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_notSystemApp_shouldReturnUnsupported_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ false));
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt()))
+                .thenReturn(list);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+
+        when(mMockPm.queryIntentActivities(any(Intent.class), anyInt())).thenReturn(null);
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_intentResolvesToNull_shouldReturnUnsupported() {
+        when(mMockPm.queryIntentActivities(eq(mPreferenceController.getIntent()), anyInt()))
+                .thenReturn(Collections.emptyList());
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_intentResolvesToNull_shouldReturnUnsupported_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        when(mMockPm.queryIntentActivities(eq(mPreferenceController.getIntent()), anyInt()))
+                .thenReturn(Collections.emptyList());
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_intentResolvesToNull_shouldReturnUnsupported_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        when(mMockPm.queryIntentActivities(eq(mPreferenceController.getIntent()), anyInt()))
+                .thenReturn(Collections.emptyList());
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_intentResolvesToNull_shouldReturnUnsupported_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        when(mMockPm.queryIntentActivities(eq(mPreferenceController.getIntent()), anyInt()))
+                .thenReturn(Collections.emptyList());
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void onCreate_intentResolvesToActivity_isVisible() {
+        Intent intent = mPreferenceController.getIntent();
+
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ true));
+
+        when(mMockPm.queryIntentActivities(eq(intent), anyInt())).thenReturn(list);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void onCreate_intentResolvesToActivity_updatesTitle() {
+        Intent intent = mPreferenceController.getIntent();
+
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ true));
+
+        when(mMockPm.queryIntentActivities(eq(intent), anyInt())).thenReturn(list);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getTitle()).isEqualTo(TEST_LABEL);
+    }
+
+    @Test
+    @FlakyTest(bugId = 316067921)
+    public void onCreate_intentResolvesToActivity_updatesIntentToSpecificActivity() {
+        Intent intent = mPreferenceController.getIntent();
+
+        List<ResolveInfo> list = new ArrayList<>();
+        list.add(getTestResolveInfo(/* isSystemApp= */ true));
+
+        when(mMockPm.queryIntentActivities(eq(intent), anyInt())).thenReturn(list);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.getIntent().getComponent().flattenToString()).isEqualTo(
+                TEST_PACKAGE_NAME + "/" + TEST_ACTIVITY_NAME);
+    }
+
+    /**
+     * Returns a ResolveInfo object for testing
+     *
+     * @param isSystemApp If true, the application is a system app.
+     */
+    private ResolveInfo getTestResolveInfo(boolean isSystemApp) {
+        ActivityInfo activityInfo = new ActivityInfo();
+        activityInfo.packageName = TEST_PACKAGE_NAME;
+        activityInfo.name = TEST_ACTIVITY_NAME;
+        activityInfo.applicationInfo = new ApplicationInfo();
+        if (isSystemApp) {
+            activityInfo.applicationInfo.flags |= ApplicationInfo.FLAG_SYSTEM;
+        }
+
+        ResolveInfo resolveInfo = new ResolveInfo() {
+            @Override
+            public CharSequence loadLabel(PackageManager pm) {
+                return TEST_LABEL;
+            }
+        };
+        resolveInfo.activityInfo = activityInfo;
+        return resolveInfo;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/legal/TermsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/legal/TermsPreferenceControllerTest.java
new file mode 100644
index 000000000..9cc07763b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/legal/TermsPreferenceControllerTest.java
@@ -0,0 +1,35 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.legal;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class TermsPreferenceControllerTest extends LegalPreferenceControllerTestCase {
+    @Override
+    protected LegalPreferenceController getPreferenceController() {
+        return new TermsPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Override
+    protected String getIntentAction() {
+        return "android.settings.TERMS";
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/legal/ThirdPartyLicensePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/legal/ThirdPartyLicensePreferenceControllerTest.java
new file mode 100644
index 000000000..adf2eb157
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/legal/ThirdPartyLicensePreferenceControllerTest.java
@@ -0,0 +1,35 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.legal;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class ThirdPartyLicensePreferenceControllerTest extends LegalPreferenceControllerTestCase {
+    @Override
+    protected LegalPreferenceController getPreferenceController() {
+        return new ThirdPartyLicensePreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Override
+    protected String getIntentAction() {
+        return "android.settings.THIRD_PARTY_LICENSE";
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/system/legal/WebViewLicensePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/system/legal/WebViewLicensePreferenceControllerTest.java
new file mode 100644
index 000000000..e646ce394
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/system/legal/WebViewLicensePreferenceControllerTest.java
@@ -0,0 +1,35 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.system.legal;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class WebViewLicensePreferenceControllerTest extends LegalPreferenceControllerTestCase {
+    @Override
+    protected LegalPreferenceController getPreferenceController() {
+        return new WebViewLicensePreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions);
+    }
+
+    @Override
+    protected String getIntentAction() {
+        return "android.settings.WEBVIEW_LICENSE";
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/BaseCarSettingsTestActivity.java b/tests/multivalent/src/com/android/car/settings/testutils/BaseCarSettingsTestActivity.java
new file mode 100644
index 000000000..2111ec83d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/BaseCarSettingsTestActivity.java
@@ -0,0 +1,71 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.content.Intent;
+
+import androidx.annotation.Nullable;
+import androidx.fragment.app.Fragment;
+
+import com.android.car.settings.common.BaseCarSettingsActivity;
+
+public class BaseCarSettingsTestActivity extends BaseCarSettingsActivity {
+
+    private final TestEventListener<Intent> mStartActivityListener = new TestEventListener<>();
+    private boolean mOnBackPressedFlag;
+
+    @Nullable
+    @Override
+    protected Fragment getInitialFragment() {
+        return null;
+    }
+
+    @Override
+    public void onBackPressed() {
+        mOnBackPressedFlag = true;
+        super.onBackPressed();
+    }
+
+    @Override
+    public void startActivity(Intent intent) {
+        mStartActivityListener.accept(intent);
+        super.startActivity(intent);
+    }
+
+    /**
+     * Gets a boolean flag indicating whether onBackPressed has been called.
+     *
+     * @return {@code true} if onBackPressed called, {@code false} otherwise.
+     */
+    public boolean getOnBackPressedFlag() {
+        return mOnBackPressedFlag;
+    }
+
+    /**
+     * Clear the boolean flag for onBackPressed by setting it to false.
+     */
+    public void clearOnBackPressedFlag() {
+        mOnBackPressedFlag = false;
+    }
+
+    /**
+     * Gets an event listener for {@link #startActivity(Intent)}
+     */
+    public TestEventListener<Intent> getStartActivityListener() {
+        return mStartActivityListener;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/BaseTestSettingsFragment.java b/tests/multivalent/src/com/android/car/settings/testutils/BaseTestSettingsFragment.java
new file mode 100644
index 000000000..307c4ef8b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/BaseTestSettingsFragment.java
@@ -0,0 +1,40 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.car.drivingstate.CarUxRestrictions;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.SettingsFragment;
+
+public class BaseTestSettingsFragment extends SettingsFragment {
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Override
+    protected int getPreferenceScreenResId() {
+        return R.xml.test_preference_screen;
+    }
+
+    @Override
+    public void onUxRestrictionsChanged(CarUxRestrictions restrictionInfo) {
+        mCarUxRestrictions = restrictionInfo;
+    }
+
+    public CarUxRestrictions getUxRestrictions() {
+        return mCarUxRestrictions;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/BluetoothTestUtils.java b/tests/multivalent/src/com/android/car/settings/testutils/BluetoothTestUtils.java
new file mode 100644
index 000000000..4abd20d94
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/BluetoothTestUtils.java
@@ -0,0 +1,169 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import static junit.framework.Assert.fail;
+
+import android.annotation.StringRes;
+import android.bluetooth.BluetoothAdapter;
+import android.bluetooth.BluetoothClass;
+import android.bluetooth.BluetoothDevice;
+import android.content.BroadcastReceiver;
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+
+import com.android.car.settings.R;
+import com.android.settingslib.bluetooth.LocalBluetoothProfile;
+
+import java.util.concurrent.CountDownLatch;
+import java.util.concurrent.TimeUnit;
+
+/**
+ * Collection of helper methods for testing Bluetooth.
+ */
+public class BluetoothTestUtils {
+
+    private static final int BLUETOOTH_TOGGLE_TIMEOUT = 30; // in seconds
+    private static final IntentFilter STATE_INTENT_FILTER = new IntentFilter(
+            BluetoothAdapter.ACTION_STATE_CHANGED);
+    private static final int TEST_RES_ID = R.string.settings_label; // placeholder
+
+    /**
+     * Set the default bluetooth adapter state.
+     *
+     * Because the adapter isn't enabled/disabled immediately after calling enable or disable,
+     * this helper function will listen and wait for the state to change before returning (or will
+     * fail upon timeout).
+     */
+    public static void setBluetoothState(Context context, boolean enable) {
+        BluetoothAdapter adapter = BluetoothAdapter.getDefaultAdapter();
+        if (adapter.isEnabled() == enable) {
+            // state is already correct
+            return;
+        }
+        CountDownLatch latch = new CountDownLatch(1);
+        LatchBroadcastReceiver receiver = new LatchBroadcastReceiver(latch, enable);
+        context.registerReceiver(receiver, STATE_INTENT_FILTER);
+        if (enable) {
+            adapter.enable();
+        } else {
+            adapter.disable();
+        }
+        try {
+            latch.await(BLUETOOTH_TOGGLE_TIMEOUT, TimeUnit.SECONDS);
+        } catch (InterruptedException e) {
+            fail("Unable to toggle bluetooth");
+        } finally {
+            context.unregisterReceiver(receiver);
+        }
+        if (adapter.isEnabled() != enable) {
+            // failed to toggle
+            fail("Unable to toggle bluetooth");
+        }
+    }
+
+    private static class LatchBroadcastReceiver extends BroadcastReceiver {
+        private final CountDownLatch mLatch;
+        private final boolean mEnable;
+
+        private LatchBroadcastReceiver(CountDownLatch latch, boolean enable) {
+            mLatch = latch;
+            mEnable = enable;
+        }
+
+        @Override
+        public void onReceive(Context context, Intent intent) {
+            int state = intent.getIntExtra(BluetoothAdapter.EXTRA_STATE, BluetoothAdapter.ERROR);
+            if (mEnable && state == BluetoothAdapter.STATE_ON) {
+                mLatch.countDown();
+            } else if (!mEnable && state == BluetoothAdapter.STATE_OFF) {
+                mLatch.countDown();
+            }
+        }
+    }
+
+    public static class TestLocalBluetoothProfile implements LocalBluetoothProfile {
+        private final int mProfileId;
+        private boolean mIsEnabled;
+
+        public TestLocalBluetoothProfile(int profileId) {
+            mProfileId = profileId;
+        }
+
+        @Override
+        public boolean accessProfileEnabled() {
+            return false;
+        }
+
+        @Override
+        public boolean isAutoConnectable() {
+            return false;
+        }
+
+        @Override
+        public int getConnectionStatus(BluetoothDevice device) {
+            return 0;
+        }
+
+        @Override
+        public boolean isEnabled(BluetoothDevice device) {
+            return mIsEnabled;
+        }
+
+        @Override
+        public int getConnectionPolicy(BluetoothDevice device) {
+            return 0;
+        }
+
+        @Override
+        public boolean setEnabled(BluetoothDevice device, boolean enabled) {
+            return mIsEnabled = enabled;
+        }
+
+        @Override
+        public boolean isProfileReady() {
+            return false;
+        }
+
+        @Override
+        public int getProfileId() {
+            return mProfileId;
+        }
+
+        @Override
+        public int getOrdinal() {
+            return 0;
+        }
+
+        @Override
+        @StringRes
+        public int getNameResource(BluetoothDevice device) {
+            return TEST_RES_ID;
+        }
+
+        @Override
+        public int getSummaryResourceForDevice(BluetoothDevice device) {
+            return 0;
+        }
+
+        @Override
+        public int getDrawableResource(BluetoothClass btClass) {
+            return 0;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/DialogTestUtils.java b/tests/multivalent/src/com/android/car/settings/testutils/DialogTestUtils.java
new file mode 100644
index 000000000..71f489cd0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/DialogTestUtils.java
@@ -0,0 +1,63 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.widget.Button;
+import android.widget.TextView;
+
+import androidx.fragment.app.DialogFragment;
+
+/**
+ * Helper methods for DialogFragment testing.
+ */
+public class DialogTestUtils {
+    private DialogTestUtils() {
+    }
+
+    /**
+     * Invokes onClick on the dialog's positive button.
+     */
+    public static void clickPositiveButton(DialogFragment dialogFragment) {
+        Button positiveButton = dialogFragment.getDialog().getWindow().findViewById(
+                com.android.internal.R.id.button1);
+        positiveButton.callOnClick();
+    }
+
+    /**
+     * Invokes onClick on the dialog's negative button.
+     */
+    public static void clickNegativeButton(DialogFragment dialogFragment) {
+        Button negativeButton = dialogFragment.getDialog().getWindow().findViewById(
+                com.android.internal.R.id.button2);
+        negativeButton.callOnClick();
+    }
+
+    /**
+     * Gets dialog's title.
+     */
+    public static String getTitle(DialogFragment dialogFragment) {
+        TextView titleView = dialogFragment.getDialog().getWindow().findViewById(
+                com.android.internal.R.id.alertTitle);
+        return titleView.getText().toString();
+    }
+
+    public static String getMessage(DialogFragment dialogFragment) {
+        TextView messageView = dialogFragment.getDialog().getWindow().findViewById(
+                com.android.internal.R.id.message);
+        return messageView.getText().toString();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/DualPaneTestActivity.java b/tests/multivalent/src/com/android/car/settings/testutils/DualPaneTestActivity.java
new file mode 100644
index 000000000..89cf6b3e7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/DualPaneTestActivity.java
@@ -0,0 +1,23 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+/**
+ * Same as {@link BaseCarSettingsTestActivity} but always dual-pane (via manifest meta-data).
+ */
+public class DualPaneTestActivity extends BaseCarSettingsTestActivity {
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/EmptySettingsFragment.java b/tests/multivalent/src/com/android/car/settings/testutils/EmptySettingsFragment.java
new file mode 100644
index 000000000..6ccec65c6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/EmptySettingsFragment.java
@@ -0,0 +1,26 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import com.android.car.settings.R;
+
+public class EmptySettingsFragment extends BaseTestSettingsFragment {
+    @Override
+    protected int getPreferenceScreenResId() {
+        return R.xml.empty_preference_screen;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/EnterpriseTestUtils.java b/tests/multivalent/src/com/android/car/settings/testutils/EnterpriseTestUtils.java
new file mode 100644
index 000000000..71136cc32
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/EnterpriseTestUtils.java
@@ -0,0 +1,49 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.os.UserManager;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.when;
+
+/**
+ * Collection of helper methods for PreferenceController with restricted access.
+ */
+public class EnterpriseTestUtils {
+    public static void mockUserRestrictionSetByUm(UserManager um, String restriction,
+            boolean restricted) {
+        when(um.hasBaseUserRestriction(eq(restriction), any()))
+                .thenReturn(restricted);
+        if (restricted) {
+            // In this test infra, setting base user restriction does not automatically set
+            // user restriction
+            when(um.hasUserRestriction(restriction)).thenReturn(restricted);
+        }
+    }
+
+    public static void mockUserRestrictionSetByDpm(UserManager um, String restriction,
+            boolean restricted) {
+        mockUserRestrictionSetByUm(um, restriction, false);
+        when(um.hasUserRestriction(restriction)).thenReturn(restricted);
+    }
+
+    private EnterpriseTestUtils() {
+        throw new AssertionError();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/PollingCheck.java b/tests/multivalent/src/com/android/car/settings/testutils/PollingCheck.java
new file mode 100644
index 000000000..0b6455714
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/PollingCheck.java
@@ -0,0 +1,114 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import junit.framework.Assert;
+
+import java.util.concurrent.Callable;
+import java.util.function.BooleanSupplier;
+
+public abstract class PollingCheck {
+    private static final long TIME_SLICE = 50;
+    private static final long DEFAULT_TIMEOUT = 5_000;
+    private static final String DEFAULT_ERROR_MESSAGE = "unexpected timeout";
+
+    private final long mTimeout;
+    private final String mErrorMessage;
+
+    public interface PollingCheckCondition {
+        boolean canProceed();
+    }
+
+    public PollingCheck() {
+        this(DEFAULT_TIMEOUT, DEFAULT_ERROR_MESSAGE);
+    }
+
+    public PollingCheck(long timeout) {
+        this(timeout, DEFAULT_ERROR_MESSAGE);
+    }
+
+    public PollingCheck(long timeout, String errorMessage) {
+        mTimeout = timeout;
+        mErrorMessage = errorMessage;
+    }
+
+    protected abstract boolean check();
+
+    public void run() {
+        if (check()) {
+            return;
+        }
+
+        long timeout = mTimeout;
+        while (timeout > 0) {
+            try {
+                Thread.sleep(TIME_SLICE);
+            } catch (InterruptedException e) {
+                Assert.fail("unexpected InterruptedException");
+            }
+
+            if (check()) {
+                return;
+            }
+
+            timeout -= TIME_SLICE;
+        }
+
+        Assert.assertTrue(mErrorMessage, check());
+    }
+
+    public static void check(CharSequence message, long timeout, Callable<Boolean> condition)
+            throws Exception {
+        while (timeout > 0) {
+            if (condition.call()) {
+                return;
+            }
+
+            Thread.sleep(TIME_SLICE);
+            timeout -= TIME_SLICE;
+        }
+
+        Assert.fail(message.toString());
+    }
+
+    public static void waitFor(final PollingCheckCondition condition) {
+        new PollingCheck() {
+            @Override
+            protected boolean check() {
+                return condition.canProceed();
+            }
+        }.run();
+    }
+
+    public static void waitFor(long timeout, final PollingCheckCondition condition) {
+        new PollingCheck(timeout) {
+            @Override
+            protected boolean check() {
+                return condition.canProceed();
+            }
+        }.run();
+    }
+
+    public static void waitFor(long timeout, BooleanSupplier condition, String errorMessage) {
+        new PollingCheck(timeout, errorMessage) {
+            @Override
+            protected boolean check() {
+                return condition.getAsBoolean();
+            }
+        }.run();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/ResourceTestUtils.java b/tests/multivalent/src/com/android/car/settings/testutils/ResourceTestUtils.java
new file mode 100644
index 000000000..0fccee588
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/ResourceTestUtils.java
@@ -0,0 +1,39 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.content.Context;
+
+public class ResourceTestUtils {
+    /**
+     * Retrieve a resource string from the current package based on a name identifier.
+     */
+    public static String getString(Context context, String name) {
+        return context.getResources().getString(context.getResources().getIdentifier(
+                name, /* type= */ "string", context.getPackageName()));
+    }
+
+    /**
+     * Retrieve a formatted resource string from the current package based on a name identifier,
+     * substituting the format arguments as defined in {@link java.util.Formatter} and
+     * {@link java.lang.String#format}.
+     */
+    public static String getString(Context context, String name, Object... formatArgs) {
+        return context.getResources().getString(context.getResources().getIdentifier(
+                name, /* type= */ "string", context.getPackageName()), formatArgs);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/RootTestSettingsFragment.java b/tests/multivalent/src/com/android/car/settings/testutils/RootTestSettingsFragment.java
new file mode 100644
index 000000000..7b7f95ef2
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/RootTestSettingsFragment.java
@@ -0,0 +1,51 @@
+/*
+ * Copyright (C) 2019 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.os.Bundle;
+
+import com.android.car.settings.R;
+import com.android.car.ui.toolbar.NavButtonMode;
+import com.android.car.ui.toolbar.ToolbarController;
+
+/**
+ * Empty root fragment.
+ */
+public class RootTestSettingsFragment extends BaseTestSettingsFragment {
+    @Override
+    protected int getPreferenceScreenResId() {
+        return R.xml.test_base_settings_fragment;
+    }
+
+    @Override
+    public void onActivityCreated(Bundle savedInstanceState) {
+        super.onActivityCreated(savedInstanceState);
+        ToolbarController toolbar = getToolbar();
+        if (toolbar != null) {
+            // If the fragment is root, change the back button to settings icon.
+            if (getContext().getResources().getBoolean(R.bool.config_is_root_fragment_root)) {
+                toolbar.setNavButtonMode(NavButtonMode.DISABLED);
+                toolbar.setLogo(getContext().getResources()
+                        .getBoolean(R.bool.config_show_settings_root_exit_icon)
+                        ? R.drawable.ic_launcher_settings
+                        : 0);
+            } else {
+                toolbar.setNavButtonMode(NavButtonMode.BACK);
+            }
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/SinglePaneTestActivity.java b/tests/multivalent/src/com/android/car/settings/testutils/SinglePaneTestActivity.java
new file mode 100644
index 000000000..ed7fe5ed0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/SinglePaneTestActivity.java
@@ -0,0 +1,34 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import androidx.annotation.Nullable;
+import androidx.fragment.app.Fragment;
+
+/**
+ * {@link BaseCarSettingsTestActivity} instance that always single-pane (via manifest meta-data).
+ */
+public class SinglePaneTestActivity extends BaseCarSettingsTestActivity {
+
+    @Nullable
+    @Override
+    protected Fragment getInitialFragment() {
+        // Specifying an initial fragment for single pane testing since it can't be launched later
+        // (because that will launch a new activity)
+        return new BaseTestSettingsFragment();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestContentProvider.java b/tests/multivalent/src/com/android/car/settings/testutils/TestContentProvider.java
new file mode 100644
index 000000000..0e7f994c5
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestContentProvider.java
@@ -0,0 +1,141 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.content.ContentProvider;
+import android.content.ContentValues;
+import android.content.pm.PackageManager;
+import android.content.res.Resources;
+import android.database.Cursor;
+import android.net.Uri;
+import android.os.Bundle;
+import android.text.TextUtils;
+
+import java.util.List;
+
+/**
+ * A simple content provider for tests.  This provider runs in the same process as the test.
+ */
+public class TestContentProvider extends ContentProvider {
+
+    public static final String TEST_TEXT_CONTENT = "TestContentProviderText";
+
+    private static final String SCHEME = "content";
+    private static final String AUTHORITY =
+            "com.android.car.settings.testutils.TestContentProvider";
+    private static final String METHOD_GET_TEXT = "getText";
+    private static final String METHOD_GET_ICON = "getIcon";
+    private static final String KEY_PREFERENCE_TITLE = "com.android.settings.title";
+    private static final String KEY_PREFERENCE_SUMMARY = "com.android.settings.summary";
+    private static final String KEY_PREFERENCE_ICON = "com.android.settings.icon";
+    private static final String KEY_PREFERENCE_ICON_PACKAGE = "com.android.settings.icon_package";
+    private static final String TEXT_KEY = "textKey";
+    private static final String ICON_KEY = "iconKey";
+
+
+    @Override
+    public boolean onCreate() {
+        return true;
+    }
+
+    @Override
+    public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs,
+            String sortOrder) {
+        return null;
+    }
+
+    @Override
+    public String getType(Uri uri) {
+        return null;
+    }
+
+    @Override
+    public Uri insert(Uri uri, ContentValues values) {
+        return null;
+    }
+
+    @Override
+    public int delete(Uri uri, String selection, String[] selectionArgs) {
+        return 0;
+    }
+
+    @Override
+    public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) {
+        return 0;
+    }
+
+    @Override
+    public Bundle call(String methodName, String uriString, Bundle extras) {
+        if (TextUtils.isEmpty(methodName)) {
+            return null;
+        }
+        if (TextUtils.isEmpty(uriString)) {
+            return null;
+        }
+        Uri uri = Uri.parse(uriString);
+        if (uri == null) {
+            return null;
+        }
+        // Only process URIs with valid scheme, authority, and no assigned port.
+        if (!(SCHEME.equals(uri.getScheme())
+                && AUTHORITY.equals(uri.getAuthority())
+                && (uri.getPort() == -1))) {
+            return null;
+        }
+        List<String> pathSegments = uri.getPathSegments();
+        // Path segments should consist of the method name and the argument. If the number of path
+        // segments is not exactly two, the content provider is not being called as intended.
+        if ((pathSegments == null) || (pathSegments.size() != 2)) {
+            return null;
+        }
+        // The first path segment needs to match the methodName.
+        if (!methodName.equals(pathSegments.get(0))) {
+            return null;
+        }
+        String key = pathSegments.get(1);
+        if (METHOD_GET_TEXT.equals(methodName)) {
+            if (TEXT_KEY.equals(key)) {
+                Bundle bundle = new Bundle();
+                bundle.putString(KEY_PREFERENCE_TITLE, TEST_TEXT_CONTENT);
+                bundle.putString(KEY_PREFERENCE_SUMMARY, TEST_TEXT_CONTENT);
+                return bundle;
+            }
+        } else if (METHOD_GET_ICON.equals(methodName)) {
+            if (ICON_KEY.equals(key)) {
+                try {
+                    String packageName = getContext().getPackageName();
+                    PackageManager manager = getContext().getPackageManager();
+                    Resources resources = manager.getResourcesForApplication(packageName);
+                    int iconRes = resources.getIdentifier("test_icon", "drawable",
+                            packageName);
+                    if (iconRes == 0) {
+                        return null;
+                    }
+
+                    Bundle bundle = new Bundle();
+                    bundle.putInt(KEY_PREFERENCE_ICON, iconRes);
+                    bundle.putString(KEY_PREFERENCE_ICON_PACKAGE, packageName);
+                    return bundle;
+
+                } catch (PackageManager.NameNotFoundException e) {
+                    return null;
+                }
+            }
+        }
+        return null;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestEventListener.java b/tests/multivalent/src/com/android/car/settings/testutils/TestEventListener.java
new file mode 100644
index 000000000..4387c49da
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestEventListener.java
@@ -0,0 +1,56 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import static junit.framework.Assert.assertFalse;
+
+import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertTrue;
+
+import androidx.annotation.Nullable;
+
+/**
+ * Test listener that can be used to spy on, control responses from,
+ * and make assertions against values tested.
+ */
+public class TestEventListener<T> {
+
+    private @Nullable T mLastValue;
+    private boolean mWasCalled;
+
+    public void accept(T event) {
+        mWasCalled = true;
+        mLastValue = event;
+    }
+
+    public void assertLastArgument(@Nullable T expected) {
+        assertEquals(expected, mLastValue);
+    }
+
+    public void assertCalled() {
+        assertTrue(mWasCalled);
+    }
+
+    public void assertNotCalled() {
+        assertFalse(mWasCalled);
+    }
+
+    @Nullable
+    public T getLastValue() {
+        return mLastValue;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestFinishActivity.java b/tests/multivalent/src/com/android/car/settings/testutils/TestFinishActivity.java
new file mode 100644
index 000000000..68965ea64
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestFinishActivity.java
@@ -0,0 +1,33 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import android.os.Bundle;
+
+import androidx.annotation.Nullable;
+import androidx.fragment.app.FragmentActivity;
+
+/**
+ * Test activity that will finish after being created.
+ */
+public class TestFinishActivity extends FragmentActivity {
+
+    protected void onCreate(@Nullable Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        finish();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestLifecycleOwner.java b/tests/multivalent/src/com/android/car/settings/testutils/TestLifecycleOwner.java
new file mode 100644
index 000000000..45aa4fd9f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestLifecycleOwner.java
@@ -0,0 +1,36 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import androidx.annotation.NonNull;
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.lifecycle.LifecycleRegistry;
+
+/**
+ * A LifecycleOwner implementation that can be used for testing.
+ */
+public class TestLifecycleOwner implements LifecycleOwner {
+
+    private final LifecycleRegistry mRegistry = new LifecycleRegistry(this);
+
+    @NonNull
+    @Override
+    public Lifecycle getLifecycle() {
+        return mRegistry;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsFragment1.java b/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsFragment1.java
new file mode 100644
index 000000000..32ca80deb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsFragment1.java
@@ -0,0 +1,20 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+public class TestSettingsFragment1 extends BaseTestSettingsFragment {
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsFragment2.java b/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsFragment2.java
new file mode 100644
index 000000000..6632af1e1
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsFragment2.java
@@ -0,0 +1,20 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+public class TestSettingsFragment2 extends BaseTestSettingsFragment {
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsScreenLockActivity.java b/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsScreenLockActivity.java
new file mode 100644
index 000000000..ebb56d3a4
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestSettingsScreenLockActivity.java
@@ -0,0 +1,28 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import com.android.car.settings.security.CheckLockListener;
+import com.android.internal.widget.LockscreenCredential;
+
+public class TestSettingsScreenLockActivity extends BaseCarSettingsTestActivity implements
+        CheckLockListener {
+
+    @Override
+    public void onLockVerified(LockscreenCredential lock) {
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestSubSettingsActivity.java b/tests/multivalent/src/com/android/car/settings/testutils/TestSubSettingsActivity.java
new file mode 100644
index 000000000..62255db90
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestSubSettingsActivity.java
@@ -0,0 +1,31 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import androidx.fragment.app.Fragment;
+
+import com.android.car.settings.common.SubSettingsActivity;
+
+/**
+ * Example SubSettingsActivity class used for Testing secondary pane behavior.
+ */
+public class TestSubSettingsActivity extends SubSettingsActivity {
+    @Override
+    protected Fragment getInitialFragment() {
+        return null;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TestTopLevelMenuFragment.java b/tests/multivalent/src/com/android/car/settings/testutils/TestTopLevelMenuFragment.java
new file mode 100644
index 000000000..76b184c30
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TestTopLevelMenuFragment.java
@@ -0,0 +1,27 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.TopLevelMenuFragment;
+
+public class TestTopLevelMenuFragment extends TopLevelMenuFragment {
+    @Override
+    protected int getPreferenceScreenResId() {
+        return R.xml.test_top_level_menu_fragment;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/testutils/TextDrawable.java b/tests/multivalent/src/com/android/car/settings/testutils/TextDrawable.java
new file mode 100644
index 000000000..80039c0ae
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/testutils/TextDrawable.java
@@ -0,0 +1,76 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settings.testutils;
+
+import android.graphics.Canvas;
+import android.graphics.ColorFilter;
+import android.graphics.Paint;
+import android.graphics.drawable.Drawable;
+
+import java.util.Objects;
+
+/**
+ * A simple {@link Drawable} that draws a text.
+ *
+ * <p>Useful on tests that compare icons.
+ */
+public final class TextDrawable extends Drawable {
+
+    private static final Paint PAINT = new Paint();
+
+    private final CharSequence mText;
+
+    public TextDrawable(CharSequence label) {
+        mText = Objects.requireNonNull(label);
+    }
+
+    @Override
+    public void draw(Canvas canvas) {
+        canvas.drawText(mText, 0, mText.length(), 0, 0, PAINT);
+    }
+
+    @Override
+    public void setAlpha(int alpha) {
+    }
+
+    @Override
+    public void setColorFilter(ColorFilter cf) {
+    }
+
+    @Override
+    public int getOpacity() {
+        return 0;
+    }
+
+    @Override
+    public boolean equals(Object obj) {
+        if (!(obj instanceof TextDrawable)) {
+            return false;
+        }
+        return mText.equals(((TextDrawable) obj).mText);
+    }
+
+    @Override
+    public int hashCode() {
+        return mText.hashCode();
+    }
+
+    @Override
+    public String toString() {
+        return getClass().getSimpleName() + "[text=" + mText + ", id="
+                + System.identityHashCode(this) + "]";
+    };
+}
diff --git a/tests/multivalent/src/com/android/car/settings/tts/PreferredEngineEntryPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/tts/PreferredEngineEntryPreferenceControllerTest.java
new file mode 100644
index 000000000..62c9adffa
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/tts/PreferredEngineEntryPreferenceControllerTest.java
@@ -0,0 +1,104 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.tts;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.speech.tts.TextToSpeech;
+import android.speech.tts.TtsEngines;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionIconPreference;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class PreferredEngineEntryPreferenceControllerTest {
+
+    private static final TextToSpeech.EngineInfo ENGINE_INFO = new TextToSpeech.EngineInfo();
+    private static final String INTENT_ACTION = "test_action";
+
+    static {
+        ENGINE_INFO.label = "Test Engine";
+        ENGINE_INFO.name = "com.android.car.settings.tts.test.Engine";
+    }
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiTwoActionIconPreference mPreference;
+    private PreferredEngineEntryPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private TtsEngines mEnginesHelper;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new CarUiTwoActionIconPreference(mContext);
+        mPreferenceController = new PreferredEngineEntryPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions, mEnginesHelper);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+
+        Intent intent = new Intent(INTENT_ACTION);
+        when(mEnginesHelper.getSettingsIntent(ENGINE_INFO.name)).thenReturn(intent);
+        when(mEnginesHelper.getEngineInfo(ENGINE_INFO.name)).thenReturn(
+                ENGINE_INFO);
+        when(mEnginesHelper.getDefaultEngine()).thenReturn(ENGINE_INFO.name);
+        doNothing().when(mContext).startActivity(any());
+    }
+
+    @Test
+    public void performButtonClick_navigateToNextActivity() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreference.performSecondaryActionClick();
+
+        ArgumentCaptor<Intent> intentArgumentCaptor = ArgumentCaptor.forClass(
+                Intent.class);
+        verify(mContext).startActivity(intentArgumentCaptor.capture());
+
+        Intent intent = intentArgumentCaptor.getValue();
+        assertThat(intent.getAction()).isEqualTo(INTENT_ACTION);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/tts/PreferredEngineOptionsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/tts/PreferredEngineOptionsPreferenceControllerTest.java
new file mode 100644
index 000000000..aec8bc3a2
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/tts/PreferredEngineOptionsPreferenceControllerTest.java
@@ -0,0 +1,214 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.tts;
+
+import static android.provider.Settings.Secure.TTS_DEFAULT_SYNTH;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.provider.Settings;
+import android.speech.tts.TextToSpeech;
+import android.speech.tts.TtsEngines;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public class PreferredEngineOptionsPreferenceControllerTest {
+    private static final TextToSpeech.EngineInfo OTHER_ENGINE_INFO = new TextToSpeech.EngineInfo();
+    private static final TextToSpeech.EngineInfo CURRENT_ENGINE_INFO =
+            new TextToSpeech.EngineInfo();
+
+    static {
+        OTHER_ENGINE_INFO.label = "Test Engine 1";
+        OTHER_ENGINE_INFO.name = "com.android.car.settings.tts.test.Engine1";
+        CURRENT_ENGINE_INFO.label = "Test Engine 2";
+        CURRENT_ENGINE_INFO.name = "com.android.car.settings.tts.test.Engine2";
+    }
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private PreferredEngineOptionsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private String mDefaultTtsEngine;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private TtsEngines mEnginesHelper;
+    @Mock
+    private TextToSpeech mTextToSpeech;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mDefaultTtsEngine = Settings.Secure.getString(mContext.getContentResolver(),
+                TTS_DEFAULT_SYNTH);
+
+        when(mEnginesHelper.getEngines()).thenReturn(
+                Arrays.asList(OTHER_ENGINE_INFO, CURRENT_ENGINE_INFO));
+        when(mEnginesHelper.getEngineInfo(OTHER_ENGINE_INFO.name)).thenReturn(OTHER_ENGINE_INFO);
+        when(mEnginesHelper.getEngineInfo(CURRENT_ENGINE_INFO.name)).thenReturn(
+                CURRENT_ENGINE_INFO);
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new TestPreferredEngineOptionsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+    }
+
+    @After
+    @UiThreadTest
+    public void tearDown() {
+        Settings.Secure.putString(mContext.getContentResolver(), TTS_DEFAULT_SYNTH,
+                mDefaultTtsEngine);
+    }
+
+    @Test
+    public void onCreate_populatesGroup() {
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(CURRENT_ENGINE_INFO.name);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void refreshUi_currentEngineInfoSummarySet() {
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(CURRENT_ENGINE_INFO.name);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(
+                mPreferenceGroup.findPreference(CURRENT_ENGINE_INFO.name).getSummary()).isEqualTo(
+                mContext.getString(R.string.text_to_speech_current_engine));
+    }
+
+    @Test
+    public void refreshUi_otherEngineInfoSummaryEmpty() {
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(CURRENT_ENGINE_INFO.name);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.refreshUi();
+
+        assertThat(mPreferenceGroup.findPreference(OTHER_ENGINE_INFO.name).getSummary()).isEqualTo(
+                "");
+    }
+
+    @Test
+    public void performClick_currentEngine_returnFalse() {
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(CURRENT_ENGINE_INFO.name);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Preference currentEngine = mPreferenceGroup.findPreference(CURRENT_ENGINE_INFO.name);
+        assertThat(currentEngine.getOnPreferenceClickListener().onPreferenceClick(
+                currentEngine)).isFalse();
+    }
+
+    @Test
+    public void performClick_otherEngine_returnTrue() {
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(CURRENT_ENGINE_INFO.name);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        Preference otherEngine = mPreferenceGroup.findPreference(OTHER_ENGINE_INFO.name);
+        assertThat(otherEngine.getOnPreferenceClickListener().onPreferenceClick(
+                otherEngine)).isTrue();
+    }
+
+    @Test
+    public void performClick_otherEngine_initSuccess_changeCurrentEngine() {
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(CURRENT_ENGINE_INFO.name);
+        Settings.Secure.putString(mContext.getContentResolver(), TTS_DEFAULT_SYNTH,
+                CURRENT_ENGINE_INFO.name);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        Preference otherEngine = mPreferenceGroup.findPreference(OTHER_ENGINE_INFO.name);
+        otherEngine.performClick();
+
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(OTHER_ENGINE_INFO.name);
+        mPreferenceController.onUpdateEngine(TextToSpeech.SUCCESS);
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(), TTS_DEFAULT_SYNTH))
+                .isEqualTo(OTHER_ENGINE_INFO.name);
+    }
+
+    @Test
+    public void performClick_otherEngine_initFail_keepCurrentEngine() {
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(CURRENT_ENGINE_INFO.name);
+        Settings.Secure.putString(mContext.getContentResolver(), TTS_DEFAULT_SYNTH,
+                CURRENT_ENGINE_INFO.name);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        Preference otherEngine = mPreferenceGroup.findPreference(OTHER_ENGINE_INFO.name);
+        otherEngine.performClick();
+
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(OTHER_ENGINE_INFO.name);
+        mPreferenceController.onUpdateEngine(TextToSpeech.ERROR);
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(), TTS_DEFAULT_SYNTH))
+                .isEqualTo(CURRENT_ENGINE_INFO.name);
+    }
+
+    private class TestPreferredEngineOptionsPreferenceController
+            extends PreferredEngineOptionsPreferenceController {
+
+        TestPreferredEngineOptionsPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        TtsEngines createEnginesHelper() {
+            return mEnginesHelper;
+        }
+
+        @Override
+        TextToSpeech createTts(TextToSpeech.OnInitListener listener, String engine) {
+            return mTextToSpeech;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/tts/TtsPlaybackPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/tts/TtsPlaybackPreferenceControllerTest.java
new file mode 100644
index 000000000..7d8835bb3
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/tts/TtsPlaybackPreferenceControllerTest.java
@@ -0,0 +1,507 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.tts;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.ArgumentMatchers.isNull;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.provider.Settings;
+import android.speech.tts.TextToSpeech;
+import android.speech.tts.TtsEngines;
+import android.speech.tts.Voice;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.preference.Preference;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ActivityResultCallback;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.common.SeekBarPreference;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import com.google.android.collect.Lists;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Locale;
+import java.util.concurrent.CountDownLatch;
+import java.util.concurrent.TimeUnit;
+
+@RunWith(AndroidJUnit4.class)
+public class TtsPlaybackPreferenceControllerTest {
+
+    private static final String DEFAULT_ENGINE_NAME = "com.android.car.settings.tts.test.default";
+    private static final TextToSpeech.EngineInfo ENGINE_INFO = new TextToSpeech.EngineInfo();
+    private static final Voice VOICE = new Voice("Test Name", Locale.ENGLISH, /* quality= */ 0,
+            /* latency= */ 0, /* requiresNetworkConnection= */ true, /* features= */ null);
+
+    static {
+        ENGINE_INFO.label = "Test Engine";
+        ENGINE_INFO.name = "com.android.car.settings.tts.test.other";
+    }
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private TtsPlaybackPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private PreferenceGroup mPreferenceGroup;
+    private ListPreference mDefaultLanguagePreference;
+    private SeekBarPreference mSpeechRatePreference;
+    private SeekBarPreference mVoicePitchPreference;
+    private Preference mResetPreference;
+
+    @Mock
+    private TextToSpeech mTextToSpeech;
+    @Mock
+    private TtsEngines mEnginesHelper;
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        mPreferenceController = new TestTtsPlaybackPreferenceController(mContext,
+                "key", mFragmentController, mCarUxRestrictions, mEnginesHelper);
+
+        mDefaultLanguagePreference = new ListPreference(mContext);
+        mDefaultLanguagePreference.setKey(mContext.getString(R.string.pk_tts_default_language));
+        mPreferenceGroup.addPreference(mDefaultLanguagePreference);
+
+        mSpeechRatePreference = new SeekBarPreference(mContext);
+        mSpeechRatePreference.setKey(mContext.getString(R.string.pk_tts_speech_rate));
+        mPreferenceGroup.addPreference(mSpeechRatePreference);
+
+        mVoicePitchPreference = new SeekBarPreference(mContext);
+        mVoicePitchPreference.setKey(mContext.getString(R.string.pk_tts_pitch));
+        mPreferenceGroup.addPreference(mVoicePitchPreference);
+
+        mResetPreference = new Preference(mContext);
+        mResetPreference.setKey(mContext.getString(R.string.pk_tts_reset));
+        mPreferenceGroup.addPreference(mResetPreference);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        when(mTextToSpeech.getCurrentEngine()).thenReturn(ENGINE_INFO.name);
+        when(mTextToSpeech.getVoice()).thenReturn(VOICE);
+        when(mEnginesHelper.parseLocaleString(VOICE.getLocale().toString())).thenReturn(
+                VOICE.getLocale());
+        when(mEnginesHelper.parseLocaleString(Locale.CANADA.toString())).thenReturn(Locale.CANADA);
+        when(mEnginesHelper.parseLocaleString(Locale.KOREA.toString())).thenReturn(Locale.KOREA);
+
+        Settings.Secure.putInt(mContext.getContentResolver(), Settings.Secure.TTS_DEFAULT_RATE,
+                TextToSpeech.Engine.DEFAULT_RATE);
+        Settings.Secure.putInt(mContext.getContentResolver(), Settings.Secure.TTS_DEFAULT_PITCH,
+                TextToSpeech.Engine.DEFAULT_PITCH);
+    }
+
+    @Test
+    public void onCreate_startsCheckVoiceData() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        ArgumentCaptor<Intent> intent = ArgumentCaptor.forClass(Intent.class);
+        verify(mFragmentController).startActivityForResult(
+                intent.capture(), eq(TtsPlaybackPreferenceController.VOICE_DATA_CHECK),
+                any(ActivityResultCallback.class));
+
+        assertThat(intent.getValue().getAction()).isEqualTo(
+                TextToSpeech.Engine.ACTION_CHECK_TTS_DATA);
+        assertThat(intent.getValue().getPackage()).isEqualTo(ENGINE_INFO.name);
+    }
+
+    @Test
+    public void voiceDataCheck_processActivityResult_dataIsNull_defaultSynthRemainsUnchanged() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Settings.Secure.putString(mContext.getContentResolver(), Settings.Secure.TTS_DEFAULT_SYNTH,
+                DEFAULT_ENGINE_NAME);
+
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, /* data= */ null);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.TTS_DEFAULT_SYNTH)).isEqualTo(DEFAULT_ENGINE_NAME);
+    }
+
+    @Test
+    public void voiceDataCheck_processActivityResult_dataIsNotNull_updatesDefaultSynth() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Settings.Secure.putString(mContext.getContentResolver(), Settings.Secure.TTS_DEFAULT_SYNTH,
+                DEFAULT_ENGINE_NAME);
+
+        Intent data = new Intent();
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, data);
+
+        assertThat(Settings.Secure.getString(mContext.getContentResolver(),
+                Settings.Secure.TTS_DEFAULT_SYNTH)).isEqualTo(ENGINE_INFO.name);
+    }
+
+    @Test
+    public void voiceDataCheck_processActivityResult_checkSuccess_hasVoices_populatesPreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        // Check that the length is 0 initially.
+        assertThat(mDefaultLanguagePreference.getEntries()).isNull();
+
+        Intent data = new Intent();
+        data.putStringArrayListExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES,
+                Lists.newArrayList(
+                        Locale.ENGLISH.toString(),
+                        Locale.CANADA.toString(),
+                        Locale.KOREA.toString()
+                ));
+
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, data);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Length is 3 languages + default language.
+        assertThat(mDefaultLanguagePreference.getEntries().length).isEqualTo(4);
+    }
+
+    @Test
+    public void getSampleText_processActivityResult_dataIsNull_setsDefaultText() {
+        mPreferenceController.processActivityResult(TtsPlaybackPreferenceController.GET_SAMPLE_TEXT,
+                TextToSpeech.LANG_AVAILABLE, /* data= */ null);
+
+        assertThat(mPreferenceController.getSampleText()).isEqualTo(
+                mContext.getString(R.string.tts_default_sample_string));
+    }
+
+    @Test
+    public void getSampleText_processActivityResult_emptyText_setsDefaultText() {
+        String testData = "";
+
+        Intent data = new Intent();
+        data.putExtra(TextToSpeech.Engine.EXTRA_SAMPLE_TEXT, testData);
+
+        mPreferenceController.processActivityResult(TtsPlaybackPreferenceController.GET_SAMPLE_TEXT,
+                TextToSpeech.LANG_AVAILABLE, data);
+
+        assertThat(mPreferenceController.getSampleText()).isEqualTo(
+                mContext.getString(R.string.tts_default_sample_string));
+    }
+
+    @Test
+    public void getSampleText_processActivityResult_dataIsNotNull_setsCorrectText() {
+        String testData = "Test sample text";
+
+        Intent data = new Intent();
+        data.putExtra(TextToSpeech.Engine.EXTRA_SAMPLE_TEXT, testData);
+
+        mPreferenceController.processActivityResult(TtsPlaybackPreferenceController.GET_SAMPLE_TEXT,
+                TextToSpeech.LANG_AVAILABLE, data);
+
+        assertThat(mPreferenceController.getSampleText()).isEqualTo(testData);
+    }
+
+    @Test
+    public void defaultLanguage_handlePreferenceChanged_passEmptyValue_setsDefault() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        Intent data = new Intent();
+        data.putStringArrayListExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES,
+                Lists.newArrayList(
+                        Locale.ENGLISH.toString(),
+                        Locale.CANADA.toString(),
+                        Locale.KOREA.toString()
+                ));
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, data);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Test change listener.
+        mDefaultLanguagePreference.callChangeListener("");
+
+        verify(mTextToSpeech).setLanguage(Locale.getDefault());
+    }
+
+    @Test
+    public void defaultLanguage_handlePreferenceChanged_passLocale_setsLocale() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        Intent data = new Intent();
+        data.putStringArrayListExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES,
+                Lists.newArrayList(
+                        Locale.ENGLISH.toString(),
+                        Locale.CANADA.toString(),
+                        Locale.KOREA.toString()
+                ));
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, data);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        // Test change listener.
+        mDefaultLanguagePreference.callChangeListener(Locale.ENGLISH.toString());
+
+        verify(mTextToSpeech).setLanguage(Locale.ENGLISH);
+    }
+
+    @Test
+    public void defaultLanguage_handlePreferenceChanged_passLocale_setsSummary() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        Intent data = new Intent();
+        data.putStringArrayListExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES,
+                Lists.newArrayList(
+                        Locale.ENGLISH.toString(),
+                        Locale.CANADA.toString(),
+                        Locale.KOREA.toString()
+                ));
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, data);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        mDefaultLanguagePreference.callChangeListener(Locale.ENGLISH.toString());
+
+        assertThat(mDefaultLanguagePreference.getSummary()).isEqualTo(
+                Locale.ENGLISH.getDisplayName());
+    }
+
+    @Test
+    public void speechRate_handlePreferenceChanged_updatesSecureSettings() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        int newSpeechRate = TextToSpeech.Engine.DEFAULT_RATE + 40;
+        mSpeechRatePreference.callChangeListener(newSpeechRate);
+
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.TTS_DEFAULT_RATE, TextToSpeech.Engine.DEFAULT_RATE)).isEqualTo(
+                newSpeechRate);
+    }
+
+    @Test
+    public void speechRate_handlePreferenceChanged_updatesTts() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        int newSpeechRate = TextToSpeech.Engine.DEFAULT_RATE + 40;
+        mSpeechRatePreference.callChangeListener(newSpeechRate);
+
+        verify(mTextToSpeech).setSpeechRate(
+                newSpeechRate / TtsPlaybackSettingsManager.SCALING_FACTOR);
+    }
+
+    @Test
+    public void speechRate_handlePreferenceChanged_speaksSampleText() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        int newSpeechRate = TextToSpeech.Engine.DEFAULT_RATE + 40;
+        mSpeechRatePreference.callChangeListener(newSpeechRate);
+
+        verify(mTextToSpeech).speak(any(), eq(TextToSpeech.QUEUE_FLUSH), isNull(), eq("Sample"));
+    }
+
+    @Test
+    public void voicePitch_handlePreferenceChanged_updatesSecureSettings() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        int newVoicePitch = TextToSpeech.Engine.DEFAULT_PITCH + 40;
+        mVoicePitchPreference.callChangeListener(newVoicePitch);
+
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.TTS_DEFAULT_PITCH, TextToSpeech.Engine.DEFAULT_PITCH)).isEqualTo(
+                newVoicePitch);
+    }
+
+    @Test
+    public void voicePitch_handlePreferenceChanged_updatesTts() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        int newVoicePitch = TextToSpeech.Engine.DEFAULT_PITCH + 40;
+        mVoicePitchPreference.callChangeListener(newVoicePitch);
+
+        verify(mTextToSpeech).setPitch(
+                newVoicePitch / TtsPlaybackSettingsManager.SCALING_FACTOR);
+    }
+
+    @Test
+    public void voicePitch_handlePreferenceChanged_speaksSampleText() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        int newVoicePitch = TextToSpeech.Engine.DEFAULT_PITCH + 40;
+        mVoicePitchPreference.callChangeListener(newVoicePitch);
+
+        verify(mTextToSpeech).speak(any(), eq(TextToSpeech.QUEUE_FLUSH), isNull(), eq("Sample"));
+    }
+
+    @Test
+    public void refreshUi_notInitialized_disablesPreference() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mDefaultLanguagePreference.isEnabled()).isFalse();
+        // Default language preference is always hidden
+        assertThat(mDefaultLanguagePreference.isVisible()).isFalse();
+        assertThat(mSpeechRatePreference.isEnabled()).isFalse();
+        assertThat(mVoicePitchPreference.isEnabled()).isFalse();
+        assertThat(mResetPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_initialized_defaultLocaleIsNull_disablesPreference() {
+        when(mEnginesHelper.parseLocaleString(any())).thenReturn(null);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mDefaultLanguagePreference.isEnabled()).isFalse();
+        // Default language preference is always hidden
+        assertThat(mDefaultLanguagePreference.isVisible()).isFalse();
+        assertThat(mSpeechRatePreference.isEnabled()).isFalse();
+        assertThat(mVoicePitchPreference.isEnabled()).isFalse();
+        assertThat(mResetPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_defaultLocaleNotSupported_disablesPreferencesExceptLanguage() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        Intent data = new Intent();
+        data.putStringArrayListExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES,
+                Lists.newArrayList(
+                        // English is default locale, but isn't available.
+                        Locale.CANADA.toString(),
+                        Locale.KOREA.toString()
+                ));
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, data);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        mPreferenceController.refreshUi();
+
+        assertThat(mDefaultLanguagePreference.isEnabled()).isTrue();
+        // Default language preference is always hidden
+        assertThat(mDefaultLanguagePreference.isVisible()).isFalse();
+        assertThat(mSpeechRatePreference.isEnabled()).isFalse();
+        assertThat(mVoicePitchPreference.isEnabled()).isFalse();
+        assertThat(mResetPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_initialized_defaultLocaleSupported_enablesPreference()
+            throws InterruptedException {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.mOnInitListener.onInit(TextToSpeech.SUCCESS);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        Intent data = new Intent();
+        data.putStringArrayListExtra(TextToSpeech.Engine.EXTRA_AVAILABLE_VOICES,
+                Lists.newArrayList(
+                        Locale.ENGLISH.toString(),
+                        Locale.CANADA.toString(),
+                        Locale.KOREA.toString()
+                ));
+        mPreferenceController.processActivityResult(
+                TtsPlaybackPreferenceController.VOICE_DATA_CHECK,
+                TextToSpeech.Engine.CHECK_VOICE_DATA_PASS, data);
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        mPreferenceController.refreshUi();
+        // Some fields are posted to the background handler.
+        // Wait to make sure all states have been finalized.
+        CountDownLatch latch = new CountDownLatch(1);
+        latch.await(5, TimeUnit.SECONDS);
+        mPreferenceController.mBackgroundHandler.post(latch::countDown);
+
+        assertThat(mPreferenceGroup.isEnabled()).isTrue();
+        assertThat(mDefaultLanguagePreference.isEnabled()).isTrue();
+        // Default language preference is always hidden
+        assertThat(mDefaultLanguagePreference.isVisible()).isFalse();
+        assertThat(mSpeechRatePreference.isEnabled()).isTrue();
+        assertThat(mVoicePitchPreference.isEnabled()).isTrue();
+        assertThat(mResetPreference.isEnabled()).isTrue();
+    }
+
+    private class TestTtsPlaybackPreferenceController extends TtsPlaybackPreferenceController {
+
+        TestTtsPlaybackPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions, TtsEngines enginesHelper) {
+            super(context, preferenceKey, fragmentController, uxRestrictions, enginesHelper);
+        }
+
+        @Override
+        TextToSpeech createTts() {
+            return mTextToSpeech;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/tts/TtsPlaybackSettingsManagerTest.java b/tests/multivalent/src/com/android/car/settings/tts/TtsPlaybackSettingsManagerTest.java
new file mode 100644
index 000000000..b40a31cfc
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/tts/TtsPlaybackSettingsManagerTest.java
@@ -0,0 +1,229 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.tts;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.AlertDialog;
+import android.content.Context;
+import android.provider.Settings;
+import android.speech.tts.TextToSpeech;
+import android.speech.tts.TtsEngines;
+import android.speech.tts.Voice;
+
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.Locale;
+
+@RunWith(AndroidJUnit4.class)
+public class TtsPlaybackSettingsManagerTest {
+    private static final String ENGINE_NAME = "com.android.car.settings.tts.test";
+    private static final String SAMPLE_TEXT = "Sample text";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private TtsPlaybackSettingsManager mPlaybackSettingsManager;
+
+    @Mock
+    private TextToSpeech mTts;
+    @Mock
+    private TtsEngines mEnginesHelper;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mPlaybackSettingsManager = new TtsPlaybackSettingsManager(mContext, mTts, mEnginesHelper);
+
+        when(mTts.getCurrentEngine()).thenReturn(ENGINE_NAME);
+        Settings.Secure.putInt(mContext.getContentResolver(), Settings.Secure.TTS_DEFAULT_RATE,
+                TextToSpeech.Engine.DEFAULT_RATE);
+        Settings.Secure.putInt(mContext.getContentResolver(), Settings.Secure.TTS_DEFAULT_PITCH,
+                TextToSpeech.Engine.DEFAULT_PITCH);
+    }
+
+    @Test
+    public void updateSpeechRate_updatesSetting() {
+        int newSpeechRate = TextToSpeech.Engine.DEFAULT_RATE + 40;
+        mPlaybackSettingsManager.updateSpeechRate(newSpeechRate);
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.TTS_DEFAULT_RATE, TextToSpeech.Engine.DEFAULT_RATE)).isEqualTo(
+                newSpeechRate);
+    }
+
+    @Test
+    public void updateSpeechRate_updatesTts() {
+        int newSpeechRate = TextToSpeech.Engine.DEFAULT_RATE + 40;
+        mPlaybackSettingsManager.updateSpeechRate(newSpeechRate);
+        verify(mTts).setSpeechRate(newSpeechRate / TtsPlaybackSettingsManager.SCALING_FACTOR);
+    }
+
+    @Test
+    public void getCurrentSpeechRate_returnsCorrectRate() {
+        int newSpeechRate = TextToSpeech.Engine.DEFAULT_RATE + 40;
+        mPlaybackSettingsManager.updateSpeechRate(newSpeechRate);
+
+        assertThat(mPlaybackSettingsManager.getCurrentSpeechRate()).isEqualTo(newSpeechRate);
+    }
+
+    @Test
+    public void resetSpeechRate_setsToDefault() {
+        int newSpeechRate = TextToSpeech.Engine.DEFAULT_RATE + 40;
+        mPlaybackSettingsManager.updateSpeechRate(newSpeechRate);
+
+        mPlaybackSettingsManager.resetSpeechRate();
+
+        assertThat(mPlaybackSettingsManager.getCurrentSpeechRate()).isEqualTo(
+                TextToSpeech.Engine.DEFAULT_RATE);
+    }
+
+    @Test
+    public void updateVoicePitch_updatesSetting() {
+        int newVoicePitch = TextToSpeech.Engine.DEFAULT_PITCH + 40;
+        mPlaybackSettingsManager.updateVoicePitch(newVoicePitch);
+        assertThat(Settings.Secure.getInt(mContext.getContentResolver(),
+                Settings.Secure.TTS_DEFAULT_PITCH, TextToSpeech.Engine.DEFAULT_PITCH)).isEqualTo(
+                newVoicePitch);
+    }
+
+    @Test
+    public void updateVoicePitch_updatesTts() {
+        int newVoicePitch = TextToSpeech.Engine.DEFAULT_PITCH + 40;
+        mPlaybackSettingsManager.updateVoicePitch(newVoicePitch);
+        verify(mTts).setPitch(newVoicePitch / TtsPlaybackSettingsManager.SCALING_FACTOR);
+    }
+
+    @Test
+    public void getCurrentVoicePitch_returnsCorrectRate() {
+        int newVoicePitch = TextToSpeech.Engine.DEFAULT_PITCH + 40;
+        mPlaybackSettingsManager.updateVoicePitch(newVoicePitch);
+
+        assertThat(mPlaybackSettingsManager.getCurrentVoicePitch()).isEqualTo(newVoicePitch);
+    }
+
+    @Test
+    public void resetVoicePitch_setsToDefault() {
+        int newVoicePitch = TextToSpeech.Engine.DEFAULT_PITCH + 40;
+        mPlaybackSettingsManager.updateVoicePitch(newVoicePitch);
+
+        mPlaybackSettingsManager.resetVoicePitch();
+
+        assertThat(mPlaybackSettingsManager.getCurrentVoicePitch()).isEqualTo(
+                TextToSpeech.Engine.DEFAULT_PITCH);
+    }
+
+    @Test
+    public void getStoredTtsLocale_localeIsNotDefaultForEngine_returnsLocale() {
+        when(mEnginesHelper.isLocaleSetToDefaultForEngine(ENGINE_NAME)).thenReturn(false);
+        when(mEnginesHelper.getLocalePrefForEngine(ENGINE_NAME)).thenReturn(Locale.CHINESE);
+
+        assertThat(mPlaybackSettingsManager.getStoredTtsLocale()).isEqualTo(Locale.CHINESE);
+    }
+
+    @Test
+    public void getStoredTtsLocale_localeIsDefaultForEngine_returnsNull() {
+        when(mEnginesHelper.isLocaleSetToDefaultForEngine(ENGINE_NAME)).thenReturn(true);
+
+        assertThat(mPlaybackSettingsManager.getStoredTtsLocale()).isNull();
+    }
+
+    @Test
+    public void updateTtsLocale_nonNullLocale_setsLanguage() {
+        mPlaybackSettingsManager.updateTtsLocale(Locale.KOREAN);
+
+        verify(mTts).setLanguage(Locale.KOREAN);
+    }
+
+    @Test
+    public void updateTtsLocale_nullLocale_setsDefaultLanguage() {
+        mPlaybackSettingsManager.updateTtsLocale(null);
+
+        verify(mTts).setLanguage(Locale.getDefault());
+    }
+
+    @Test
+    public void updateTtsLocale_nonNullLocale_correctResultCode_updatesLocalePref() {
+        when(mTts.setLanguage(Locale.KOREAN)).thenReturn(TextToSpeech.LANG_AVAILABLE);
+        mPlaybackSettingsManager.updateTtsLocale(Locale.KOREAN);
+
+        verify(mEnginesHelper).updateLocalePrefForEngine(ENGINE_NAME, Locale.KOREAN);
+    }
+
+    @Test
+    public void updateTtsLocale_nonNullLocale_wrongResultCode_doesNotUpdateLocalePref() {
+        when(mTts.setLanguage(Locale.KOREAN)).thenReturn(TextToSpeech.LANG_MISSING_DATA);
+        mPlaybackSettingsManager.updateTtsLocale(Locale.KOREAN);
+
+        verify(mEnginesHelper, never()).updateLocalePrefForEngine(any(), any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void speakSampleText_requiresNetworkConnection_languageNotAvailable_showsAlert() {
+        TtsPlaybackSettingsManager spiedManager = spy(mPlaybackSettingsManager);
+        AlertDialog alertDialog = mock(AlertDialog.class);
+        when(spiedManager.createNetworkAlertDialog()).thenReturn(alertDialog);
+
+        Voice voice = new Voice("Test Name", Locale.FRANCE, /* quality= */ 0,
+                /* latency= */ 0, /* requiresNetworkConnection= */ true, /* features= */ null);
+        when(mTts.getVoice()).thenReturn(voice);
+        when(mEnginesHelper.parseLocaleString(Locale.FRANCE.toString())).thenReturn(Locale.FRANCE);
+        when(mTts.isLanguageAvailable(any(Locale.class))).thenReturn(
+                TextToSpeech.LANG_MISSING_DATA);
+
+        spiedManager.speakSampleText(SAMPLE_TEXT);
+
+        verify(alertDialog).show();
+    }
+
+    @Test
+    public void speakSampleText_requiresNetworkConnection_languageAvailable_speaksText() {
+        Voice voice = new Voice("Test Name", Locale.FRENCH, /* quality= */ 0,
+                /* latency= */ 0, /* requiresNetworkConnection= */ true, /* features= */ null);
+        when(mTts.getVoice()).thenReturn(voice);
+        when(mTts.isLanguageAvailable(Locale.FRENCH)).thenReturn(TextToSpeech.LANG_AVAILABLE);
+
+        mPlaybackSettingsManager.speakSampleText(SAMPLE_TEXT);
+
+        verify(mTts).speak(SAMPLE_TEXT, TextToSpeech.QUEUE_FLUSH, null, "Sample");
+    }
+
+    @Test
+    public void speakSampleText_doesNotRequireNetworkConnection_speaksText() {
+        Voice voice = new Voice("Test Name", Locale.FRENCH, /* quality= */ 0,
+                /* latency= */ 0, /* requiresNetworkConnection= */ false, /* features= */ null);
+        when(mTts.getVoice()).thenReturn(voice);
+
+        mPlaybackSettingsManager.speakSampleText(SAMPLE_TEXT);
+
+        verify(mTts).speak(SAMPLE_TEXT, TextToSpeech.QUEUE_FLUSH, null, "Sample");
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsBasePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsBasePreferenceControllerTest.java
new file mode 100644
index 000000000..08839cdab
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsBasePreferenceControllerTest.java
@@ -0,0 +1,318 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsBasePreferenceControllerTest {
+
+    private static final int TEST_PROPERTY_ID = -1;
+    private static final Unit[] AVAILABLE_UNITS =
+            {UnitsMap.YEAR, UnitsMap.SECS, UnitsMap.NANO_SECS};
+    private static final Unit DEFAULT_UNIT = UnitsMap.YEAR;
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsBasePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        doNothing().when(mCarUnitsManager).registerCarServiceListener(any());
+        when(mCarUnitsManager.getUnitsSupportedByProperty(TEST_PROPERTY_ID))
+                .thenReturn(AVAILABLE_UNITS);
+        updateDefaultUnit(DEFAULT_UNIT);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsBasePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCreate_registersCarServiceListener() {
+        verify(mCarUnitsManager)
+                .registerCarServiceListener(mPreferenceController.mOnCarServiceListener);
+    }
+
+    @Test
+    public void onCreate_preferenceIsConditionallyUnavailable() {
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCreate_preferenceIsConditionallyUnavailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCreate_preferenceIsConditionallyUnavailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCreate_preferenceIsConditionallyUnavailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_availableUnitsExist_preferenceIsAvailable() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_availableUnitsExist_preferenceIsAvailable_zoneWrite() {
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_availableUnitsExist_preferenceIsAvailable_zoneRead() {
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onCarServiceConnected_availableUnitsExist_preferenceIsAvailable_zoneHidden() {
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_noAvailableUnits_preferenceIsConditionallyUnavailable() {
+        when(mCarUnitsManager.getUnitsSupportedByProperty(TEST_PROPERTY_ID))
+                .thenReturn(null);
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        assertThat(mPreferenceController.getAvailabilityStatus())
+                .isEqualTo(PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_preferenceIsConditionallyUnavailable_zoneWrite() {
+        when(mCarUnitsManager.getUnitsSupportedByProperty(TEST_PROPERTY_ID))
+                .thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_preferenceIsConditionallyUnavailable_zoneRead() {
+        when(mCarUnitsManager.getUnitsSupportedByProperty(TEST_PROPERTY_ID))
+                .thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_preferenceIsConditionallyUnavailable_zoneHidden() {
+        when(mCarUnitsManager.getUnitsSupportedByProperty(TEST_PROPERTY_ID))
+                .thenReturn(null);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(),
+                PreferenceController.CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsEntriesOfSupportedUnits() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntries = mPreferenceController.getEntriesOfSupportedUnits();
+
+        assertThat(mPreference.getEntries()).isEqualTo(expectedEntries);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsSupportedUnitsIdsAsEntryValues() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntryValues = mPreferenceController.getIdsOfSupportedUnits();
+
+        assertThat(mPreference.getEntryValues()).isEqualTo(expectedEntryValues);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsUnitBeingUsedAsPreferenceValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        String expectedValue = Integer.toString(DEFAULT_UNIT.getId());
+
+        assertThat(mPreference.getValue()).isEqualTo(expectedValue);
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(UnitsMap.SECS.getId()));
+
+        assertThat(mCarUnitsManager.getUnitUsedByProperty(TEST_PROPERTY_ID))
+                .isEqualTo(UnitsMap.SECS);
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = UnitsMap.SECS;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitAbbreviationAsSummary() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = UnitsMap.SECS;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getSummary())
+                .isEqualTo(mContext.getString(newUnit.getAbbreviationResId()));
+    }
+
+    @Test
+    public void onDestroy_disconnectsCarUnitsManager() {
+        mPreferenceController.onDestroy(mLifecycleOwner);
+
+        verify(mCarUnitsManager).disconnect();
+    }
+
+    @Test
+    public void onDestroy_unregistersCarServiceListener() {
+        mPreferenceController.onDestroy(mLifecycleOwner);
+
+        verify(mCarUnitsManager).unregisterCarServiceListener();
+    }
+
+    private void updateDefaultUnit(Unit unit) {
+        when(mCarUnitsManager.getUnitUsedByProperty(TEST_PROPERTY_ID))
+                .thenReturn(unit);
+    }
+
+    private class TestUnitsBasePreferenceController extends UnitsBasePreferenceController {
+
+        private TestUnitsBasePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected int getPropertyId() {
+            return TEST_PROPERTY_ID;
+        }
+
+
+        @Override
+        protected Class<ListPreference> getPreferenceType() {
+            return ListPreference.class;
+        }
+
+        @Override
+        public boolean handlePreferenceChanged(ListPreference preference, Object newValue) {
+            int unitId = Integer.parseInt((String) newValue);
+            Unit newUnit = UnitsMap.MAP.get(unitId);
+            if (newUnit != null) {
+                updateDefaultUnit(newUnit);
+            }
+            return super.handlePreferenceChanged(preference, newValue);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsDistancePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsDistancePreferenceControllerTest.java
new file mode 100644
index 000000000..6df56998d
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsDistancePreferenceControllerTest.java
@@ -0,0 +1,133 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.VehiclePropertyIds;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsDistancePreferenceControllerTest {
+    private static final Unit[] AVAILABLE_UNITS = {UnitsMap.MILE, UnitsMap.KILOMETER};
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsDistancePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArgumentCaptor<Integer> mCaptor = ArgumentCaptor.forClass(Integer.class);
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mCarUnitsManager.getUnitsSupportedByProperty(mCaptor.capture()))
+                .thenReturn(AVAILABLE_UNITS);
+        when(mCarUnitsManager.getUnitUsedByProperty(anyInt())).thenReturn(null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsDistancePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsPreferenceEntriesAndValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntries = mPreferenceController.getEntriesOfSupportedUnits();
+
+        assertThat(mCaptor.getValue()).isEqualTo(VehiclePropertyIds.DISTANCE_DISPLAY_UNITS);
+        assertThat(mPreference.getEntries()).isEqualTo(expectedEntries);
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(AVAILABLE_UNITS[0].getId()));
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        Unit newUnit = AVAILABLE_UNITS[1];
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(newUnit.getId()));
+
+        verify(mCarUnitsManager).setUnitUsedByProperty(VehiclePropertyIds.DISTANCE_DISPLAY_UNITS,
+                newUnit.getId());
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = AVAILABLE_UNITS[1];;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+        assertThat(mPreference.getSummary().toString())
+                .isEqualTo(mContext.getString(newUnit.getAbbreviationResId()));
+    }
+
+    private class TestUnitsDistancePreferenceController extends
+            UnitsDistancePreferenceController {
+
+        public TestUnitsDistancePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsEnergyConsumptionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsEnergyConsumptionPreferenceControllerTest.java
new file mode 100644
index 000000000..152b2f850
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsEnergyConsumptionPreferenceControllerTest.java
@@ -0,0 +1,138 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.VehiclePropertyIds;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsEnergyConsumptionPreferenceControllerTest {
+    private static final Unit[] AVAILABLE_UNITS =
+            {UnitsMap.KILOWATT_HOUR, UnitsMap.WATT_HOUR};
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsEnergyConsumptionPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArgumentCaptor<Integer> mCaptor = ArgumentCaptor.forClass(Integer.class);
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mCarUnitsManager.getUnitsSupportedByProperty(mCaptor.capture()))
+                .thenReturn(AVAILABLE_UNITS);
+        when(mCarUnitsManager.getUnitUsedByProperty(anyInt())).thenReturn(null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsEnergyConsumptionPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsPreferenceEntriesAndValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntries = mPreferenceController.getEntriesOfSupportedUnits();
+
+        assertThat(mCaptor.getValue()).isEqualTo(VehiclePropertyIds.EV_BATTERY_DISPLAY_UNITS);
+        assertThat(mPreference.getEntries()[0].toString()).isEqualTo(
+                mPreferenceController.generateEntryStringFromUnit(AVAILABLE_UNITS[0]));
+        assertThat(mPreference.getEntries()[1].toString()).isEqualTo(
+                mPreferenceController.generateEntryStringFromUnit(AVAILABLE_UNITS[1]));
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(AVAILABLE_UNITS[0].getId()));
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        Unit newUnit = AVAILABLE_UNITS[1];
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(newUnit.getId()));
+
+        verify(mCarUnitsManager).setUnitUsedByProperty(
+                VehiclePropertyIds.EV_BATTERY_DISPLAY_UNITS,
+                newUnit.getId());
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = AVAILABLE_UNITS[1];;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+        assertThat(mPreference.getSummary().toString()).isEqualTo(
+                mPreferenceController.generateSummaryFromUnit(newUnit));
+    }
+
+    private class TestUnitsEnergyConsumptionPreferenceController extends
+            UnitsEnergyConsumptionPreferenceController {
+
+        public TestUnitsEnergyConsumptionPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsFuelConsumptionPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsFuelConsumptionPreferenceControllerTest.java
new file mode 100644
index 000000000..9256c30f3
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsFuelConsumptionPreferenceControllerTest.java
@@ -0,0 +1,138 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.VehiclePropertyIds;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsFuelConsumptionPreferenceControllerTest {
+    private static final Unit[] AVAILABLE_UNITS =
+            {UnitsMap.US_GALLON, UnitsMap.IMPERIAL_GALLON};
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsFuelConsumptionPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArgumentCaptor<Integer> mCaptor = ArgumentCaptor.forClass(Integer.class);
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mCarUnitsManager.getUnitsSupportedByProperty(mCaptor.capture()))
+                .thenReturn(AVAILABLE_UNITS);
+        when(mCarUnitsManager.getUnitUsedByProperty(anyInt())).thenReturn(null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsFuelConsumptionPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsPreferenceEntriesAndValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+
+        assertThat(mCaptor.getValue()).isEqualTo(VehiclePropertyIds.FUEL_VOLUME_DISPLAY_UNITS);
+        assertThat(mPreference.getEntries()[0].toString()).isEqualTo(
+                mPreferenceController.generateEntryStringFromUnit(AVAILABLE_UNITS[0]));
+        assertThat(mPreference.getEntries()[1].toString()).isEqualTo(
+                mPreferenceController.generateEntryStringFromUnit(AVAILABLE_UNITS[1]));
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(AVAILABLE_UNITS[0].getId()));
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        Unit newUnit = AVAILABLE_UNITS[1];
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(newUnit.getId()));
+
+        verify(mCarUnitsManager).setUnitUsedByProperty(
+                VehiclePropertyIds.FUEL_VOLUME_DISPLAY_UNITS,
+                newUnit.getId());
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = AVAILABLE_UNITS[1];;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+        assertThat(mPreference.getSummary().toString()).isEqualTo(
+                mPreferenceController.generateSummaryFromUnit(newUnit)
+        );
+    }
+
+    private class TestUnitsFuelConsumptionPreferenceController extends
+            UnitsFuelConsumptionPreferenceController {
+
+        public TestUnitsFuelConsumptionPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsPressurePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsPressurePreferenceControllerTest.java
new file mode 100644
index 000000000..b44af36cd
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsPressurePreferenceControllerTest.java
@@ -0,0 +1,135 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.VehiclePropertyIds;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsPressurePreferenceControllerTest {
+    private static final Unit[] AVAILABLE_UNITS =
+            {UnitsMap.PSI, UnitsMap.BAR};
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsPressurePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArgumentCaptor<Integer> mCaptor = ArgumentCaptor.forClass(Integer.class);
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mCarUnitsManager.getUnitsSupportedByProperty(mCaptor.capture()))
+                .thenReturn(AVAILABLE_UNITS);
+        when(mCarUnitsManager.getUnitUsedByProperty(anyInt())).thenReturn(null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsPressurePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsPreferenceEntriesAndValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntries = mPreferenceController.getEntriesOfSupportedUnits();
+
+        assertThat(mCaptor.getValue()).isEqualTo(VehiclePropertyIds.TIRE_PRESSURE_DISPLAY_UNITS);
+        assertThat(mPreference.getEntries()).isEqualTo(expectedEntries);
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(AVAILABLE_UNITS[0].getId()));
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        Unit newUnit = AVAILABLE_UNITS[1];
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(newUnit.getId()));
+
+        verify(mCarUnitsManager).setUnitUsedByProperty(
+                VehiclePropertyIds.TIRE_PRESSURE_DISPLAY_UNITS,
+                newUnit.getId());
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = AVAILABLE_UNITS[1];;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+        assertThat(mPreference.getSummary().toString())
+                .isEqualTo(mContext.getString(newUnit.getAbbreviationResId()));
+    }
+
+    private class TestUnitsPressurePreferenceController extends
+            UnitsPressurePreferenceController {
+
+        public TestUnitsPressurePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsSpeedPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsSpeedPreferenceControllerTest.java
new file mode 100644
index 000000000..9c6de355e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsSpeedPreferenceControllerTest.java
@@ -0,0 +1,135 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.VehiclePropertyIds;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsSpeedPreferenceControllerTest {
+    private static final Unit[] AVAILABLE_UNITS =
+            {UnitsMap.MILES_PER_HOUR, UnitsMap.KILOMETERS_PER_HOUR};
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsSpeedPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArgumentCaptor<Integer> mCaptor = ArgumentCaptor.forClass(Integer.class);
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mCarUnitsManager.getUnitsSupportedByProperty(mCaptor.capture()))
+                .thenReturn(AVAILABLE_UNITS);
+        when(mCarUnitsManager.getUnitUsedByProperty(anyInt())).thenReturn(null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsSpeedPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsPreferenceEntriesAndValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntries = mPreferenceController.getEntriesOfSupportedUnits();
+
+        assertThat(mCaptor.getValue()).isEqualTo(VehiclePropertyIds.VEHICLE_SPEED_DISPLAY_UNITS);
+        assertThat(mPreference.getEntries()).isEqualTo(expectedEntries);
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(AVAILABLE_UNITS[0].getId()));
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        Unit newUnit = AVAILABLE_UNITS[1];
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(newUnit.getId()));
+
+        verify(mCarUnitsManager).setUnitUsedByProperty(
+            VehiclePropertyIds.VEHICLE_SPEED_DISPLAY_UNITS,
+            newUnit.getId());
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = AVAILABLE_UNITS[1];;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+        assertThat(mPreference.getSummary().toString())
+                .isEqualTo(mContext.getString(newUnit.getAbbreviationResId()));
+    }
+
+    private class TestUnitsSpeedPreferenceController extends
+            UnitsSpeedPreferenceController {
+
+        public TestUnitsSpeedPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsTemperaturePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsTemperaturePreferenceControllerTest.java
new file mode 100644
index 000000000..a0f99efba
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsTemperaturePreferenceControllerTest.java
@@ -0,0 +1,134 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.VehiclePropertyIds;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsTemperaturePreferenceControllerTest {
+    private static final Unit[] AVAILABLE_UNITS = {UnitsMap.CELSIUS, UnitsMap.FAHRENHEIT};
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsTemperaturePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArgumentCaptor<Integer> mCaptor = ArgumentCaptor.forClass(Integer.class);
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mCarUnitsManager.getUnitsSupportedByProperty(mCaptor.capture()))
+                .thenReturn(AVAILABLE_UNITS);
+        when(mCarUnitsManager.getUnitUsedByProperty(anyInt())).thenReturn(null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsTemperaturePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsPreferenceEntriesAndValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntries = mPreferenceController.getEntriesOfSupportedUnits();
+
+        assertThat(mCaptor.getValue()).isEqualTo(VehiclePropertyIds.HVAC_TEMPERATURE_DISPLAY_UNITS);
+        assertThat(mPreference.getEntries()).isEqualTo(expectedEntries);
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(AVAILABLE_UNITS[0].getId()));
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        Unit newUnit = AVAILABLE_UNITS[1];
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(newUnit.getId()));
+
+        verify(mCarUnitsManager).setUnitUsedByProperty(
+            VehiclePropertyIds.HVAC_TEMPERATURE_DISPLAY_UNITS,
+            newUnit.getId());
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = AVAILABLE_UNITS[1];;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+        assertThat(mPreference.getSummary().toString())
+                .isEqualTo(mContext.getString(newUnit.getAbbreviationResId()));
+    }
+
+    private class TestUnitsTemperaturePreferenceController extends
+            UnitsTemperaturePreferenceController {
+
+        public TestUnitsTemperaturePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/units/UnitsVolumePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/units/UnitsVolumePreferenceControllerTest.java
new file mode 100644
index 000000000..a888d3799
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/units/UnitsVolumePreferenceControllerTest.java
@@ -0,0 +1,133 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.units;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.VehiclePropertyIds;
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.hardware.CarPropertyValue;
+import android.car.hardware.property.CarPropertyManager;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class UnitsVolumePreferenceControllerTest {
+    private static final Unit[] AVAILABLE_UNITS = {UnitsMap.LITER, UnitsMap.US_GALLON};
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mPreference;
+    private UnitsVolumePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private ArgumentCaptor<Integer> mCaptor = ArgumentCaptor.forClass(Integer.class);
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarUnitsManager mCarUnitsManager;
+    @Mock
+    private CarPropertyManager mCarPropertyManager;
+    @Mock
+    private CarPropertyValue mCarPropertyValue;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mCarUnitsManager.getUnitsSupportedByProperty(mCaptor.capture()))
+                .thenReturn(AVAILABLE_UNITS);
+        when(mCarUnitsManager.getUnitUsedByProperty(anyInt())).thenReturn(null);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new ListPreference(mContext);
+        mPreferenceController = new TestUnitsVolumePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void onCarServiceConnected_setsPreferenceEntriesAndValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        CharSequence[] expectedEntries = mPreferenceController.getEntriesOfSupportedUnits();
+
+        assertThat(mCaptor.getValue()).isEqualTo(VehiclePropertyIds.FUEL_VOLUME_DISPLAY_UNITS);
+        assertThat(mPreference.getEntries()).isEqualTo(expectedEntries);
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(AVAILABLE_UNITS[0].getId()));
+    }
+
+    @Test
+    public void onPreferenceChanged_runsSetUnitUsedByPropertyWithNewUnit() {
+        Unit newUnit = AVAILABLE_UNITS[1];
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(newUnit.getId()));
+
+        verify(mCarUnitsManager).setUnitUsedByProperty(VehiclePropertyIds.FUEL_VOLUME_DISPLAY_UNITS,
+                newUnit.getId());
+    }
+
+    @Test
+    public void onPropertyChanged_propertyStatusIsAvailable_setsNewUnitIdAsValue() {
+        mPreferenceController.mOnCarServiceListener.handleServiceConnected(mCarPropertyManager);
+        Unit newUnit = AVAILABLE_UNITS[1];;
+        when(mCarPropertyValue.getStatus()).thenReturn(CarPropertyValue.STATUS_AVAILABLE);
+        when(mCarPropertyValue.getValue()).thenReturn(newUnit.getId());
+        mPreferenceController.mCarPropertyEventCallback.onChangeEvent(mCarPropertyValue);
+
+        assertThat(mPreference.getValue()).isEqualTo(Integer.toString(newUnit.getId()));
+        assertThat(mPreference.getSummary().toString())
+                .isEqualTo(mContext.getString(newUnit.getAbbreviationResId()));
+    }
+
+    private class TestUnitsVolumePreferenceController extends
+            UnitsVolumePreferenceController {
+
+        public TestUnitsVolumePreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        CarUnitsManager createCarUnitsManager() {
+            return mCarUnitsManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/AddWifiFragmentTest.java b/tests/multivalent/src/com/android/car/settings/wifi/AddWifiFragmentTest.java
new file mode 100644
index 000000000..64eb2e343
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/AddWifiFragmentTest.java
@@ -0,0 +1,180 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.withSettings;
+
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.localbroadcastmanager.content.LocalBroadcastManager;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AddWifiFragmentTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private AddWifiFragment mFragment;
+    private BaseCarSettingsTestActivity mActivity;
+    private FragmentManager mFragmentManager;
+    private MockitoSession mSession;
+
+    @Mock
+    private LocalBroadcastManager mMockLocalBroadcastManager;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        MockitoAnnotations.initMocks(this);
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        setUpFragment();
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                LocalBroadcastManager.class, withSettings().lenient()).startMocking();
+        ExtendedMockito.when(LocalBroadcastManager.getInstance(any())).thenReturn(
+                mMockLocalBroadcastManager);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void onCreate_registersReceivers() {
+        mFragment.onCreate(null);
+        ArgumentCaptor<IntentFilter> argumentCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+        verify(mMockLocalBroadcastManager, times(2))
+                .registerReceiver(any(), argumentCaptor.capture());
+
+        List<IntentFilter> capturedIntentFilters = argumentCaptor.getAllValues();
+        assertThat(capturedIntentFilters.get(0).hasAction(
+                NetworkNamePreferenceController.ACTION_NAME_CHANGE)).isTrue();
+        assertThat(capturedIntentFilters.get(1).hasAction(
+                NetworkSecurityPreferenceController.ACTION_SECURITY_CHANGE)).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onDestroy_unregistersReceivers() {
+        mFragment.onCreate(null);
+        Mockito.reset(mMockLocalBroadcastManager);
+        mFragment.onDestroy();
+
+        verify(mMockLocalBroadcastManager, times(2))
+                .unregisterReceiver(any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void initialState_buttonDisabled() {
+        mFragment.onCreate(null);
+        mFragment.onStart();
+        assertThat(mFragment.getToolbarMenuItems().get(0).isEnabled()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void receiveNameChangeIntent_emptyName_buttonDisabled() {
+        mFragment.onCreate(null);
+        mFragment.onStart();
+
+        Intent intent = new Intent(NetworkNamePreferenceController.ACTION_NAME_CHANGE);
+        intent.putExtra(NetworkNamePreferenceController.KEY_NETWORK_NAME, "");
+        mFragment.mNameChangeReceiver.onReceive(mContext, intent);
+
+        assertThat(mFragment.getToolbarMenuItems().get(0).isEnabled()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void receiveNameChangeIntent_name_buttonEnabled() {
+        mFragment.onCreate(null);
+        mFragment.onStart();
+
+        Intent intent = new Intent(NetworkNamePreferenceController.ACTION_NAME_CHANGE);
+        intent.putExtra(NetworkNamePreferenceController.KEY_NETWORK_NAME, "test_network_name");
+        mFragment.mNameChangeReceiver.onReceive(mContext, intent);
+
+        assertThat(mFragment.getToolbarMenuItems().get(0).isEnabled()).isTrue();
+    }
+
+    @Test
+    @UiThreadTest
+    public void receiveSecurityChangeIntent_nameSet_buttonDisabled() {
+        mFragment.onCreate(null);
+        mFragment.onStart();
+        Intent nameIntent = new Intent(NetworkNamePreferenceController.ACTION_NAME_CHANGE);
+        nameIntent.putExtra(NetworkNamePreferenceController.KEY_NETWORK_NAME, "test_network_name");
+        mFragment.mNameChangeReceiver.onReceive(mContext, nameIntent);
+
+        Intent securityIntent = new Intent(
+                NetworkSecurityPreferenceController.ACTION_SECURITY_CHANGE);
+        securityIntent.putExtra(NetworkSecurityPreferenceController.KEY_SECURITY_TYPE,
+                WifiEntry.SECURITY_PSK);
+        mFragment.mSecurityChangeReceiver.onReceive(mContext, securityIntent);
+
+        assertThat(mFragment.getToolbarMenuItems().get(0).isEnabled()).isFalse();
+    }
+
+    private void setUpFragment() throws Throwable {
+        String addWifiFragmentTag = "add_wifi_fragment";
+        mActivityTestRule.runOnUiThread(() -> {
+            mFragmentManager.beginTransaction()
+                    .replace(R.id.fragment_container, new AddWifiFragment(), addWifiFragmentTag)
+                    .commitNow();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (AddWifiFragment) mFragmentManager.findFragmentByTag(addWifiFragmentTag);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/AddWifiPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/AddWifiPreferenceControllerTest.java
new file mode 100644
index 000000000..65ab36b09
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/AddWifiPreferenceControllerTest.java
@@ -0,0 +1,297 @@
+/*
+ * Copyright (C) 2022 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static android.os.UserManager.DISALLOW_ADD_WIFI_CONFIG;
+import static android.os.UserManager.DISALLOW_WIFI_TETHERING;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.testutils.EnterpriseTestUtils.mockUserRestrictionSetByDpm;
+import static com.android.car.settings.testutils.EnterpriseTestUtils.mockUserRestrictionSetByUm;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.test.AbstractExpectableTestCase;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.net.wifi.WifiManager;
+import android.os.UserManager;
+import android.util.Log;
+
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+import java.util.Arrays;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class AddWifiPreferenceControllerTest extends AbstractExpectableTestCase {
+
+    private static final String TAG = AddWifiPreferenceControllerTest.class.getSimpleName();
+
+    private static final List<Integer> VISIBLE_STATES = Arrays.asList(
+            WifiManager.WIFI_STATE_ENABLED,
+            WifiManager.WIFI_STATE_DISABLING,
+            WifiManager.WIFI_STATE_ENABLING,
+            WifiManager.WIFI_STATE_UNKNOWN);
+    private static final List<Integer> INVISIBLE_STATES = Arrays.asList(
+            WifiManager.WIFI_STATE_DISABLED);
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+
+    @Mock
+    private FragmentController mMockFragmentController;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private UserManager mMockUserManager;
+
+    private Context mContext;
+    private CarUxRestrictions mCarUxRestrictions;
+    private Preference mPreference;
+    private AddWifiPreferenceController mController;
+
+    @Before
+    public void setUp() {
+        mContext = spy(ApplicationProvider.getApplicationContext());
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new Preference(mContext);
+        mController = new AddWifiPreferenceController(mContext,
+                /* preferenceKey= */ "key", mMockFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+
+        // WIFI is enabled by default.
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiFeatureDisabled() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiFeatureDisabled_zoneWrite() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiFeatureDisabled_zoneRead() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiFeatureDisabled_zoneHidden() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByUm() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByUm_zoneWrite() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByUm_zoneRead() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByUm_zoneHidden() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByDpm() {
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByDpm_zoneWrite() {
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByDpm_zoneRead() {
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_restrictionByDpm_zoneHidden() {
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_ADD_WIFI_CONFIG, true);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentRestriction() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentRestriction_zoneWrite() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentRestriction_zoneRead() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_differentRestriction_zoneHidden() {
+        mockUserRestrictionSetByUm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_WIFI_TETHERING, true);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noRestrictions() {
+        // UserManager#hasRestriction() returns false by default. No need to mock.
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noRestrictions_zoneWrite() {
+        // UserManager#hasRestriction() returns false by default. No need to mock.
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noRestrictions_zoneRead() {
+        // UserManager#hasRestriction() returns false by default. No need to mock.
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_noRestrictions_zoneHidden() {
+        // UserManager#hasRestriction() returns false by default. No need to mock.
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onWifiStateChanged_invisible() {
+        for (int state : INVISIBLE_STATES) {
+            Log.d(TAG, "Calling onWifiStateChanged(" + state + ")");
+            mController.onWifiStateChanged(state);
+
+            expectThat(mPreference.isVisible()).isEqualTo(false);
+        }
+    }
+
+    @Test
+    public void onWifiStateChanged_visible() {
+        for (int state : VISIBLE_STATES) {
+            Log.d(TAG, "Calling onWifiStateChanged(" + state + ")");
+            mController.onWifiStateChanged(state);
+
+            expectThat(mPreference.isVisible()).isEqualTo(true);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/LimitedWifiEntryListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/LimitedWifiEntryListPreferenceControllerTest.java
new file mode 100644
index 000000000..9b4fe4a42
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/LimitedWifiEntryListPreferenceControllerTest.java
@@ -0,0 +1,171 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class LimitedWifiEntryListPreferenceControllerTest {
+    private static final int SIGNAL_LEVEL = 1;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private LimitedWifiEntryListPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private Lifecycle mMockLifecycle;
+    @Mock
+    private CarWifiManager mMockCarWifiManager;
+    @Mock
+    private WifiEntry mMockWifiEntry1;
+    @Mock
+    private WifiEntry mMockWifiEntry2;
+    @Mock
+    private WifiEntry mMockWifiEntry3;
+    @Mock
+    private WifiEntry mMockWifiEntry4;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mContext);
+        screen.addPreference(mPreferenceGroup);
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+        mPreferenceController = new TestLimitedWifiEntryListPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_NONE);
+        when(mMockWifiEntry1.getLevel()).thenReturn(SIGNAL_LEVEL);
+        when(mMockWifiEntry2.getSecurity()).thenReturn(WifiEntry.SECURITY_NONE);
+        when(mMockWifiEntry2.getLevel()).thenReturn(SIGNAL_LEVEL);
+        when(mMockWifiEntry3.getSecurity()).thenReturn(WifiEntry.SECURITY_NONE);
+        when(mMockWifiEntry3.getLevel()).thenReturn(SIGNAL_LEVEL);
+        when(mMockWifiEntry4.getSecurity()).thenReturn(WifiEntry.SECURITY_NONE);
+        when(mMockWifiEntry4.getLevel()).thenReturn(SIGNAL_LEVEL);
+    }
+
+    @Test
+    public void connected_oneSavedNetworks_twoWifiEntries() {
+        List<WifiEntry> wifiEntryList = new ArrayList<>(Arrays.asList(mMockWifiEntry1));
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        when(mMockCarWifiManager.getConnectedWifiEntries())
+                .thenReturn(Collections.singletonList(mMockWifiEntry1));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(2);
+    }
+
+    @Test
+    public void notConnected_oneSavedNetworks_oneWifiEntry() {
+        List<WifiEntry> wifiEntryList = Collections.singletonList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        when(mMockCarWifiManager.getConnectedWifiEntries()).thenReturn(Collections.emptyList());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(1);
+    }
+
+    @Test
+    public void connected_moreThanTwoSavedNetworks_maxWifiEntries() {
+        int maxWifiEntryCount = mContext.getResources().getInteger(
+                R.integer.limited_wifi_entry_list_count);
+        List<WifiEntry> wifiEntryList = new ArrayList<>(
+                Arrays.asList(mMockWifiEntry1, mMockWifiEntry2, mMockWifiEntry3));
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        when(mMockCarWifiManager.getConnectedWifiEntries())
+                .thenReturn(Collections.singletonList(mMockWifiEntry1));
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(maxWifiEntryCount);
+    }
+
+    @Test
+    public void notConnected_moreThanThreeSavedNetworks_maxWifiEntries() {
+        int maxWifiEntryCount = mContext.getResources().getInteger(
+                R.integer.limited_wifi_entry_list_count);
+        List<WifiEntry> wifiEntryList = new ArrayList<>(
+                Arrays.asList(mMockWifiEntry1, mMockWifiEntry2, mMockWifiEntry3, mMockWifiEntry4));
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        when(mMockCarWifiManager.getConnectedWifiEntries()).thenReturn(Collections.emptyList());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(maxWifiEntryCount);
+    }
+
+    private class TestLimitedWifiEntryListPreferenceController
+            extends LimitedWifiEntryListPreferenceController {
+
+        TestLimitedWifiEntryListPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected CarWifiManager getCarWifiManager() {
+            return mMockCarWifiManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/NetworkNameRestrictedPasswordEditTextPreferenceTest.java b/tests/multivalent/src/com/android/car/settings/wifi/NetworkNameRestrictedPasswordEditTextPreferenceTest.java
new file mode 100644
index 000000000..253bf80c0
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/NetworkNameRestrictedPasswordEditTextPreferenceTest.java
@@ -0,0 +1,113 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.content.Context;
+import android.widget.Toast;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.preference.PreferenceManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.SettingsFragment;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class NetworkNameRestrictedPasswordEditTextPreferenceTest {
+    private static final String KEY = "test_key";
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private FragmentManager mFragmentManager;
+    private NetworkNameRestrictedPasswordEditTextPreference mPreference;
+    private MockitoSession mSession;
+
+    // Using single pane to inherit initial fragment.
+    @Rule
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
+
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+
+        mSession = ExtendedMockito.mockitoSession()
+                .mockStatic(Toast.class, withSettings().lenient())
+                .startMocking();
+        when(Toast.makeText(any(), anyInt(), anyInt())).thenReturn(mMockToast);
+
+        SettingsFragment fragment = (SettingsFragment) mFragmentManager.findFragmentById(
+                R.id.fragment_container);
+
+        mPreference = new NetworkNameRestrictedPasswordEditTextPreference(mContext);
+        mPreference.setKey(KEY);
+        fragment.getPreferenceScreen().addPreference(mPreference);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void performClick_noName_toastShown() {
+        mPreference.performClick();
+
+        ExtendedMockito.verify(
+                () -> Toast.makeText(any(),
+                        eq(R.string.wifi_no_network_name),
+                        anyInt()));
+        verify(mMockToast).show();
+    }
+
+    @Test
+    public void performClick_hasName_showsDialog() {
+        ExtendedMockito.spyOn(mPreference);
+        PreferenceManager preferenceManager = mock(PreferenceManager.class);
+        when(mPreference.getPreferenceManager()).thenReturn(preferenceManager);
+        mPreference.setNetworkName("test_name");
+        mPreference.performClick();
+
+        verify(preferenceManager).showDialog(mPreference);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/NetworkPasswordPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/NetworkPasswordPreferenceControllerTest.java
new file mode 100644
index 000000000..c6dda8b97
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/NetworkPasswordPreferenceControllerTest.java
@@ -0,0 +1,204 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+import android.content.IntentFilter;
+import android.net.wifi.WifiConfiguration;
+import android.net.wifi.WifiManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.localbroadcastmanager.content.LocalBroadcastManager;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class NetworkPasswordPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private NetworkNameRestrictedPasswordEditTextPreference mPreference;
+    private NetworkPasswordPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private LocalBroadcastManager mMockLocalBroadcastManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new NetworkNameRestrictedPasswordEditTextPreference(mContext);
+        mPreferenceController = new NetworkPasswordPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                LocalBroadcastManager.class, withSettings().lenient()).startMocking();
+        when(LocalBroadcastManager.getInstance(any())).thenReturn(
+                mMockLocalBroadcastManager);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void onCreate_registersReceivers() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        ArgumentCaptor<IntentFilter> argumentCaptor = ArgumentCaptor.forClass(
+                IntentFilter.class);
+        verify(mMockLocalBroadcastManager, times(2))
+                .registerReceiver(any(), argumentCaptor.capture());
+
+        List<IntentFilter> capturedIntentFilters = argumentCaptor.getAllValues();
+        assertThat(capturedIntentFilters.get(0).hasAction(
+                NetworkNamePreferenceController.ACTION_NAME_CHANGE)).isTrue();
+        assertThat(capturedIntentFilters.get(1).hasAction(
+                NetworkSecurityPreferenceController.ACTION_SECURITY_CHANGE)).isTrue();
+    }
+
+    @Test
+    public void onDestroy_unregistersReceivers() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        Mockito.reset(mMockLocalBroadcastManager);
+        mPreferenceController.onDestroy(mLifecycleOwner);
+
+        verify(mMockLocalBroadcastManager, times(2))
+                .unregisterReceiver(any());
+    }
+
+    @Test
+    public void receiveNameChangeIntent_emptyName_dialogNameRemoved() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        Intent intent = new Intent(NetworkNamePreferenceController.ACTION_NAME_CHANGE);
+        intent.putExtra(NetworkNamePreferenceController.KEY_NETWORK_NAME, "");
+
+        mPreferenceController.mNameChangeReceiver.onReceive(mContext, intent);
+
+        assertThat(mPreference.getDialogTitle().toString()).isEqualTo(
+                ResourceTestUtils.getString(mContext, "wifi_password"));
+    }
+
+    @Test
+    public void receiveNameChangeIntent_name_dialogNameSet() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        String networkName = "test_network_name";
+        Intent intent = new Intent(NetworkNamePreferenceController.ACTION_NAME_CHANGE);
+        intent.putExtra(NetworkNamePreferenceController.KEY_NETWORK_NAME, networkName);
+
+        mPreferenceController.mNameChangeReceiver.onReceive(mContext, intent);
+
+        assertThat(mPreference.getDialogTitle().toString()).isEqualTo(networkName);
+    }
+
+    @Test
+    public void receiveSecurityChangeIntent_setUnsecureType_preferenceHidden() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        Intent intent = new Intent(NetworkSecurityPreferenceController.ACTION_SECURITY_CHANGE);
+        intent.putExtra(NetworkSecurityPreferenceController.KEY_SECURITY_TYPE,
+                WifiEntry.SECURITY_NONE);
+
+        mPreferenceController.mSecurityChangeReceiver.onReceive(mContext, intent);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    @Test
+    public void receiveSecurityChangeIntent_setSecureType_preferenceVisible() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        Intent intent = new Intent(NetworkSecurityPreferenceController.ACTION_SECURITY_CHANGE);
+        intent.putExtra(NetworkSecurityPreferenceController.KEY_SECURITY_TYPE,
+                WifiEntry.SECURITY_PSK);
+
+        mPreferenceController.mSecurityChangeReceiver.onReceive(mContext, intent);
+
+        assertThat(mPreference.isVisible()).isTrue();
+    }
+
+    @Test
+    public void handlePreferenceChanged_hasSecurity_networkNameSet_wifiConnected() {
+        WifiManager mockWifiManager = mock(WifiManager.class);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mockWifiManager);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        String networkName = "network_name";
+        String password = "password";
+        Intent intent = new Intent(NetworkSecurityPreferenceController.ACTION_SECURITY_CHANGE);
+        intent.putExtra(NetworkSecurityPreferenceController.KEY_SECURITY_TYPE,
+                WifiEntry.SECURITY_PSK);
+        mPreferenceController.mSecurityChangeReceiver.onReceive(mContext, intent);
+
+        intent = new Intent(NetworkNamePreferenceController.ACTION_NAME_CHANGE);
+        intent.putExtra(NetworkNamePreferenceController.KEY_NETWORK_NAME, networkName);
+        mPreferenceController.mNameChangeReceiver.onReceive(mContext, intent);
+        mPreference.callChangeListener(password);
+
+        ArgumentCaptor<WifiConfiguration> argumentCaptor = ArgumentCaptor.forClass(
+                WifiConfiguration.class);
+        verify(mockWifiManager).connect(argumentCaptor.capture(), any());
+
+        WifiConfiguration config = argumentCaptor.getValue();
+        assertThat(config.SSID).contains(networkName);
+        assertThat(config.getAuthType()).isEqualTo(WifiConfiguration.KeyMgmt.WPA_PSK);
+        assertThat(config.preSharedKey).contains(password);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/NetworkSecurityPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/NetworkSecurityPreferenceControllerTest.java
new file mode 100644
index 000000000..caeba9e6b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/NetworkSecurityPreferenceControllerTest.java
@@ -0,0 +1,128 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.Intent;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.localbroadcastmanager.content.LocalBroadcastManager;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+import java.util.List;
+
+@RunWith(AndroidJUnit4.class)
+public class NetworkSecurityPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private ListPreference mListPreference;
+    private NetworkSecurityPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private LocalBroadcastManager mMockLocalBroadcastManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mListPreference = new ListPreference(mContext);
+        mPreferenceController = new NetworkSecurityPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mListPreference);
+        mSession = ExtendedMockito.mockitoSession().mockStatic(
+                LocalBroadcastManager.class, withSettings().lenient()).startMocking();
+        when(LocalBroadcastManager.getInstance(any())).thenReturn(
+                mMockLocalBroadcastManager);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    public void handlePreferenceChanged_unsecureNetwork_summaryUpdated() {
+        String value = Integer.toString(WifiEntry.SECURITY_NONE);
+        mListPreference.callChangeListener(value);
+
+        assertThat(mListPreference.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.wifi_security_none));
+    }
+
+    @Test
+    public void handlePreferenceChanged_pskNetwork_summaryUpdated() {
+        String value = Integer.toString(WifiEntry.SECURITY_PSK);
+        mListPreference.callChangeListener(value);
+
+        assertThat(mListPreference.getSummary().toString()).isEqualTo(
+                mContext.getString(R.string.wifi_security_psk_generic));
+    }
+
+    @Test
+    public void handlePreferenceChanged_broadcastIsSent() {
+        String value = Integer.toString(WifiEntry.SECURITY_PSK);
+        mListPreference.callChangeListener(value);
+
+        ArgumentCaptor<Intent> argumentCaptor = ArgumentCaptor.forClass(
+                Intent.class);
+        verify(mMockLocalBroadcastManager).sendBroadcastSync(argumentCaptor.capture());
+        List<Intent> intents = argumentCaptor.getAllValues();
+        assertThat(intents).hasSize(1);
+        assertThat(intents.get(0).getAction()).isEqualTo(
+                NetworkSecurityPreferenceController.ACTION_SECURITY_CHANGE);
+        assertThat(intents.get(0).getIntExtra(NetworkSecurityPreferenceController.KEY_SECURITY_TYPE,
+                WifiEntry.SECURITY_NONE)).isEqualTo(Integer.parseInt(value));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiEntryGroupPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiEntryGroupPreferenceControllerTest.java
new file mode 100644
index 000000000..6f8ef2df6
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiEntryGroupPreferenceControllerTest.java
@@ -0,0 +1,286 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.os.UserManager;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiEntryGroupPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_WIFI;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private LogicalPreferenceGroup mPreference;
+    private CarUxRestrictions mCarUxRestrictions;
+    private WifiEntryGroupPreferenceController mController;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private PackageManager mPackageManager;
+    @Mock
+    private Lifecycle mMockLifecycle;
+    @Mock
+    private UserManager mMockUserManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreference = new LogicalPreferenceGroup(mContext);
+        mController = new WifiEntryGroupPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+
+        when(mContext.getPackageManager()).thenReturn(mPackageManager);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available_zoneWrite() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available_zoneRead() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available_zoneHidden() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByUm_viewing() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByUm_viewing_zoneWrite() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByUm_viewing_zoneRead() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByUm_viewing_zoneHidden() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByUm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing_zoneWrite() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing_zoneRead() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing_zoneHidden() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice_zoneWrite() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice_zoneRead() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice_zoneHidden() {
+        when(mPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+
+        mController.onCreate(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiEntryListPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiEntryListPreferenceControllerTest.java
new file mode 100644
index 000000000..06b695fb5
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiEntryListPreferenceControllerTest.java
@@ -0,0 +1,388 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static android.net.wifi.WifiConfiguration.NetworkSelectionStatus.NETWORK_SELECTION_ENABLED;
+import static android.os.UserManager.DISALLOW_CONFIG_WIFI;
+
+import static com.android.car.settings.testutils.EnterpriseTestUtils.mockUserRestrictionSetByDpm;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.times;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.wifi.WifiConfiguration;
+import android.net.wifi.WifiManager;
+import android.os.UserManager;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.PreferenceGroup;
+import androidx.preference.PreferenceManager;
+import androidx.preference.PreferenceScreen;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.LogicalPreferenceGroup;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.settings.wifi.details.WifiDetailsFragment;
+import com.android.car.ui.preference.CarUiTwoActionIconPreference;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.Collections;
+import java.util.HashSet;
+import java.util.List;
+import java.util.Set;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiEntryListPreferenceControllerTest {
+    private static final int SIGNAL_LEVEL = 1;
+
+    // Use a spied context to be able to mock UserManager.
+    private Context mSpiedContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private PreferenceGroup mPreferenceGroup;
+    private WifiEntryListPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private Lifecycle mMockLifecycle;
+    @Mock
+    private CarWifiManager mMockCarWifiManager;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private WifiManager mMockWifiManager;
+    @Mock
+    private WifiEntry mMockWifiEntry1;
+    @Mock
+    private WifiEntry mMockWifiEntry2;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        PreferenceManager preferenceManager = new PreferenceManager(mSpiedContext);
+        PreferenceScreen screen = preferenceManager.createPreferenceScreen(mSpiedContext);
+        mPreferenceGroup = new LogicalPreferenceGroup(mSpiedContext);
+        screen.addPreference(mPreferenceGroup);
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+        mPreferenceController = new TestWifiEntryListPreferenceController(mSpiedContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreferenceGroup);
+
+        when(mSpiedContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_NONE);
+        when(mMockWifiEntry1.getLevel()).thenReturn(SIGNAL_LEVEL);
+        when(mMockWifiEntry2.getSecurity()).thenReturn(WifiEntry.SECURITY_NONE);
+        when(mMockWifiEntry2.getLevel()).thenReturn(SIGNAL_LEVEL);
+    }
+
+    @Test
+    public void refreshUi_emptyList_notVisible() {
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(new ArrayList<>());
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.isVisible()).isEqualTo(false);
+    }
+
+    @Test
+    public void refreshUi_notEmpty_visible() {
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.isVisible()).isEqualTo(true);
+    }
+
+    @Test
+    public void refreshUi_notEmpty_listCount() {
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(wifiEntryList.size());
+    }
+
+    @Test
+    public void refreshUi_notSavedWifiEntry_noForgetButton() {
+        when(mMockWifiEntry1.isSaved()).thenReturn(false);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        CarUiTwoActionIconPreference preference =
+                (CarUiTwoActionIconPreference) mPreferenceGroup.getPreference(0);
+        assertThat(preference.isSecondaryActionVisible()).isFalse();
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_switchToSavedWifiEntriesOnly() {
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1, mMockWifiEntry2);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        List<WifiEntry> savedWifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getSavedWifiEntries()).thenReturn(savedWifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(wifiEntryList.size());
+
+        CarUxRestrictions noSetupRestrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(noSetupRestrictions);
+        assertThat(mPreferenceGroup.getPreferenceCount()).isEqualTo(savedWifiEntryList.size());
+    }
+
+    @Test
+    public void performClick_noSecurityNotConnectedWifiEntry_connect() {
+        when(mMockWifiEntry1.isPrimaryNetwork()).thenReturn(true);
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_NONE);
+        when(mMockWifiEntry1.isSaved()).thenReturn(false);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceGroup.getPreference(0).performClick();
+        verify(mMockWifiEntry1).connect(any());
+    }
+
+    @Test
+    public void performClick_shouldEditBeforeConnect_launchDialog() {
+        when(mMockWifiEntry1.isPrimaryNetwork()).thenReturn(true);
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_PSK);
+        when(mMockWifiEntry1.isSaved()).thenReturn(false);
+        when(mMockWifiEntry1.shouldEditBeforeConnect()).thenReturn(true);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceGroup.getPreference(0).performClick();
+        verify(mFragmentController).showDialog(any(WifiPasswordDialog.class), any());
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_activeWifiEntry_showDetailsFragment() {
+        when(mMockWifiEntry1.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_CONNECTED);
+        when(mMockWifiEntry1.isPrimaryNetwork()).thenReturn(true);
+        when(mMockCarWifiManager.getConnectedWifiEntries())
+                .thenReturn(Collections.singletonList(mMockWifiEntry1));
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(new ArrayList<>());
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceGroup.getPreference(0).performClick();
+        verify(mFragmentController).launchFragment(any(WifiDetailsFragment.class));
+    }
+
+    @Test
+    @UiThreadTest
+    public void performClick_secondaryActiveWifiEntry_doesNotShowDetailsFragment() {
+        when(mMockWifiEntry1.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_CONNECTED);
+        when(mMockWifiEntry1.isPrimaryNetwork()).thenReturn(false);
+        when(mMockCarWifiManager.getConnectedWifiEntries())
+                .thenReturn(Collections.singletonList(mMockWifiEntry1));
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(new ArrayList<>());
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceGroup.getPreference(0).performClick();
+        verify(mFragmentController, times(0)).launchFragment(any(WifiDetailsFragment.class));
+    }
+
+    @Test
+    public void performClick_savedWifiEntry_connect() {
+        when(mMockWifiEntry1.isSaved()).thenReturn(true);
+        when(mMockWifiEntry1.isPrimaryNetwork()).thenReturn(true);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceGroup.getPreference(0).performClick();
+        verify(mMockWifiEntry1).connect(any());
+    }
+
+    @Test
+    public void performButtonClick_savedWifiEntry_forgetsNetwork() {
+        int netId = 1;
+
+        WifiConfiguration config = mock(WifiConfiguration.class);
+        WifiConfiguration.NetworkSelectionStatus status = mock(
+                WifiConfiguration.NetworkSelectionStatus.class);
+        config.networkId = netId;
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_PSK);
+        when(mMockWifiEntry1.isSaved()).thenReturn(true);
+        when(mMockWifiEntry1.getWifiConfiguration()).thenReturn(config);
+        when(config.getNetworkSelectionStatus()).thenReturn(status);
+        when(status.getNetworkSelectionStatus()).thenReturn(NETWORK_SELECTION_ENABLED);
+
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        CarUiTwoActionIconPreference preference =
+                (CarUiTwoActionIconPreference) mPreferenceGroup.getPreference(0);
+        preference.performSecondaryActionClick();
+        verify(mMockWifiEntry1).forget(any());
+    }
+
+    @Test
+    public void callChangeListener_newSecureWifiEntry_wifiConnected() {
+        String title = "test_title";
+        String password = "test_password";
+        when(mMockWifiEntry1.getTitle()).thenReturn(title);
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_PSK);
+        when(mMockWifiEntry1.isSaved()).thenReturn(false);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        WifiPasswordDialog dialog = mock(WifiPasswordDialog.class);
+        WifiConfiguration config = WifiUtil.getWifiConfig(mMockWifiEntry1, password);
+        when(dialog.getConfig()).thenReturn(config);
+        when(dialog.getWifiEntry()).thenReturn(mMockWifiEntry1);
+        mPreferenceController.mDialogListener.onSubmit(dialog);
+
+        verify(mMockWifiManager).connect(eq(config), any());
+    }
+
+    @Test
+    public void fetchWifiEntries_getSavedWifiEntries() {
+        String title = "test_title";
+        when(mMockWifiEntry1.getTitle()).thenReturn(title);
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_PSK);
+        when(mMockWifiEntry1.isSaved()).thenReturn(false);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        List<WifiEntry> noWifiEntries = new ArrayList<>();
+
+        when(mMockCarWifiManager.getSavedWifiEntries()).thenReturn(wifiEntryList);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(noWifiEntries);
+
+        TestWifiEntryListPreferenceController prefController =
+                (TestWifiEntryListPreferenceController) mPreferenceController;
+        Set<String> prefsThatIgnore = new HashSet<>();
+        prefsThatIgnore.add("unknown key");
+
+        prefController.setUxRestrictionsIgnoredConfig(/* allIgnore= */ false, prefsThatIgnore);
+        CarUxRestrictions noSetupRestrictions = new CarUxRestrictions.Builder(
+                true, CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP, 0).build();
+        mPreferenceController.onUxRestrictionsChanged(noSetupRestrictions);
+
+        List<WifiEntry> result = prefController.fetchWifiEntries();
+
+        assertThat(result).containsExactlyElementsIn(wifiEntryList);
+    }
+
+    @Test
+    public void fetchWifiEntries_getAllWifiEntries() {
+        String title = "test_title";
+        when(mMockWifiEntry1.getTitle()).thenReturn(title);
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_PSK);
+        when(mMockWifiEntry1.isSaved()).thenReturn(false);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        List<WifiEntry> noWifiEntries = new ArrayList<>();
+
+        when(mMockCarWifiManager.getSavedWifiEntries()).thenReturn(wifiEntryList);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(noWifiEntries);
+
+        TestWifiEntryListPreferenceController prefController =
+                (TestWifiEntryListPreferenceController) mPreferenceController;
+
+        prefController.setUxRestrictionsIgnoredConfig(/* allIgnore= */ false, new HashSet<>());
+
+        List<WifiEntry> result = prefController.fetchWifiEntries();
+
+        assertThat(result).containsExactlyElementsIn(noWifiEntries);
+    }
+
+    @Test
+    public void fetchWifiEntries_restrictionByDpm_returnsNoEntries() {
+        String title = "test_title";
+        mockUserRestrictionSetByDpm(mMockUserManager, DISALLOW_CONFIG_WIFI, true);
+        when(mMockWifiEntry1.getTitle()).thenReturn(title);
+        when(mMockWifiEntry1.getSecurity()).thenReturn(WifiEntry.SECURITY_PSK);
+        when(mMockWifiEntry1.isSaved()).thenReturn(false);
+        List<WifiEntry> wifiEntryList = Arrays.asList(mMockWifiEntry1);
+        when(mMockCarWifiManager.getSavedWifiEntries()).thenReturn(wifiEntryList);
+        when(mMockCarWifiManager.getAllWifiEntries()).thenReturn(wifiEntryList);
+
+        TestWifiEntryListPreferenceController prefController =
+                (TestWifiEntryListPreferenceController) mPreferenceController;
+
+        prefController.setUxRestrictionsIgnoredConfig(/* allIgnore= */ false, new HashSet<>());
+
+        List<WifiEntry> result = prefController.fetchWifiEntries();
+
+        assertThat(result).isEmpty();
+    }
+
+    private class TestWifiEntryListPreferenceController extends WifiEntryListPreferenceController {
+
+        private boolean mAllIgnoresUxRestrictions = false;
+        private Set<String> mPreferencesIgnoringUxRestrictions = new HashSet<>();
+
+        TestWifiEntryListPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected CarWifiManager getCarWifiManager() {
+            return mMockCarWifiManager;
+        }
+
+        @Override
+        WifiManager getWifiManager() {
+            return mMockWifiManager;
+        }
+
+        public void setUxRestrictionsIgnoredConfig(boolean allIgnore, Set preferencesThatIgnore) {
+            mAllIgnoresUxRestrictions = allIgnore;
+            mPreferencesIgnoringUxRestrictions = preferencesThatIgnore;
+        }
+
+        @Override
+        protected boolean isUxRestrictionsIgnored(boolean allIgnores, Set prefsThatIgnore) {
+            return super.isUxRestrictionsIgnored(mAllIgnoresUxRestrictions,
+                    mPreferencesIgnoringUxRestrictions);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiPasswordDialogTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiPasswordDialogTest.java
new file mode 100644
index 000000000..283787111
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiPasswordDialogTest.java
@@ -0,0 +1,122 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.app.AlertDialog;
+import android.content.DialogInterface;
+import android.text.InputType;
+import android.view.View;
+import android.widget.Button;
+import android.widget.CheckBox;
+import android.widget.EditText;
+import android.widget.TextView;
+
+import androidx.fragment.app.FragmentManager;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiPasswordDialogTest {
+
+    private static final String TEST_TITLE = "test_title";
+
+    private WifiPasswordDialog mFragment;
+    private FragmentManager mFragmentManager;
+
+    @Mock
+    private WifiEntry mMockWifiEntry;
+    @Mock
+    private WifiPasswordDialog.WifiDialogListener mMockListener;
+
+    @Rule
+    public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
+
+    @Before
+    public void setup() {
+        MockitoAnnotations.initMocks(this);
+        mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+        when(mMockWifiEntry.getTitle()).thenReturn(TEST_TITLE);
+    }
+
+    @Test
+    public void onDialogCreated_titleSet() throws Throwable {
+        setUpDialog();
+        View titleView = mFragment.getDialog().findViewById(com.android.internal.R.id.alertTitle);
+        assertThat(titleView).isNotNull();
+        assertThat(((TextView) titleView).getText().toString()).isEqualTo(TEST_TITLE);
+    }
+
+    @Test
+    public void onDialogCreated_editTextInputTypeSet() throws Throwable {
+        setUpDialog();
+        EditText editText = mFragment.getDialog().findViewById(android.R.id.edit);
+        assertThat(editText.getInputType()).isEqualTo(
+                InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_VARIATION_PASSWORD);
+    }
+
+    @Test
+    public void onCheckboxChanged_editTextInputTypeSet() throws Throwable {
+        setUpDialog();
+        EditText editText = mFragment.getDialog().findViewById(android.R.id.edit);
+        CheckBox cb = mFragment.getDialog().findViewById(R.id.checkbox);
+        mActivityTestRule.runOnUiThread(() -> cb.performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        assertThat(editText.getInputType()).isEqualTo(
+                InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_VARIATION_VISIBLE_PASSWORD);
+        mActivityTestRule.runOnUiThread(() -> cb.performClick());
+        assertThat(editText.getInputType()).isEqualTo(
+                InputType.TYPE_CLASS_TEXT | InputType.TYPE_TEXT_VARIATION_PASSWORD);
+    }
+
+    @Test
+    public void onConfirm_listenerTriggered() throws Throwable {
+        setUpDialog();
+        Button confirmButton = ((AlertDialog) mFragment.getDialog()).getButton(
+                DialogInterface.BUTTON_POSITIVE);
+        mActivityTestRule.runOnUiThread(() -> confirmButton.performClick());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        verify(mMockListener).onSubmit(any());
+    }
+
+    private void setUpDialog() throws Throwable {
+        mActivityTestRule.runOnUiThread(
+                () -> new WifiPasswordDialog(mMockWifiEntry, mMockListener).show(mFragmentManager,
+                        WifiPasswordDialog.TAG));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mFragment = (WifiPasswordDialog) mFragmentManager.findFragmentByTag(
+                WifiPasswordDialog.TAG);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiStateSwitchPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiStateSwitchPreferenceControllerTest.java
new file mode 100644
index 000000000..131a62adc
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiStateSwitchPreferenceControllerTest.java
@@ -0,0 +1,302 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+import static com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment.DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.pm.PackageManager;
+import android.net.wifi.WifiManager;
+import android.os.UserManager;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.enterprise.ActionDisabledByAdminDialogFragment;
+import com.android.car.settings.testutils.EnterpriseTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiStateSwitchPreferenceControllerTest {
+    private static final String TEST_RESTRICTION =
+            android.os.UserManager.DISALLOW_CONFIG_WIFI;
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private ColoredSwitchPreference mSwitchPreference;
+    private LifecycleOwner mLifecycleOwner;
+    private WifiStateSwitchPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private Lifecycle mMockLifecycle;
+    @Mock
+    private PackageManager mMockPackageManager;
+    @Mock
+    private UserManager mMockUserManager;
+    @Mock
+    private WifiManager mMockWifiManager;
+
+    @Before
+    @UiThreadTest
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new WifiStateSwitchPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+
+        when(mContext.getPackageManager()).thenReturn(mMockPackageManager);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mMockWifiManager);
+        when(mContext.getSystemService(UserManager.class)).thenReturn(mMockUserManager);
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+    }
+
+    @Test
+    public void onWifiStateChanged_disabled_setsSwitchUnchecked() {
+        initializePreference(/* checked= */ true, /* enabled= */ true);
+        mPreferenceController.onWifiStateChanged(WifiManager.WIFI_STATE_DISABLED);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onWifiStateChanged_enabled_setsSwitchChecked() {
+        initializePreference(/* checked= */ false, /* enabled= */ true);
+        mPreferenceController.onWifiStateChanged(WifiManager.WIFI_STATE_ENABLED);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onWifiStateChanged_enabling_setsSwitchChecked() {
+        initializePreference(/* checked= */ false, /* enabled= */ true);
+        mPreferenceController.onWifiStateChanged(WifiManager.WIFI_STATE_ENABLING);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onPolicyChanged_enabled_setsSwitchEnabled() {
+        initializePreference(/* checked= */ false, /* enabled= */ false);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ true);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+    }
+
+    @Test
+    public void onPolicyChanged_disabled_setsSwitchDisabled() {
+        initializePreference(/* checked= */ false, /* enabled= */ true);
+
+        mPreferenceController.mPowerPolicyListener.getPolicyChangeHandler()
+                .handlePolicyChange(/* isOn= */ false);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available_zoneWrite() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available_zoneRead() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_notRestricted_available_zoneHidden() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing_zoneWrite() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing_zoneRead() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiAvailable_restrictedByDpm_viewing_zoneHidden() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreferenceController.getAvailabilityStatus()).isEqualTo(UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice_zoneWrite() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice_zoneRead() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void getAvailabilityStatus_wifiNotAvailable_unsupportedOnDevice_zoneHidden() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onPreferenceClicked_wifiAvailable_restrictedByDpm_showAdminDialog() {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        EnterpriseTestUtils
+                .mockUserRestrictionSetByDpm(mMockUserManager, TEST_RESTRICTION, true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mSwitchPreference.performClick();
+
+        assertShowingDisabledByAdminDialog();
+    }
+
+    private void assertShowingDisabledByAdminDialog() {
+        verify(mFragmentController).showDialog(any(ActionDisabledByAdminDialogFragment.class),
+                eq(DISABLED_BY_ADMIN_CONFIRM_DIALOG_TAG));
+    }
+
+    private void initializePreference(boolean checked, boolean enabled) {
+        when(mMockPackageManager.hasSystemFeature(PackageManager.FEATURE_WIFI)).thenReturn(true);
+        when(mMockWifiManager.isWifiEnabled()).thenReturn(enabled);
+        mSwitchPreference.setChecked(checked);
+        mSwitchPreference.setEnabled(enabled);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherApBandPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherApBandPreferenceControllerTest.java
new file mode 100644
index 000000000..7ccd79402
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherApBandPreferenceControllerTest.java
@@ -0,0 +1,235 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static android.net.wifi.SoftApConfiguration.BAND_2GHZ;
+import static android.net.wifi.SoftApConfiguration.BAND_5GHZ;
+
+import static com.android.car.settings.wifi.WifiTetherApBandPreferenceController.BAND_2GHZ_5GHZ;
+import static com.android.car.settings.wifi.WifiTetherApBandPreferenceController.DUAL_BANDS;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.wifi.SoftApConfiguration;
+import android.platform.test.annotations.EnableFlags;
+import android.platform.test.flag.junit.SetFlagsRule;
+import android.util.SparseIntArray;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.Flags;
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiTetherApBandPreferenceControllerTest {
+    @Rule
+    public final SetFlagsRule mSetFlagsRule = new SetFlagsRule();
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private ListPreference mPreference;
+    private LifecycleOwner mLifecycleOwner;
+    private WifiTetherApBandPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private Lifecycle mMockLifecycle;
+    @Mock
+    private CarWifiManager mCarWifiManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+        mPreference = new ListPreference(mContext);
+        when(mCarWifiManager.getCountryCode()).thenReturn("1");
+        mPreferenceController = new WifiTetherApBandPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mCarWifiManager);
+
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void onStart_5GhzBandNotSupported_defaultTo2Ghz() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(false);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBand(BAND_5GHZ).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isFalse();
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.wifi_ap_choose_2G));
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_HOTSPOT_UI_SPEED_UPDATE)
+    public void onStart_dualBandNotSupported_defaultTo2Ghz() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(true);
+        when(mCarWifiManager.isDualBandSupported()).thenReturn(false);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBands(DUAL_BANDS).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isTrue();
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.wifi_ap_choose_2G));
+        assertThat(mPreference.getValue()).isEqualTo(
+                Integer.toString(SoftApConfiguration.BAND_2GHZ));
+    }
+
+    @Test
+    public void onStart_wifiConfigApBandSetTo5Ghz_valueIsSetTo5Ghz() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(true);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBand(BAND_5GHZ).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isTrue();
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.wifi_ap_prefer_5G));
+        assertThat(mPreference.getValue()).isEqualTo(
+                Integer.toString(SoftApConfiguration.BAND_5GHZ));
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_HOTSPOT_UI_SPEED_UPDATE)
+    public void onStart_wifiConfigDualApBand_valueIsSetToDualBand() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(true);
+        when(mCarWifiManager.isDualBandSupported()).thenReturn(true);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBands(DUAL_BANDS).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isEnabled()).isTrue();
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.wifi_ap_2G_5G));
+        assertThat(mPreference.getValue()).isEqualTo(
+                Integer.toString(BAND_2GHZ_5GHZ));
+    }
+
+    @Test
+    public void onStart_wifiConfigApBandSetTo2Ghz_valueIsSetTo2Ghz() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(true);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBand(BAND_2GHZ).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.getValue()).isEqualTo(
+                Integer.toString(SoftApConfiguration.BAND_2GHZ));
+    }
+
+    @Test
+    public void onPreferenceChangedTo5Ghz_updatesApBandConfigTo5Ghz() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(true);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBand(BAND_2GHZ).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(SoftApConfiguration.BAND_5GHZ));
+
+        SoftApConfiguration actualConfig = getSoftApConfig();
+        assertThat(getBandFromConfig(actualConfig)).isEqualTo(BAND_2GHZ_5GHZ);
+        assertThat(actualConfig.getChannels().size()).isEqualTo(1);
+    }
+
+    @Test
+    public void onPreferenceChangedTo2Ghz_updatesApBandConfigTo2Ghz() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(true);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBand(BAND_5GHZ).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.handlePreferenceChanged(mPreference, Integer.toString(BAND_2GHZ));
+
+        SoftApConfiguration actualConfig = getSoftApConfig();
+        assertThat(getBandFromConfig(actualConfig)).isEqualTo(BAND_2GHZ);
+        assertThat(actualConfig.getChannels().size()).isEqualTo(1);
+    }
+
+    @Test
+    @EnableFlags(Flags.FLAG_HOTSPOT_UI_SPEED_UPDATE)
+    public void onPreferenceChangedToDualBand_updatesApBandConfigToDualBand() {
+        when(mCarWifiManager.is5GhzBandSupported()).thenReturn(true);
+        when(mCarWifiManager.isDualBandSupported()).thenReturn(true);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(
+                new SoftApConfiguration.Builder().setBand(BAND_2GHZ).build());
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.handlePreferenceChanged(mPreference,
+                Integer.toString(BAND_2GHZ_5GHZ));
+
+        SoftApConfiguration actualConfig = getSoftApConfig();
+        assertThat(getBandFromConfig(actualConfig)).isEqualTo(BAND_2GHZ_5GHZ);
+        assertThat(actualConfig.getChannels().size()).isEqualTo(2);
+    }
+
+    private SoftApConfiguration getSoftApConfig() {
+        ArgumentCaptor<SoftApConfiguration> captor = ArgumentCaptor.forClass(
+                SoftApConfiguration.class);
+        verify(mCarWifiManager).setSoftApConfig(captor.capture());
+        return captor.getValue();
+    }
+
+    private int getBandFromConfig(SoftApConfiguration config) {
+        int band = 0;
+
+        SparseIntArray channels = config.getChannels();
+        for (int i = 0; i < channels.size(); i++) {
+            band |= channels.keyAt(i);
+        }
+
+        return band;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherPersistentOnPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherPersistentOnPreferenceControllerTest.java
new file mode 100644
index 000000000..6571841b7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherPersistentOnPreferenceControllerTest.java
@@ -0,0 +1,136 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static android.car.settings.CarSettings.Global.ENABLE_PERSISTENT_TETHERING;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.DISABLED_FOR_PROFILE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.car.wifi.CarWifiManager;
+import android.content.Context;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.CarSettingsApplication;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiTetherPersistentOnPreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private SwitchPreference mPreference;
+    private LifecycleOwner mLifecycleOwner;
+    private WifiTetherPersistentOnPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private CarSettingsApplication mCarSettingsApplication;
+    @Mock
+    private CarWifiManager mCarWifiManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getApplicationContext()).thenReturn(mCarSettingsApplication);
+        when(mCarSettingsApplication.getCarWifiManager()).thenReturn(mCarWifiManager);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        mPreferenceController = new WifiTetherPersistentOnPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreference = new SwitchPreference(mContext);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+    }
+
+    @Test
+    public void getDefaultAvailabilityStatus_noAvailableOnDevice() {
+        when(mCarWifiManager.canControlPersistTetheringSettings()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), DISABLED_FOR_PROFILE);
+    }
+
+    @Test
+    public void testDefaultAvailabilityStatus_availableOnDevice() {
+        when(mCarWifiManager.canControlPersistTetheringSettings()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        PreferenceControllerTestUtil.assertAvailability(
+                mPreferenceController.getAvailabilityStatus(), AVAILABLE);
+    }
+
+    @Test
+    public void testUpdateState_stateChecked() {
+        when(mCarWifiManager.canControlPersistTetheringSettings()).thenReturn(true);
+        Settings.Global.putString(mContext.getContentResolver(), ENABLE_PERSISTENT_TETHERING,
+                WifiTetherPersistentOnPreferenceController.ENABLED);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void testUpdateState_stateNotChecked() {
+        when(mCarWifiManager.canControlPersistTetheringSettings()).thenReturn(true);
+        Settings.Global.putString(mContext.getContentResolver(), ENABLE_PERSISTENT_TETHERING,
+                WifiTetherPersistentOnPreferenceController.DISABLED);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+
+        assertThat(mPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void testHandlePreferenceChanged_enableUWB() {
+        when(mCarWifiManager.canControlPersistTetheringSettings()).thenReturn(true);
+        Settings.Global.putString(mContext.getContentResolver(), ENABLE_PERSISTENT_TETHERING,
+                WifiTetherPersistentOnPreferenceController.DISABLED);
+        mPreferenceController.onCreate(mLifecycleOwner);
+        mPreferenceController.onStart(mLifecycleOwner);
+        mPreferenceController.handlePreferenceChanged(mPreference, true);
+
+        assertThat(Settings.Global.getString(mContext.getContentResolver(),
+                ENABLE_PERSISTENT_TETHERING)).isEqualTo(
+                WifiTetherPersistentOnPreferenceController.ENABLED);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherPreferenceControllerTest.java
new file mode 100644
index 000000000..193f63d89
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherPreferenceControllerTest.java
@@ -0,0 +1,295 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.android.car.settings.common.PreferenceController.AVAILABLE;
+import static com.android.car.settings.common.PreferenceController.AVAILABLE_FOR_VIEWING;
+import static com.android.car.settings.common.PreferenceController.CONDITIONALLY_UNAVAILABLE;
+import static com.android.car.settings.common.PreferenceController.UNSUPPORTED_ON_DEVICE;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.TetheringManager;
+import android.net.wifi.SoftApConfiguration;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.car.ui.preference.CarUiTwoActionSwitchPreference;
+import com.android.settingslib.wifi.WifiUtils;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.Executor;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiTetherPreferenceControllerTest {
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private CarUiTwoActionSwitchPreference mPreference;
+    private WifiTetherPreferenceController mController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private Lifecycle mMockLifecycle;
+    @Mock
+    private TetheringManager mTetheringManager;
+    @Mock
+    private CarWifiManager mCarWifiManager;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+
+        mPreference = new CarUiTwoActionSwitchPreference(mContext);
+        mController = new WifiTetherPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions,
+                mCarWifiManager, mTetheringManager);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+    }
+
+    @Test
+    public void onStart_isAvailableForViewing() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onStart_isAvailableForViewing_zoneWrite() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onStart_isAvailableForViewing_zoneRead() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onStart_isAvailableForViewing_zoneHidden() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onStart_registersTetheringEventCallback() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        verify(mTetheringManager).registerTetheringEventCallback(
+                any(Executor.class), any(TetheringManager.TetheringEventCallback.class));
+    }
+
+    @Test
+    public void onStop_unregistersTetheringEventCallback() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.onStop(mLifecycleOwner);
+
+        verify(mTetheringManager).unregisterTetheringEventCallback(
+                any(TetheringManager.TetheringEventCallback.class));
+    }
+
+    @Test
+    public void onTetheringSupported_false_isUnsupportedOnDevice() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        setTetheringSupported(false);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void onTetheringSupported_false_isUnsupportedOnDevice_zoneWrite() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        setTetheringSupported(false);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void onTetheringSupported_false_isUnsupportedOnDevice_zoneRead() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        setTetheringSupported(false);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void onTetheringSupported_false_isUnsupportedOnDevice_zoneHidden() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        setTetheringSupported(false);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                UNSUPPORTED_ON_DEVICE);
+    }
+
+    @Test
+    public void onTetheringSupported_true_isAvailable() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+
+        setTetheringSupported(true);
+
+        assertThat(mController.getAvailabilityStatus()).isEqualTo(AVAILABLE);
+    }
+
+    @Test
+    public void onTetheringSupported_true_isAvailable_zoneWrite() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("write");
+
+        setTetheringSupported(true);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE);
+    }
+
+    @Test
+    public void onTetheringSupported_true_isAvailable_zoneRead() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("read");
+
+        setTetheringSupported(true);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                AVAILABLE_FOR_VIEWING);
+    }
+
+    @Test
+    public void onTetheringSupported_true_isAvailable_zoneHidden() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.setAvailabilityStatusForZone("hidden");
+
+        setTetheringSupported(true);
+
+        PreferenceControllerTestUtil.assertAvailability(mController.getAvailabilityStatus(),
+                CONDITIONALLY_UNAVAILABLE);
+    }
+
+    @Test
+    public void onTetheringOff_subtitleOff() {
+        when(mCarWifiManager.isWifiApEnabled()).thenReturn(false);
+        SoftApConfiguration config = mock(SoftApConfiguration.class);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(config);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        setTetheringSupported(true);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                mContext.getString(R.string.wifi_hotspot_state_off));
+    }
+
+    @Test
+    public void onTetheringOn_showsSSIDAndPassword() {
+        String testSSID = "TEST_SSID";
+        String testPassword = "TEST_PASSWORD";
+        when(mCarWifiManager.isWifiApEnabled()).thenReturn(true);
+        SoftApConfiguration config = mock(SoftApConfiguration.class);
+        when(config.getSsid()).thenReturn(testSSID);
+        when(config.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+        when(config.getPassphrase()).thenReturn(testPassword);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(config);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        setTetheringSupported(true);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                testSSID + " / " + testPassword);
+    }
+
+    @Test
+    public void onDeviceConnected_showsDeviceConnectedSubtitle() {
+        int connectedClients = 2;
+        when(mCarWifiManager.isWifiApEnabled()).thenReturn(true);
+        SoftApConfiguration config = mock(SoftApConfiguration.class);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(config);
+        mController.onConnectedClientsChanged(connectedClients);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        setTetheringSupported(true);
+
+        assertThat(mPreference.getSummary()).isEqualTo(
+                WifiUtils.getWifiTetherSummaryForConnectedDevices(mContext, connectedClients));
+    }
+
+    private void setTetheringSupported(boolean supported) {
+        ArgumentCaptor<TetheringManager.TetheringEventCallback> captor =
+                ArgumentCaptor.forClass(TetheringManager.TetheringEventCallback.class);
+        verify(mTetheringManager).registerTetheringEventCallback(
+                any(Executor.class), captor.capture());
+        captor.getValue().onTetheringSupported(supported);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherSecurityPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherSecurityPreferenceControllerTest.java
new file mode 100644
index 000000000..73d17a5de
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetherSecurityPreferenceControllerTest.java
@@ -0,0 +1,264 @@
+/*
+ * Copyright (C) 2019 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.atLeastOnce;
+import static org.mockito.Mockito.mock;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.content.SharedPreferences;
+import android.net.wifi.SoftApCapability;
+import android.net.wifi.SoftApConfiguration;
+import android.net.wifi.WifiManager;
+
+import androidx.lifecycle.Lifecycle;
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.ListPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import com.google.common.annotations.VisibleForTesting;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.junit.MockitoJUnit;
+import org.mockito.junit.MockitoRule;
+
+import java.util.concurrent.Executor;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiTetherSecurityPreferenceControllerTest {
+
+    private final Context mContext = ApplicationProvider.getApplicationContext();
+    private ListPreference mPreference;
+    private TestWifiTetherSecurityPreferenceController mController;
+
+    private LifecycleOwner mLifecycleOwner;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private Lifecycle mMockLifecycle;
+    @Mock
+    private SoftApConfiguration mConfig;
+    @Mock
+    private CarWifiManager mCarWifiManager;
+
+    @Rule
+    public final MockitoRule rule = MockitoJUnit.rule();
+
+    @Before
+    public void setup() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+        mPreference = new ListPreference(mContext);
+        when(mCarWifiManager.getSoftApConfig()).thenReturn(mConfig);
+        mController = new TestWifiTetherSecurityPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions, mConfig,
+                mCarWifiManager);
+        PreferenceControllerTestUtil.assignPreference(mController, mPreference);
+    }
+
+    @Test
+    public void onStart_securityTypeSetToNone_setsValueToNone() {
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_OPEN);
+        when(mConfig.getPassphrase()).thenReturn(null);
+        mController.setTestConfig(mConfig);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        assertThat(Integer.parseInt(mPreference.getValue()))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_OPEN);
+    }
+
+    @Test
+    public void onStart_securityTypeSetToWPA2PSK_setsValueToWPA2PSK() {
+        String testPassword = "TEST_PASSWORD";
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+        when(mConfig.getPassphrase()).thenReturn(testPassword);
+        mController.setTestConfig(mConfig);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        assertThat(Integer.parseInt(mPreference.getValue()))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+    }
+
+    @Test
+    public void onStart_securityTypeSetToWPA3SAE_setsValueForSupportedDevicesToWPA3SAE() {
+        String testPassword = "TEST_PASSWORD";
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_WPA3_SAE);
+        when(mConfig.getPassphrase()).thenReturn(testPassword);
+        mController.setTestConfig(mConfig);
+        SoftApCapability softApCapability = mock(SoftApCapability.class);
+        when(softApCapability.areFeaturesSupported(
+                SoftApCapability.SOFTAP_FEATURE_WPA3_SAE)).thenReturn(true);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        // calling callback manually to access the compatibility with WPA3
+        mController.onCapabilityChanged(softApCapability);
+        assertThat(Integer.parseInt(mPreference.getValue()))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_WPA3_SAE);
+    }
+
+    @Test
+    public void onStart_securityTypeSetToWPA3SAE_setsValueForUnSupportedDevicesToWPA2PSK() {
+        String testPassword = "TEST_PASSWORD";
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_WPA3_SAE);
+        when(mConfig.getPassphrase()).thenReturn(testPassword);
+        mController.setTestConfig(mConfig);
+        SoftApCapability softApCapability = mock(SoftApCapability.class);
+        when(softApCapability.areFeaturesSupported(
+                SoftApCapability.SOFTAP_FEATURE_WPA3_SAE)).thenReturn(false);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        // calling callback manually to access the compatibility with WPA3
+        mController.onCapabilityChanged(softApCapability);
+        assertThat(Integer.parseInt(mPreference.getValue()))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+    }
+
+    @Test
+    public void onStart_registerSoftApCallbackCalled() {
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        verify(mController.getCarWifiManager(), atLeastOnce())
+                .registerSoftApCallback(any(Executor.class), any(WifiManager.SoftApCallback.class));
+    }
+
+    @Test
+    public void onPreferenceChangedToNone_updatesSharedSecurityTypeToNone() {
+        String testPassword = "TEST_PASSWORD";
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+        when(mConfig.getPassphrase()).thenReturn(testPassword);
+        mController.setTestConfig(mConfig);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.handlePreferenceChanged(mPreference,
+                Integer.toString(SoftApConfiguration.SECURITY_TYPE_OPEN));
+        SharedPreferences sp = mContext.getSharedPreferences(
+                WifiTetherPasswordPreferenceController.SHARED_PREFERENCE_PATH,
+                Context.MODE_PRIVATE);
+        assertThat(sp.getInt(WifiTetherSecurityPreferenceController.KEY_SECURITY_TYPE, -1))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_OPEN);
+    }
+
+    @Test
+    public void onPreferenceChangedToWPA2PSK_updatesSharedSecurityTypeToWPA2PSK() {
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_OPEN);
+        when(mConfig.getPassphrase()).thenReturn(null);
+        mController.setTestConfig(mConfig);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        mController.handlePreferenceChanged(mPreference,
+                Integer.toString(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK));
+        SharedPreferences sp = mContext.getSharedPreferences(
+                WifiTetherPasswordPreferenceController.SHARED_PREFERENCE_PATH,
+                Context.MODE_PRIVATE);
+        assertThat(sp.getInt(WifiTetherSecurityPreferenceController.KEY_SECURITY_TYPE, -1))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+    }
+
+    @Test
+    public void onPreferenceChangedToWPA3SAE_updatesSharedSecurityTypeToWPA3SAE() {
+        // For devices that support WPA3
+        String testPassword = "TEST_PASSWORD";
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+        when(mConfig.getPassphrase()).thenReturn(testPassword);
+        mController.setTestConfig(mConfig);
+        SoftApCapability softApCapability = mock(SoftApCapability.class);
+        when(softApCapability.areFeaturesSupported(
+                SoftApCapability.SOFTAP_FEATURE_WPA3_SAE)).thenReturn(true);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        // calling callback manually to access the compatibility with WPA3
+        mController.onCapabilityChanged(softApCapability);
+        mController.handlePreferenceChanged(mPreference,
+                Integer.toString(SoftApConfiguration.SECURITY_TYPE_WPA3_SAE));
+        SharedPreferences sp = mContext.getSharedPreferences(
+                WifiTetherPasswordPreferenceController.SHARED_PREFERENCE_PATH,
+                Context.MODE_PRIVATE);
+        assertThat(sp.getInt(WifiTetherSecurityPreferenceController.KEY_SECURITY_TYPE, -1))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_WPA3_SAE);
+    }
+
+    @Test
+    public void onPreferenceChangedToWPA3SAE_updatesSharedSecurityTypeToWPA2PSK() {
+        // For devices that does not support WPA3
+        String testPassword = "TEST_PASSWORD";
+        when(mConfig.getSecurityType()).thenReturn(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+        when(mConfig.getPassphrase()).thenReturn(testPassword);
+        mController.setTestConfig(mConfig);
+        SoftApCapability softApCapability = mock(SoftApCapability.class);
+        when(softApCapability.areFeaturesSupported(
+                SoftApCapability.SOFTAP_FEATURE_WPA3_SAE)).thenReturn(false);
+        mController.onCreate(mLifecycleOwner);
+        mController.onStart(mLifecycleOwner);
+        // calling callback manually to access the compatibility with WPA3
+        mController.onCapabilityChanged(softApCapability);
+        mController.handlePreferenceChanged(mPreference,
+                Integer.toString(SoftApConfiguration.SECURITY_TYPE_WPA3_SAE));
+        SharedPreferences sp = mContext.getSharedPreferences(
+                WifiTetherPasswordPreferenceController.SHARED_PREFERENCE_PATH,
+                Context.MODE_PRIVATE);
+        assertThat(sp.getInt(WifiTetherSecurityPreferenceController.KEY_SECURITY_TYPE, -1))
+                .isEqualTo(SoftApConfiguration.SECURITY_TYPE_WPA2_PSK);
+    }
+
+    private static class TestWifiTetherSecurityPreferenceController
+            extends WifiTetherSecurityPreferenceController {
+        SoftApConfiguration mConfig;
+        CarWifiManager mCarWifiManager;
+
+        TestWifiTetherSecurityPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController, CarUxRestrictions uxRestrictions,
+                SoftApConfiguration config, CarWifiManager carWifiManager) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+            mConfig = config;
+            mCarWifiManager = carWifiManager;
+        }
+
+        @VisibleForTesting
+        void setTestConfig(SoftApConfiguration config) {
+            mConfig = config;
+        }
+
+        @Override
+        protected SoftApConfiguration getCarSoftApConfig() {
+            return mConfig;
+        }
+
+        @Override
+        protected CarWifiManager getCarWifiManager() {
+            return mCarWifiManager;
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/WifiTetheringHandlerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetheringHandlerTest.java
new file mode 100644
index 000000000..2b22e998b
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/WifiTetheringHandlerTest.java
@@ -0,0 +1,202 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.ConnectivityManager;
+import android.net.TetheringManager;
+import android.net.wifi.WifiManager;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.util.concurrent.Executor;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiTetheringHandlerTest {
+    private LifecycleOwner mLifecycleOwner;
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private SwitchPreference mSwitchPreference;
+    private TestWifiTetheringPreferenceController mPreferenceController;
+    private WifiTetheringHandler mWifiTetheringHandler;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private CarWifiManager mCarWifiManager;
+    @Mock
+    private TetheringManager mTetheringManager;
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new TestWifiTetheringPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mWifiTetheringHandler = new WifiTetheringHandler(mContext, mCarWifiManager,
+                mTetheringManager, mPreferenceController, /* monitorRestarts= */ true);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+    }
+
+    @Test
+    public void onCreate_tetherStateOn_shouldReturnSwitchStateOn() {
+        when(mCarWifiManager.isWifiApEnabled()).thenReturn(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mWifiTetheringHandler.isWifiTetheringEnabled()).isTrue();
+    }
+
+    @Test
+    public void onCreate_tetherStateOff_shouldReturnSwitchStateOff() {
+        when(mCarWifiManager.isWifiApEnabled()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mWifiTetheringHandler.isWifiTetheringEnabled()).isFalse();
+    }
+
+    @Test
+    public void onSwitchOn_shouldAttemptTetherOn() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mWifiTetheringHandler.updateWifiTetheringState(true);
+
+        verify(mTetheringManager).startTethering(
+                eq(ConnectivityManager.TETHERING_WIFI),
+                any(Executor.class), any(TetheringManager.StartTetheringCallback.class)
+        );
+    }
+
+    @Test
+    public void onSwitchOff_shouldAttemptTetherOff() {
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mWifiTetheringHandler.updateWifiTetheringState(false);
+
+        verify(mTetheringManager).stopTethering(ConnectivityManager.TETHERING_WIFI);
+    }
+
+    @Test
+    public void onTetherEnabling_shouldReturnSwitchStateDisabled() {
+        mSwitchPreference.setEnabled(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mWifiTetheringHandler.handleWifiApStateChanged(WifiManager.WIFI_AP_STATE_ENABLING);
+
+        assertThat(mSwitchPreference.isEnabled()).isFalse();
+    }
+
+    @Test
+    public void onTetherEnabled_shouldReturnSwitchStateEnabledAndOn() {
+        mSwitchPreference.setEnabled(false);
+        mSwitchPreference.setChecked(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mWifiTetheringHandler.handleWifiApStateChanged(WifiManager.WIFI_AP_STATE_ENABLED);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onTetherDisabled_shouldReturnSwitchStateEnabledAndOff() {
+        mSwitchPreference.setEnabled(false);
+        mSwitchPreference.setChecked(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mWifiTetheringHandler.handleWifiApStateChanged(WifiManager.WIFI_AP_STATE_DISABLED);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onEnableTetherFailed_shouldReturnSwitchStateEnabledAndOff() {
+        mSwitchPreference.setEnabled(false);
+        mSwitchPreference.setChecked(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mWifiTetheringHandler.handleWifiApStateChanged(WifiManager.WIFI_AP_STATE_ENABLING);
+        mWifiTetheringHandler.handleWifiApStateChanged(WifiManager.WIFI_AP_STATE_FAILED);
+
+        assertThat(mSwitchPreference.isEnabled()).isTrue();
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    private static class TestWifiTetheringPreferenceController
+            extends PreferenceController<ColoredSwitchPreference>
+            implements WifiTetheringHandler.WifiTetheringAvailabilityListener{
+
+        TestWifiTetheringPreferenceController(Context context, String preferenceKey,
+                FragmentController fragmentController,
+                CarUxRestrictions uxRestrictions) {
+            super(context, preferenceKey, fragmentController, uxRestrictions);
+        }
+
+        @Override
+        protected Class<ColoredSwitchPreference> getPreferenceType() {
+            return ColoredSwitchPreference.class;
+        }
+
+        @Override
+        public void onWifiTetheringAvailable() {
+            getPreference().setChecked(true);
+        }
+
+        @Override
+        public void onWifiTetheringUnavailable() {
+            getPreference().setChecked(false);
+        }
+
+        @Override
+        public void enablePreference() {
+            getPreference().setEnabled(true);
+        }
+
+        @Override
+        public void disablePreference() {
+            getPreference().setEnabled(false);
+        }
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiDetailsActionButtonsPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiDetailsActionButtonsPreferenceControllerTest.java
new file mode 100644
index 000000000..8faf88934
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiDetailsActionButtonsPreferenceControllerTest.java
@@ -0,0 +1,134 @@
+/*
+ * Copyright (C) 2020 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static com.android.car.settings.common.ActionButtonsPreference.ActionButtons;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.Network;
+import android.net.NetworkInfo;
+import android.net.wifi.WifiInfo;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.ActionButtonsPreference;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiDetailsActionButtonsPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private ActionButtonsPreference mActionButtonsPreference;
+    private WifiDetailsActionButtonsPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private androidx.lifecycle.Lifecycle mMockLifecycle;
+    @Mock
+    private WifiEntry mMockWifiEntry;
+    @Mock
+    private WifiInfoProvider mMockWifiInfoProvider;
+    @Mock
+    private Network mMockNetwork;
+    @Mock
+    private NetworkInfo mMockNetworkInfo;
+    @Mock
+    private WifiInfo mMockWifiInfo;
+
+    @Before
+    public void setUp() {
+        mLifecycleOwner = new TestLifecycleOwner();
+        MockitoAnnotations.initMocks(this);
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mActionButtonsPreference = new ActionButtonsPreference(mContext);
+        when(mFragmentController.getSettingsLifecycle()).thenReturn(mMockLifecycle);
+        mPreferenceController = new WifiDetailsActionButtonsPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.init(mMockWifiEntry, mMockWifiInfoProvider);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController,
+                mActionButtonsPreference);
+
+        when(mMockWifiInfoProvider.getNetwork()).thenReturn(mMockNetwork);
+        when(mMockWifiInfoProvider.getNetworkInfo()).thenReturn(mMockNetworkInfo);
+        when(mMockWifiInfoProvider.getWifiInfo()).thenReturn(mMockWifiInfo);
+    }
+
+    @Test
+    public void updateState_connectNotNeeded_disconnectButtonShown() {
+        when(mMockWifiEntry.isSaved()).thenReturn(true);
+        when(mMockWifiEntry.canDisconnect()).thenReturn(true);
+        when(mMockWifiEntry.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_CONNECTED);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mActionButtonsPreference.getButton(ActionButtons.BUTTON2).isVisible()).isTrue();
+        assertThat(mActionButtonsPreference.getButton(ActionButtons.BUTTON2).getText().toString())
+                .isEqualTo(ResourceTestUtils.getString(mContext, "disconnect"));
+    }
+
+    @Test
+    public void updateState_needConnect_connectButtonShown() {
+        when(mMockWifiEntry.isSaved()).thenReturn(true);
+        when(mMockWifiEntry.canConnect()).thenReturn(true);
+        when(mMockWifiEntry.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_DISCONNECTED);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mActionButtonsPreference.getButton(ActionButtons.BUTTON2).isVisible()).isTrue();
+        assertThat(mActionButtonsPreference.getButton(ActionButtons.BUTTON2).getText().toString())
+                .isEqualTo(ResourceTestUtils.getString(mContext, "wifi_setup_connect"));
+    }
+
+    @Test
+    public void updateState_canForget_forgetButtonShown() {
+        when(mMockWifiEntry.isSaved()).thenReturn(true);
+        when(mMockWifiEntry.canForget()).thenReturn(true);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mActionButtonsPreference.getButton(ActionButtons.BUTTON1).isVisible()).isTrue();
+    }
+
+    @Test
+    public void updateState_canNotForget_forgetButtonHidden() {
+        when(mMockWifiEntry.isSaved()).thenReturn(true);
+        when(mMockWifiEntry.canForget()).thenReturn(false);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+        assertThat(mActionButtonsPreference.getButton(ActionButtons.BUTTON1).isVisible()).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiDetailsBasePreferenceControllerTestCase.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiDetailsBasePreferenceControllerTestCase.java
new file mode 100644
index 000000000..037d348cb
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiDetailsBasePreferenceControllerTestCase.java
@@ -0,0 +1,98 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+public abstract class WifiDetailsBasePreferenceControllerTestCase {
+
+    protected Context mContext = ApplicationProvider.getApplicationContext();
+    protected WifiDetailsPreference mPreference;
+    protected LifecycleOwner mLifecycleOwner;
+    protected CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    protected FragmentController mFragmentController;
+    @Mock
+    protected WifiEntry mMockWifiEntry;
+    @Mock
+    protected WifiInfoProvider mMockWifiInfoProvider;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new WifiDetailsPreference(mContext);
+        getController().init(mMockWifiEntry, mMockWifiInfoProvider);
+        PreferenceControllerTestUtil.assignPreference(getController(), mPreference);
+        initTest();
+    }
+
+    @Test
+    public void onCreate_connected_shouldHaveDetailTextSet() {
+        setUpConnectedState();
+        getController().onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getDetailText()).isEqualTo(getDesiredDetailText());
+    }
+
+    @Test
+    public void onWifiChanged_isNotActive_preferenceNotVisible() {
+        setUpDisconnectedState();
+        getController().onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+
+    protected void initTest() {
+    }
+
+    protected abstract WifiDetailsBasePreferenceController<WifiDetailsPreference> getController();
+
+    protected void setUpConnectedState() {
+        when(mMockWifiEntry.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_CONNECTED);
+    }
+
+    protected void setUpDisconnectedState() {
+        when(mMockWifiEntry.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_DISCONNECTED);
+    }
+
+    protected abstract String getDesiredDetailText();
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiFrequencyPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiFrequencyPreferenceControllerTest.java
new file mode 100644
index 000000000..82a09e917
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiFrequencyPreferenceControllerTest.java
@@ -0,0 +1,61 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static org.mockito.Mockito.when;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.testutils.ResourceTestUtils;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiFrequencyPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase {
+
+    private WifiFrequencyPreferenceController mPreferenceController;
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiFrequencyPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        WifiEntry.ConnectedInfo connectedInfo = new WifiEntry.ConnectedInfo();
+        connectedInfo.frequencyMhz = WifiEntry.FREQUENCY_2_4_GHZ;
+        when(mMockWifiEntry.getConnectedInfo()).thenReturn(connectedInfo);
+    }
+
+    @Override
+    protected void setUpDisconnectedState() {
+        super.setUpDisconnectedState();
+        when(mMockWifiEntry.getConnectedInfo()).thenReturn(null);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return ResourceTestUtils.getString(mContext, "wifi_band_24ghz");
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiGatewayPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiGatewayPreferenceControllerTest.java
new file mode 100644
index 000000000..a0312aaa9
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiGatewayPreferenceControllerTest.java
@@ -0,0 +1,82 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static org.mockito.Mockito.when;
+
+import android.net.IpPrefix;
+import android.net.LinkProperties;
+import android.net.RouteInfo;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+
+import java.net.InetAddress;
+import java.util.Arrays;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiGatewayPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase {
+    private static final String GATE_WAY = "gateway";
+
+    private WifiGatewayPreferenceController mPreferenceController;
+
+    @Mock
+    private LinkProperties mMockLinkProperties;
+    @Mock
+    private RouteInfo mMockRouteInfo;
+    @Mock
+    private InetAddress mMockInetAddress;
+    @Mock
+    private IpPrefix mMockIpPrefix;
+
+    @Override
+    protected void initTest() {
+        when(mMockWifiInfoProvider.getLinkProperties()).thenReturn(mMockLinkProperties);
+    }
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiGatewayPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        when(mMockLinkProperties.getRoutes()).thenReturn(Arrays.asList(mMockRouteInfo));
+        when(mMockRouteInfo.isDefaultRoute()).thenReturn(true);
+        try {
+            when(mMockRouteInfo.getDestination()).thenReturn(mMockIpPrefix);
+            when(mMockIpPrefix.getAddress()).thenReturn(
+                    InetAddress.getByAddress(new byte[]{4, 3, 2, 1}));
+        } catch (Exception e) { }
+        when(mMockRouteInfo.hasGateway()).thenReturn(true);
+        when(mMockRouteInfo.getGateway()).thenReturn(mMockInetAddress);
+        when(mMockInetAddress.getHostAddress()).thenReturn(GATE_WAY);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return GATE_WAY;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiInfoProviderTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiInfoProviderTest.java
new file mode 100644
index 000000000..66583fc0c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiInfoProviderTest.java
@@ -0,0 +1,207 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.ArgumentMatchers.nullable;
+import static org.mockito.Mockito.doNothing;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.net.ConnectivityManager;
+import android.net.LinkProperties;
+import android.net.Network;
+import android.net.NetworkCapabilities;
+import android.net.NetworkInfo;
+import android.net.NetworkRequest;
+import android.net.wifi.WifiConfiguration;
+import android.net.wifi.WifiInfo;
+import android.net.wifi.WifiManager;
+import android.os.Handler;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.ArgumentCaptor;
+import org.mockito.Captor;
+import org.mockito.Mock;
+import org.mockito.Mockito;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiInfoProviderTest {
+    private static final int LEVEL = 1;
+    private static final int RSSI = -55;
+    private static final int LINK_SPEED = 123;
+    private static final String MAC_ADDRESS = WifiInfo.DEFAULT_MAC_ADDRESS;
+    private static final String SECURITY = "None";
+
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private WifiInfoProvider mWifiInfoProvider;
+
+    @Mock
+    private WifiEntry mMockWifiEntry;
+    @Mock
+    private ConnectivityManager mMockConnectivityManager;
+    @Mock
+    private Network mMockNetwork;
+    @Mock
+    private NetworkInfo mMockNetworkInfo;
+    @Mock
+    private WifiConfiguration mMockWifiConfig;
+    @Mock
+    private WifiInfo mMockWifiInfo;
+    @Mock
+    private LinkProperties mMockLinkProperties;
+    @Mock
+    private LinkProperties mMockChangedLinkProperties;
+    @Mock
+    private NetworkCapabilities mMockNetworkCapabilities;
+    @Mock
+    private NetworkCapabilities mMockChangedNetworkCapabilities;
+    @Mock
+    private WifiManager mMockWifiManager;
+    @Mock
+    private WifiInfoProvider.Listener mMockListener;
+
+    @Captor
+    private ArgumentCaptor<ConnectivityManager.NetworkCallback> mCallbackCaptor;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        when(mContext.getSystemService(ConnectivityManager.class))
+                .thenReturn(mMockConnectivityManager);
+        when(mContext.getSystemService(WifiManager.class)).thenReturn(mMockWifiManager);
+        when(mMockWifiEntry.getWifiConfiguration()).thenReturn(mMockWifiConfig);
+        when(mMockWifiEntry.getLevel()).thenReturn(LEVEL);
+        when(mMockWifiEntry.getSecurityString(false)).thenReturn(SECURITY);
+        when(mMockConnectivityManager.getNetworkInfo(any(Network.class)))
+                .thenReturn(mMockNetworkInfo);
+        when(mMockConnectivityManager.getLinkProperties(any(Network.class)))
+                .thenReturn(mMockLinkProperties);
+        when(mMockConnectivityManager.getNetworkCapabilities(any(Network.class)))
+                .thenReturn(mMockNetworkCapabilities);
+        doNothing().when(mMockConnectivityManager).registerNetworkCallback(
+                nullable(NetworkRequest.class), mCallbackCaptor.capture(), nullable(Handler.class));
+        when(mMockWifiInfo.getLinkSpeed()).thenReturn(LINK_SPEED);
+        when(mMockWifiInfo.getRssi()).thenReturn(RSSI);
+        when(mMockWifiInfo.getMacAddress()).thenReturn(MAC_ADDRESS);
+        when(mMockWifiManager.getConnectionInfo()).thenReturn(mMockWifiInfo);
+
+        when(mMockWifiManager.getCurrentNetwork()).thenReturn(mMockNetwork);
+
+        mWifiInfoProvider = new WifiInfoProvider(mContext, mMockWifiEntry);
+        mWifiInfoProvider.addListener(mMockListener);
+    }
+
+    @Test
+    public void onStart_allFieldsInitialized() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+
+        assertThat(mWifiInfoProvider.getNetworkInfo()).isNotNull();
+        assertThat(mWifiInfoProvider.getWifiInfo()).isNotNull();
+        assertThat(mWifiInfoProvider.getNetwork()).isNotNull();
+        assertThat(mWifiInfoProvider.getNetworkCapabilities()).isNotNull();
+        assertThat(mWifiInfoProvider.getNetworkConfiguration()).isNotNull();
+        assertThat(mWifiInfoProvider.getLinkProperties()).isNotNull();
+    }
+
+    @Test
+    public void onStart_listenerCallback() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+        verify(mMockListener).onWifiEntryUpdated();
+    }
+
+    @Test
+    public void onStart_getsNetwork() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+        assertThat(mWifiInfoProvider.getNetwork()).isEqualTo(mMockNetwork);
+    }
+
+    @Test
+    public void networkCallback_shouldBeRegisteredOnStart() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+
+        verify(mMockConnectivityManager).registerNetworkCallback(
+                nullable(NetworkRequest.class), mCallbackCaptor.capture(), nullable(Handler.class));
+    }
+
+    @Test
+    public void networkCallback_shouldBeUnregisteredOnStop() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+        mWifiInfoProvider.onStop(mLifecycleOwner);
+
+        verify(mMockConnectivityManager)
+                .unregisterNetworkCallback(mCallbackCaptor.getValue());
+    }
+
+    @Test
+    public void onWifiEntryUpdated_listenerCallback() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+        Mockito.reset(mMockListener);
+        mWifiInfoProvider.onUpdated();
+
+        verify(mMockListener).onWifiEntryUpdated();
+    }
+
+    @Test
+    public void onLost_listenerCallback() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+
+        mCallbackCaptor.getValue().onLost(mMockNetwork);
+
+        verify(mMockListener).onLost(any(Network.class));
+    }
+
+    @Test
+    public void onLinkPropertiesChanged_listenerCallback() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+
+        mCallbackCaptor.getValue().onLinkPropertiesChanged(
+                mMockNetwork, mMockChangedLinkProperties);
+
+        verify(mMockListener).onLinkPropertiesChanged(
+                any(Network.class), eq(mMockChangedLinkProperties));
+    }
+
+    @Test
+    public void onCapabilitiesChanged_listenerCallback() {
+        mWifiInfoProvider.onStart(mLifecycleOwner);
+
+        mCallbackCaptor.getValue().onCapabilitiesChanged(
+                mMockNetwork, mMockChangedNetworkCapabilities);
+
+        verify(mMockListener).onCapabilitiesChanged(
+                any(Network.class), eq(mMockChangedNetworkCapabilities));
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiIpAddressPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiIpAddressPreferenceControllerTest.java
new file mode 100644
index 000000000..fb4b8ce38
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiIpAddressPreferenceControllerTest.java
@@ -0,0 +1,72 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static org.mockito.Mockito.when;
+
+import android.net.LinkAddress;
+import android.net.LinkProperties;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+
+import java.net.Inet4Address;
+import java.net.InetAddress;
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiIpAddressPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase {
+
+    private WifiIpAddressPreferenceController mPreferenceController;
+
+    @Mock
+    private LinkProperties mMockLinkProperties;
+    @Mock
+    private LinkAddress mMockLinkAddress;
+
+    @Override
+    protected void initTest() {
+        when(mMockWifiInfoProvider.getLinkProperties()).thenReturn(mMockLinkProperties);
+        when(mMockLinkProperties.getLinkAddresses()).thenReturn(Collections.emptyList());
+    }
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiIpAddressPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        when(mMockLinkProperties.getLinkAddresses()).thenReturn(
+                Collections.singletonList(mMockLinkAddress));
+        InetAddress address = Inet4Address.LOOPBACK;
+        when(mMockLinkAddress.getAddress()).thenReturn(address);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return "127.0.0.1";
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiIpv6AddressPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiIpv6AddressPreferenceControllerTest.java
new file mode 100644
index 000000000..1b82de75e
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiIpv6AddressPreferenceControllerTest.java
@@ -0,0 +1,106 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.net.LinkAddress;
+import android.net.LinkProperties;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.wifitrackerlib.WifiEntry;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+import java.net.Inet6Address;
+import java.net.InetAddress;
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiIpv6AddressPreferenceControllerTest {
+
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private Preference mPreference;
+    private WifiIpv6AddressPreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private WifiEntry mMockWifiEntry;
+    @Mock
+    private WifiInfoProvider mMockWifiInfoProvider;
+    @Mock
+    private LinkProperties mMockLinkProperties;
+    @Mock
+    private LinkAddress mMockLinkAddress;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mPreference = new Preference(mContext);
+        mPreferenceController = new WifiIpv6AddressPreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.init(mMockWifiEntry, mMockWifiInfoProvider);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mPreference);
+        when(mMockWifiInfoProvider.getLinkProperties()).thenReturn(mMockLinkProperties);
+        when(mMockLinkProperties.getLinkAddresses()).thenReturn(Collections.emptyList());
+    }
+
+    @Test
+    public void onCreate_hasIpv6Address_summaryTextSet() {
+        when(mMockWifiEntry.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_CONNECTED);
+        when(mMockLinkProperties.getLinkAddresses()).thenReturn(
+                Collections.singletonList(mMockLinkAddress));
+        InetAddress address = Inet6Address.LOOPBACK;
+        when(mMockLinkAddress.getAddress()).thenReturn(address);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isTrue();
+        assertThat(mPreference.getSummary()).isEqualTo("::1");
+    }
+
+    @Test
+    public void onCreate_isNotActive_preferenceNotVisible() {
+        when(mMockWifiEntry.getConnectedState()).thenReturn(WifiEntry.CONNECTED_STATE_DISCONNECTED);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiLinkSpeedPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiLinkSpeedPreferenceControllerTest.java
new file mode 100644
index 000000000..34a40df3c
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiLinkSpeedPreferenceControllerTest.java
@@ -0,0 +1,78 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.Mockito.when;
+
+import android.net.wifi.WifiInfo;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiLinkSpeedPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase {
+    private static final int VALID_LINK_SPEED = 100;
+
+    private WifiLinkSpeedPreferenceController mPreferenceController;
+
+    @Mock
+    private WifiInfo mMockWifiInfo;
+
+    @Override
+    protected void initTest() {
+        when(mMockWifiInfoProvider.getWifiInfo()).thenReturn(mMockWifiInfo);
+    }
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiLinkSpeedPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        when(mMockWifiInfo.getLinkSpeed()).thenReturn(VALID_LINK_SPEED);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return mContext.getString(R.string.link_speed, VALID_LINK_SPEED);
+    }
+
+    @Test
+    public void onCreate_negativeLinkSpeed_preferenceNotVisible() {
+        super.setUpConnectedState();
+        int linkSpeed = -1;
+        when(mMockWifiInfo.getLinkSpeed()).thenReturn(linkSpeed);
+
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mPreference.isVisible()).isFalse();
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiMacAddressPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiMacAddressPreferenceControllerTest.java
new file mode 100644
index 000000000..4f4301c85
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiMacAddressPreferenceControllerTest.java
@@ -0,0 +1,57 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static org.mockito.Mockito.when;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiMacAddressPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase {
+    private static final String MAC_ADDRESS = "mac_address";
+
+    private WifiMacAddressPreferenceController mPreferenceController;
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiMacAddressPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        when(mMockWifiEntry.getMacAddress()).thenReturn(MAC_ADDRESS);
+    }
+
+    @Override
+    protected void setUpDisconnectedState() {
+        super.setUpDisconnectedState();
+        when(mMockWifiEntry.getMacAddress()).thenReturn(null);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return MAC_ADDRESS;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSecurityPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSecurityPreferenceControllerTest.java
new file mode 100644
index 000000000..8df026560
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSecurityPreferenceControllerTest.java
@@ -0,0 +1,52 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static org.mockito.ArgumentMatchers.anyBoolean;
+import static org.mockito.Mockito.when;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiSecurityPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase {
+    private static final String TEST_SECURITY_STRING = "test_security";
+
+    private WifiSecurityPreferenceController mPreferenceController;
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiSecurityPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        when(mMockWifiEntry.getSecurityString(anyBoolean())).thenReturn(TEST_SECURITY_STRING);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return TEST_SECURITY_STRING;
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSignalStrengthPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSignalStrengthPreferenceControllerTest.java
new file mode 100644
index 000000000..c96d715ea
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSignalStrengthPreferenceControllerTest.java
@@ -0,0 +1,53 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static org.mockito.Mockito.when;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+
+import org.junit.runner.RunWith;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiSignalStrengthPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase {
+    private static final int LEVEL = 1;
+
+    private WifiSignalStrengthPreferenceController mPreferenceController;
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiSignalStrengthPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        when(mMockWifiEntry.getLevel()).thenReturn(LEVEL);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return mContext.getResources().getStringArray(R.array.wifi_signals)[LEVEL];
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSubnetPreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSubnetPreferenceControllerTest.java
new file mode 100644
index 000000000..78edf360f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/details/WifiSubnetPreferenceControllerTest.java
@@ -0,0 +1,72 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.details;
+
+import static org.mockito.Mockito.when;
+
+import android.net.LinkAddress;
+import android.net.LinkProperties;
+
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+
+import java.net.Inet4Address;
+import java.net.InetAddress;
+import java.util.Collections;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiSubnetPreferenceControllerTest
+        extends WifiDetailsBasePreferenceControllerTestCase{
+
+    private WifiSubnetPreferenceController mPreferenceController;
+
+    @Mock
+    private LinkProperties mMockLinkProperties;
+    @Mock
+    private LinkAddress mMockLinkAddress;
+
+    @Override
+    protected void initTest() {
+        when(mMockWifiInfoProvider.getLinkProperties()).thenReturn(mMockLinkProperties);
+        when(mMockLinkProperties.getLinkAddresses()).thenReturn(Collections.emptyList());
+    }
+
+    @Override
+    protected WifiDetailsBasePreferenceController<WifiDetailsPreference> getController() {
+        if (mPreferenceController == null) {
+            mPreferenceController = new WifiSubnetPreferenceController(mContext,
+                    /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        }
+        return mPreferenceController;
+    }
+
+    @Override
+    protected void setUpConnectedState() {
+        super.setUpConnectedState();
+        when(mMockLinkProperties.getLinkAddresses()).thenReturn(
+                Collections.singletonList(mMockLinkAddress));
+        InetAddress address = Inet4Address.LOOPBACK;
+        when(mMockLinkAddress.getAddress()).thenReturn(address);
+    }
+
+    @Override
+    protected String getDesiredDetailText() {
+        return "0.0.0.0";
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/preferences/CellularFallbackTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/preferences/CellularFallbackTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..dee7f104f
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/preferences/CellularFallbackTogglePreferenceControllerTest.java
@@ -0,0 +1,105 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.preferences;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.provider.Settings;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+
+@RunWith(AndroidJUnit4.class)
+public class CellularFallbackTogglePreferenceControllerTest {
+    private Context mContext = ApplicationProvider.getApplicationContext();
+    private LifecycleOwner mLifecycleOwner;
+    private SwitchPreference mSwitchPreference;
+    private CellularFallbackTogglePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+
+    @Mock
+    private FragmentController mFragmentController;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        mSwitchPreference = new SwitchPreference(mContext);
+        mPreferenceController = new CellularFallbackTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+        mPreferenceController.onCreate(mLifecycleOwner);
+    }
+
+    @Test
+    public void refreshUi_unchecked() {
+        Settings.Global.putString(mContext.getContentResolver(),
+                Settings.Global.NETWORK_AVOID_BAD_WIFI, null);
+        mSwitchPreference.setChecked(true);
+
+        mPreferenceController.refreshUi();
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void refreshUi_checked() {
+        Settings.Global.putString(mContext.getContentResolver(),
+                Settings.Global.NETWORK_AVOID_BAD_WIFI, "1");
+        mSwitchPreference.setChecked(false);
+
+        mPreferenceController.refreshUi();
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void handlePreferenceChanged_toggleFalse_setsNull() {
+        Settings.Global.putString(mContext.getContentResolver(),
+                Settings.Global.NETWORK_AVOID_BAD_WIFI, "1");
+
+        mSwitchPreference.callChangeListener(false);
+        assertThat(Settings.Global.getString(mContext.getContentResolver(),
+                Settings.Global.NETWORK_AVOID_BAD_WIFI)).isNull();
+    }
+
+    @Test
+    public void handlePreferenceChanged_toggleTrue_setsEnabled() {
+        Settings.Global.putString(mContext.getContentResolver(),
+                Settings.Global.NETWORK_AVOID_BAD_WIFI, null);
+
+        mSwitchPreference.callChangeListener(true);
+        assertThat(Settings.Global.getString(mContext.getContentResolver(),
+                Settings.Global.NETWORK_AVOID_BAD_WIFI)).isEqualTo("1");
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settings/wifi/preferences/WifiWakeupTogglePreferenceControllerTest.java b/tests/multivalent/src/com/android/car/settings/wifi/preferences/WifiWakeupTogglePreferenceControllerTest.java
new file mode 100644
index 000000000..cdc15dc20
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settings/wifi/preferences/WifiWakeupTogglePreferenceControllerTest.java
@@ -0,0 +1,255 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.wifi.preferences;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.ArgumentMatchers.anyInt;
+import static org.mockito.ArgumentMatchers.anyString;
+import static org.mockito.ArgumentMatchers.eq;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+import static org.mockito.Mockito.when;
+import static org.mockito.Mockito.withSettings;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+import android.location.LocationManager;
+import android.net.wifi.WifiManager;
+import android.provider.Settings;
+import android.widget.Toast;
+
+import androidx.lifecycle.LifecycleOwner;
+import androidx.preference.SwitchPreference;
+import androidx.test.annotation.UiThreadTest;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+
+import com.android.car.settings.R;
+import com.android.car.settings.common.ColoredSwitchPreference;
+import com.android.car.settings.common.ConfirmationDialogFragment;
+import com.android.car.settings.common.FragmentController;
+import com.android.car.settings.common.PreferenceControllerTestUtil;
+import com.android.car.settings.location.LocationSettingsFragment;
+import com.android.car.settings.testutils.TestLifecycleOwner;
+import com.android.dx.mockito.inline.extended.ExtendedMockito;
+
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+import org.mockito.Mock;
+import org.mockito.MockitoAnnotations;
+import org.mockito.MockitoSession;
+
+@RunWith(AndroidJUnit4.class)
+public class WifiWakeupTogglePreferenceControllerTest {
+    private Context mContext = spy(ApplicationProvider.getApplicationContext());
+    private LifecycleOwner mLifecycleOwner;
+    private SwitchPreference mSwitchPreference;
+    private WifiWakeupTogglePreferenceController mPreferenceController;
+    private CarUxRestrictions mCarUxRestrictions;
+    private MockitoSession mSession;
+
+    @Mock
+    private FragmentController mFragmentController;
+    @Mock
+    private LocationManager mLocationManager;
+    @Mock
+    private WifiManager mWifiManager;
+    @Mock
+    private Toast mMockToast;
+
+    @Before
+    public void setUp() {
+        MockitoAnnotations.initMocks(this);
+        mLifecycleOwner = new TestLifecycleOwner();
+
+        mCarUxRestrictions = new CarUxRestrictions.Builder(/* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE, /* timestamp= */ 0).build();
+
+        when(mContext.getSystemService(LocationManager.class)).thenReturn(mLocationManager);
+
+        mSwitchPreference = new ColoredSwitchPreference(mContext);
+        mPreferenceController = new WifiWakeupTogglePreferenceController(mContext,
+                /* preferenceKey= */ "key", mFragmentController, mCarUxRestrictions);
+        mPreferenceController.mWifiManager = mWifiManager;
+        PreferenceControllerTestUtil.assignPreference(mPreferenceController, mSwitchPreference);
+
+        mSession = ExtendedMockito.mockitoSession().mockStatic(Toast.class,
+                withSettings().lenient()).startMocking();
+    }
+
+    @After
+    public void tearDown() {
+        if (mSession != null) {
+            mSession.finishMocking();
+        }
+    }
+
+    @Test
+    @UiThreadTest
+    public void handlePreferenceClicked_locationDisabled_launchFragment() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        verify(mFragmentController).launchFragment(any(LocationSettingsFragment.class));
+    }
+
+    @Test
+    public void handlePreferenceClicked_wifiWakeupEnabled_disablesWifiWakeup() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                1);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        assertThat(Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.WIFI_WAKEUP_ENABLED, 1))
+                .isEqualTo(0);
+    }
+
+    @Test
+    public void handlePreferenceClicked_wifiScanningDisabled_showsDialog() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(false);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                0);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        verify(mFragmentController).showDialog(any(ConfirmationDialogFragment.class),
+                eq(ConfirmationDialogFragment.TAG));
+    }
+
+    @Test
+    public void handlePreferenceClicked_wifiScanningEnabled_wifiWakeupDisabled_enablesWifiWakeup() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                0);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mSwitchPreference.performClick();
+
+        assertThat(Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.WIFI_WAKEUP_ENABLED, 0))
+                .isEqualTo(1);
+    }
+
+    @Test
+    public void onCreate_wifiWakeupEnabled_wifiScanningEnabled_locationEnabled_isChecked() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                1);
+        mSwitchPreference.setChecked(false);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mSwitchPreference.isChecked()).isTrue();
+    }
+
+    @Test
+    public void onCreate_wifiWakeupDisabled_wifiScanningEnabled_locationEnabled_isNotChecked() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                0);
+        mSwitchPreference.setChecked(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onCreate_wifiWakeupEnabled_wifiScanningDisabled_locationEnabled_isNotChecked() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(false);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                1);
+        mSwitchPreference.setChecked(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    public void onCreate_wifiWakeupEnabled_wifiScanningEnabled_locationDisabled_isNotChecked() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(false);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(true);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                1);
+        mSwitchPreference.setChecked(true);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+
+        assertThat(mSwitchPreference.isChecked()).isFalse();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onConfirmWifiScanning_setsWifiScanningOn() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(false);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                0);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mConfirmListener.onConfirm(/* arguments= */ null);
+
+        verify(mWifiManager).setScanAlwaysAvailable(true);
+    }
+
+    @Test
+    @UiThreadTest
+    public void onConfirmWifiScanning_showsToast() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        String toastString = mContext.getString(R.string.wifi_settings_scanning_required_enabled);
+        ExtendedMockito.when(Toast.makeText(any(), eq(toastString), anyInt()))
+                .thenReturn(mMockToast);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(false);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                0);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mConfirmListener.onConfirm(/* arguments= */ null);
+
+        verify(mMockToast).show();
+    }
+
+    @Test
+    @UiThreadTest
+    public void onConfirmWifiScanning_enablesWifiWakeup() {
+        when(mLocationManager.isLocationEnabled()).thenReturn(true);
+        ExtendedMockito.when(Toast.makeText(any(), anyString(), anyInt())).thenReturn(mMockToast);
+        when(mWifiManager.isScanAlwaysAvailable()).thenReturn(false);
+        Settings.Global.putInt(mContext.getContentResolver(), Settings.Global.WIFI_WAKEUP_ENABLED,
+                0);
+        mPreferenceController.onCreate(mLifecycleOwner);
+
+        mPreferenceController.mConfirmListener.onConfirm(/* arguments= */ null);
+
+        assertThat(Settings.Global.getInt(mContext.getContentResolver(),
+                Settings.Global.WIFI_WAKEUP_ENABLED, 0)).isEqualTo(1);
+    }
+}
diff --git a/tests/multivalent/src/com/android/car/settingslib/enterprise/EnterprisePrivacyFeatureProviderImplTest.java b/tests/multivalent/src/com/android/car/settingslib/enterprise/EnterprisePrivacyFeatureProviderImplTest.java
new file mode 100644
index 000000000..e64d7e5d7
--- /dev/null
+++ b/tests/multivalent/src/com/android/car/settingslib/enterprise/EnterprisePrivacyFeatureProviderImplTest.java
@@ -0,0 +1,206 @@
+/*
+ * Copyright (C) 2021 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package com.android.car.settingslib.enterprise;
+
+import static com.google.common.truth.Truth.assertWithMessage;
+
+import static org.mockito.Mockito.doReturn;
+import static org.mockito.Mockito.doThrow;
+import static org.mockito.Mockito.when;
+
+import android.content.pm.ApplicationInfo;
+import android.content.pm.PackageManager;
+import android.provider.Settings;
+
+import com.android.car.settings.enterprise.BaseEnterpriseTestCase;
+
+import org.junit.Before;
+import org.junit.Test;
+import org.mockito.Mock;
+
+import java.util.Date;
+
+// TODO(b/208511815): move to SettingsLib
+public final class EnterprisePrivacyFeatureProviderImplTest extends BaseEnterpriseTestCase {
+
+    private static final String IME_PACKAGE_NAME = "acme.keyboards";
+    private static final String IME_PACKAGE_LABEL = "ACME Keyboards";
+
+    private EnterprisePrivacyFeatureProviderImpl mProvider;
+
+    @Mock
+    private ApplicationInfo mApplicationInfo;
+
+    @Before
+    public void setProvider() {
+        mProvider = new EnterprisePrivacyFeatureProviderImpl(mSpiedContext, mDpm, mSpiedPm);
+    }
+
+    @Test
+    public void testGetLastBugReportRequestTime_none() {
+        mockGetLastBugreportTime(-1);
+
+        assertWithMessage("getLastBugReportRequestTime()")
+                .that(mProvider.getLastBugReportRequestTime()).isNull();
+    }
+
+    @Test
+    public void testGetLastBugReportRequestTime_ok() {
+        long now = System.currentTimeMillis();
+        mockGetLastBugreportTime(now);
+
+        Date last = mProvider.getLastBugReportRequestTime();
+        assertWithMessage("getLastBugReportRequestTime()").that(last).isNotNull();
+        assertWithMessage("getLastBugReportRequestTime().getTime()").that(last.getTime())
+                .isEqualTo(now);
+    }
+
+    @Test
+    public void testGetLastNetworkLogRetrievalTime_none() {
+        mockGetLastNetworkLogRetrievalTime(-1);
+
+        assertWithMessage("getLastNetworkLogRetrievalTime()")
+                .that(mProvider.getLastNetworkLogRetrievalTime()).isNull();
+    }
+
+    @Test
+    public void testGetLastNetworkLogRetrievalTime_ok() {
+        long now = System.currentTimeMillis();
+        mockGetLastNetworkLogRetrievalTime(now);
+
+        Date last = mProvider.getLastNetworkLogRetrievalTime();
+        assertWithMessage("getLastNetworkLogRetrievalTime()").that(last).isNotNull();
+        assertWithMessage("getLastNetworkLogRetrievalTime().getTime()").that(last.getTime())
+                .isEqualTo(now);
+    }
+
+    @Test
+    public void testGetLastSecurityLogRetrievalTime_none() {
+        mockGetLastSecurityLogRetrievalTime(-1);
+
+        assertWithMessage("getLastSecurityLogRetrievalTime()")
+                .that(mProvider.getLastSecurityLogRetrievalTime()).isNull();
+    }
+
+    @Test
+    public void testGetLastSecurityLogRetrievalTime_ok() {
+        long now = System.currentTimeMillis();
+        mockGetLastSecurityLogRetrievalTime(now);
+
+        Date last = mProvider.getLastSecurityLogRetrievalTime();
+        assertWithMessage("getLastSecurityLogRetrievalTime()").that(last).isNotNull();
+        assertWithMessage("getLastSecurityLogRetrievalTime().getTime()").that(last.getTime())
+                .isEqualTo(now);
+    }
+
+    @Test
+    public void testGetImeLabelIfOwnerSet_notSet() {
+        mockIsCurrentInputMethodSetByOwner(false);
+
+        assertWithMessage("getImeLabelIfOwnerSet()").that(mProvider.getImeLabelIfOwnerSet())
+                .isNull();
+    }
+
+    @Test
+    public void testGetImeLabelIfOwnerSet_nullString() {
+        mockIsCurrentInputMethodSetByOwner(true);
+        mockDefaultInputMehtodSettings(null);
+
+        assertWithMessage("getImeLabelIfOwnerSet()").that(mProvider.getImeLabelIfOwnerSet())
+                .isNull();
+    }
+
+    @Test
+    public void testGetImeLabelIfOwnerSet_emptyString() {
+        mockIsCurrentInputMethodSetByOwner(true);
+        mockDefaultInputMehtodSettings("");
+
+        assertWithMessage("getImeLabelIfOwnerSet()").that(mProvider.getImeLabelIfOwnerSet())
+                .isNull();
+    }
+
+    @Test
+    public void testGetImeLabelIfOwnerSet_nonexistentPackage() throws Exception {
+        mockIsCurrentInputMethodSetByOwner(true);
+        mockDefaultInputMehtodSettings(IME_PACKAGE_NAME);
+        mockGetApplicationInfoNotFound(IME_PACKAGE_NAME);
+
+        assertWithMessage("getImeLabelIfOwnerSet()").that(mProvider.getImeLabelIfOwnerSet())
+                .isNull();
+    }
+
+    @Test
+    public void testGetImeLabelIfOwnerSet_existentPackage() throws Exception {
+        mockIsCurrentInputMethodSetByOwner(true);
+        mockDefaultInputMehtodSettings(IME_PACKAGE_NAME);
+        mockGetApplicationInfoLabel(IME_PACKAGE_NAME, IME_PACKAGE_LABEL);
+
+        assertWithMessage("getImeLabelIfOwnerSet()").that(mProvider.getImeLabelIfOwnerSet())
+                .isEqualTo(IME_PACKAGE_LABEL);
+    }
+
+    @Test
+    public void testGetMaximumFailedPasswordsBeforeWipeInCurrentUser_notOwner() {
+        mockNoDeviceOwner();
+        mockNoProfileOwnerAsUser();
+        mockGetMaximumFailedPasswordsForWipe(MY_USER_ID.getIdentifier(), 42);
+
+        assertWithMessage("getMaximumFailedPasswordsBeforeWipeInCurrentUser()")
+                .that(mProvider.getMaximumFailedPasswordsBeforeWipeInCurrentUser())
+                .isEqualTo(0);
+    }
+
+    @Test
+    public void testGetMaximumFailedPasswordsBeforeWipeInCurrentUser_deviceOwner() {
+        mockDeviceOwner();
+        mockNoProfileOwnerAsUser();
+        mockGetMaximumFailedPasswordsForWipe(MY_USER_ID.getIdentifier(), 42);
+
+        assertWithMessage("getMaximumFailedPasswordsBeforeWipeInCurrentUser()")
+                .that(mProvider.getMaximumFailedPasswordsBeforeWipeInCurrentUser())
+                .isEqualTo(42);
+    }
+
+    @Test
+    public void testGetMaximumFailedPasswordsBeforeWipeInCurrentUser_profileOwner() {
+        mockNoDeviceOwner();
+        mockProfileOwnerAsUser();
+        mockGetMaximumFailedPasswordsForWipe(MY_USER_ID.getIdentifier(), 42);
+
+        assertWithMessage("getMaximumFailedPasswordsBeforeWipeInCurrentUser()")
+                .that(mProvider.getMaximumFailedPasswordsBeforeWipeInCurrentUser())
+                .isEqualTo(42);
+    }
+
+    private void mockDefaultInputMehtodSettings(String value) {
+        Settings.Secure.putString(mRealContext.getContentResolver(),
+                Settings.Secure.DEFAULT_INPUT_METHOD, value);
+    }
+
+    private void mockGetApplicationInfoNotFound(String packageName) throws Exception {
+        doThrow(new PackageManager.NameNotFoundException("D'OH!")).when(mSpiedPm)
+                .getApplicationInfoAsUser(packageName, /* flags= */ 0, MY_USER_ID);
+    }
+
+    private void mockGetApplicationInfoLabel(String packageName, CharSequence label)
+            throws Exception {
+        doReturn(mApplicationInfo).when(mSpiedPm).getApplicationInfoAsUser(packageName,
+                /* flags= */ 0, MY_USER_ID);
+        doReturn(mApplicationInfo).when(mSpiedPm).getApplicationInfoAsUser(packageName,
+                /* flags= */ 0, MY_USER_ID.getIdentifier());
+        when(mApplicationInfo.loadLabel(mSpiedPm)).thenReturn(label);
+    }
+}
diff --git a/tests/robotests/readme.md b/tests/robotests/readme.md
deleted file mode 100644
index abc4def97..000000000
--- a/tests/robotests/readme.md
+++ /dev/null
@@ -1,6 +0,0 @@
-Unit test suite for SettingsLib using Robolectric.
-
-```
-$ croot
-$ make RunCarSettingsRoboTests -j96
-```
\ No newline at end of file
diff --git a/tests/robotests/src/com/android/car/settings/testutils/ShadowCar.java b/tests/robotests/src/com/android/car/settings/testutils/ShadowCar.java
deleted file mode 100644
index 1b1db5362..000000000
--- a/tests/robotests/src/com/android/car/settings/testutils/ShadowCar.java
+++ /dev/null
@@ -1,129 +0,0 @@
-/*
- * Copyright (C) 2018 The Android Open Source Project
- *
- * Licensed under the Apache License, Version 2.0 (the "License");
- * you may not use this file except in compliance with the License.
- * You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package com.android.car.settings.testutils;
-
-import static org.mockito.Mockito.doAnswer;
-import static org.mockito.Mockito.doReturn;
-import static org.mockito.Mockito.mock;
-
-import android.car.Car;
-import android.car.Car.CarServiceLifecycleListener;
-import android.car.CarNotConnectedException;
-import android.content.Context;
-import android.content.ServiceConnection;
-import android.os.Handler;
-
-import org.mockito.stubbing.Answer;
-import org.robolectric.annotation.Implementation;
-import org.robolectric.annotation.Implements;
-import org.robolectric.annotation.Resetter;
-
-/**
- * Shadow class for {@link Car}. Components in car support library expects
- * this class to be available at run time.
- */
-@Implements(Car.class)
-public class ShadowCar {
-
-    private static Car sMockCar = mock(Car.class);
-    private static boolean sIsConnected;
-    private static String sServiceName;
-    private static Object sCarManager;
-
-    /**
-     * Returns a mocked version of a {@link Car} object.
-     */
-    @Implementation
-    protected static Car createCar(Context context, ServiceConnection serviceConnection) {
-        if (serviceConnection != null) {
-            doAnswer((Answer<Void>) invocation -> {
-                serviceConnection.onServiceConnected(null, null);
-                return null;
-            }).when(sMockCar).connect();
-            doAnswer((Answer<Void>) invocation -> {
-                serviceConnection.onServiceDisconnected(null);
-                return null;
-            }).when(sMockCar).disconnect();
-        }
-        doReturn(sIsConnected).when(sMockCar).isConnected();
-        if (sServiceName != null) {
-            try {
-                doReturn(sCarManager).when(sMockCar).getCarManager(sServiceName);
-            } catch (CarNotConnectedException e) {
-                // do nothing, have to do this because compiler doesn't understand mock can't throw
-                // exception.
-            }
-        }
-        return sMockCar;
-    }
-
-    /**
-     * Returns a mocked version of a {@link Car} object.
-     */
-    @Implementation
-    public static Car createCar(Context context,
-                                Handler handler,
-                                long waitTimeoutMs,
-                                CarServiceLifecycleListener statusChangeListener) {
-        return createCar(context, null);
-    }
-
-    /**
-     * Returns a mocked version of a {@link Car} object.
-     */
-    @Implementation
-    protected static Car createCar(Context context) {
-        doReturn(sIsConnected).when(sMockCar).isConnected();
-        if (sServiceName != null) {
-            try {
-                doReturn(sCarManager).when(sMockCar).getCarManager(sServiceName);
-            } catch (CarNotConnectedException e) {
-                // do nothing, have to do this because compiler doesn't understand mock can't throw
-                // exception.
-            }
-        }
-        return sMockCar;
-    }
-
-    /**
-     * Sets the manager returned by {@link Car#getCarManager(String)}.
-     *
-     * @param serviceName the name for the service request that should return this car manager.
-     * @param carManager  the object returned by a call with this service.
-     */
-    public static void setCarManager(String serviceName, Object carManager) {
-        sServiceName = serviceName;
-        sCarManager = carManager;
-        try {
-            doReturn(carManager).when(sMockCar).getCarManager(serviceName);
-        } catch (CarNotConnectedException e) {
-            // do nothing, have to do this because compiler doesn't understand mock can't throw e.
-        }
-    }
-
-    /**
-     * Resets the shadow state, note this will not remove stubbed behavior on references to older
-     * calls to {@link #createCar(Context, ServiceConnection)}.
-     */
-    @Resetter
-    public static void reset() {
-        sMockCar = mock(Car.class);
-        sServiceName = null;
-        sCarManager = null;
-        sIsConnected = false;
-    }
-}
diff --git a/tests/unit/Android.bp b/tests/unit/Android.bp
index 847dc43ac..ddcfab046 100644
--- a/tests/unit/Android.bp
+++ b/tests/unit/Android.bp
@@ -3,6 +3,12 @@ package {
     default_applicable_licenses: ["Android-Apache-2.0"],
 }
 
+/** TODO(b/368412197): DO NOT USE. Do not add new changes to `/unit`.
+    This will be removed in favior of same but multivalent capable tests.
+    Use `CarSettingsMultivalentDeviceTests` instead.  */
+
+// LINT.IfChange
+
 android_test {
     name: "CarSettingsUnitTests",
 
@@ -21,7 +27,7 @@ android_test {
     ],
 
     static_libs: [
-        "CarSettingsForUnitTesting",
+        "CarSettingsLibForDeviceTesting",
         "android.car",
         "android.car.test.utils",
         "androidx.test.core",
@@ -54,3 +60,5 @@ android_test {
     // TODO(b/319708040): re-enable use_resource_processor
     use_resource_processor: false,
 }
+
+// LINT.ThenChange(packages/apps/Car/Settings/tests/multivalent/Android.bp)
diff --git a/tests/unit/AndroidManifest.xml b/tests/unit/AndroidManifest.xml
index bf17969f3..a1d628363 100644
--- a/tests/unit/AndroidManifest.xml
+++ b/tests/unit/AndroidManifest.xml
@@ -139,6 +139,13 @@
             <meta-data android:name="distractionOptimized" android:value="true"/>
         </activity>
 
+        <activity
+            android:name="com.android.car.settings.testutils.TestSubSettingsActivity"
+            android:theme="@style/CarSettingTheme"
+            android:windowSoftInputMode="adjustPan">/>
+            <meta-data android:name="distractionOptimized" android:value="true"/>
+        </activity>
+
         <activity android:name="com.android.car.settings.notifications.NotificationAccessConfirmationActivity"
             android:taskAffinity="com.android.car.settings.notifications.NotificationAccessConfirmationActivity"
             android:theme="@android:style/Theme.DeviceDefault.Light.Dialog.Alert" />
diff --git a/tests/unit/src/com/android/car/settings/CarSettingsApplicationTest.java b/tests/unit/src/com/android/car/settings/CarSettingsApplicationTest.java
index bd6e1649a..1af45c23b 100644
--- a/tests/unit/src/com/android/car/settings/CarSettingsApplicationTest.java
+++ b/tests/unit/src/com/android/car/settings/CarSettingsApplicationTest.java
@@ -99,7 +99,7 @@ public class CarSettingsApplicationTest {
         }).when(mCarOccupantZoneManager).registerOccupantZoneConfigChangeListener(any());
 
         mCarSettingsApplication = new CarSettingsApplication();
-        mCarSettingsApplication.onCreate();
+        mCarSettingsApplication.registerCarServiceLifecycleListener();
     }
 
     @After
diff --git a/tests/unit/src/com/android/car/settings/common/DualPaneBaseCarSettingsActivityTest.java b/tests/unit/src/com/android/car/settings/common/DualPaneBaseCarSettingsActivityTest.java
index e4b2b5fcb..bb0c90c43 100644
--- a/tests/unit/src/com/android/car/settings/common/DualPaneBaseCarSettingsActivityTest.java
+++ b/tests/unit/src/com/android/car/settings/common/DualPaneBaseCarSettingsActivityTest.java
@@ -16,29 +16,24 @@
 
 package com.android.car.settings.common;
 
-import static com.google.common.truth.Truth.assertThat;
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
 
-import android.annotation.Nullable;
-import android.car.drivingstate.CarUxRestrictions;
+import android.content.Intent;
 
-import androidx.fragment.app.Fragment;
 import androidx.preference.Preference;
 import androidx.test.platform.app.InstrumentationRegistry;
 import androidx.test.rule.ActivityTestRule;
 
-import com.android.car.settings.R;
+import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
 import com.android.car.settings.testutils.BaseTestSettingsFragment;
 import com.android.car.settings.testutils.DualPaneTestActivity;
-import com.android.car.settings.testutils.EmptySettingsFragment;
-import com.android.car.settings.testutils.TestTopLevelMenuFragment;
-import com.android.car.ui.toolbar.NavButtonMode;
-import com.android.car.ui.toolbar.ToolbarController;
 
 import org.junit.Rule;
 import org.junit.Test;
 
-import java.util.concurrent.atomic.AtomicReference;
-
 public class DualPaneBaseCarSettingsActivityTest
         extends BaseCarSettingsActivityTestCase<DualPaneTestActivity> {
 
@@ -52,231 +47,17 @@ public class DualPaneBaseCarSettingsActivityTest
     }
 
     @Test
-    public void onPreferenceStartFragment_launchesFragment() throws Throwable {
+    public void onPreferenceStartFragment_startsActivity() throws Throwable {
         Preference pref = new Preference(mContext);
         pref.setFragment(BaseTestSettingsFragment.class.getName());
 
-        mActivityTestRule.runOnUiThread(() ->
-                mActivity.onPreferenceStartFragment(/* caller= */ null, pref));
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-
-        assertThat(mActivity.getSupportFragmentManager().findFragmentById(
-                R.id.fragment_container)).isInstanceOf(BaseTestSettingsFragment.class);
-    }
-
-    @Test
-    public void onUxRestrictionsChanged_topFragmentInBackStackHasUpdatedUxRestrictions()
-            throws Throwable {
-        CarUxRestrictions oldUxRestrictions = new CarUxRestrictions.Builder(
-                /* reqOpt= */ true,
-                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
-                /* timestamp= */ 0
-        ).build();
-
-        CarUxRestrictions newUxRestrictions = new CarUxRestrictions.Builder(
-                /* reqOpt= */ true,
-                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP,
-                /* timestamp= */ 0
-        ).build();
-
-        AtomicReference<BaseTestSettingsFragment> fragmentA = new AtomicReference<>();
-        AtomicReference<BaseTestSettingsFragment> fragmentB = new AtomicReference<>();
-
-        mActivityTestRule.runOnUiThread(() -> {
-            fragmentA.set(new BaseTestSettingsFragment());
-            fragmentB.set(new BaseTestSettingsFragment());
-            mActivity.launchFragment(fragmentA.get());
-            mActivity.onUxRestrictionsChanged(oldUxRestrictions);
-            mActivity.launchFragment(fragmentB.get());
-            mActivity.onUxRestrictionsChanged(newUxRestrictions);
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-
-        assertThat(
-                fragmentB.get().getUxRestrictions().isSameRestrictions(newUxRestrictions)).isTrue();
-    }
-
-    @Test
-    public void onBackStackChanged_uxRestrictionsChanged_currentFragmentHasUpdatedUxRestrictions()
-            throws Throwable {
-        CarUxRestrictions oldUxRestrictions = new CarUxRestrictions.Builder(
-                /* reqOpt= */ true,
-                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
-                /* timestamp= */ 0
-        ).build();
-
-        CarUxRestrictions newUxRestrictions = new CarUxRestrictions.Builder(
-                /* reqOpt= */ true,
-                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP,
-                /* timestamp= */ 0
-        ).build();
-
-        AtomicReference<BaseTestSettingsFragment> fragmentA = new AtomicReference<>();
-        AtomicReference<BaseTestSettingsFragment> fragmentB = new AtomicReference<>();
-
-        mActivityTestRule.runOnUiThread(() -> {
-            fragmentA.set(new BaseTestSettingsFragment());
-            fragmentB.set(new BaseTestSettingsFragment());
-            mActivity.launchFragment(fragmentA.get());
-            mActivity.onUxRestrictionsChanged(oldUxRestrictions);
-            mActivity.launchFragment(fragmentB.get());
-            mActivity.onUxRestrictionsChanged(newUxRestrictions);
-            mActivity.goBack();
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-
-        assertThat(
-                fragmentA.get().getUxRestrictions().isSameRestrictions(newUxRestrictions)).isTrue();
-    }
-
-    @Test
-    public void onBackStackChanged_toolbarUpdated() throws Throwable {
-        ToolbarController toolbar = mActivity.getToolbar();
-
-        mActivityTestRule.runOnUiThread(() -> {
-            BaseTestSettingsFragment fragment1 = new BaseTestSettingsFragment();
-            mActivity.launchFragment(fragment1);
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-
-        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
-                NavButtonMode.DISABLED);
-
-        mActivityTestRule.runOnUiThread(() -> {
-            BaseTestSettingsFragment fragment2 = new BaseTestSettingsFragment();
-            mActivity.launchFragment(fragment2);
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-
-        assertThat(toolbar.getNavButtonMode()).isEqualTo(NavButtonMode.BACK);
-
-        mActivityTestRule.runOnUiThread(() -> mActivity.goBack());
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-
-        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
-                NavButtonMode.DISABLED);
-    }
-
-    @Test
-    public void onActivityCreated_noFragment_topLevelMenuFocused() throws Throwable {
-        assertThat(mActivity.findViewById(R.id.top_level_menu).hasFocus()).isTrue();
-    }
-
-    @Test
-    public void onActivityCreated_homepage_topLevelMenuFocused() throws Throwable {
-        ActivityTestRule<TestDualPaneHomepageActivity> activityTestRule =
-                new ActivityTestRule<>(TestDualPaneHomepageActivity.class);
-        activityTestRule.launchActivity(null);
-        mActivity = activityTestRule.getActivity();
-        mFragmentManager = activityTestRule.getActivity().getSupportFragmentManager();
-
-        assertThat(mActivity.findViewById(R.id.top_level_menu).hasFocus()).isTrue();
-    }
-
-    @Test
-    public void onActivityCreated_hasFragment_contentFocused() throws Throwable {
-        ActivityTestRule<TestDualPaneFragmentActivity> activityTestRule =
-                new ActivityTestRule<>(TestDualPaneFragmentActivity.class);
-        activityTestRule.launchActivity(null);
-        mActivity = activityTestRule.getActivity();
-        mFragmentManager = activityTestRule.getActivity().getSupportFragmentManager();
+        BaseCarSettingsTestActivity spiedActivity = spy(mActivity);
+        verify(spiedActivity, never()).startActivity(any(Intent.class));
 
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-    }
-
-    @Test
-    public void onTopLevelPreferenceTapped_focusUpdated() throws Throwable {
-        setUpTopLevelTestFragment();
         mActivityTestRule.runOnUiThread(() ->
-                mTopLevelFragment.getPreferenceScreen().getPreference(0).performClick());
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-    }
-
-    @Test
-    public void onFragmentLaunched_maintainContentFocus() throws Throwable {
-        mActivityTestRule.runOnUiThread(() -> {
-            BaseTestSettingsFragment fragment = new BaseTestSettingsFragment();
-            mActivity.launchFragment(fragment);
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-        mActivityTestRule.runOnUiThread(() ->
-                getCurrentFragment().getPreferenceScreen().getPreference(0).performClick());
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-    }
-
-    @Test
-    public void onBack_maintainContentFocus() throws Throwable {
-        mActivityTestRule.runOnUiThread(() -> {
-            BaseTestSettingsFragment fragment1 = new BaseTestSettingsFragment();
-            mActivity.launchFragment(fragment1);
-            BaseTestSettingsFragment fragment2 = new BaseTestSettingsFragment();
-            mActivity.launchFragment(fragment2);
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-        mActivityTestRule.runOnUiThread(() -> mActivity.goBack());
+                spiedActivity.onPreferenceStartFragment(/* caller= */ null, pref));
         InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-    }
-
-    @Test
-    public void onPreferenceDisabled_maintainContentFocus() throws Throwable {
-        mActivityTestRule.runOnUiThread(() -> {
-            BaseTestSettingsFragment fragment = new BaseTestSettingsFragment();
-            mActivity.launchFragment(fragment);
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-        mActivityTestRule.runOnUiThread(() ->
-                getCurrentFragment().getPreferenceScreen().getPreference(0).setEnabled(false));
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getView().hasFocus()).isTrue();
-    }
-
-    @Test
-    public void onFragmentLaunched_noFocusableElements_parkingViewFocused() throws Throwable {
-        mActivityTestRule.runOnUiThread(() -> {
-            EmptySettingsFragment fragment = new EmptySettingsFragment();
-            mActivity.launchFragment(fragment);
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-
-        assertThat(mActivity.findViewById(R.id.settings_focus_parking_view).isFocused()).isTrue();
-    }
-
-    private void setUpTopLevelTestFragment() throws Throwable {
-        String topLevelMenuTag = "top_level_menu";
-        mActivityTestRule.runOnUiThread(() -> {
-            mFragmentManager.beginTransaction()
-                    .replace(R.id.top_level_menu, new TestTopLevelMenuFragment(), topLevelMenuTag)
-                    .commitNow();
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        mTopLevelFragment = (TopLevelMenuFragment) mFragmentManager.findFragmentByTag(
-                topLevelMenuTag);
-    }
-
-    public static class TestDualPaneHomepageActivity extends DualPaneTestActivity {
-        @Nullable
-        @Override
-        protected Fragment getInitialFragment() {
-            return new BaseTestSettingsFragment();
-        }
-
-        @Override
-        protected boolean shouldFocusContentOnLaunch() {
-            return false;
-        }
-    }
 
-    public static class TestDualPaneFragmentActivity extends DualPaneTestActivity {
-        @Nullable
-        @Override
-        protected Fragment getInitialFragment() {
-            return new BaseTestSettingsFragment();
-        }
+        verify(spiedActivity).startActivity(any(Intent.class));
     }
 }
diff --git a/tests/unit/src/com/android/car/settings/common/DualPaneSettingsFragmentTest.java b/tests/unit/src/com/android/car/settings/common/DualPaneSettingsFragmentTest.java
index 3810bd3e8..c1de251e0 100644
--- a/tests/unit/src/com/android/car/settings/common/DualPaneSettingsFragmentTest.java
+++ b/tests/unit/src/com/android/car/settings/common/DualPaneSettingsFragmentTest.java
@@ -18,10 +18,12 @@ package com.android.car.settings.common;
 
 import static com.google.common.truth.Truth.assertThat;
 
-import androidx.test.platform.app.InstrumentationRegistry;
+import static org.junit.Assert.assertNotNull;
+
+import android.content.Intent;
+
 import androidx.test.rule.ActivityTestRule;
 
-import com.android.car.settings.R;
 import com.android.car.settings.testutils.DualPaneTestActivity;
 
 import org.junit.Rule;
@@ -41,16 +43,17 @@ public class DualPaneSettingsFragmentTest extends SettingsFragmentTestCase<DualP
     }
 
     @Test
-    public void launchFragment_otherFragment_opensFragment() throws Throwable {
+    public void launchFragment_startsActivity() throws Throwable {
         AtomicReference<TestSettingsFragment> otherFragment = new AtomicReference<>();
         getActivityTestRule().runOnUiThread(() -> {
             otherFragment.set(new TestSettingsFragment());
             mFragment.onCreate(null);
             mFragment.launchFragment(otherFragment.get());
         });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(
-                mFragment.getFragmentManager().findFragmentById(R.id.fragment_container)).isEqualTo(
-                otherFragment.get());
+        Intent intent = mActivity.getStartActivityListener().getLastValue();
+        assertNotNull(intent);
+        assertNotNull(intent.getComponent());
+        assertThat(intent.getComponent().getClassName()).isEqualTo(
+                SubSettingsActivity.class.getName());
     }
 }
diff --git a/tests/unit/src/com/android/car/settings/common/DualPaneSubSettingsActivityTest.java b/tests/unit/src/com/android/car/settings/common/DualPaneSubSettingsActivityTest.java
new file mode 100644
index 000000000..7c1cd333a
--- /dev/null
+++ b/tests/unit/src/com/android/car/settings/common/DualPaneSubSettingsActivityTest.java
@@ -0,0 +1,173 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.common;
+
+import static com.google.common.truth.Truth.assertThat;
+
+import static org.mockito.ArgumentMatchers.any;
+import static org.mockito.Mockito.never;
+import static org.mockito.Mockito.spy;
+import static org.mockito.Mockito.verify;
+
+import android.car.drivingstate.CarUxRestrictions;
+import android.content.Context;
+
+import androidx.fragment.app.Fragment;
+import androidx.fragment.app.FragmentManager;
+import androidx.preference.Preference;
+import androidx.test.core.app.ApplicationProvider;
+import androidx.test.ext.junit.runners.AndroidJUnit4;
+import androidx.test.platform.app.InstrumentationRegistry;
+import androidx.test.rule.ActivityTestRule;
+
+import com.android.car.settings.testutils.BaseTestSettingsFragment;
+import com.android.car.settings.testutils.TestSubSettingsActivity;
+import com.android.car.ui.toolbar.NavButtonMode;
+import com.android.car.ui.toolbar.ToolbarController;
+
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+import org.junit.runner.RunWith;
+
+import java.util.concurrent.atomic.AtomicReference;
+
+@RunWith(AndroidJUnit4.class)
+public class DualPaneSubSettingsActivityTest {
+    Context mContext = ApplicationProvider.getApplicationContext();
+    TestSubSettingsActivity mActivity;
+    FragmentManager mFragmentManager;
+
+    @Rule
+    public ActivityTestRule<TestSubSettingsActivity> mActivityTestRule =
+            new ActivityTestRule<>(TestSubSettingsActivity.class);
+
+    @Before
+    public void setUp() throws Throwable {
+        mActivity = mActivityTestRule.getActivity();
+        mFragmentManager = mActivity.getSupportFragmentManager();
+    }
+
+    @Test
+    public void onPreferenceStartFragment_updateFragmentContainer() throws Throwable {
+        Preference pref = new Preference(mContext);
+        pref.setFragment(BaseTestSettingsFragment.class.getName());
+
+        SubSettingsActivity spiedActivity = spy(mActivity);
+        verify(spiedActivity, never()).updateFragmentContainer(any(Fragment.class));
+
+        mActivityTestRule.runOnUiThread(() ->
+                spiedActivity.onPreferenceStartFragment(/* caller= */ null, pref));
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        verify(spiedActivity).updateFragmentContainer(any(Fragment.class));
+    }
+
+    @Test
+    public void onUxRestrictionsChanged_topFragmentInBackStackHasUpdatedUxRestrictions()
+            throws Throwable {
+        CarUxRestrictions oldUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                /* timestamp= */ 0
+        ).build();
+
+        CarUxRestrictions newUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP,
+                /* timestamp= */ 0
+        ).build();
+
+        AtomicReference<BaseTestSettingsFragment> fragmentA = new AtomicReference<>();
+        AtomicReference<BaseTestSettingsFragment> fragmentB = new AtomicReference<>();
+
+        mActivityTestRule.runOnUiThread(() -> {
+            fragmentA.set(new BaseTestSettingsFragment());
+            fragmentB.set(new BaseTestSettingsFragment());
+            mActivity.launchFragment(fragmentA.get());
+            mActivity.onUxRestrictionsChanged(oldUxRestrictions);
+            mActivity.launchFragment(fragmentB.get());
+            mActivity.onUxRestrictionsChanged(newUxRestrictions);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(
+                fragmentB.get().getUxRestrictions().isSameRestrictions(newUxRestrictions)).isTrue();
+    }
+
+    @Test
+    public void onBackStackChanged_uxRestrictionsChanged_currentFragmentHasUpdatedUxRestrictions()
+            throws Throwable {
+        CarUxRestrictions oldUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_BASELINE,
+                /* timestamp= */ 0
+        ).build();
+
+        CarUxRestrictions newUxRestrictions = new CarUxRestrictions.Builder(
+                /* reqOpt= */ true,
+                CarUxRestrictions.UX_RESTRICTIONS_NO_SETUP,
+                /* timestamp= */ 0
+        ).build();
+
+        AtomicReference<BaseTestSettingsFragment> fragmentA = new AtomicReference<>();
+        AtomicReference<BaseTestSettingsFragment> fragmentB = new AtomicReference<>();
+
+        mActivityTestRule.runOnUiThread(() -> {
+            fragmentA.set(new BaseTestSettingsFragment());
+            fragmentB.set(new BaseTestSettingsFragment());
+            mActivity.launchFragment(fragmentA.get());
+            mActivity.onUxRestrictionsChanged(oldUxRestrictions);
+            mActivity.launchFragment(fragmentB.get());
+            mActivity.onUxRestrictionsChanged(newUxRestrictions);
+            mActivity.goBack();
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(
+                fragmentA.get().getUxRestrictions().isSameRestrictions(newUxRestrictions)).isTrue();
+    }
+
+    @Test
+    public void getToolbar_updateFragmentContainer_navButtonAlwaysBack() throws Throwable {
+        ToolbarController toolbar = mActivity.getToolbar();
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.BACK);
+
+        BaseTestSettingsFragment fragment1 = new BaseTestSettingsFragment();
+        mActivityTestRule.runOnUiThread(() -> {
+            mActivity.updateFragmentContainer(fragment1);
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+        mActivityTestRule.runOnUiThread(() -> {
+            fragment1.setupToolbar(fragment1.getToolbar());
+        });
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.BACK);
+
+
+        assertThat(toolbar.getNavButtonMode()).isEqualTo(NavButtonMode.BACK);
+
+        mActivityTestRule.runOnUiThread(() -> mActivity.goBack());
+        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
+
+        assertThat(toolbar.getNavButtonMode()).isEquivalentAccordingToCompareTo(
+                NavButtonMode.BACK);
+    }
+}
diff --git a/tests/unit/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java b/tests/unit/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
index f0aa9b27a..b9a782f6a 100644
--- a/tests/unit/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
+++ b/tests/unit/src/com/android/car/settings/common/ExtraSettingsLoaderTest.java
@@ -16,7 +16,7 @@
 
 package com.android.car.settings.common;
 
-import static com.android.car.settings.common.ExtraSettingsLoader.META_DATA_PREFERENCE_IS_TOP_LEVEL;
+import static com.android.car.settings.common.ExtraSettingsLoader.META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_KEY_ORDER;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_ICON_URI;
 import static com.android.settingslib.drawer.TileUtils.META_DATA_PREFERENCE_SUMMARY;
@@ -235,7 +235,7 @@ public class ExtraSettingsLoaderTest {
 
         assertThat(preferenceToBundleMap).hasSize(1);
         for (Bundle b : preferenceToBundleMap.values()) {
-            assertThat(b.getBoolean(META_DATA_PREFERENCE_IS_TOP_LEVEL)).isTrue();
+            assertThat(b.getBoolean(META_DATA_IS_TOP_LEVEL_EXTRA_SETTINGS)).isTrue();
         }
     }
 
diff --git a/tests/unit/src/com/android/car/settings/common/SinglePaneBaseCarSettingsActivityTest.java b/tests/unit/src/com/android/car/settings/common/SinglePaneBaseCarSettingsActivityTest.java
index d4f605914..67f69ebdb 100644
--- a/tests/unit/src/com/android/car/settings/common/SinglePaneBaseCarSettingsActivityTest.java
+++ b/tests/unit/src/com/android/car/settings/common/SinglePaneBaseCarSettingsActivityTest.java
@@ -23,7 +23,6 @@ import static org.mockito.Mockito.spy;
 import static org.mockito.Mockito.verify;
 
 import android.car.drivingstate.CarUxRestrictions;
-import android.content.Intent;
 
 import androidx.preference.Preference;
 import androidx.test.platform.app.InstrumentationRegistry;
@@ -49,7 +48,7 @@ public class SinglePaneBaseCarSettingsActivityTest
     }
 
     @Test
-    public void onPreferenceStartFragment_launchesActivity() throws Throwable {
+    public void onPreferenceStartFragment_updateFragmentContainer() throws Throwable {
         Preference pref = new Preference(mContext);
         pref.setFragment(BaseTestSettingsFragment.class.getName());
 
@@ -59,7 +58,7 @@ public class SinglePaneBaseCarSettingsActivityTest
                 spiedActivity.onPreferenceStartFragment(/* caller= */ null, pref));
         InstrumentationRegistry.getInstrumentation().waitForIdleSync();
 
-        verify(spiedActivity).startActivity(any(Intent.class));
+        verify(spiedActivity).updateFragmentContainer(any(BaseTestSettingsFragment.class));
     }
 
     @Test
diff --git a/tests/unit/src/com/android/car/settings/common/TopLevelMenuFragmentTest.java b/tests/unit/src/com/android/car/settings/common/TopLevelMenuFragmentTest.java
index c78af5305..c88819fb3 100644
--- a/tests/unit/src/com/android/car/settings/common/TopLevelMenuFragmentTest.java
+++ b/tests/unit/src/com/android/car/settings/common/TopLevelMenuFragmentTest.java
@@ -25,9 +25,8 @@ import androidx.test.platform.app.InstrumentationRegistry;
 import androidx.test.rule.ActivityTestRule;
 
 import com.android.car.settings.R;
-import com.android.car.settings.testutils.DualPaneTestActivity;
+import com.android.car.settings.testutils.SinglePaneTestActivity;
 import com.android.car.settings.testutils.TestSettingsFragment1;
-import com.android.car.settings.testutils.TestSettingsFragment2;
 import com.android.car.settings.testutils.TestTopLevelMenuFragment;
 
 import org.junit.Before;
@@ -40,17 +39,15 @@ import org.mockito.MockitoAnnotations;
 public class TopLevelMenuFragmentTest {
 
     private TopLevelMenuFragment mFragment;
-    private DualPaneTestActivity mActivity;
     private FragmentManager mFragmentManager;
 
     @Rule
-    public ActivityTestRule<DualPaneTestActivity> mActivityTestRule =
-            new ActivityTestRule<>(DualPaneTestActivity.class);
+    public ActivityTestRule<SinglePaneTestActivity> mActivityTestRule =
+            new ActivityTestRule<>(SinglePaneTestActivity.class);
 
     @Before
     public void setUp() throws Throwable {
         MockitoAnnotations.initMocks(this);
-        mActivity = mActivityTestRule.getActivity();
         mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
         setUpFragment();
     }
@@ -72,33 +69,12 @@ public class TopLevelMenuFragmentTest {
         assertThat(mFragment.getSelectedPreferenceKey()).isEqualTo("pk_test_fragment_1");
     }
 
-    @Test
-    public void onSamePreferenceTapped_noDuplicateEntry() throws Throwable {
-        mActivityTestRule.runOnUiThread(() -> {
-            mFragment.getPreferenceScreen().getPreference(0).performClick();
-            mFragment.getPreferenceScreen().getPreference(0).performClick();
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getClass()).isEqualTo(TestSettingsFragment1.class);
-        assertThat(mFragmentManager.getBackStackEntryCount()).isEqualTo(1);
-    }
-
-    @Test
-    public void onDifferentPreferenceTapped_clearsBackStack() throws Throwable {
-        mActivityTestRule.runOnUiThread(() -> {
-            mFragment.getPreferenceScreen().getPreference(0).performClick();
-            mFragment.getPreferenceScreen().getPreference(1).performClick();
-        });
-        InstrumentationRegistry.getInstrumentation().waitForIdleSync();
-        assertThat(getCurrentFragment().getClass()).isEqualTo(TestSettingsFragment2.class);
-        assertThat(mFragmentManager.getBackStackEntryCount()).isEqualTo(1);
-    }
-
     private void setUpFragment() throws Throwable {
         String topLevelMenuTag = "top_level_menu";
         mActivityTestRule.runOnUiThread(() -> {
             mFragmentManager.beginTransaction()
-                    .replace(R.id.top_level_menu, new TestTopLevelMenuFragment(), topLevelMenuTag)
+                    .replace(R.id.fragment_container, new TestTopLevelMenuFragment(),
+                            topLevelMenuTag)
                     .commitNow();
         });
         InstrumentationRegistry.getInstrumentation().waitForIdleSync();
diff --git a/tests/unit/src/com/android/car/settings/datausage/AppDataUsageFragmentTest.java b/tests/unit/src/com/android/car/settings/datausage/AppDataUsageFragmentTest.java
index abddc4a4f..6942ab351 100644
--- a/tests/unit/src/com/android/car/settings/datausage/AppDataUsageFragmentTest.java
+++ b/tests/unit/src/com/android/car/settings/datausage/AppDataUsageFragmentTest.java
@@ -18,9 +18,14 @@ package com.android.car.settings.datausage;
 
 import static com.google.common.truth.Truth.assertThat;
 
+import static org.mockito.Mockito.when;
+
+import android.content.Context;
+import android.net.NetworkTemplate;
 import android.os.Bundle;
 import android.text.format.DateUtils;
 
+import androidx.annotation.NonNull;
 import androidx.fragment.app.FragmentManager;
 import androidx.test.annotation.UiThreadTest;
 import androidx.test.ext.junit.runners.AndroidJUnit4;
@@ -28,14 +33,17 @@ import androidx.test.rule.ActivityTestRule;
 
 import com.android.car.settings.R;
 import com.android.car.settings.testutils.BaseCarSettingsTestActivity;
+import com.android.settingslib.net.DataUsageController;
 import com.android.settingslib.net.NetworkCycleChartData;
 
 import org.junit.Before;
 import org.junit.Rule;
 import org.junit.Test;
 import org.junit.runner.RunWith;
+import org.mockito.Mock;
 import org.mockito.MockitoAnnotations;
 
+import java.util.Collections;
 import java.util.HashMap;
 import java.util.Map;
 
@@ -48,6 +56,13 @@ public class AppDataUsageFragmentTest {
     private TestAppDataUsageFragment mFragment;
     private FragmentManager mFragmentManager;
 
+    @Mock
+    private NetworkTemplate mNetworkTemplate;
+    @Mock
+    private DataUsageController.DataUsageInfo mDataUsageInfo;
+    @Mock
+    private DataUsageCycleManager mDataUsageCycleManager;
+
     @Rule
     public ActivityTestRule<BaseCarSettingsTestActivity> mActivityTestRule =
             new ActivityTestRule<>(BaseCarSettingsTestActivity.class);
@@ -56,6 +71,8 @@ public class AppDataUsageFragmentTest {
     public void setUp() throws Throwable {
         MockitoAnnotations.initMocks(this);
         mFragmentManager = mActivityTestRule.getActivity().getSupportFragmentManager();
+
+        when(mNetworkTemplate.getWifiNetworkKeys()).thenReturn(Collections.emptySet());
     }
 
     @Test
@@ -101,7 +118,8 @@ public class AppDataUsageFragmentTest {
         mActivityTestRule.runOnUiThread(() -> {
             mFragmentManager.beginTransaction()
                     .replace(R.id.fragment_container,
-                            TestAppDataUsageFragment.newInstance(hasDataCycles),
+                            TestAppDataUsageFragment.newInstance(hasDataCycles, mNetworkTemplate,
+                                    mDataUsageInfo, mDataUsageCycleManager),
                             appDataUsageFragmentTag)
                     .commitNow();
         });
@@ -114,10 +132,19 @@ public class AppDataUsageFragmentTest {
 
         // Ensure onDataCyclePicked() isn't called on test devices with data plans
         private boolean mHasDataCycles;
-
-        public static TestAppDataUsageFragment newInstance(boolean hasDataCycles) {
+        private NetworkTemplate mNetworkTemplate;
+        private DataUsageController.DataUsageInfo mDataUsageInfo;
+        private DataUsageCycleManager mDataUsageCycleManager;
+
+        /** Creates a TestAppDataUsageFragment with the substituted values */
+        public static TestAppDataUsageFragment newInstance(boolean hasDataCycles,
+                NetworkTemplate networkTemplate, DataUsageController.DataUsageInfo dataUsageInfo,
+                DataUsageCycleManager dataUsageCycleManager) {
             TestAppDataUsageFragment fragment = new TestAppDataUsageFragment();
             fragment.mHasDataCycles = hasDataCycles;
+            fragment.mNetworkTemplate = networkTemplate;
+            fragment.mDataUsageInfo = dataUsageInfo;
+            fragment.mDataUsageCycleManager = dataUsageCycleManager;
             return fragment;
         }
 
@@ -129,5 +156,21 @@ public class AppDataUsageFragmentTest {
             }
             super.onDataCyclePicked(cycle, usages);
         }
+
+        @Override
+        NetworkTemplate getNetworkTemplate(Context context, int subId) {
+            return mNetworkTemplate;
+        }
+
+        @Override
+        DataUsageController.DataUsageInfo getDataUsageInfo(
+                @NonNull NetworkTemplate networkTemplate) {
+            return mDataUsageInfo;
+        }
+
+        @Override
+        DataUsageCycleManager getDataUsageCycleManager(@NonNull NetworkTemplate networkTemplate) {
+            return mDataUsageCycleManager;
+        }
     }
 }
diff --git a/tests/unit/src/com/android/car/settings/system/DualPaneFactoryResetFragmentTest.java b/tests/unit/src/com/android/car/settings/system/DualPaneFactoryResetFragmentTest.java
index 621f673c2..ba964a732 100644
--- a/tests/unit/src/com/android/car/settings/system/DualPaneFactoryResetFragmentTest.java
+++ b/tests/unit/src/com/android/car/settings/system/DualPaneFactoryResetFragmentTest.java
@@ -18,15 +18,18 @@ package com.android.car.settings.system;
 
 import static android.app.Activity.RESULT_OK;
 
+import static com.android.car.settings.common.SubSettingsActivity.KEY_SUB_SETTINGS_FRAGMENT;
 import static com.android.car.settings.system.FactoryResetFragment.CHECK_LOCK_REQUEST_CODE;
 
 import static com.google.common.truth.Truth.assertThat;
 
-import androidx.fragment.app.Fragment;
+import static org.junit.Assert.assertNotNull;
+
+import android.content.Intent;
+
 import androidx.test.platform.app.InstrumentationRegistry;
 import androidx.test.rule.ActivityTestRule;
 
-import com.android.car.settings.R;
 import com.android.car.settings.testutils.DualPaneTestActivity;
 
 import org.junit.Rule;
@@ -45,15 +48,17 @@ public class DualPaneFactoryResetFragmentTest
     }
 
     @Test
-    public void processActivityResult_resultOk_launchesFactoryResetConfirmFragment()
+    public void processActivityResult_resultOk_launchesFactoryResetConfirmActivity()
             throws Throwable {
         getActivityTestRule().runOnUiThread(() -> {
             mFragment.processActivityResult(CHECK_LOCK_REQUEST_CODE, RESULT_OK, /* data= */ null);
         });
         InstrumentationRegistry.getInstrumentation().waitForIdleSync();
 
-        Fragment launchedFragment = mFragmentManager.findFragmentById(R.id.fragment_container);
-
-        assertThat(launchedFragment).isInstanceOf(FactoryResetConfirmFragment.class);
+        Intent intent = mActivity.getStartActivityListener().getLastValue();
+        assertNotNull(intent);
+        String fragmentClass = intent.getStringExtra(KEY_SUB_SETTINGS_FRAGMENT);
+        assertNotNull(fragmentClass);
+        assertThat(fragmentClass).isEqualTo(FactoryResetConfirmFragment.class.getName());
     }
 }
diff --git a/tests/unit/src/com/android/car/settings/system/SinglePaneFactoryResetFragmentTest.java b/tests/unit/src/com/android/car/settings/system/SinglePaneFactoryResetFragmentTest.java
index 6edda4504..645646f3b 100644
--- a/tests/unit/src/com/android/car/settings/system/SinglePaneFactoryResetFragmentTest.java
+++ b/tests/unit/src/com/android/car/settings/system/SinglePaneFactoryResetFragmentTest.java
@@ -20,9 +20,12 @@ import static android.app.Activity.RESULT_OK;
 
 import static com.android.car.settings.system.FactoryResetFragment.CHECK_LOCK_REQUEST_CODE;
 
+import static com.google.common.truth.Truth.assertThat;
+
 import androidx.test.platform.app.InstrumentationRegistry;
 import androidx.test.rule.ActivityTestRule;
 
+import com.android.car.settings.R;
 import com.android.car.settings.testutils.SinglePaneTestActivity;
 
 import org.junit.Rule;
@@ -41,13 +44,14 @@ public class SinglePaneFactoryResetFragmentTest
     }
 
     @Test
-    public void processActivityResult_resultOk_launchesActivity()
+    public void processActivityResult_resultOk_updatesFragmentContainer()
             throws Throwable {
         getActivityTestRule().runOnUiThread(() -> {
             mFragment.processActivityResult(CHECK_LOCK_REQUEST_CODE, RESULT_OK, /* data= */ null);
         });
         InstrumentationRegistry.getInstrumentation().waitForIdleSync();
 
-        mActivity.getStartActivityListener().assertCalled();
+        assertThat(mFragmentManager.findFragmentById(R.id.fragment_container))
+                .isInstanceOf(FactoryResetConfirmFragment.class);
     }
 }
diff --git a/tests/unit/src/com/android/car/settings/testutils/TestSubSettingsActivity.java b/tests/unit/src/com/android/car/settings/testutils/TestSubSettingsActivity.java
new file mode 100644
index 000000000..62255db90
--- /dev/null
+++ b/tests/unit/src/com/android/car/settings/testutils/TestSubSettingsActivity.java
@@ -0,0 +1,31 @@
+/*
+ * Copyright (C) 2024 The Android Open Source Project
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package com.android.car.settings.testutils;
+
+import androidx.fragment.app.Fragment;
+
+import com.android.car.settings.common.SubSettingsActivity;
+
+/**
+ * Example SubSettingsActivity class used for Testing secondary pane behavior.
+ */
+public class TestSubSettingsActivity extends SubSettingsActivity {
+    @Override
+    protected Fragment getInitialFragment() {
+        return null;
+    }
+}
diff --git a/tools/add_intents_to_manifest.sh b/tools/add_intents_to_manifest.sh
new file mode 100755
index 000000000..ada0b87af
--- /dev/null
+++ b/tools/add_intents_to_manifest.sh
@@ -0,0 +1,27 @@
+#!/bin/bash
+#  Copyright (C) 2024 The Android Open Source Project
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+# Run this script to add the new unresolved intents to Settings manifest.xml file.
+if [[ -z "$ANDROID_BUILD_TOP" ]]; then
+  echo 'ANDROID_BUILD_TOP environment variable is empty; did you forget to run `lunch`?'
+  exit 1
+fi
+PROJECT_TOP=$ANDROID_BUILD_TOP/packages/apps/Car/Settings
+python3 $PROJECT_TOP/tools/handleintents/auto_add_intents.py \
+    -i $ANDROID_BUILD_TOP/frameworks/base/core/java/android/provider/Settings.java \
+    -o $PROJECT_TOP/AndroidManifest.xml \
+    -p ACTION_ \
+    -f $PROJECT_TOP/tools/handleintents/intent_format.txt \
+    -t $PROJECT_TOP/tools/handleintents/target_string.txt \
+    -e
diff --git a/tools/handleintents/add_to_file.py b/tools/handleintents/add_to_file.py
new file mode 100644
index 000000000..215cdba0f
--- /dev/null
+++ b/tools/handleintents/add_to_file.py
@@ -0,0 +1,85 @@
+#  Copyright (C) 2024 The Android Open Source Project
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+
+import re
+
+"""
+Script used to insert a list of strings in a certain format after the target string.
+"""
+def insert_after_string(output_file, target_string_file, list, format_file):
+    format_string = extract_format_string(format_file)
+
+    string_to_insert = ""
+    for new_string in list:
+        string_to_insert += format_string.format(new_string)
+
+    target_string = extract_target_string(target_string_file)
+    try:
+        with open(output_file, 'r+') as file:
+            file_content = file.read()
+            match = re.search(target_string, file_content, re.DOTALL)
+            if match:
+                file.seek(match.end())
+                remaining_content = file.read()
+                file.seek(match.end())
+                file.write('\n' + string_to_insert.rstrip() + remaining_content)
+            else:
+                print(f"Target string '{target_string}' not found in file.")
+
+    except FileNotFoundError:
+        print(f"Error: Output file '{output_file}' not found.")
+    except Exception as e:
+        print(f"An error occurred: {e}")
+
+def extract_format_string(format_file):
+    try:
+        with open(format_file, 'r') as file:
+            format_string = ""
+            for line in file.readlines():
+                format_string += line
+            return format_string
+
+    except FileNotFoundError:
+        print(f"Error: File '{format_file}' not found.")
+        return "{}"
+    except Exception as e:
+        print(f"An error occurred: {e}")
+        return "{}"
+
+def extract_target_string(target_string_file):
+    try:
+        with open(target_string_file, 'r') as file:
+            target_string = ""
+            for line in file.readlines():
+                target_string += line.rstrip()
+            return "({})".format(target_string)
+
+    except FileNotFoundError:
+        print(f"Error: File '{format_file}' not found.")
+        return ""
+    except Exception as e:
+        print(f"An error occurred: {e}")
+        return ""
diff --git a/tools/handleintents/auto_add_intents.py b/tools/handleintents/auto_add_intents.py
new file mode 100644
index 000000000..d54974310
--- /dev/null
+++ b/tools/handleintents/auto_add_intents.py
@@ -0,0 +1,82 @@
+#!/usr/bin/env python3
+#  Copyright (C) 2024 The Android Open Source Project
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+
+import argparse
+import sys
+import parse_input_file
+import parse_output_file
+import add_to_file
+from datetime import datetime
+if sys.version_info[0] != 3:
+    print("Must use python 3")
+    sys.exit(1)
+
+COPYRIGHT_STR = """ Copyright (C) %s The Android Open Source Project
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+  http://www.apache.org/licenses/LICENSE-2.0
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.""" % (datetime.today().strftime("%Y"))
+
+"""
+Script used to automatically add the intents that match the filterPattern to the outputFile.
+"""
+def main():
+    parser = argparse.ArgumentParser(description='Auto adding Intents.')
+    required_args = parser.add_argument_group('required arguments')
+    required_args.add_argument('-i', '--inputFile', nargs='+', help='Input file path (absolute or relative to cwd)', required=True)
+    required_args.add_argument('-o', '--outputFile', help='Output file path (absolute or relative to cwd)', required=True)
+    required_args.add_argument('-p', '--filterPattern', default='', help='Input file path (absolute or relative to cwd)', required=True)
+    optional_args = parser.add_argument_group('optional arguments')
+    optional_args.add_argument('-f', '--formatFile', default='', help='The file contains the format for the filtered strings when added to the output file')
+    optional_args.add_argument('-t', '--targetStringFile', default='', help='This file contains the target string after which the new content will be inserted.')
+    optional_args.add_argument('-e', '--excludeHiddenIntents', action=argparse.BooleanOptionalAction, help='whether to exclude hidden apis.')
+    args = parser.parse_args()
+
+    new_strings = filter_new_strings(args)
+    if (len(new_strings) != 0):
+        add_new_strings(args, new_strings)
+
+def filter_new_strings(args):
+    filtered_strings = []
+    for file in args.inputFile:
+        filtered_strings.extend(parse_input_file.filter_javadoc_fields(
+            file, args.filterPattern, args.excludeHiddenIntents))
+
+    current_strings = parse_output_file.filter_intent_actions(args.outputFile)
+    new_strings = sorted(set(filtered_strings) - set(current_strings))
+    return new_strings
+
+def add_new_strings(args, new_strings):
+    add_to_file.insert_after_string(args.outputFile, args.targetStringFile, new_strings, args.formatFile)
+
+if __name__ == '__main__':
+    main()
diff --git a/tools/handleintents/intent_format.txt b/tools/handleintents/intent_format.txt
new file mode 100644
index 000000000..d314fad7b
--- /dev/null
+++ b/tools/handleintents/intent_format.txt
@@ -0,0 +1,4 @@
+            <intent-filter>
+                <action android:name="{}" />
+                <category android:name="android.intent.category.DEFAULT" />
+            </intent-filter>
diff --git a/tools/handleintents/parse_input_file.py b/tools/handleintents/parse_input_file.py
new file mode 100644
index 000000000..52cb98d59
--- /dev/null
+++ b/tools/handleintents/parse_input_file.py
@@ -0,0 +1,46 @@
+#  Copyright (C) 2024 The Android Open Source Project
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+
+import re
+import os
+
+"""
+Script used to filter a file for public static final string values that match the provided format.
+"""
+def filter_javadoc_fields(file_path, format, exclude_hidden):
+    try:
+        with open(file_path, 'r') as file:
+            content = file.read()
+
+            pattern = fr'/\*\*(.*?)\*/\s*(.*?)public static final String\s+({format}\w+)\s*=\s*"(.*?)";'
+            matches = re.findall(pattern, content, re.DOTALL)
+            results = []
+
+            for match in matches:
+                java_doc, tag, field_name, value = match
+                if (exclude_hidden and "@hide" not in java_doc) or not exclude_hidden:
+                    results.append(value)
+            return results
+
+    except FileNotFoundError:
+        print(f"Error: File '{file_path}' not found.")
+    except Exception as e:
+        print(f"An error occurred: {e}")
+
+def main():
+    file_path = os.environ.get('ANDROID_BUILD_TOP') + '/frameworks/base/core/java/android/provider/Settings.java'
+    results = filter_javadoc_fields(file_path, "ACTION_", True)
+
+if __name__ == '__main__':
+    main()
diff --git a/tools/handleintents/parse_output_file.py b/tools/handleintents/parse_output_file.py
new file mode 100644
index 000000000..bc55b7a70
--- /dev/null
+++ b/tools/handleintents/parse_output_file.py
@@ -0,0 +1,40 @@
+#  Copyright (C) 2024 The Android Open Source Project
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+
+import re
+
+"""
+Script used to filter a file for intent actions.
+"""
+def filter_intent_actions(file_path):
+    try:
+        with open(file_path, 'r') as file:
+            content = file.read()
+
+            pattern = r'<action android:name="([^"]+)"'
+            matches = re.findall(pattern, content)
+
+            return matches
+
+    except FileNotFoundError:
+        print(f"Error: File '{file_path}' not found.")
+    except Exception as e:
+        print(f"An error occurred: {e}")
+
+def main():
+    file_path = '../../AndroidManifest.xml'
+    actions = filter_intent_filter_actions(file_path)
+
+if __name__ == '__main__':
+    main()
diff --git a/tools/handleintents/target_string.txt b/tools/handleintents/target_string.txt
new file mode 100644
index 000000000..aa94e8ed5
--- /dev/null
+++ b/tools/handleintents/target_string.txt
@@ -0,0 +1 @@
+SettingsToastActivity.*?>
diff --git a/tools/handleintents/verify_intents.py b/tools/handleintents/verify_intents.py
new file mode 100755
index 000000000..e7cc430c7
--- /dev/null
+++ b/tools/handleintents/verify_intents.py
@@ -0,0 +1,61 @@
+#!/usr/bin/env python3
+#  Copyright (C) 2024 The Android Open Source Project
+#
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
+#
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
+
+import argparse
+import sys
+
+from datetime import datetime
+if sys.version_info[0] != 3:
+    print("Must use python 3")
+    sys.exit(1)
+
+COPYRIGHT_STR = """ Copyright (C) %s The Android Open Source Project
+Licensed under the Apache License, Version 2.0 (the "License");
+you may not use this file except in compliance with the License.
+You may obtain a copy of the License at
+  http://www.apache.org/licenses/LICENSE-2.0
+Unless required by applicable law or agreed to in writing, software
+distributed under the License is distributed on an "AS IS" BASIS,
+WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+See the License for the specific language governing permissions and
+limitations under the License.""" % (datetime.today().strftime("%Y"))
+
+"""
+Script used to verify whether there are new intents that should be handled by CarSettings.
+"""
+import auto_add_intents
+import sys
+
+def main():
+    parser = argparse.ArgumentParser(description='Auto adding Intents.')
+    required_args = parser.add_argument_group('required arguments')
+    required_args.add_argument('-i', '--inputFile', nargs='+', help='Input file path (absolute or relative to cwd)', required=True)
+    required_args.add_argument('-o', '--outputFile', help='Output file path (absolute or relative to cwd)', required=True)
+    required_args.add_argument('-p', '--filterPattern', default='', help='Input file path (absolute or relative to cwd)', required=True)
+    optional_args = parser.add_argument_group('optional arguments')
+    optional_args.add_argument('-e', '--excludeHiddenIntents', action=argparse.BooleanOptionalAction, help='whether to exclude hidden apis.')
+    args = parser.parse_args()
+
+    new_strings = auto_add_intents.filter_new_strings(args)
+    if (len(new_strings) != 0):
+        print("WARNING: The following new Intents should be supported!")
+        for new_string in new_strings:
+            print(new_string)
+        sys.exit(77)
+    else:
+        sys.exit(0)
+
+if __name__ == '__main__':
+    main()
```

