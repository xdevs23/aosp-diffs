```diff
diff --git a/res/values-af/strings.xml b/res/values-af/strings.xml
index fe50c19..673739d 100644
--- a/res/values-af/strings.xml
+++ b/res/values-af/strings.xml
@@ -18,8 +18,8 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="app_name" msgid="170210454004696382">"Sleutelketting"</string>
     <string name="title_select_cert" msgid="3588447616418041699">"Kies \'n sertifikaat"</string>
-    <string name="requesting_application" msgid="1589142627467598421">"Die %s-program het \'n sertifikaat versoek. Die kies van \'n sertifikaat sal dat die program hierdie identiteit nou en in die toekoms by bedieners gaan gebruik."</string>
-    <string name="requesting_server" msgid="5832565605998634370">"Die program het die versoekende bediener as %s geïdentifiseer, maar jy moet slegs vir die program toegang tot die sertifikaat gee as jy die program vertrou."</string>
+    <string name="requesting_application" msgid="1589142627467598421">"Die %s-app het \'n sertifikaat versoek. Die kies van \'n sertifikaat sal die app toelaat om hierdie identiteit nou en in die toekoms by bedieners te gebruik."</string>
+    <string name="requesting_server" msgid="5832565605998634370">"Die app het die versoekende bediener as %s geïdentifiseer, maar jy moet slegs vir die app toegang tot die sertifikaat gee as jy die app vertrou."</string>
     <string name="install_new_cert_message" msgid="4451971501142085495">"Jy kan sertifikate installeer van \'n PKCS#12-lêer met \'n %1$s- of \'n %2$s-uitbreiding wat in eksterne berging geleë is."</string>
     <string name="allow_button" msgid="3030990695030371561">"Kies"</string>
     <string name="deny_button" msgid="3766539809121892584">"Weier"</string>
diff --git a/res/values-kn/strings.xml b/res/values-kn/strings.xml
index 8d6b506..a9d05ba 100644
--- a/res/values-kn/strings.xml
+++ b/res/values-kn/strings.xml
@@ -18,8 +18,8 @@
     xmlns:xliff="urn:oasis:names:tc:xliff:document:1.2">
     <string name="app_name" msgid="170210454004696382">"ಕೀ ಚೈನ್‌"</string>
     <string name="title_select_cert" msgid="3588447616418041699">"ಪ್ರಮಾಣಪತ್ರವನ್ನು ಆಯ್ಕೆಮಾಡಿ"</string>
-    <string name="requesting_application" msgid="1589142627467598421">"%s ಅಪ್ಲಿಕೇಶನ್‌‌ ಪ್ರಮಾಣಪತ್ರವೊಂದನ್ನು ವಿನಂತಿಸಿದೆ. ಪ್ರಮಾಣಪತ್ರವನ್ನು ಆಯ್ಕೆ ಮಾಡುವುದರಿಂದ ಸರ್ವರ್‌ಗಳೊಂದಿಗೆ ಈಗ ಮತ್ತು ಭವಿಷ್ಯದಲ್ಲಿ ಈ ಗುರುತನ್ನು ಬಳಸಲು ಈ ಅಪ್ಲಿಕೇಶನ್‌‌ಗೆ ಅನುಮತಿಸುತ್ತದೆ."</string>
-    <string name="requesting_server" msgid="5832565605998634370">"ಅಪ್ಲಿಕೇಶನ್‌ ವಿನಂತಿಸಿದ ಸರ್ವರ್‌ ಅನ್ನು %s ರಂತೆ ಗುರುತಿಸಿದೆ, ಆದರೆ ನೀವು ಅಪ್ಲಿಕೇಶನ್‌‌ ಅನ್ನು ನಂಬಿದರೆ ಮಾತ್ರ ಪ್ರಮಾಣಪತ್ರಕ್ಕೆ ಅಪ್ಲಿಕೇಶನ್‌ ಪ್ರವೇಶವನ್ನು ನೀಡಬೇಕು."</string>
+    <string name="requesting_application" msgid="1589142627467598421">"%s ಆ್ಯಪ್‌ ಪ್ರಮಾಣಪತ್ರವೊಂದನ್ನು ವಿನಂತಿಸಿದೆ. ಪ್ರಮಾಣಪತ್ರವನ್ನು ಆಯ್ಕೆ ಮಾಡುವುದರಿಂದ ಸರ್ವರ್‌ಗಳೊಂದಿಗೆ ಈಗ ಮತ್ತು ಭವಿಷ್ಯದಲ್ಲಿ ಈ ಗುರುತನ್ನು ಬಳಸಲು ಈ ಆ್ಯಪ್‌ಗೆ ಅನುಮತಿಸುತ್ತದೆ."</string>
+    <string name="requesting_server" msgid="5832565605998634370">"ಆ್ಯಪ್‌ ವಿನಂತಿಸಿದ ಸರ್ವರ್‌ ಅನ್ನು %s ರಂತೆ ಗುರುತಿಸಿದೆ, ಆದರೆ ನೀವು ಆ್ಯಪ್‌ ಅನ್ನು ನಂಬಿದರೆ ಮಾತ್ರ ಪ್ರಮಾಣಪತ್ರಕ್ಕೆ ಆ್ಯಪ್‌ ಪ್ರವೇಶವನ್ನು ನೀಡಬೇಕು."</string>
     <string name="install_new_cert_message" msgid="4451971501142085495">"ಬಾಹ್ಯ ಸಂಗ್ರಹಣೆಯಲ್ಲಿ ಸಂಗ್ರಹವಾಗಿರುವ %1$s ಅಥವಾ %2$s ವಿಸ್ತರಣೆಯೊಂದಿಗೆ PKCS#12 ಫೈಲ್‌ನಿಂದ ನೀವು ಪ್ರಮಾಣಪತ್ರಗಳನ್ನು ಇನ್‌ಸ್ಟಾಲ್ ಮಾಡಬಹುದು."</string>
     <string name="allow_button" msgid="3030990695030371561">"ಆಯ್ಕೆಮಾಡಿ"</string>
     <string name="deny_button" msgid="3766539809121892584">"ನಿರಾಕರಿಸಿ"</string>
diff --git a/src/com/android/keychain/KeyChainService.java b/src/com/android/keychain/KeyChainService.java
index 18f6b45..699f507 100644
--- a/src/com/android/keychain/KeyChainService.java
+++ b/src/com/android/keychain/KeyChainService.java
@@ -37,6 +37,7 @@ import android.net.Uri;
 import android.os.Binder;
 import android.os.Build;
 import android.os.IBinder;
+import android.os.UserManager;
 import android.os.Process;
 import android.os.UserHandle;
 import android.security.AppUriAuthenticationPolicy;
@@ -533,11 +534,10 @@ public class KeyChainService extends IntentService {
                 return false;
             }
 
-            if (uid == Process.WIFI_UID && UserHandle.myUserId() != UserHandle.USER_SYSTEM) {
-                Log.e(TAG, String.format(
-                        "Installation into the WiFi Keystore should be called from the primary "
-                                + "user, not user %d",
-                        UserHandle.myUserId()));
+            UserManager userManager = mContext.getSystemService(UserManager.class);
+            if (uid == Process.WIFI_UID && !userManager.isAdminUser()) {
+                Log.e(TAG,
+                    "Installation into the WiFi Keystore should be called from the admin user");
                 return false;
             }
 
```

